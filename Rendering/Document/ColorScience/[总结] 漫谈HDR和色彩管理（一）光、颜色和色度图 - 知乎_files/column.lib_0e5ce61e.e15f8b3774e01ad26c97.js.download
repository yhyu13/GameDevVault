(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{99:function(e,t,n){"use strict";n.d(t,"a",(function(){return qt})),n.d(t,"b",(function(){return ht})),n.d(t,"c",(function(){return Ut})),n.d(t,"d",(function(){return Kt})),n.d(t,"e",(function(){return Tt})),n.d(t,"f",(function(){return Zt})),n.d(t,"g",(function(){return ot})),n.d(t,"h",(function(){return pt})),n.d(t,"i",(function(){return et})),n.d(t,"j",(function(){return Ct})),n.d(t,"k",(function(){return tt})),n.d(t,"l",(function(){return Ye})),n.d(t,"m",(function(){return Jt})),n.d(t,"n",(function(){return Pt}));var o,r=n(32),a=n.n(r),i=n(50),c=n.n(i),l=n(71),s=n.n(l),u=n(24),d=n.n(u),f=n(27),g=n.n(f),b=n(30),m=n.n(b),h=n(114),p=n.n(h),v=n(37),A=n.n(v),O=n(10),k=n.n(O),j=n(1),w=n(57),y=n.n(w),C=n(19),x=(n(741),n(8)),B=n(91),L=n(385),z=n(732),G=n(0),S=n(2),R=n.n(S),I=n(7),W=n.n(I),T=n(5),E=n(162),D=n(105),N=n.n(D),K=n(65),P=n(18),M=n(457),_=n.n(M),V=n(47),q=n(1273),U=n(1270),Q=n(913),H=n.n(Q),F=n(83),Z=n(118),J=n.n(Z),X=n(115),Y=n(55),$=n(233),ee=n(88),te=n.n(ee),ne=n(551),oe=n.n(ne),re=n(49),ae=n(73),ie=n.n(ae),ce=n(448),le=["as","tag","className","html","clearBoth","richContentKey","root","Portal","useHooks"],se=["text","target","url","image","imageWidth","imageHeight","component","className","size","children"],ue=["inEditor","data-text","href","zaBlock"],de=["root"],fe=["node","tagName"],ge=["src","useWebP","useMp4","onRef","onLoadStateChange"],be=["html","css","options","ConditionalImage","linkCardInfo"],me=["lazyLoadImageOptions","useGifPortalOption"];function he(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var o=t.length;return function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}(t,void 0!==n&&n<o?n:o)}return e(t,n)}var pe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){"function"==typeof t?t(e):t&&(t.current=e)}))}};function ve(e){var t=this;return e.length?function(n,o){for(var r=e.length-1,a=n;r>=0;)a=e[r].call(t,a,o),r--;return a}:y.a}var Ae="function"==typeof queueMicrotask?queueMicrotask:function(e){return Promise.resolve().then(e)},Oe=function(e){var t=Object(j.useRef)(null);Object(j.useEffect)((function(){if(e)return Ae((function(){e&&(t.current=function(e){var t=new IntersectionObserver((function(e){e.forEach(n)}),{threshold:[.1]});function n(e){if(0!==e.intersectionRatio){var n=e.target;n.dataset.zaDetailViewId=n.cardShowViewId,C.a.trackCardShow(n,{},{link:{url:n.href}}),t.unobserve(n),n.clickViewId&&(n.dataset.zaDetailViewId=n.clickViewId)}}return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'},{cardShowViewId:7692,selector:"a.FileLinkCard .FileLinkCard-info"},{cardShowViewId:9744,selector:".Catalog"}].forEach((function(n){var o=n.selector,r=n.cardShowViewId,a=n.clickViewId;Array.from(e.querySelectorAll(o)).forEach((function(e){e.cardShowViewId=r,e.clickViewId=a,t.observe(e)}))})),function(){t.disconnect()}}(e))})),function(){t.current&&t.current()}}),[e])},ke=function(e){return{elementLocation:{type:"Button",content:{type:e.dataset.zaContentType}}}},je=function(e){return{attachedInfoBytes:e.dataset.zaAttachInfo}},we=[{selector:"a.external, a.internal",zaBlock:"ZTextLink"},{selector:"a.member_mention, a.UserLink-link",zaBlock:"ZTextMention"},{selector:"a.video-box",zaBlock:"ZTextVideoCard"},{selector:'a.LinkCard.old[data-draft-type="link-card"]',zaBlock:"ZTextLinkCard"},{selector:'a.LinkCard.new.static[data-draft-type="link-card"]:not([data-za-content-type="Zvideo"])',zaBlock:"ZTextLinkCard",viewInfoBuilder:ke,extraInfoBuilder:je},{selector:'a.LinkCard.new.static[data-draft-type="link-card"][data-za-content-type="Zvideo"]',zaBlock:"ZTextZVideoLinkCard",viewInfoBuilder:ke,extraInfoBuilder:je},{selector:"a.FileLinkCard",zaBlock:"ZTextFileLinkCard"}],ye=function(e){var t,n,o=e.element,r=e.config,a=null===(t=r.viewInfoBuilder)||void 0===t?void 0:t.call(r,o,r),i=Object.assign({elementLocation:{type:"Button"},block:r.zaBlock},a),c=Object.assign({action:"OpenUrl",elementLocation:{type:"Button"},block:r.zaBlock,eventType:"Click"},a),l=Object.assign({link:{url:o.href}},null===(n=r.extraInfoBuilder)||void 0===n?void 0:n.call(r,o,r)),s=Object(x.l)().trackEvent,u=Object(x.k)(i,l),d=Object(B.a)((function(e){s(c,l),"ZTextLinkCard"===r.zaBlock&&o.dataset.isEcommerce&&e.preventDefault()}));return Object(j.useEffect)((function(){return o.addEventListener("click",d),function(){o.removeEventListener("click",d)}}),[]),Object(j.useEffect)((function(){return u(o),function(){return u(null)}}),[]),null},Ce=function(e){var t=e.root,n=Object(j.useState)([]),o=he(k.a,n,2),r=o[0],a=o[1];return Object(j.useEffect)((function(){if(t){var e=[];we.forEach((function(n){var o=n.selector;Array.from(t.querySelectorAll(o)).forEach((function(t){e.push({el:t,config:n})}))})),a(e)}}),[t]),Object(G.b)(j.Fragment,{children:r.map((function(e,t){var n=e.el,o=e.config;return Object(G.b)(ye,{element:n,config:o},t)}))})},xe=/<p><br><\/p>/g,Be=/<[^<>\s]+(\s|>)/,Le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBK05A)}},ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBL07A)}},Ge=function(e){return{color:e.colors.GBL07A,"&:hover":ze(e)}},Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[data-focus-visible]";return A()({outline:"none",transition:"box-shadow 0.3s"},"html".concat(t," &"),{boxShadow:"0 0 0 2px ".concat(e.colors.GBK99A,", 0 0 0 4px ").concat(e.colorMod(e.colors.GBL01A).alpha(.3))})},Re=Object(T.h)(o||(o=p()(["\n   from { opacity: 0; }\n   to { opacity: 1; }\n"]))),Ie=function(e){return Object.assign({wordBreak:"break-word",lineHeight:"1.6","> [data-first-child]":{marginTop:0},"> :last-child":{marginBottom:0},"h1,h2":{clear:"left",marginTop:"calc((".concat("1.4em"," * 2) / 1.2)"),marginBottom:"calc(".concat("1.4em"," / 1.2)"),fontSize:"1.2em",lineHeight:1.5,fontWeight:e.fontWeights.bold},"h3,h4,h5,h6":{clear:"left",marginTop:"calc((".concat("1.4em"," * 1.5) / 1.1)"),marginBottom:"calc(".concat("1.4em"," / 1.1)"),fontSize:"1.1em",lineHeight:"1.5",fontWeight:e.fontWeights.bold},u:{textDecoration:"none",borderBottom:"1px solid ".concat(e.colors.GBK03A)},b:{fontWeight:e.fontWeights.bold},sup:{fontSize:"0.8em"},"sup[data-draft-type='reference']":{color:e.colors.GBL07A},"a:focus":Se(e),"a.ztext-link,a.internal,a.external":Object.assign(Object.assign({textDecoration:"none",cursor:"pointer"},Le(e)),{},{"&:hover":Object.assign({color:e.colors.GBL07A},ze(e))," > .ellipsis::after":{content:"'...'"},"> .invisible":{font:"0/0 a",color:"transparent",textShadow:"none",backgroundColor:"transparent"},u:{border:"none"}}),"a.member_mention":Ge(e),"a.UserLink-link":Ge(e),p:{margin:"".concat("1.4em"," 0")},"p.ztext-empty-paragraph":{margin:"calc((".concat("2.8em","- (").concat("1.4em"," * 2 + 1.6em)) / 2) 0"),"+ .ztext-empty-paragraph":{margin:"".concat("1.4em"," 0")}},hr:{margin:"4em auto",width:"240px",maxWidth:"100%",border:"none",borderTop:"1px solid ".concat(e.colors.GBK08A)},"img[eeimg]":Object.assign({maxWidth:"100%",verticalAlign:"middle"},e.isDarkMod&&{filter:"invert(1)"}),'img[eeimg="1"]':{margin:"0 3px",maxWidth:"calc(100% - 6px)",display:"inline-block"},'img[eeimg="2"]':{margin:"".concat("1.4em"," auto"),display:"block"},blockquote:{margin:"".concat("1.4em"," 0"),paddingLeft:"1em",color:e.colors.GBK04A,borderLeft:"3px solid ".concat(e.colors.GBK08A)},"ol,ul":{margin:"".concat("1.4em"," 0"),padding:0,width:"100%","ol,ul":{margin:0},"li::before":{width:"1em"},"> ol, > ul":{display:"table-row","&::before":{display:"table-cell",content:"''"}}},ul:{display:"table","&>li":{display:"table-row",listStyle:"none","&::before":{display:"table-cell",content:"'•  '",whiteSpace:"pre"}}},ol:{display:"table",counterReset:"ol","> li":{display:"table-row",listStyle:"none","&::before":{display:"table-cell",textAlign:"right",counterIncrement:"ol",content:"counter(ol) '. '",whiteSpace:"pre"}}},"ol ol":{counterReset:"ol2","li::before":{counterIncrement:"ol2",content:"counter(ol2) '. '"}},"ol ol ol":{counterReset:"ol3","li::before":{counterIncrement:"ol3",content:"counter(ol3) '. '"}},"ol ol ol ol":{counterReset:"ol4","li::before":{counterIncrement:"ol4",content:"counter(ol4) '. '"}},figure:{margin:"".concat("1.4em"," 0"),".content_image,.origin_image":{margin:"0 auto"},figcaption:{marginTop:"calc(0.6em / 0.9)",padding:"0 1em",fontSize:"0.9em",lineHeight:"1.5",textAlign:"center",color:e.colors.GBK06A},"& + figure":{marginTop:"calc(".concat("1.4em"," * 1.6)")},"&[data-size='small'],&:not([data-size]) > [data-size='small']":{clear:"both"},"&[data-size='left'],&:not([data-size]) > [data-size='left']":{float:"left",margin:"0 20px 20px 0",maxWidth:"33%"},"&[data-size='right'],&:not([data-size]) > [data-size='right']":{float:"right",margin:"0 0 20px 20px",maxWidth:"33%"},"&[data-size='collapse']":{marginBottom:0,"& + figure":{marginTop:0}}},".content_image, .origin_image":{display:"block",maxWidth:"100%",height:"auto",margin:"".concat("1.4em"," auto"),"&[data-size='small']":{maxWidth:"40%"},"&.zh-lightbox-thumb":{cursor:"zoom-in"}},code:{margin:"0 2px",padding:"3px 4px",borderRadius:"3px",fontFamily:e.fonts.monospace,fontSize:"0.9em",backgroundColor:e.colors.GBK10A},pre:{margin:"".concat("1.4em"," 0"),padding:"calc(0.8em / 0.9)",fontSize:"0.9em",wordBreak:"initial",wordWrap:"initial",whiteSpace:"pre",overflow:"auto",WebkitOverflowScrolling:"touch",background:e.colors.GBK10A,borderRadius:"4px",code:{margin:0,padding:0,fontSize:"inherit",borderRadius:0,backgroundColor:"inherit"}},"li pre":{whiteSpace:"pre-wrap"},"table[data-draft-type='table']":{borderCollapse:"collapse",fontSize:"15px",margin:"".concat("1.4em"," auto"),maxWidth:"100%",tableLayout:"fixed",textAlign:"left",width:"100%","&[data-size='small']":{minWidth:"260px",width:"40%"},"&[data-row-style='striped'] tr:nth-of-type(2n + 1)":{background:e.colors.GBK10A},"td,th":{border:"1px solid ".concat(e.colors.GBK08A),lineHeight:"24px",height:"24px",padding:"3px 12px"},th:{background:e.colors.GBK09A,color:e.colors.GBK02A,fontWeight:500}},"& .video-box, & .link-box":{position:"relative",display:"flex",justifyContent:"space-between",margin:"".concat("1.4em"," 0"),overflow:"auto",whiteSpace:"normal",cursor:"pointer",border:"solid 1px ".concat(e.colors.GBK09A),borderRadius:"4px"}},function(e){return{".lazy[data-lazy-status]":{backgroundColor:e.colors.GBK10A},'.lazy[data-lazy-status="ok"]':{backgroundColor:"transparent",animation:"".concat(Re," 0.5s ease-in")}}}(e))},We=[function(e){return e?e.replace(xe,'<p class="ztext-empty-paragraph"><br /></p>'):e},function(e){return e?e.replace(Be,(function(e,t){return e.replace(t," data-first-child".concat(t))})):e}],Te=Object(j.forwardRef)((function(e,t){var n,o=e.as,r=e.tag,a=e.className,i=e.html,c=e.clearBoth,l=void 0!==c&&c,s=e.richContentKey,u=e.root,d=e.Portal,f=e.useHooks,g=m()(e,le),b=ve(We);f(u);var h=null!==(n=null!=o?o:r)&&void 0!==n?n:"div";return Object(G.c)(G.a,{children:[d&&Object(G.b)(d,{root:u}),Object(G.b)(h,Object.assign({ref:t,css:function(e){return Object.assign(Object.assign(Object.assign({},Ie(e)),function(e){return{"& .highlight":{margin:"1em 0",pre:{margin:0},".hll":{backgroundColor:e.colors.GBK12A},".c":{fontStyle:"italic",color:e.colors.GBK06A},".err":{color:e.colors.GRD03A},".k":{fontWeight:e.fontWeights.bold},".o":{fontWeight:e.fontWeights.bold},".cm":{fontStyle:"italic",color:e.colors.GBK06A},".cp":{fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".c1":{fontStyle:"italic",color:e.colors.GBK06A},".cs":{fontStyle:"italic",fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".gd":{color:e.colors.GRD01A},".ge":{fontStyle:"italic"},".gr":{color:e.colors.GRD03A},".gh":{color:e.colors.GBK06A},".gi":{color:"#12b370"},".go":{color:e.colors.GBK05A},".gp":{color:e.colors.GBK04A},".gs":{fontWeight:e.fontWeights.bold},".gu":{color:e.colors.GBK06A},".gt":{color:e.colors.GRD03A},".kc":{fontWeight:e.fontWeights.bold},".kd":{fontWeight:e.fontWeights.bold},".kn":{fontWeight:e.fontWeights.bold},".kp":{fontWeight:e.fontWeights.bold},".kr":{fontWeight:e.fontWeights.bold},".kt":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".m":{color:e.colors.GBL01A},".s":{color:e.colors.GRD03A},".na":{color:e.colors.GBL01A},".nb":{color:e.colors.GBL01A},".nc":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".no":{color:e.colors.GBL01A},".ni":{color:e.colors.GRD07A},".ne":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nf":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nn":{color:e.colors.GBK04A},".nt":{color:e.colors.GBL07A},".nv":{color:e.colors.GBL01A},".ow":{fontWeight:e.fontWeights.bold},".w":{color:e.colors.GBK07A},".mf":{color:e.colors.GBL01A},".mh":{color:e.colors.GBL01A},".mi":{color:e.colors.GBL01A},".mo":{color:e.colors.GBL01A},".sb":{color:e.colors.GRD03A},".sc":{color:e.colors.GRD03A},".sd":{color:e.colors.GRD03A},".s2":{color:e.colors.GRD03A},".se":{color:e.colors.GRD03A},".sh":{color:e.colors.GRD03A},".si":{color:e.colors.GRD03A},".sx":{color:e.colors.GRD03A},".sr":{color:e.colors.GYL02A},".s1":{color:e.colors.GRD03A},".ss":{color:e.colors.GRD03A},".bp":{color:e.colors.GBK06A},".vc":{color:e.colors.GBL01A},".vg":{color:e.colors.GBL01A},".vi":{color:e.colors.GBL01A},".il":{color:e.colors.GBL01A},"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-thumb:horizontal":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.5),borderRadius:"6px","&:hover":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.6)}}}}}(e)),l&&{"&::before, &::after":{clear:"both",content:'""',display:"block"}})},className:W()("RichText","ztext",a,{"RichText--clearBoth":l}),dangerouslySetInnerHTML:{__html:b(i)}},g),s||i)]})}));Te.propTypes={as:R.a.string,tag:R.a.string,html:R.a.string.isRequired,clearBoth:R.a.bool,ref:R.a.func,Portal:R.a.func,useHooks:R.a.func},Te.defaultProps={useHooks:y.a};var Ee=Object(j.memo)(Te),De=Object(j.forwardRef)((function(e,t){var n=N()(e,["entityType","entityData","notCommerce"]),o=n.text,r=n.target,a=n.url,i=n.image,c=n.imageWidth,l=n.imageHeight,s=n.component,u=n.className,d=n.size,f=n.children,g=m()(n,se),b=function(e,t){if(e>0&&t>0){var n=e/t;if(n>1.2)return"180x120";if(n<=.8)return"120x160"}return"ipico"}(c,l),h=Object(K.imgUrl)(i,b);return Object(G.b)(s,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({ref:t,target:r,href:a,"data-draft-node":"block","data-draft-type":"link-card"},h&&{"data-image":h}),c&&{"data-image-width":c}),l&&{"data-image-height":l}),d&&{"data-size":d}),o!==a&&o&&{"data-text":o}),{},{className:W()("LinkCard new",u)},g),{},{children:f||Object(G.c)(G.a,{children:[Object(G.c)("span",{className:"LinkCard-contents",children:[Object(G.b)("span",{className:"LinkCard-title loading","data-text":!0}),Object(G.b)("span",{className:"LinkCard-desc loading"})]}),Object(G.b)("span",{className:"LinkCard-image LinkCard-image--default"})]})}))}));De.propTypes={component:R.a.oneOfType([R.a.string,R.a.func]),target:R.a.string,url:R.a.string.isRequired,text:R.a.string,image:R.a.string,imageWidth:R.a.oneOfType([R.a.string,R.a.number]),imageHeight:R.a.oneOfType([R.a.string,R.a.number])},De.defaultProps={component:"a",target:"_blank"};var Ne={answer:"回答",article:"文章",zvideo:"视频",question:"问题",collection:"收藏夹",roundtable:"圆桌",topic:"话题"},Ke={voteupCount:"赞同",commentCount:"评论",playCount:"播放",followerCount:"关注",answerCount:"回答",visitCount:"浏览"},Pe={answer:["voteupCount","commentCount"],article:["voteupCount","commentCount"],zvideo:["playCount","voteupCount"],question:["followerCount","answerCount"],collection:["visitCount","followerCount"],default:["followerCount","visitCount"]},Me=function(e){var t=e.twoLine,n=e.children;return Boolean(n)&&Object(G.b)("span",{className:W()("LinkCard-title",{"two-line":t}),children:n})},_e=function(e){var t=e.data,n=t.objectType,o=(Pe[n]||Pe.default).map((function(e){var n=t[e];return"".concat(Object(V.cnNiceNumber)(n)).concat(Ke[e])})).filter(Boolean).join(" · ");return Object(G.c)("span",{className:"LinkCard-desc",children:[o,Object(G.b)("span",{className:"LinkCard-tag",children:Ne[n]})]})},Ve=function(e){var t=e.url,n=Object(j.useMemo)((function(){var e=null,n=_()(t,!0);return"link.zhihu.com"===n.hostname&&(e=n.query.target),(e||t).replace(/^https?:\/\//,"")}),[t]);return Object(G.c)("span",{className:"LinkCard-desc",children:[Object(G.b)(q.a,{size:14,center:!0}),n]})},qe=function(e){var t=e.url,n=e.isVideo,o=e.ratio,r=void 0===o?1:o,a=e.onClick;return Boolean(t)&&Object(G.c)("span",{className:"LinkCard-image",style:{height:60*r},children:[Object(G.b)("img",{src:t,onClick:a,alt:n?"点击可播放视频":""}),n&&Object(G.b)("span",{className:"LinkCard-image--video",children:Object(G.b)(U.a,{size:10,center:!0})})]})},Ue=function(e,t){var n=e.url,o=e.data,r=e.onClick,a=e.onClickImage,i=o.title,c=o.thumbnail,l=o.objectType;return Object(G.c)(G.a,{children:[Object(G.c)("span",{ref:t,className:"LinkCard-contents",onClick:r,children:[Object(G.b)(Me,{twoLine:!0,children:i}),l?Object(G.b)(_e,{data:o}):Object(G.b)(Ve,{url:n})]}),Object(G.b)(qe,{url:c,isVideo:"zvideo"===l,onClick:a})]})},Qe=Object(j.forwardRef)(Ue),He=function(e){var t=e.className,n=e.html;return n?Object(G.b)("span",{className:"LinkCard-richText ".concat(t),dangerouslySetInnerHTML:{__html:"<object>".concat(n,"</object>")}}):null},Fe=function(e){var t=e.data,n=t.title,o=t.desc,r=t.url,a=t.image,i=t.ratio,c=t.isVideo;return Object(G.c)(G.a,{children:[Object(G.c)("span",{className:"LinkCard-contents",children:[Object(G.b)(Me,{twoLine:!0,children:n},"title"),Object(G.b)(He,{className:"LinkCard-desc",html:o}),!o&&Object(G.b)(Ve,{url:r},"url")]}),Object(G.b)(qe,{url:a,ratio:i,isVideo:c})]})},Ze={ANSWER:"Answer",ARTICLE:"Column",ZVIDEO:"Zvideo",QUESTION:"Question",COLLECTION:"Collection",ROUNDTABLE:"Roundtable",SPECIAL:"Special",TOPIC:"Topic"},Je=function(e){var t=Object(j.useMemo)((function(){return function(e){var t={};if(e.data){var n=Object(P.camelizeKeys)(JSON.parse(e.data)),o=n.source,r=void 0===o?{}:o,a=n.display,i=void 0===a?{}:a,c=n.zaData,l=void 0===c?{}:c,s=i.cardOpenUrl,u=i.title,d=i.content,f=i.desc,g=i.image||{};t={source:r,url:s,title:u,content:d,desc:f,image:g.imageUrl,ratio:g.ratio,isVideo:g.isVideo,zaAttachInfo:l.attachInfo}}return Object.assign(Object.assign(Object.assign({},t),e),{},{title:e.text||t.title,image:t.image||e.image})}(e)}),[e]),n=t.source,o=t.target,r=t.title,a=t.url,i=t.zaAttachInfo;return Object(G.b)(De,{notCommerce:!0,target:o,text:r,url:a,"data-za-attach-info":i,"data-za-content-type":Ze[null==n?void 0:n.contentType]||"Unknown",className:"static",children:Object(G.b)(Fe,{data:t})})},Xe=/([-\w]+)(="([^"]+)"|='([^']+)')?/g,Ye=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.decodeValue,r=void 0!==o&&o,a={};t=Xe.exec(e);){var i=t[1],c=t[3]||t[4];a[i]=(r?et(c):c)||""}return a},$e=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#13;/g,"\r")}function tt(){return Math.max(window.innerHeight/10,100)}var nt=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=document.defaultView.getComputedStyle(t);if([n.overflow,n.overflowY,n.overflowX].some((function(e){return"scroll"===e||"auto"===e})))return t;t=t.parentNode||t.parentElement}return window};function ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=nt(e),r=e.getBoundingClientRect().top+(o.pageYOffset||o.scrollTop||0)-(n?tt():0)-t;o.scrollTo({top:r,behavior:"smooth"})}var rt=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,at=function(e){var t=e.target,n=e.url,o=e.component,r=e.className;return Object(G.b)(o,{target:t,href:n,"data-draft-node":"block","data-draft-type":"link-card","data-is-ecommerce":"1",className:W()("LinkCard",r),children:Object(G.c)("span",{className:"LinkCard-content LinkCard-ecommerceLoadingCard",children:[Object(G.b)("div",{className:"LinkCard-ecommerceLoadingCardAvatarWrapper",children:Object(G.b)("img",{src:"https://pic2.zhimg.com/v2-1b0bbef27f0496a58468f92d94c8a80e_l.png",className:"LinkCard-ecommerceLoadingCardNetwork"})}),Object(G.c)("div",{className:"LinkCard-ecommerceLoadingCardLoadingbar",children:[Object(G.b)("span",{}),Object(G.b)("span",{})]})]})})};at.defaultProps={component:"a",target:"_blank"};var it=/<a\b([^>]*BIZ(=|%3D)ECOMMERCE[^>]*)>(.*?)<\/a>/g;var ct=function(){function e(t){var n,o,r,a=this;d()(this,e),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.url||(a.url=e),e!==a.url)throw new Error("mismatch url\n".concat(e,"\n").concat(a.url),e,a.url);return new Promise((function(e,n){a.addToQueue({options:t,resolve:e,reject:n})}))},(o="fetch")in(n=this)?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,this.instance=null,this.customFetch=t,this.delay=200,this.maxDelay=1e3,this.url="",this.queueMaxLength=10,this.queue=[],this.startTime=Date.now(),this.timeout=null,this.initialized=!1}var t;return g()(e,[{key:"initConfig",value:function(e){var t=e.delay,n=e.maxDelay,o=e.maxBatchCount;t&&(this.delay=t),n&&(this.maxDelay=n),o&&(this.maxBatchCount=o),this.initialized=!0}},{key:"buildFetchParams",value:function(e){var t=he(k.a,e,1)[0].options,n=e.reduce((function(e,t){var n,o;return(null===(n=(o=t.options).dataBuilder)||void 0===n?void 0:n.call(o,e,t))||e}),{}),o=this.url,r=!t.method||"GET"===t.method.toUpperCase();if(r){var a=_()(o,!0);a.query=Object.assign(Object.assign({},a.query),n),o=a.toString()}return[o,Object.assign(Object.assign({},t),{},{data:r?null:Object.assign(Object.assign({},t.data),n)})]}},{key:"doFetch",value:(t=s()(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.queue.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.queue,this.queue=[],e.prev=4,e.next=7,this.customFetch.apply(this,he(c.a,this.buildFetchParams(t)));case 7:n=e.sent,t.forEach((function(e){var t=e.options,o=e.resolve;t.resultBuilder?o(t.resultBuilder(n)):o(n)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),t.forEach((function(t){return t.reject(e.t0)}));case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(){return t.apply(this,arguments)})},{key:"addToQueue",value:function(e){var t=this;this.initialized||this.initConfig(e.options),clearTimeout(this.timeout),(Date.now()-this.startTime>this.maxDelay||this.queue.length>=this.maxBatchCount)&&(this.startTime=Date.now(),this.doFetch()),this.queue.push(e),setTimeout((function(){t.startTime=Date.now(),t.doFetch()}),this.delay)}}]),e}(),lt=null,st=function(){throw new Error("Not implemented")},ut=function(){return function(e){return function(t,n){return lt||(lt=new ct(e)),lt.fetch(t,n)}}(function(e){return function(){var t=s()(a.a.mark((function t(n,o){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,o);case 2:return r=t.sent,t.t0=P.camelizeKeys,t.next=6,r.json();case 6:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}("undefined"!=typeof fetch?fetch:st))},dt="https://www.zhihu.com/api/v4/link_card_infos",ft=J()((function(){if(!Object(F.isBrowser)())return dt;var e=window.location,t=e.hostname,n=e.origin;return[".zpres.zhihu.dev",".zpres.zhihu.com"].some((function(e){return t.endsWith(e)}))?"".concat(n,"/api/v4/link_card_infos"):dt})),gt={},bt=function(e,t,n){var o=e["data-text"],r=e.href,a=e.zvideoLinkCardProps;Object(j.useEffect)((function(){n&&Object(X.onViewedOnce)(t.current,(function(){return e=t.current,void C.a.trackCardShow(e,{id:7844},{button:{text:"inlinezvideo"}});var e}))}),[n,t]);var i=Object(B.a)((function(e){!function(e,t,n){var o;C.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,{title:o,url:r,video:{}})})),c=Object(B.a)((function(e){!function(e,t,n){var o;C.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,a,{title:o,url:r})}));return n?{handleImageClick:i,handleInfoClick:c}:{}},mt={answer:"Answer",article:"Column",zvideo:"Zvideo",question:"Question",collection:"Collection",roundtable:"Roundtable",topic:"Topic"},ht=j.forwardRef((function(e,t){var n=N()(e,["zvideoLinkCardProps"]),o=n.inEditor,r=n["data-text"],i=n.href,c=n.zaBlock,l=m()(n,ue),u=Object(j.useRef)(),d=function(e){var t=Object(j.useRef)(0),n=e.inEditor,o=e["data-offset-key"],r=e["data-text"],i=e["data-image"],c=e.href,l=Object(j.useRef)(!1),u=Object(j.useRef)(c),d="draftjs"===n,f=Object(j.useState)((function(){return d&&gt[o]||null})),g=he(k.a,f,2),b=g[0],m=g[1],h=Object(L.a)({once:!0}),p=he(k.a,h,2),v=p[0],A=p[1],O=Object(B.a)((function(e){var t=e||b;if(!t||0===Object.keys(t).length)return{objectType:null,title:r||c,thumbnail:i};t.title=r||t.title||c,t.thumbnail=i||t.thumbnail;var n=Object.assign(Object.assign({},t),{},{cached:!0});return d&&(gt[o]=n),n})),w=Object(B.a)(ut()),y=Object(B.a)(s()(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.current+=1,e.prev=1,e.next=4,w(ft(),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},dataBuilder:function(e){return e.urls="".concat(e.urls?e.urls+",":"").concat(c),e},resultBuilder:function(e){return e[c]}});case 4:n=e.sent,m(O(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.current<=1?y():m(O());case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))));return Object(j.useEffect)((function(){(!A||b&&b.cached)&&u.current===c||y()}),[A,b,y,c]),Object(j.useEffect)((function(){n&&l.current&&m(O(u.current!==c?{title:r}:null))}),[n,O,r,c]),Object(j.useEffect)((function(){u.current=c}),[c]),Object(j.useEffect)((function(){l.current=!0}),[]),[v,b]}(e),f=he(k.a,d,2),g=f[0],b=f[1],h=bt(e,u,"zvideo"===(null==b?void 0:b.objectType)),p=h.handleImageClick,v=h.handleInfoClick,A=Object(j.useCallback)(pe(t,g,u),[]),O=o?Qe:x.a,w=o?null:{as:Qe,shouldTrackShow:!0,zaText:!0,zaType:"Button",zaAction:"OpenUrl",zaBlock:c,extra:{link:{url:i}},"data-za-module":"Content"},y=Object(G.b)(O,Object.assign(Object.assign({},w),{},{url:i,data:b,onClick:v,onClickImage:p}));return Object(G.b)(De,Object.assign(Object.assign({ref:A,text:r,url:i,component:"a"},l),{},{children:Boolean(b)&&Object(G.b)(x.b,{content:{type:mt[b.objectType]||"Unknown"},children:y})}))})),pt=function(e){return function(t){var n=Object(j.useState)(null),o=he(k.a,n,2),r=o[0],a=o[1],i=e.idAttr,c=e.selector,l=e.component,s=e.targetClassName,u=e.cardDataFilter,d=e.getCardProps,f=t.root,g=m()(t,de),b=i&&c&&s&&Object(j.useCallback)((function(e){return function(e){var t=e.idAttr,n=e.targetClassName;return function(e){var o=e.getAttribute(t),r=document.createElement("div");return r.className=n,e.parentNode.replaceChild(r,e),{data:{id:o},target:r}}}({idAttr:i,targetClassName:s})(e)}),[i,s]),h=Object(j.useMemo)((function(){return b?function(e){return Array.from(e.querySelectorAll(c)).map(b)}:y.a}),[b,f,c]);return Object(j.useEffect)((function(){if(f||c&&u){var e=(u||h)(f).map((function(e){var t=e.data,n=e.target,o=null;return"function"==typeof d&&(o=d(t)),Object(Y.createPortal)(Object(G.b)(l,Object.assign(Object.assign({id:t.id},o),g),t.id),n)}));e.length>0&&a(e)}}),[f]),r}},vt=pt({cardDataFilter:function(e){return Array.from(e.querySelectorAll("a.LinkCard[data-draft-type=link-card]:not([data-is-ecommerce])")).map((function(e){var t,n=(t=e.attributes,Array.from(t).reduce((function(e,t){return"class"===t.name?e.className=t.value:e[t.name]=t.value,e}),{})),o=document.createElement("div");return o.className="RichText-LinkCardContainer",e.parentNode.replaceChild(o,e),{data:n,target:o}}))},getCardProps:function(e){return e.href&&e.href.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)?e.zaBlock="ZTextZVideoLinkCard":e.zaBlock="ZTextLinkCard",e},component:ht}),At=function(e){return{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:"inherit",height:80,boxSizing:"border-box",background:e.colorMod(e.colors.GBK10A).alpha(.88),color:e.colors.GBK08A}},Ot=function(e){return{width:60,height:60,background:e.colors.GBK09A,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:6,marginRight:10}},kt=function(e){return{height:60,flex:1,display:"flex",flexDirection:"column",span:{height:16,display:"inline-block",background:e.colors.GBK09A},"span:nth-of-type(1)":{width:60,marginBottom:4},"span:nth-of-type(2)":{width:127}}},jt=function(e){return{".LinkCard.old":{position:"relative",display:"block",margin:"1em auto",width:390,boxSizing:"border-box",borderRadius:12,maxWidth:"100%",overflow:"hidden","&,&:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"}},".LinkCard-ecommerceLoadingCard":At(e),".LinkCard-ecommerceLoadingCardAvatarWrapper":Ot(e),".LinkCard-ecommerceLoadingCardNetwork":{width:20,height:20},".LinkCard-ecommerceLoadingCardLoadingbar":kt(e)}},wt=function(e){return{position:"relative",display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",width:390,minHeight:84,borderRadius:8,maxWidth:"100%",overflow:"hidden",margin:"16px auto",padding:"12px 12px 9px 12px",backgroundColor:e.colors.GBK10A,"&, &:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"},".LinkCard-contents":{display:"block",flex:"1 1 auto",position:"relative",".loading":{height:14,background:e.colors.GBK09A,borderRadius:7},"&.withTitle":{marginBottom:3}},".LinkCard-title":Object.assign(Object.assign({display:"block",fontSize:15,fontWeight:500,lineHeight:1.4,marginBottom:2,color:e.colors.GBK02A},Object($.a)(1)),{},{"&.two-line":Object.assign({lineHeight:"20px"},Object($.a)(2)),"&.loading":{marginBottom:8,width:"80%","&.withTitle":{marginBottom:6}},"&.loadingTitle":{marginBottom:5}}),".LinkCard-excerpt":Object.assign(Object.assign({display:"block",textOverflow:"ellipsis",fontSize:13,lineHeight:"18px",color:e.colors.GBK06A,marginBottom:4},Object($.a)(1)),{},{".LinkCard-author":{color:e.colors.GBK03A}}),".LinkCard-desc":Object.assign(Object.assign({display:"block",fontSize:13,height:18,lineHeight:"18px",color:e.colors.GBK06A,wordBreak:"break-all"},Object($.a)(1)),{},{".LinkCard-tag,.tag":{display:"inline-block",fontSize:11,marginLeft:8,padding:"0 4px",borderRadius:3,background:e.colorMod(e.colors.GBK08A).alpha(.3)},"&.loading":{width:"40%"},svg:{marginRight:2}}),".LinkCard-image":{flex:"0 0 auto",backgroundColor:e.colors.GBK09A,backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"block",width:60,height:60,marginLeft:20,objectFit:"cover",borderRadius:"inherit",overflow:"hidden","&.LinkCard-image--default":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.colors.GBK09A,color:e.colors.GBK08A,svg:{color:e.colors.GBK06A}},img:{width:"100%",height:"100%",objectFit:"cover"},".LinkCard-image--video":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",width:24,height:24,borderRadius:12,background:e.colorMod(e.colors.GBK99C).alpha(.9),pointerEvents:"none",svg:{color:e.colors.GBK03A}}},".LinkCard-richText":{".text":{color:e.colors.GBK03A},".bold":{fontWeight:e.fontWeights.bold},".tag":{marginLeft:4}}}},yt=function(e){return{".LinkCard.new":wt(e)}},Ct=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,Object.assign({credentials:"include",headers:{"X-Requested-With":"Fetch"}},t)).then((function(e){return e.json()}))},xt=function(e){return Object.assign(Object.assign({},jt(e)),yt(e))},Bt=function(e){return Object.assign(Object.assign({},yt(e)),jt(e))},Lt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.rootMargin,r=n.threshold,a=n.once,i=void 0===a||a;e=Array.isArray(e)?e:e?[e]:[];var c=Object(j.useRef)(null),l=Object(B.a)(t);Object(j.useEffect)((function(){if(e.length)return c.current&&e.forEach((function(e){return c.current.unobserve(e)})),c.current=new IntersectionObserver((function(e){e.forEach((function(e){e.intersectionRatio>0&&(l(e),i&&c.current.unobserve(e.target))}))}),{rootMargin:o,threshold:r}),e.forEach((function(e){return c.current.observe(e)})),function(){e.forEach((function(e){return c.current.unobserve(e)}))}}),[e,o,JSON.stringify(r),i])},zt=n(118);var Gt="function"==typeof Image,St={},Rt=Gt?zt((function(e){return new Promise((function(t){return n=e,o=function(e,n){St[e]=n,t(n)},(r=new Image).onload=function(){var e=r.width>0&&r.height>0;o(n,e)},r.onerror=function(){o(n,!1)},void(r.src="data:image/webp;base64,"+{lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"}[n]);var n,o,r}))})):function(){return Promise.resolve(!1)},It=function(e){var t=St[e],n=Object(j.useState)(t),o=he(k.a,n,2),r=o[0],a=o[1];return Gt&&void 0===t&&Rt(e).then(a),r},Wt={class:"className"},Tt=Object(j.forwardRef)((function(e,t){var n=e.node,o=e.tagName,r=m()(e,fe),a=Object(j.useMemo)((function(){return function(e){return Array.from(e.attributes).reduce((function(e,t){var n=Wt[t.name]||t.name;return"style"!==n&&(e[n]=t.value),e}),{})}(n)}),[n]);return Object(j.createElement)(o||n.tagName.toLowerCase(),Object.assign(Object.assign(Object.assign({},a),r),{},{ref:t}))})),Et=te()((function(){return/Mobile/.test(navigator.userAgent)}));function Dt(e,t){var n={monitor:{type:"Event",imgResourceErrorInfo:{error_description:t,img_url:e,img_from:"web"}}};C.a.trackMonitor({name:t},n)}var Nt=function(e){var t=e.onLoadStateChange,n=e.enableWebP,o=e.size,r=e.quality;return function(e){var a=e.target,i=function(e){var t=e.image,n=e.enableWebP,o=e.size,r=e.quality,a=void 0===r?80:r,i=t.dataset,c=i.actualsrc,l=i.actualgif;return n&&l&&l.match(/.gif$/i)?c:(o||(o="720w",!Et()&&window.devicePixelRatio>=1.5&&(o="1440w"),Et()&&window.devicePixelRatio*window.innerWidth>=1080&&(o="1440w")),Object(K.imgUrl)(c,{quality:a,size:o}))}({image:a,enableWebP:n,size:o,quality:r});if(n&&(i=function(e){return e.replace(/\.(jpg|png|jpeg|gif)/,".webp")}(i)),a.dataset.rawheight&&!a.getAttribute("height")&&a.setAttribute("height",a.dataset.rawheight),a.src=i,a.complete)a.dataset.lazyStatus="ok";else{t&&a.addEventListener("loadstart",(function(){t("loadstart",i)})),a.dataset.lazyStatus="loading";var c=setTimeout((function(){a.complete||Dt(a.url,"image_web_timeout_image"),t&&t("timeout",i)}),15e3);a.addEventListener("load",(function(){a.dataset.lazyStatus="ok",clearTimeout(c),Dt(a.url,"image_web_success_image"),t&&t("load",i)})),a.addEventListener("error",(function(){clearTimeout(c),Dt(a.url,"image_web_fail_image"),t&&t("error",i)}))}}},Kt=function(e){var t=e.node,n=e.useWebP,o=void 0===n||n,r=e.onLoadStateChange,a=e.size,i=e.quality,c=t.classList.contains("lazy"),l=It("lossless"),s=Object(L.a)({once:!0,rootMargin:"600px"}),u=he(k.a,s,3),d=u[0],f=u[1],g=u[2],b=Object(B.a)(Nt({onLoadStateChange:r,enableWebP:l&&o,size:a,quality:i}));return Object(j.useEffect)((function(){f&&b(g)}),[g,f,b]),Object(G.b)(Tt,{node:t,ref:c?d:void 0})},Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.useWebP,o=void 0===n||n,r=t.disabled,a=void 0!==r&&r,i=t.onLoadStateChange,c=t.size,l=t.quality,s=Object(j.useState)([]),u=he(k.a,s,2),d=u[0],f=u[1],g=It("lossless");Lt(d,Nt({onLoadStateChange:i,enableWebP:g&&o,size:c,quality:l}),{rootMargin:"300px"}),Object(j.useEffect)((function(){if(e&&!a){var t=Array.from(e.querySelectorAll("img.lazy:not([data-thumbnail])"));t.length&&f(t)}}),[e,a])},Mt=function(e){var t=e.root,n=e.options;return Pt(t,n),null},_t=function(e,t){C.a.trackEvent(e,{action:"StatusReport",element:"Card"},{status:{result:t}})},Vt=function(e,t){var n,o,r;null===(n=window)||void 0===n||null===(o=n.Raven)||void 0===o||null===(r=o.captureException)||void 0===r||r.call(o,e,{fingerprint:["gif2mp4"],extra:t})},qt=function(e){var t=e.src,n=e.useWebP,o=void 0===n?"auto":n,r=e.useMp4,a=void 0!==r&&r,i=e.onRef,c=e.onLoadStateChange,l=m()(e,ge),s=Object(j.useState)(""),u=he(k.a,s,2),d=u[0],f=u[1],g=Object(j.useState)(null),b=he(k.a,g,2),h=b[0],p=b[1],v=Object(j.useState)(Date.now()),A=he(k.a,v,2),O=A[0],w=A[1],x=Object(j.useState)(!1),B=he(k.a,x,2),L=B[0],S=B[1],R=Object(j.useState)(null),I=he(k.a,R,2),W=I[0],T=I[1],E=It("animation"),D=Object(j.useCallback)((function(){var e=(Object(ne.imgPathParse)(t)||{}).hash;a&&Object(X.onViewedOnce)(h,(function(){var t;(t=e,fetch("https://api.zhihu.com/gif2mp4/".concat(t),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then((function(e){return e.json()}))).then((function(e){var t,n,o=e.playlist,r=(null==o||null===(t=o.SD)||void 0===t?void 0:t.play_url)||(null==o||null===(n=o.LD)||void 0===n?void 0:n.play_url);r&&re.b.increment("Gif2Mp4Player.mp4.fetch.success.count"),f(r)})).catch(y.a)}))}),[h,t,a]);Object(j.useEffect)(D,[t,a,h]),Object(j.useEffect)((function(){h&&C.a.setModule(h,{module:"GifItem"})}),[h]),Lt(h,(function(){C.a.trackCardShow(h,{element:"Card"})})),Object(z.a)((function(){re.b.increment("Gif2Mp4Player.mp4.play.failure.count"),Vt(new Error("Gif2Mp4 play timeout"),{src:t,videoUrl:d}),S(!1)}),L?2e3:null),Object(z.a)((function(){re.b.increment("Gif2Mp4Player.mp4.play.success.count"),re.b.timing("Gif2Mp4Player.mp4.first_frame_time",Date.now()-O-100),S(!1),T(null)}),W);var N=oe()(t,{extension:("auto"===o?E:o)?"webp":"gif"});return Object(G.b)(ce.d,Object.assign({videoUrl:d,src:N,onRef:Object(j.useCallback)(pe(i,p),[]),onPlayChange:function(e){e||(w(Date.now()),d&&(re.b.increment("Gif2Mp4Player.mp4.click.count"),S(!0)),C.a.trackEvent(h,{action:"Click",element:"Image"}))},onLoadStart:function(){if(d){var e=ie.a.parse(d).expiration;e&&Number(e)<Date.now()/1e3+900&&D()}w(Date.now()),c&&c("loadstart",N)},onSuccess:function(){_t(h,"Success"),d?L&&T(100):re.b.timing("Gif2Mp4Player.gif.first_frame_time",Date.now()-O),c&&c("load",N)},onFailed:function(e){_t(h,"Fail"),d&&(L&&(re.b.increment("Gif2Mp4Player.mp4.play.failure.count"),S(!1),T(null)),Vt(e,{videoUrl:d,src:t})),c&&c("error",N)}},l))},Ut=function(e){var t=e.node,n=e.Component,o=void 0===n?qt:n,r=Object(j.useMemo)((function(){return function(e){var t=e.dataset,n=t.thumbnail;return{src:n,poster:n,size:t.size}}(t)}),[t]);return Object(G.b)(o,Object.assign({},r))},Qt=function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.Component,o=void 0===n?qt:n,r=Object(j.useState)(null),a=he(k.a,r,2),i=a[0],c=a[1];return Object(j.useEffect)((function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));if(t.length){var n=t.map((function(e,t){var n=document.createElement("div");return n.className="RichText-gifPlaceholder",e.parentNode.replaceChild(n,e),Object(Y.createPortal)(Object(G.b)(Ut,{node:e,Component:o},t),n)}));c(n)}}}),[e]),i}(e.root,e.options)},Ht=function(e){var t=e.root,n=e.ConditionalImage,o=Object(j.useState)([]),r=he(k.a,o,2),a=r[0],i=r[1];return Object(j.useEffect)((function(){if(t){var e=Array.from(t.querySelectorAll("img.origin_image,img.content_image"));if(e.length){var o=e.map((function(e,t){var o=document.createElement("div");return e.parentNode.replaceChild(o,e),Object(Y.createPortal)(Object(G.b)(n,{node:e},t),o)}));i(o)}}}),[t]),a},Ft=ve([function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.linkCardInfo;return e?e.replace(rt,(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Ye(t,{decodeValue:!0}),a=r.target,i=void 0===a?"_blank":a,c=r.href,l=void 0===c?"":c,s=r["data-image"],u=r["data-image-width"],d=r["data-image-height"],f=r["data-entity-type"],g=r["data-entity-data"],b=r["data-size"],m=r["data-is-ecommerce"];if(m)return e;var h=o.replace(/<[^>]*>/g,"");h=et(h),l.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)&&!h&&(h="知乎视频");var p=n?Je:De;return Object(E.renderToStaticMarkup)(Object(G.b)(p,Object.assign({text:h,url:l,target:i,image:s,imageWidth:u,imageHeight:d,entityType:f,entityData:$e(g),size:b},n&&{data:n[l]})))})):e},function(e){return e?e.replace(it,(function(e,t){var n=Ye(t,{decodeValue:!0}),o=n["data-draft-type"],r=n.href,a=n.class;return"link-card"!==o?e:Object(E.renderToStaticMarkup)(Object(G.b)(at,{url:r,className:H()(a,{old:!0,new:!1,static:!1})}))})):e}]),Zt=Object(j.forwardRef)((function(e,t){var n=Object(j.useState)(null),o=he(k.a,n,2),r=o[0],a=o[1],i=e.html,c=e.css,l=e.options,s=void 0===l?{}:l,u=e.ConditionalImage,d=e.linkCardInfo,f=m()(e,be),g=s.lazyLoadImageOptions,b=s.useGifPortalOption,h=m()(s,me);Oe(r);var p=[xt,Bt,c].reduce((function(e,t){return t||(t={}),"function"==typeof t?function(n){return Object.assign(Object.assign({},e(n)),t(n))}:function(n){return Object.assign(Object.assign({},e(n)),t)}}),(function(e){return{}})),v=Object(j.useCallback)(pe(t,a),[]);return Object(G.c)(j.Fragment,{children:[!d&&Object(G.b)(vt,{css:Bt,root:r}),u?Object(G.b)(Ht,{root:r,ConditionalImage:u}):Object(G.c)(G.a,{children:[Object(G.b)(Mt,{root:r,options:g}),Object(G.b)(Qt,{root:r,options:b})]}),Object(G.b)(Ce,{root:r}),Object(G.b)(Ee,Object.assign({ref:v,html:Ft(i,{linkCardInfo:d}),css:p,root:r,options:h},f))]})})),Jt=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g}}]);
//# sourceMappingURL=column.lib_0e5ce61e.e15f8b3774e01ad26c97.js.map