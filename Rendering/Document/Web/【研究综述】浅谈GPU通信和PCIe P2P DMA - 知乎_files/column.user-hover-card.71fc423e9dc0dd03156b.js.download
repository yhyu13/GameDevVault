(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{1223:function(e,t,n){"use strict";n.r(t);var a=n(23),o=n(11),c=n(12),r=n(13),l=n(14),s=n(6),i=n(0),u=n(1),d=n.n(u),p=n(10),b=n(24),h=n(61),f=n(5),O=n(17),m=n(8),v=Object.assign;function j(e){return d.a.createElement(m.a,v(v({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"BriefcaseFill24","data-old-api":"Company"},e),{className:"Zi Zi--Company"+(e.className?" ".concat(e.className):"")}),d.a.createElement("path",{d:"M21.5 8.199V18.8c0 .939-.768 1.699-1.715 1.699H4.215c-.947 0-1.715-.76-1.715-1.699V8.2c0-.938.768-1.699 1.715-1.699h15.572A1.707 1.707 0 0121.5 8.199zM6.944 11.5a.75.75 0 000 1.5h10.112a.75.75 0 000-1.5H6.944z",fillRule:"evenodd",clipRule:"evenodd"}),d.a.createElement("path",{d:"M6.75 5c0-.966.784-1.75 1.75-1.75h7c.966 0 1.75.784 1.75 1.75v2a.75.75 0 01-1.5 0V5a.25.25 0 00-.25-.25h-7a.25.25 0 00-.25.25v2a.75.75 0 01-1.5 0V5z",fillRule:"evenodd",clipRule:"evenodd"}))}var g=n(1643),w=n(131),M=n.n(w),y=n(321),k=n(179),C=n(80),R=n(210),S=n(294),N=n(253),B=n(125),U=n(2),x=n.n(U),F=n(7),T=n.n(F),E=n(19),A=n(42),P=n(82),z=n(1370),L=n(150),H=n(231),_=n(64),G=n(1311),q=n(37),I=n(1537),V=n(27);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var J=function(e){Object(r.a)(n,e);var t=Z(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={modalShown:!1},e.handleSendMessage=function(){var t=e.props,n=t.onModalOpen,a=t.user.allowMessage,o=t.dispatch,c=t.doNotCheckAllowMessageSetting;a||void 0===a&&c?(e.setState({modalShown:!0}),n&&n()):o(Object(q.g)(V.M.blocked,"red")),O.a.trackEvent(Object(_.a)(e),{action:"Message",element:"Button",is_intent:!0})},e.handleCloseModal=function(){var t=e.props.onModalClose;e.setState({modalShown:!1}),t&&t()},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.preset,a=e.color,o=e.icon,c=e.label,r=e.className,l=e.tooltip,s=e.tooltipPreset,u=e.authRequired,d=this.state.modalShown,p="3d198a56310c02c4a83efb9f4a4c027e"===t.id;return Object(i.c)(i.a,{children:[Object(i.b)(E.c,{preset:n,color:a,className:r,icon:o,label:c,onClick:u(this.handleSendMessage,p?V.O.serviceAccountMessage:V.O.message),"data-tooltip":l,"aria-label":l,"data-tooltip-preset":s}),Object(i.b)(I.a,{memberHashId:t.id,handleCloseModal:this.handleCloseModal,isModalShow:d})]})}}]),n}(u.Component);J.propTypes={onModalOpen:x.a.func,onModalClose:x.a.func},J.defaultProps={preset:"outline",color:"grey",icon:G.a,label:"发私信",doNotCheckAllowMessageSetting:!1};var K=Object(b.compose)(P.a,Object(p.connect)())(J),D=n(186);function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var W=function(e){Object(r.a)(n,e);var t=Q(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={reportModalShown:!1},e.handleShieldUser=function(){var t=e.props,n=t.user.urlToken,a=t.updateUserBlocking,o=t.showNotification;a(n,!1).then((function(){return o("屏蔽已取消")}))},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.user,o=a.urlToken,c=a.isBlocking,r=a.isOrg,l=t.canShowMutualFollowStatus,s=t.className,u=t.buttonClassName,d=t.onModalOpen,p=t.onModalClose,b=t.authRequired,h=this.state.reportModalShown,f=T()("MemberButtonGroup",s);return c?Object(i.c)("div",{className:f,children:[Object(i.c)(E.c,{className:u,preset:"primary",color:"red",onClick:this.handleShieldUser,children:[Object(i.b)(z.a,{center:!0,text:!0})," 已屏蔽"]}),!r&&Object(i.c)(E.c,{className:u,onClick:b((function(){e.setState({reportModalShown:!0}),d&&d()}),V.O.report),children:["举报用户",Object(i.b)(H.a,{shown:h,onClose:function(){e.setState({reportModalShown:!1}),p&&p()},type:"member",urlToken:o,zaEnabled:!0})]})]}):Object(i.c)("div",{className:f,children:[Object(i.b)(L.a,{id:o,type:n.type,gender:n.gender,isFollowing:n.isFollowing,isFollowed:n.isFollowed,canShowMutualFollowStatus:l,className:u,preset:L.a.PRESETS.primary}),Object(i.b)(K,{user:n,className:u,onModalOpen:d,onModalClose:p})]})}}]),n}(u.Component);W.propTypes={user:x.a.object.isRequired,buttonClassName:x.a.string,onModalOpen:x.a.func,onModalClose:x.a.func};var X=Object(b.compose)(P.a,Object(p.connect)(null,{updateUserBlocking:D.k,showNotification:q.g}))(W);function Y(e){var t=this,n=e.user,a=e.user.isOrg,o=e.className,c=e.buttonClassName,r=e.onModalOpen,l=e.onModalClose,s=e.authRequired,u=e.router,d=T()("ProfileButtonGroup",o);return Object(A.k)(n)?Object(i.b)("div",{className:d,children:Object(i.c)(E.c,{color:"blue",className:c,onClick:s((function(){O.a.trackEvent(t,{action:"OpenUrl",element:"Link"},{link:{url:"".concat(location.origin,"/people/edit")}}),u.push("/people/edit")}),V.O.editProfile),children:["编辑",a?"机构":"个人","资料"]})}):Object(i.b)(X,{user:n,canShowMutualFollowStatus:!0,className:d,buttonClassName:c,onModalOpen:r,onModalClose:l})}Y.propTypes={user:x.a.object.isRequired,buttonClassName:x.a.string,onModalOpen:x.a.func,onModalClose:x.a.func};var $=Object(b.compose)(h.withRouter,P.a)(Y),ee=n(493),te=n(105),ne=n(849),ae=n(848),oe=["toggler","user","id","urlToken","mutuals","onRef","currentUser"];function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var re=function(e,t){return e.map((function(e){return t[e]})).slice(0,3)},le=Object(C.isBrowser)()?M()(re,(function(e,t){return"".concat(e.join(","),"-").concat(t.length)})):re,se=[];var ie=function(e){return Object(i.b)(f.Flex,Object.assign({css:{"&:not(:last-child)":{marginBottom:8}}},e))},ue=function(e){Object(r.a)(n,e);var t=ce(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={isLoading:!1,childModalOpened:!1},e.loadUserProfile=function(){var t=e.props,n=t.id,a=t.urlToken;return(0,t.dispatch)(Object(D.h)(a||n,!1))},e.load=function(){var t=e.props,n=t.id;(t.urlToken||n)&&(e.setState({isLoading:!0}),e.loadUserProfile().then((function(){return e.setState({isLoading:!1})})),e.loadMutuals())},e.loadMutuals=function(){var t=e.props,n=t.user,a=t.dispatch,o=t.mutuals,c=void 0===o?[]:o,r=t.currentUser;return!c.length&&r&&n?a(Object(D.f)(n.urlToken,"mutuals")):Promise.resolve()},e.track=function(){var t=e.props.user;e.hoverCardElement&&t&&(O.a.setModule(e.hoverCardElement,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:t.id}}}),O.a.trackCardShow(e.hoverCardElement))},e.handleOpen=function(){e.load(),e.track()},e}return Object(c.a)(n,[{key:"render",value:function(){var e,t,n=this,o=this.props,c=o.toggler,r=o.user,l=o.id,s=o.urlToken,u=o.mutuals,d=void 0===u?[]:u,p=o.onRef,b=o.currentUser,O=Object(a.default)(o,oe),m=r||{},v=m.isOrg,w=m.headline,M=m.avatarUrl,C=m.badge,B=m.badgeV2,U=m.answerCount,x=m.articlesCount,F=m.followerCount,T=m.employments,E=m.coverUrl,A=m.gender,P=m.isFollowed,z=m.isFollowing,L=this.state,H=L.isLoading,_=L.childModalOpened,G=d.length,q=Object(k.d)(B||C),I=q.bestAnswerer,Z=q.identity,J="//www.zhihu.com/".concat(v?"org":"people","/").concat(s||l),K=b&&r&&b.urlToken===r.urlToken,D=G>0&&!K,Q=T&&T[0];if(null!=Z&&Z.length)t=Object(i.c)(ie,{children:[Object(i.b)("a",{href:"".concat(V.x,"/account/verification/intro"),target:"_blank",rel:"noopener noreferrer",css:{marginRight:".3em"},children:Object(i.b)(k.a,{})}),Object(i.b)("div",{children:Z.slice(0,2).map((function(e){return e.description})).join("，")})]});else if(Q){var W=Q.company,X=Q.job;t=Object(i.c)(ie,{children:[(W||X)&&Object(i.b)(f.Box,{as:"span",mr:".3em",color:"GBL05A",children:Object(i.b)(j,{text:!0,center:!0})}),Object(i.c)("div",{children:[W&&W.name,W&&X&&Object(i.b)(f.Box,{display:"inline-block",width:"1px",height:"10px",mx:"8px",bg:"GBK09A"}),X&&X.name]})]})}else t=null;return Object(i.c)(S.b,Object.assign(Object.assign({toggler:c,onOpen:this.handleOpen,isLoading:H,globalClose:!_,stickHover:_,preventCloseOnTarget:!0},O),{},{onRef:function(e){p&&"function"==typeof p&&p(e),n.hoverCardElement=e},children:[Object(i.b)(S.a,{coverUrl:E,title:Object(i.c)("span",{css:{display:"flex"},children:[Object(i.b)(ee.a,{user:r,noHoverCard:!0}),Object(i.b)(ae.a,{isFollowed:P,isFollowing:z})]}),subtitle:w&&Object(i.b)(N.a,{inline:!0,html:w}),avatarUrl:M}),(t||I||D)&&Object(i.c)("div",{children:[t,Boolean(null==I||null===(e=I.topics)||void 0===e?void 0:e.length)&&Object(i.c)(ie,{children:[Object(i.b)("span",{css:{marginRight:".3em"},children:Object(i.b)(k.b,{})}),Object(i.c)("div",{children:[Object(i.b)(ne.a,{expandable:!1,noHoverCard:!0,topics:I.topics,user:r}),"的优秀答主"]})]}),D&&Object(i.c)(ie,{color:"GBL05A",children:[Object(i.b)(f.Box,{mr:".3em",children:Object(i.b)(g.a,{text:!0,center:!0})}),Object(i.b)("div",{children:Object(i.c)(y.CJKSpace,{children:[d.map((function(e,t){return Object(i.c)(h.Link,{to:"//www.zhihu.com/".concat(v?"org":"people","/").concat(e.urlToken),target:"_blank",children:[e.name,t<G-1&&"、"]},t)})),"也关注了",V.G[A]]})})]})]}),Object(i.c)("div",{children:[Object(i.c)(R.a,{children:[Object(i.b)(R.a.Item,{tag:te.a,preset:"plain",to:"".concat(J,"/answers"),name:"回答",value:U,target:"_blank"}),Object(i.b)(R.a.Item,{tag:te.a,preset:"plain",to:"".concat(J,"/posts"),name:"文章",value:x,target:"_blank"}),Object(i.b)(R.a.Item,{tag:te.a,preset:"plain",to:"".concat(J,"/followers"),name:"关注者",value:F,target:"_blank"})]}),r&&!K&&Object(i.b)($,{className:"HoverCard-buttons",user:r,onModalOpen:function(){n.hoverCardElement.style.opacity="0",n.setState({childModalOpened:!0})},onModalClose:function(){return n.setState({childModalOpened:!1})}})]})]}))}}]),n}(u.PureComponent);t.default=Object(b.compose)(B.a,Object(p.connect)((function(e,t){var n=t.id,a=t.urlToken,o=e.entities,c=e.people.mutualsByUser,r=o.users[a]||Object.values(o.users).find((function(e){return e.id===n}))||t.user,l=c[a||n]||{ids:se,isFetching:!1},s=l.ids,i=l.isFetching;return{user:r,mutuals:le(s,o.users),isFetching:i}})))(ue)},1643:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1),o=n.n(a),c=n(8),r=Object.assign;function l(e){return o.a.createElement(c.a,r(r({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"UsersFill24","data-old-api":"Users"},e),{className:"Zi Zi--Users"+(e.className?" ".concat(e.className):"")}),o.a.createElement("path",{d:"M4.5 8A5.5 5.5 0 0110 2.5 5.5 5.5 0 0115.5 8a5.5 5.5 0 01-5.5 5.5A5.5 5.5 0 014.5 8zm-.602 7.738c.965-1.075 2.418-1.574 4.19-1.325 1.263.178 2.56.178 3.825 0 1.77-.249 3.224.25 4.189 1.325.628.7 1.212 1.69 1.657 2.656.442.961.78 1.973.868 2.733.07.6-.424 1.023-.927 1.023H2.3c-.503 0-.997-.423-.927-1.023.088-.76.426-1.772.868-2.733.444-.967 1.029-1.956 1.657-2.656zm12.312-2.046a.743.743 0 01-.309-.24.747.747 0 01.081-.995c.338-.335.655-.827.92-1.37.441-.906.652-1.98.59-3.065-.036-.607-.135-1.289-.302-1.782a.75.75 0 011.42-.48c.228.672.34 1.503.379 2.176.076 1.327-.178 2.658-.739 3.809a7.991 7.991 0 01-.594 1.028c.89.564 1.632 1.316 2.22 2.083.768 1.002 1.308 2.075 1.585 2.907a.75.75 0 11-1.423.474c-.223-.668-.682-1.595-1.352-2.468-.667-.87-1.507-1.643-2.476-2.077z",fillRule:"evenodd",clipRule:"evenodd"}))}}}]);
//# sourceMappingURL=column.user-hover-card.71fc423e9dc0dd03156b.js.map