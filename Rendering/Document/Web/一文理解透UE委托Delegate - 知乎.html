<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/460092901 -->
<html lang="zh" data-hairline="true" data-theme="light" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>一文理解透UE委托Delegate - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="虚幻引擎,C++,代理"><meta data-rh="true" name="description" content="引言一、理解委托1.1 初识委托1.2 简单对委托的思考二、UE委托的概要2.1 三大类型2.2 支持绑定类型2.3 UE委托特性三、TDelegate单播C++实现3.1定义与使用3.2 TDelegate的C++实现分析3.3 FDefaultDelegateUserPolic…"><meta data-rh="true" property="og:title" content="一文理解透UE委托Delegate"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/460092901"><meta data-rh="true" property="og:description" content="引言一、理解委托1.1 初识委托1.2 简单对委托的思考二、UE委托的概要2.1 三大类型2.2 支持绑定类型2.3 UE委托特性三、TDelegate单播C++实现3.1定义与使用3.2 TDelegate的C++实现分析3.3 FDefaultDelegateUserPolic…"><meta data-rh="true" property="og:image" content="https://pic1.zhimg.com/v2-faf6f604d3facd256ac1a8841b8a72bd_720w.jpg?source=172ae18b"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.bbce8f18.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.cbade8f9.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.8f6c52aa.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><style data-emotion-css="1m4merm">.u-safeAreaInset-top{height:constant(safe-area-inset-top) !important;height:env(safe-area-inset-top) !important;}.u-safeAreaInset-bottom{height:constant(safe-area-inset-bottom) !important;height:env(safe-area-inset-bottom) !important;}</style><link href="./一文理解透UE委托Delegate - 知乎_files/column.app.216a26f4.05772ea41548f390319f.css" crossorigin="" rel="stylesheet"><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"4678-bb634356\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;4678-bb634356&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./一文理解透UE委托Delegate - 知乎_files/init.js.download"></script><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="n99yhz">.css-n99yhz{box-sizing:border-box;margin:0;min-width:0;color:#175199;display:inline-block;margin-left:.3em;}</style><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="1ifz0go">.css-1ifz0go{overflow:visible!important;}</style><style data-emotion-css="1yuhvjn">.css-1yuhvjn{margin-top:16px;}</style><style data-emotion-css="3jt6os">.css-3jt6os .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-3jt6os .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-3jt6os .FileLinkCard-info{margin-left:12px;}.css-3jt6os .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-3jt6os .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-3jt6os .FileLinkCard-source{white-space:pre;}</style><style data-emotion-css="1wr1m8">.css-1wr1m8 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-1wr1m8 .LinkCard.new,.css-1wr1m8 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1wr1m8 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-1wr1m8 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1wr1m8 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1wr1m8 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-1wr1m8 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1wr1m8 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1wr1m8 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-1wr1m8 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1wr1m8 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1wr1m8 .LinkCard.old,.css-1wr1m8 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="hypxot">.css-hypxot .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-hypxot .LinkCard.old,.css-hypxot .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-hypxot .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-hypxot .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-hypxot .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-hypxot .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-hypxot .LinkCard.new,.css-hypxot .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-hypxot .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-hypxot .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-hypxot .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-hypxot .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-hypxot .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-hypxot .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-hypxot .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-hypxot .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-hypxot .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-hypxot .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-hypxot .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-hypxot .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-hypxot .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-hypxot .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-hypxot .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-hypxot .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-hypxot .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-hypxot .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-hypxot .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-hypxot .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-hypxot .FileLinkCard-info{margin-left:12px;}.css-hypxot .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-hypxot .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-hypxot .FileLinkCard-source{white-space:pre;}</style><style data-emotion-css="yvdm7v animation-1sh55c5">.css-yvdm7v{word-break:break-word;line-height:1.6;}.css-yvdm7v a.UserLink-link{color:#175199;}.css-yvdm7v a.UserLink-link:hover{border-bottom:1px solid #175199;}.css-yvdm7v lazy[data-lazy-status]{background-color:#F6F6F6;}.css-yvdm7v lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1sh55c5 0.5s ease-in;animation:animation-1sh55c5 0.5s ease-in;}.css-yvdm7v > [data-first-child]{margin-top:0;}.css-yvdm7v > :last-child{margin-bottom:0;}.css-yvdm7v h1,.css-yvdm7v h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-yvdm7v h3,.css-yvdm7v h4,.css-yvdm7v h5,.css-yvdm7v h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-yvdm7v u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #444444;}.css-yvdm7v b{font-weight:600;}.css-yvdm7v sup{font-size:0.8em;}.css-yvdm7v sup[data-draft-type='reference']{color:#175199;}.css-yvdm7v a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-yvdm7v a:focus{box-shadow:0 0 0 2px #FFFFFF,0 0 0 4px rgba(5,109,232,0.3);}.css-yvdm7v a.ztext-link,.css-yvdm7v a.internal,.css-yvdm7v a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #808080;}.css-yvdm7v a.ztext-link:hover,.css-yvdm7v a.internal:hover,.css-yvdm7v a.external:hover{color:#175199;border-bottom:1px solid #175199;}.css-yvdm7v a.ztext-link > .ellipsis::after,.css-yvdm7v a.internal > .ellipsis::after,.css-yvdm7v a.external > .ellipsis::after{content:'...';}.css-yvdm7v a.ztext-link > .invisible,.css-yvdm7v a.internal > .invisible,.css-yvdm7v a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-yvdm7v a.ztext-link u,.css-yvdm7v a.internal u,.css-yvdm7v a.external u{border:none;}.css-yvdm7v a.member_mention{color:#175199;}.css-yvdm7v a.member_mention:hover{border-bottom:1px solid #175199;}.css-yvdm7v p{margin:1.4em 0;}.css-yvdm7v p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-yvdm7v p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-yvdm7v hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #D3D3D3;}.css-yvdm7v img[eeimg]{max-width:100%;vertical-align:middle;}.css-yvdm7v img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-yvdm7v img[eeimg="2"]{margin:1.4em auto;display:block;}.css-yvdm7v blockquote{margin:1.4em 0;padding-left:1em;color:#646464;border-left:3px solid #D3D3D3;}.css-yvdm7v ol,.css-yvdm7v ul{margin:1.4em 0;padding:0;width:100%;}.css-yvdm7v ol ol,.css-yvdm7v ul ol,.css-yvdm7v ol ul,.css-yvdm7v ul ul{margin:0;}.css-yvdm7v ol li::before,.css-yvdm7v ul li::before{width:1em;}.css-yvdm7v ol > ol,.css-yvdm7v ul > ol,.css-yvdm7v ol > ul,.css-yvdm7v ul > ul{display:table-row;}.css-yvdm7v ol > ol::before,.css-yvdm7v ul > ol::before,.css-yvdm7v ol > ul::before,.css-yvdm7v ul > ul::before{display:table-cell;content:'';}.css-yvdm7v ul{display:table;}.css-yvdm7v ul>li{display:table-row;list-style:none;}.css-yvdm7v ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-yvdm7v ol{display:table;counter-reset:ol;}.css-yvdm7v ol > li{display:table-row;list-style:none;}.css-yvdm7v ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-yvdm7v ol ol{counter-reset:ol2;}.css-yvdm7v ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-yvdm7v ol ol ol{counter-reset:ol3;}.css-yvdm7v ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-yvdm7v ol ol ol ol{counter-reset:ol4;}.css-yvdm7v ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-yvdm7v figure{margin:1.4em 0;}.css-yvdm7v figure .content_image,.css-yvdm7v figure .origin_image{margin:0 auto;}.css-yvdm7v figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#999999;}.css-yvdm7v figure + figure{margin-top:calc(1.4em * 1.6);}.css-yvdm7v figure[data-size='small'],.css-yvdm7v figure:not([data-size]) > [data-size='small']{clear:both;}.css-yvdm7v figure[data-size='left'],.css-yvdm7v figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-yvdm7v figure[data-size='right'],.css-yvdm7v figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-yvdm7v figure[data-size='collapse']{margin-bottom:0;}.css-yvdm7v figure[data-size='collapse'] + figure{margin-top:0;}.css-yvdm7v .content_image,.css-yvdm7v .origin_image{display:block;max-width:100%;margin:1.4em auto;}.css-yvdm7v .content_image[data-size='small'],.css-yvdm7v .origin_image[data-size='small']{max-width:40%;}.css-yvdm7v .content_image.zh-lightbox-thumb,.css-yvdm7v .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-yvdm7v code{margin:0 2px;padding:3px 4px;border-radius:3px;font-size:0.9em;background-color:#F6F6F6;}.css-yvdm7v pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#F6F6F6;border-radius:4px;}.css-yvdm7v pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-yvdm7v li pre{white-space:pre-wrap;}.css-yvdm7v table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-yvdm7v table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-yvdm7v table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#F6F6F6;}.css-yvdm7v table[data-draft-type='table'] td,.css-yvdm7v table[data-draft-type='table'] th{border:1px solid #D3D3D3;line-height:24px;height:24px;padding:3px 12px;}.css-yvdm7v table[data-draft-type='table'] th{background:#EBEBEB;color:#121212;font-weight:500;}.css-yvdm7v .video-box,.css-yvdm7v .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #EBEBEB;border-radius:4px;}.css-yvdm7v .highlight{margin:1em 0;}.css-yvdm7v .highlight pre{margin:0;}.css-yvdm7v .highlight .hll{background-color:#FDFDFD;}.css-yvdm7v .highlight .c{font-style:italic;color:#999999;}.css-yvdm7v .highlight .err{color:#F1403C;}.css-yvdm7v .highlight .k{font-weight:600;}.css-yvdm7v .highlight .o{font-weight:600;}.css-yvdm7v .highlight .cm{font-style:italic;color:#999999;}.css-yvdm7v .highlight .cp{font-weight:600;color:#999999;}.css-yvdm7v .highlight .c1{font-style:italic;color:#999999;}.css-yvdm7v .highlight .cs{font-style:italic;font-weight:600;color:#999999;}.css-yvdm7v .highlight .gd{color:#FF3366;}.css-yvdm7v .highlight .ge{font-style:italic;}.css-yvdm7v .highlight .gr{color:#F1403C;}.css-yvdm7v .highlight .gh{color:#999999;}.css-yvdm7v .highlight .gi{color:#12b370;}.css-yvdm7v .highlight .go{color:#808080;}.css-yvdm7v .highlight .gp{color:#646464;}.css-yvdm7v .highlight .gs{font-weight:600;}.css-yvdm7v .highlight .gu{color:#999999;}.css-yvdm7v .highlight .gt{color:#F1403C;}.css-yvdm7v .highlight .kc{font-weight:600;}.css-yvdm7v .highlight .kd{font-weight:600;}.css-yvdm7v .highlight .kn{font-weight:600;}.css-yvdm7v .highlight .kp{font-weight:600;}.css-yvdm7v .highlight .kr{font-weight:600;}.css-yvdm7v .highlight .kt{font-weight:600;color:#175199;}.css-yvdm7v .highlight .m{color:#056DE8;}.css-yvdm7v .highlight .s{color:#F1403C;}.css-yvdm7v .highlight .na{color:#056DE8;}.css-yvdm7v .highlight .nb{color:#056DE8;}.css-yvdm7v .highlight .nc{font-weight:600;color:#175199;}.css-yvdm7v .highlight .no{color:#056DE8;}.css-yvdm7v .highlight .ni{color:#5555DD;}.css-yvdm7v .highlight .ne{font-weight:600;color:#F1403C;}.css-yvdm7v .highlight .nf{font-weight:600;color:#F1403C;}.css-yvdm7v .highlight .nn{color:#646464;}.css-yvdm7v .highlight .nt{color:#175199;}.css-yvdm7v .highlight .nv{color:#056DE8;}.css-yvdm7v .highlight .ow{font-weight:600;}.css-yvdm7v .highlight .w{color:#BFBFBF;}.css-yvdm7v .highlight .mf{color:#056DE8;}.css-yvdm7v .highlight .mh{color:#056DE8;}.css-yvdm7v .highlight .mi{color:#056DE8;}.css-yvdm7v .highlight .mo{color:#056DE8;}.css-yvdm7v .highlight .sb{color:#F1403C;}.css-yvdm7v .highlight .sc{color:#F1403C;}.css-yvdm7v .highlight .sd{color:#F1403C;}.css-yvdm7v .highlight .s2{color:#F1403C;}.css-yvdm7v .highlight .se{color:#F1403C;}.css-yvdm7v .highlight .sh{color:#F1403C;}.css-yvdm7v .highlight .si{color:#F1403C;}.css-yvdm7v .highlight .sx{color:#F1403C;}.css-yvdm7v .highlight .sr{color:#A5542F;}.css-yvdm7v .highlight .s1{color:#F1403C;}.css-yvdm7v .highlight .ss{color:#F1403C;}.css-yvdm7v .highlight .bp{color:#999999;}.css-yvdm7v .highlight .vc{color:#056DE8;}.css-yvdm7v .highlight .vg{color:#056DE8;}.css-yvdm7v .highlight .vi{color:#056DE8;}.css-yvdm7v .highlight .il{color:#056DE8;}.css-yvdm7v .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-yvdm7v .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(18,18,18,0.5);border-radius:6px;}.css-yvdm7v .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(18,18,18,0.6);}.css-yvdm7v .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yvdm7v .LinkCard.old,.css-yvdm7v .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yvdm7v .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-yvdm7v .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yvdm7v .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-yvdm7v .LinkCard.new,.css-yvdm7v .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yvdm7v .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yvdm7v .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-yvdm7v .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yvdm7v .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yvdm7v .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yvdm7v .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yvdm7v .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yvdm7v .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yvdm7v .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-yvdm7v .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yvdm7v .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yvdm7v .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yvdm7v .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-yvdm7v .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-yvdm7v .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yvdm7v .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yvdm7v .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yvdm7v .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yvdm7v .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yvdm7v .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yvdm7v .FileLinkCard-info{margin-left:12px;}.css-yvdm7v .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yvdm7v .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yvdm7v .FileLinkCard-source{white-space:pre;}@-webkit-keyframes animation-1sh55c5{from{opacity:0;}to{opacity:1;}}@keyframes animation-1sh55c5{from{opacity:0;}to{opacity:1;}}</style><style data-emotion-css="1s3a4zw">.css-1s3a4zw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#056DE8;vertical-align:top;border-radius:100px;background:rgba(5,109,232,0.1);}.css-1s3a4zw:hover{background-color:rgba(5,109,232,0.15);}</style><style data-emotion-css="u1frr4">.css-u1frr4{width:724px;}.css-u1frr4 .Modal-content{margin:22px 0 5px;}.css-u1frr4 .Creator-QuestionShared-title{padding-right:65px;}</style><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.zswsdid.2cc328e23d7862d71b15.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.shared_da7c8ae9ba4d3befc7c2f1c0b3e151cc8ee375ec.4f345cab0cd0b6a503cb.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./一文理解透UE委托Delegate - 知乎_files/column.user-hover-card.216a26f4.2325354b564ca3c742a9.css" crossorigin="anonymous"><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.user-hover-card.e87bd5c7db1ff02c3ce4.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./一文理解透UE委托Delegate - 知乎_files/column.Labels.216a26f4.7d19d2afdc588e36471f.css" crossorigin="anonymous"><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.Labels.25fadde6407133a2ad02.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./一文理解透UE委托Delegate - 知乎_files/column.GoodsRecommendGoodsCardList.216a26f4.fa4bea774ed719d42a42.css" crossorigin="anonymous"><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.GoodsRecommendGoodsCardList.190473a9b75a37ce9cf2.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./一文理解透UE委托Delegate - 知乎_files/column.modals.216a26f4.4cc94e5a02bc6d62ae13.css" crossorigin="anonymous"><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.modals.7427bf5d37d675b109a9.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.report_modals.f2d5fb1489ceb67917fe.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_cf230269.651fe07b8e686459fe58.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.comments-v3.8b56d754fdc37da78fe9.js.download" crossorigin="anonymous"></script><style data-emotion="css"></style><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.83.5124800e486d3a602647.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_9974496f.52c2110d3401aef4e8b3.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.shared_03103dc5b8182a3433c5ef33bacb88093fd08a38.9ca8f4a418b67f92c939.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.shared_889419e066c38251e2dcbb9a7c42dbfc379cadeb.254e4f3e730a6b488d17.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./一文理解透UE委托Delegate - 知乎_files/column.EditableV2.216a26f4.56bfcd6fcf02391f767f.css" crossorigin="anonymous"><script charset="utf-8" src="./一文理解透UE委托Delegate - 知乎_files/column.EditableV2.9f0e35d0c4103cc5b4ea.js.download" crossorigin="anonymous"></script></head><body class="WhiteBg-body PostIndex-body" data-rh="class"><div id="root"><div class="App"><div class="LoadingBar"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;ao-ta-kang-007&quot;}" data-zop="{&quot;authorName&quot;:&quot;rayhunter&quot;,&quot;itemId&quot;:460092901,&quot;title&quot;:&quot;一文理解透UE委托Delegate&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;460092901&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader is-fixed css-1l12z7y" style="width: 1581.33px; top: 0px; left: 0px;"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#056DE8" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="https://www.zhihu.com/column/c_1405665457299308544">游戏引擎</a></div></div><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover1-content" type="button" class="Button ColumnPageHeader-MenuToggler Button--plain"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots" class="Zi Zi--Dots" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="PencilPaper24" data-old-api="EditSurround" class="Zi Zi--EditSurround" fill="currentColor"><path d="M3.55 5.97a2.415 2.415 0 012.415-2.416h7.56a.75.75 0 010 1.5h-7.56a.915.915 0 00-.915.915v12.072c0 .505.41.915.915.915h12.074c.506 0 .915-.41.915-.915v-7.557a.75.75 0 011.5 0v7.557a2.415 2.415 0 01-2.415 2.415H5.965A2.415 2.415 0 013.55 18.04V5.969z" fill-rule="evenodd" clip-rule="evenodd"></path><path d="M20.239 3.77a.75.75 0 010 1.06l-8.206 8.206a.75.75 0 01-1.06-1.06l8.205-8.206a.75.75 0 011.06 0z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover9-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover9-content" type="button" class="Button AppHeader-profileEntry Button--plain"><img class="Avatar AppHeader-profileAvatar" width="30" height="30" src="./一文理解透UE委托Delegate - 知乎_files/v2-ef69d369588e9764f9252225e6dc29ce_is.jpg" srcset="https://picx.zhimg.com/v2-ef69d369588e9764f9252225e6dc29ce_im.jpg?source=32738c0c 2x" alt="点击打开奥塔康007的主页"></button></div><div class="Popover AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover10-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover10-content"></div></div></div></div><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div></div><img class="TitleImage" src="./一文理解透UE委托Delegate - 知乎_files/v2-faf6f604d3facd256ac1a8841b8a72bd_1440w.jpg" alt="一文理解透UE委托Delegate"><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">一文理解透UE委托Delegate</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="rayhunter"><meta itemprop="image" content="https://pic2.zhimg.com/7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/zhou-zhi-long-16"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover11-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover11-content"><a href="https://www.zhihu.com/people/zhou-zhi-long-16" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar Avatar--round AuthorInfo-avatar" width="38" height="38" src="./一文理解透UE委托Delegate - 知乎_files/7353717666ea56b82d1b39a5d6acf7de_xs.jpg" srcset="https://pic2.zhimg.com/7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b 2x" alt="rayhunter"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover12-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover12-content"><a href="https://www.zhihu.com/people/zhou-zhi-long-16" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">rayhunter</a></div></div><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-n99yhz" aria-label="腾讯游戏 游戏客户端开发工程师" data-tooltip="腾讯游戏 游戏客户端开发工程师"><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-1ifz0go" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#0066FF"></path><svg class="Zi Zi--Check" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText css-0">腾讯游戏 游戏客户端开发工程师</div></div></div></div></div></div><button type="button" class="Button FollowButton Button--primary Button--blue"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="PlusFill24" data-old-api="Plus" class="Zi Zi--Plus FollowButton-icon" fill="currentColor"><path d="M13.25 3.25a1.25 1.25 0 10-2.5 0v7.5h-7.5a1.25 1.25 0 100 2.5h7.5v7.5a1.25 1.25 0 102.5 0v-7.5h7.5a1.25 1.25 0 000-2.5h-7.5v-7.5z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>关注他</button></div><div class="LabelContainer-wrapper"></div><div role="button" tabindex="0"><span class="Voters"><button type="button" class="Button Button--plain">62 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="css-1yuhvjn"><div class="Catalog isCatalogV2 css-m3ckor" data-za-detail-view-name="正文" style="visibility: visible;"><div class="css-jpzy4w"><div class="css-zkfaav"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--Catalog24" fill="currentColor"><path d="M10 5a1 1 0 011-1h10a1 1 0 110 2H11a1 1 0 01-1-1zm4 6a1 1 0 100 2h7a1 1 0 100-2h-7zm0 7a1 1 0 100 2h7a1 1 0 100-2h-7zm-8.335.25a.915.915 0 01-.915-.915V12.75H10a.75.75 0 000-1.5H4.75V6.665c0-.505.41-.915.915-.915H7a.75.75 0 000-1.5H5.665A2.415 2.415 0 003.25 6.665v10.67a2.415 2.415 0 002.415 2.415H10a.75.75 0 000-1.5H5.665z"></path></svg></span><div class="css-5287jj">目录</div></div><div class="css-17oyyq4">收起</div></div><div class="css-1456usx"><div class="Catalog-content css-a3sv8e"><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_0" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">引言</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_1" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">一、理解委托</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_2" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">1.1 初识委托</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_3" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">1.2 简单对委托的思考</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_4" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">二、UE委托的概要</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_5" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">2.1 三大类型</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_6" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">2.2 支持绑定类型</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_7" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">2.3 UE委托特性</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_8" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">三、TDelegate单播C++实现</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_9" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.1定义与使用</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1hz6n6s"><div data-catalog-target-id="h_460092901_10" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.2 TDelegate的C++实现分析</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_11" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.3 FDefaultDelegateUserPolicy策略模式</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_12" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.4 绑定</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_13" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.5 创建</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_14" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.6 执行</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_15" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">3.7 内嵌眼花缭乱的模板类</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_16" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">四、DelegateInstance的C++实现</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_17" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">4.1 TBaseUObjectMethodDelegateInstance的细节</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_18" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">4.2 TCommonDelegateInstanceState的细节</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-s9jga1"><div data-catalog-target-id="h_460092901_19" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-lwqo8e"><div class="css-nj7ofv">4.3 IBaseDelegateInstance与IDelegateInstance</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_20" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">五、TMulticastDelegate多播</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_21" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">六、TBaseDynamicDelegate动态委托</div></div></div><div class="Catalog-FirstLevelTitle Catalog-Title css-1kilzsx"><div data-catalog-target-id="h_460092901_22" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-hvuawc"><div class="css-nj7ofv">结语</div></div></div></div></div></div><div class="RichText ztext Post-RichText css-yvdm7v" options="[object Object]"><ul data-first-child=""><ul><li data-pid="rY5GosHe"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E5%BC%95%E8%A8%80" class="internal" data-za-detail-view-id="1043">引言</a></li><li data-pid="tcrqWZ73"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E4%B8%80%E7%90%86%E8%A7%A3%E5%A7%94%E6%89%98" class="internal" data-za-detail-view-id="1043">一、理解委托</a></li><ul><li data-pid="0x0RvDd0"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#11-%E5%88%9D%E8%AF%86%E5%A7%94%E6%89%98" class="internal" data-za-detail-view-id="1043">1.1 初识委托</a></li><li data-pid="RiuHu_Bi"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#12-%E7%AE%80%E5%8D%95%E5%AF%B9%E5%A7%94%E6%89%98%E7%9A%84%E6%80%9D%E8%80%83" class="internal" data-za-detail-view-id="1043">1.2 简单对委托的思考</a></li></ul><li data-pid="p3ozvPBO"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E4%BA%8Cue%E5%A7%94%E6%89%98%E7%9A%84%E6%A6%82%E8%A6%81" class="internal" data-za-detail-view-id="1043">二、UE委托的概要</a></li><ul><li data-pid="8koXvEMi"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#21-%E4%B8%89%E5%A4%A7%E7%B1%BB%E5%9E%8B" class="internal" data-za-detail-view-id="1043">2.1 三大类型</a></li><li data-pid="LpYge60H"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#22-%E6%94%AF%E6%8C%81%E7%BB%91%E5%AE%9A%E7%B1%BB%E5%9E%8B" class="internal" data-za-detail-view-id="1043">2.2 支持绑定类型</a></li><li data-pid="Bamf3H1_"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#23-ue%E5%A7%94%E6%89%98%E7%89%B9%E6%80%A7" class="internal" data-za-detail-view-id="1043">2.3 UE委托特性</a></li></ul><li data-pid="5W3My3lV"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E4%B8%89tdelegate%E5%8D%95%E6%92%ADc%E5%AE%9E%E7%8E%B0" class="internal" data-za-detail-view-id="1043">三、TDelegate单播C++实现</a></li><ul><li data-pid="r0LxABxO"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#31%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8" class="internal" data-za-detail-view-id="1043">3.1定义与使用</a></li><li data-pid="29b_fVWN"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#32-tdelegate%E7%9A%84c%E5%AE%9E%E7%8E%B0%E5%88%86%E6%9E%90" class="internal" data-za-detail-view-id="1043">3.2 TDelegate的C++实现分析</a></li><li data-pid="WRH2LxI0"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#33-fdefaultdelegateuserpolicy%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F" class="internal" data-za-detail-view-id="1043">3.3 FDefaultDelegateUserPolicy策略模式</a></li><li data-pid="oEfoTupM"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#34-%E7%BB%91%E5%AE%9A" class="internal" data-za-detail-view-id="1043">3.4 绑定</a></li><li data-pid="vhKTn0qv"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#35-%E5%88%9B%E5%BB%BA" class="internal" data-za-detail-view-id="1043">3.5 创建</a></li><li data-pid="arKTjEAk"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#36-%E6%89%A7%E8%A1%8C" class="internal" data-za-detail-view-id="1043">3.6 执行</a></li><li data-pid="fzYo66yZ"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#37-%E5%86%85%E5%B5%8C%E7%9C%BC%E8%8A%B1%E7%BC%AD%E4%B9%B1%E7%9A%84%E6%A8%A1%E6%9D%BF%E7%B1%BB" class="internal" data-za-detail-view-id="1043">3.7 内嵌眼花缭乱的模板类</a></li></ul><li data-pid="2BKNRXe9"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E5%9B%9Bdelegateinstance%E7%9A%84c%E5%AE%9E%E7%8E%B0" class="internal" data-za-detail-view-id="1043">四、DelegateInstance的C++实现</a></li><ul><li data-pid="y4sNsQDJ"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#41-tbaseuobjectmethoddelegateinstance%E7%9A%84%E7%BB%86%E8%8A%82" class="internal" data-za-detail-view-id="1043">4.1 TBaseUObjectMethodDelegateInstance的细节</a></li><li data-pid="ZKZUqD02"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#42-tcommondelegateinstancestate%E7%9A%84%E7%BB%86%E8%8A%82" class="internal" data-za-detail-view-id="1043">4.2 TCommonDelegateInstanceState的细节</a></li><li data-pid="LviFdl7n"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#43-ibasedelegateinstance%E4%B8%8Eidelegateinstance" class="internal" data-za-detail-view-id="1043">4.3 IBaseDelegateInstance与IDelegateInstance</a></li></ul><li data-pid="6NGes-L_"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E4%BA%94tmulticastdelegate%E5%A4%9A%E6%92%AD" class="internal" data-za-detail-view-id="1043">五、TMulticastDelegate多播</a></li><li data-pid="9VGebyRH"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E5%85%ADtbasedynamicdelegate%E5%8A%A8%E6%80%81%E5%A7%94%E6%89%98" class="internal" data-za-detail-view-id="1043">六、TBaseDynamicDelegate动态委托</a></li><li data-pid="hde0QKHt"><a href="https://zhuanlan.zhihu.com/p/460092901/edit#%E7%BB%93%E8%AF%AD" class="internal" data-za-detail-view-id="1043">结语</a> </li></ul></ul><h2 id="h_460092901_0" data-into-catalog-status="">引言</h2><p data-pid="RotiFcWW">写完<a href="https://zhuanlan.zhihu.com/p/446500670" class="internal" data-za-detail-view-id="1043">《UE4智能指针及与STL的对比》</a>后，好久没有写C++专有文章了，想写一篇了，但话题只能在UE内。由于UE的委托还是比较偏纯C++设计，加上内部有不少宏和模板，想要完全理解，可能对C++新手不是特别友好。我个人作为一名C++元编程爱好者，想在这里谈谈个人浅见，如果还能帮助到大家那再好不过了。上次我写了一篇《由UE4注册TDelegate的委托让我陷入了C++的沉思》介绍委托的部分知识点，重点分析了函数签名类型转换与委拖部分结构和借new重载转换，还入选了UE的社区周报，本文就想在此基础上全面介绍委托，如果想深入的了解强列建议两篇一起读。</p><div class="RichText-LinkCardContainer"><a target="_blank" href="https://zhuanlan.zhihu.com/p/433019649" data-draft-node="block" data-draft-type="link-card" data-text="由UE4注册TDelegate的委托让我陷入了C++的沉思" class="LinkCard new css-1wr1m8" data-image="https://pic2.zhimg.com/v2-faf6f604d3facd256ac1a8841b8a72bd_ipico.jpg" data-za-detail-view-id="172"><span class="LinkCard-contents"><span class="LinkCard-title two-line">由UE4注册TDelegate的委托让我陷入了C++的沉思</span><span class="LinkCard-desc">81 赞同 · 5 评论<span class="LinkCard-tag">文章</span></span></span><span class="LinkCard-image" style="height: 60px;"><img src="./一文理解透UE委托Delegate - 知乎_files/v2-faf6f604d3facd256ac1a8841b8a72bd_ipico.jpg" alt=""></span></a></div><div class="RichText-LinkCardContainer"><a target="_blank" href="https://zhuanlan.zhihu.com/p/446500670" data-draft-node="block" data-draft-type="link-card" data-text="UE4智能指针及与STL的对比" class="LinkCard new css-1wr1m8" data-image="https://pic1.zhimg.com/v2-1bc66b075acb68438e160ec77134b2e4_ipico.jpg" data-za-detail-view-id="172"><span class="LinkCard-contents"><span class="LinkCard-title two-line">UE4智能指针及与STL的对比</span><span class="LinkCard-desc">80 赞同 · 3 评论<span class="LinkCard-tag">文章</span></span></span><span class="LinkCard-image" style="height: 60px;"><img src="./一文理解透UE委托Delegate - 知乎_files/v2-1bc66b075acb68438e160ec77134b2e4_ipico.jpg" alt=""></span></a></div><div class="RichText-LinkCardContainer"><a target="_blank" href="https://zhuanlan.zhihu.com/p/397720700" data-draft-node="block" data-draft-type="link-card" data-text="rayhunter：C++中VS2019下STL的std::tuple元组深入剖析" class="LinkCard new css-1wr1m8" data-image="https://pic1.zhimg.com/v2-1bc66b075acb68438e160ec77134b2e4_180x120.jpg" data-image-width="1200" data-image-height="500" data-za-detail-view-id="172"><span class="LinkCard-contents"><span class="LinkCard-title two-line">rayhunter：C++中VS2019下STL的std::tuple元组深入剖析</span><span class="LinkCard-desc">26 赞同 · 8 评论<span class="LinkCard-tag">文章</span></span></span><span class="LinkCard-image" style="height: 60px;"><img src="./一文理解透UE委托Delegate - 知乎_files/v2-1bc66b075acb68438e160ec77134b2e4_180x120.jpg" alt=""></span></a></div><div class="RichText-LinkCardContainer"><a target="_blank" href="https://www.zhihu.com/question/472749525/answer/2084936755" data-draft-node="block" data-draft-type="link-card" data-text="C++代码可以魔法到什么程度？" class="LinkCard new css-1wr1m8" data-za-detail-view-id="172"><span class="LinkCard-contents"><span class="LinkCard-title two-line">C++代码可以魔法到什么程度？</span><span class="LinkCard-desc">500 赞同 · 11 评论<span class="LinkCard-tag">回答</span></span></span></a></div><h2 id="h_460092901_1" data-into-catalog-status="">一、理解委托</h2><p data-pid="2UzPxv7f">第一章节非常简单，适合完全不了解委托的新同学，已经了解过委托的建议直接跳过。</p><h3 id="h_460092901_2" data-into-catalog-status="">1.1 初识委托</h3><p data-pid="0nGcnGhq">C++原生并没有委托，不过像C#语言原生就有，但C++几乎是无所不能，像智能指针，内存池及GC非常重要的设计，就由我们自己实现，委托也不例外。不过委托这词还是有点抽象，用个例子类比一下。</p><p data-pid="We6k_1z-">行军打仗，侦察兵负责侦察，炮兵负责攻击，侦察兵将发现的敌军据点报告给炮兵，炮兵实施火力打击。从程序语言设计层面考虑：模块A代表侦察兵；模块B代表炮兵。A，B模块本身无直接关联，相互独立解耦，侦查兵发现敌方据点后并不直接或者说根本无法对其进行进攻，委拖就像侦查兵身上配备的无线电，非常小巧，把据点位置告之炮兵，炮兵进行真正火力打击。委托的注册就像炮兵本身有个固定频率的电台，提前告之侦察兵，就一流程就是委托的注册，发现敌方据点后可以向这个特定的频率发送通知。更进一步，侦察兵只把发现的据点信息告之炮兵叫单播委托；如果信息化，狙击以及冲锋三个小队都关心敌方哨兵情况，告之侦察兵，如果发现哨兵立马通知我们（就是多播注册），当侦察兵实际勘察发现敌方哨兵时，立马通知这三个小队，三个小队可以按自己的方法处理收到的消息，这叫多播委托。</p><p data-pid="7MJ3kXV4">上面是简单的实例来理解委托，我们从非常简单的C++代码来理解一下委托。</p><div class="highlight"><pre><code class="language-cpp"><span class="k">using</span> <span class="n">DelegateType</span> <span class="o">=</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">ArtilleryAction</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Drop a bomb on the (%d,%d) position</span><span class="se">\r\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Scout</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">Scout</span><span class="p">(</span><span class="n">DelegateType</span> <span class="n">Delegate</span><span class="p">)</span> <span class="o">:</span><span class="n">ArtilleryDelegate</span><span class="p">(</span><span class="n">Delegate</span><span class="p">)</span> <span class="p">{}</span>
    <span class="kt">void</span> <span class="nf">FindInformation</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="p">(</span><span class="o">*</span><span class="n">ArtilleryDelegate</span><span class="p">)(</span><span class="n">rand</span><span class="p">(),</span> <span class="n">rand</span><span class="p">());</span>
    <span class="p">}</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">DelegateType</span> <span class="n">ArtilleryDelegate</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Scout</span> <span class="n">OneScout</span><span class="p">(</span><span class="n">ArtilleryAction</span><span class="p">);</span>
    <span class="n">OneScout</span><span class="p">.</span><span class="n">FindInformation</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p data-pid="yCGlouHM">我们将<code>void (*)(int x, int y)</code>无返回值且接受两个int型参数的函数指针类型重定义为：<b>DelegateType</b>，就是一种超级简单的委托类型。然后写了Scout侦察兵类，只有一个成员ArtilleryDelegate，就是刚定义的DelegateType委托类型，在Scout构造函数中提供了委托的初始化赋值，即对委托进行绑定注册，在我们的main函数中，将委托绑定到了<code>void ArtilleryAction(int x, int y)</code>函数中了。最后当然类中还给了一个简单测试函数：<code>FindInformation</code>,表示侦察兵发现敌方据点坐标信息时，将信息传给已经绑定委托回调函数，调用后会打印：Drop a bomb on the （xx,xx） Position，总的来说这就是委托的简单模型，Scout类只是按它的功能发现信息，传递发现的信息，并不关心信息到底谁处理，怎么处理。这样设计很容易将模块解耦和组合起来，比如注册时也可以换成其它的符合注册条件的函数，给我们比较大的自由。</p><h3 id="h_460092901_3" data-into-catalog-status="">1.2 简单对委托的思考</h3><p data-pid="vfuzaavm">有了这些基础知识，我先提一些想法，也是UE设计要面临的，自己提前考虑一下： </p><ul><li data-pid="i7_1sp-S"><i>委托只能是简单的函数指针吗？ </i> </li><li data-pid="cXtuByOQ">委托能提前保存函数参数吗？类似std::bind可以将参数提前缓存起来 </li><li data-pid="yeaMlVF2"><i>委托能对不同的函数类型进行转换吗 </i> </li><li data-pid="1iMz82Tn">委托如果都支持上面功能，怎么设计，成员数据怎么保存 </li><li data-pid="-o_qK5yQ"><i>委托如果支持成员函数，怎么处理成员对象时效安全问题 </i> </li><li data-pid="8mqIQaE9">委托怎么设计支持多播 </li><li data-pid="0Vzf0iYY"> 委托对UE专有UObject怎么进行反射处理</li></ul><h2 id="h_460092901_4" data-into-catalog-status="">二、UE委托的概要</h2><h3 id="h_460092901_5" data-into-catalog-status="">2.1 三大类型</h3><p data-pid="_lVJIns6">UE的委托分为三大类，具体的枚举分类可以参见：DelegateCombinations.h文件  </p><ul><li data-pid="VIFDvtAE"><i><b>1.单播委托:</b> TDelegate模板类，通常用<code>DECLARE_DELEGATE</code>及<code>DECLARE_DELEGATE_XXXXParams</code>宏进行声明，后面的宏表示带XXXX个参数 </i> </li><li data-pid="QugeV6nB"><b>2.多播委托:</b> TMulticastDelegate模板类，通常用<code>DECLARE_MULTICAST_DELEGATE</code>及<code>DECLARE_MULTICAST_DELEGATE_&lt;Num&gt;Params</code>宏进行声明，后面的宏表示带XXXX个参数  </li><li data-pid="-3V_iDSA"><i><b>3.动态委托:</b> 继承于TBaseDynamicDelegate，TBaseDynamicMulticastDelegate模板类，通常用<code>DECLARE_DYNAMIC_DELEGATE</code>及<code>DECLARE_DYNAMIC_MULTICAST_DELEGATE</code>宏进行声明，分别表示单播与多播，另外还有包含参数个数的宏如<code>DECLARE_DYNAMIC_DELEGATE_OneParam</code>，其本质集成了UObject的反射系统，让其可以注册蓝图实现的函数及支持序列化存储到本机，UFunction只需给函数名称及蓝图支持是其最大的特性，概念上并未逃出前两类，性能和功能弱于前两类。 </i> </li><li data-pid="9hGqucI_"><b>2.1 Event:</b> 其继承多播，不单独讨论了。</li></ul><p data-pid="Q5DrubWZ">以单播为例，我们可以看一下表格的映射关系</p><p data-pid="HgTlAgbC"> | </p><h3 id="h_460092901_6" data-into-catalog-status="">2.2 支持绑定类型</h3><table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><th>函数签名类型</th><th>宏声明</th></tr><tr><td>void Function()</td><td>DECLARE_DELEGATE( DelegateName )</td></tr><tr><td>void Function(  &lt;Param1&gt;)</td><td>DECLARE_DELEGATE_OneParam( DelegateName, Param1Type )</td></tr><tr><td>void Function( &lt;Param1&gt;,&lt;Parm2&gt;  )</td><td>DECLARE_DELEGATE_TwoParams( DelegateName, Param1Type, Param2Type )</td></tr><tr><td>void Function(&lt;Param1 &gt;, &lt;Parm2&gt; ,...)</td><td>DECLARE_DELEGATE_&lt;Num&gt;Params( DelegateName, Param1Type, Param2Type, ... )</td></tr><tr><td>&lt;RetVal&gt; Function()</td><td>DECLARE_DELEGATE_RetVal( RetValType, DelegateName )</td></tr><tr><td>&lt;RetVal&gt; Function(&lt;Parm1&gt;)</td><td>DECLARE_DELEGATE_RetVal_OneParam( RetValType, DelegateName, Param1Type )</td></tr><tr><td>&lt;RetVal&gt; Function(&lt;Parm1&gt;,&lt;Parm2&gt;)</td><td>DECLARE_DELEGATE_RetVal_TwoParams( RetValType, DelegateName, Param1Type, Param2Type )</td></tr><tr><td>&lt;RetVal&gt; Function(&lt;Param1&gt;,&lt;Parm2&gt;,...)</td><td>DECLARE_DELEGATE_RetVal_&lt;Num&gt;Params( RetValType, DelegateName, Param1Type, Param2Type, ... )</td></tr></tbody></table><p data-pid="0rxyUlyI">UE的委托很强大，一但2.1中类型声明确定后，只要能将要绑定的类型转换为声明的类型都能进行注册绑定，这个在<a href="https://zhuanlan.zhihu.com/p/433019649" class="internal" data-za-detail-view-id="1043">《由UE4注册TDelegate的委托让我陷入了C++的沉思》</a>有分析，后面也会有一定的讨论。下面的表列举了单播可以绑定的类型，单播是<b>Bind开头</b>，如果是多播注册，只需将<b>Bind换成Add</b></p><blockquote data-pid="vgYu4mHb"> 这里先简单说一下，UE的委托类似std::bind可带有tuple保存信息，官方称为<b>payload</b>，比如声明委托函数原类型是<code>void()(int)</code>型，比如想绑定注册<code>void MyClass::Test(int，int，string)</code>函数，明显类型是不匹配的。因为待注册的函数首先是一个成员函数，会隐藏第一个参数this指针，后面还多了两个参数int，string;但只需将this指针保存并使得后面两个变量值，比如18与“helloworld”也能提前保存到<b>payload</b>中，调用时再还原，也是可以转换成功的，当然还要考虑指针的有效性问题，这背后肯定有复杂的设计。<br> </blockquote><table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><th>方式</th><th>用途</th></tr><tr><td>BindStatic(&amp;GlobalFunctionName)</td><td>绑定静态函数，要么是普通全局函数要么是静态成员函数</td></tr><tr><td>BindUObject(UObject, &amp;UClass::Function)</td><td>TWeakObjectPtr为安全性设计要点，绑定UObject类成员函数，object必有效</td></tr><tr><td>BindSP(SharedPtr, &amp;FClass::Function)</td><td>TWeakPtr为安全性设计要点，绑定普通类成员函数，注意是F开头，指针对象必有效</td></tr><tr><td>BindThreadSafeSP(SharedPtr, &amp;FClass::Function)</td><td>TWeakPtr为安全性设计要点，绑定普通类成员函数，注意是F开头，指针对象必有效，只是线程安全版，安全版问题可以参考开头链接：《UE4智能指针及与STL的对比》</td></tr><tr><td>BindRaw(RawPtr, &amp;FClass::Function)</td><td>绑定普通类成员函数，注意是F开头，这次没有智能指针帮助，没有绑定对象内存的安全检查处理，一但对象内存回收，我们必手动处理Unbind或者移除，不然可能crash</td></tr><tr><td>BindLambda(Lambda)</td><td>绑定lambda表达式，没有安全检查，自己处理好指针或引用的延迟调用问题</td></tr><tr><td>BindWeakLambda(UObject, Lambda)</td><td>绑定lambda表达式，UObject有效性可以确保，但Lambda的其它引用或指针就不确保了</td></tr><tr><td>BindUFunction(UObject, FName("FunctionName"))</td><td>同时支持UObject的普通委托和Dynamic委托，因为它是用UFunction名称查询的，借了UE的序列化</td></tr><tr><td>BindDynamic(UObject, &amp;UClass::FunctionName)</td><td>仅仅可用于Dynamic委托，成员函数FunctionName必须有UFUNCTION宏声明过</td></tr></tbody></table><h3 id="h_460092901_7" data-into-catalog-status="">2.3 UE委托特性</h3><ol><li data-pid="XUtP9br4">1.委托内部特性</li></ol><ul><li data-pid="RIPd4U75">支持回调函数带返回值</li><li data-pid="UTYYwHre">内部最高支持4个<b>payload</b>，如果4个参数还不够你用的话，请考虑将部分参数合为结构体或者类</li></ul><blockquote data-pid="thsgBdrC"> 这个我细看了一下，实际上C++模板及tuple设计都是可变参，支持无限多个。只是UE在TDelegate模板类中对DelegateInstance实例模板类反查只提供了4个参数，所以建议为4个，如果不需要反查，可以传无限多。</blockquote><ul><li data-pid="EXaE1F32">委托类型支持多参数，可以见2.1的声明定义，暂时最多9个，请考虑将部分参数合为结构体或者</li><li data-pid="qvRhtIvA">支持const函数，比用const成员函数与非const成员函数</li><li data-pid="CYbvl9kP">强大的函数签名类型转换</li><li data-pid="bnX2JHRf">委托本体与委托实例解耦及交互设计</li></ul><blockquote data-pid="B0uCCqxJ">  个人理解最后两点为精华，无论从C++模板语法层面还是从设计使用上，都是非常赞的</blockquote><ol><li data-pid="3BroY-CN">多播委托通过<code>Broadcast()</code>一次触发所有注册的回调函数执行，不支持函数带有返回值</li><li data-pid="Vv_Evyei">Dynamic动态委托主要就是集成了UObject的反射系统，让其可以注册蓝图实现的函数及支持序列化存储到本机。当然也可以绑定原生C++函数代码，前提是这个函数被<b>UFUNCTION</b>标记（因为UFUNCTION标记过，这个函数就可以进行反射与序列化了）</li><li data-pid="LywvGrA3">UE的委拖内部通过<b>payload</b>保存数据，实质是UE自己实现的TTuple，tuple本身可以支持任意类型变量，所以这里可以让委托变得异常强大，有了这个可以轻松处理不同类型的函数转换。</li></ol><h2 id="h_460092901_8" data-into-catalog-status="">三、TDelegate单播C++实现</h2><p data-pid="BJZdjqAe">先看结构图,图可能直接看不清，双击查看原图，画这个图费了我不少时间： </p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-1e159439edd6b5bc632b9defa04cf236_b.jpg" data-caption="" data-size="normal" data-rawwidth="2300" data-rawheight="1959" class="origin_image zh-lightbox-thumb" width="2300" data-original="https://pic3.zhimg.com/v2-1e159439edd6b5bc632b9defa04cf236_r.jpg"/></noscript><img src="./一文理解透UE委托Delegate - 知乎_files/v2-1e159439edd6b5bc632b9defa04cf236_1440w.jpg" data-caption="" data-size="normal" data-rawwidth="2300" data-rawheight="1959" class="origin_image zh-lightbox-thumb lazy" width="2300" data-original="https://pic3.zhimg.com/v2-1e159439edd6b5bc632b9defa04cf236_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-1e159439edd6b5bc632b9defa04cf236_b.jpg" data-lazy-status="ok"></figure><p data-pid="Aiv9l9a_"> 总括一下：TDelegate是UE提供的单播委托，声明委托时目前限定了最多可携带9个参数。支持多种可调用对象（普通函数，成员函数，仿函数，lambda等）到声明函数类型进行转换，同时转换的时还支持额外预保存payload参数，类似std:bind一样。TDelegate委托自己没有成员，使用了策略模式继承于基类FDelegateBase。基类FDelegateBase通过new两次重载提供对委托实例的内存分配，并且提供释放及访问方法，这样将委托本体与真正实例解耦开，委托本身不直接保存实例对象，实例由于有多种类型，通过中间层也可以很好的解决了类型擦除与转换的问题，委托本体的size也比较小，只有12字节，由于对齐原因，占16字节。</p><h3 id="h_460092901_9" data-into-catalog-status="">3.1定义与使用</h3><ol><li data-pid="Dw97t3YP">定义单播委托FOnMontageEnded类型的实现</li></ol><div class="highlight"><pre><code class="language-cpp"><span class="n">DECLARE_DELEGATE_TwoParams</span><span class="p">(</span> <span class="n">FOnMontageEnded</span><span class="p">,</span> <span class="k">class</span> <span class="nc">UAnimMontage</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="p">);</span>
</code></pre></div><ol><li data-pid="dr1V9o3p">在<code>UAbilityTask_PlayMontageAndWait</code>类中定义委托对象MontageEndedDelegate，作为类成员对象</li></ol><div class="highlight"><pre><code class="language-cpp"><span class="k">class</span> <span class="nc">UAbilityTask_PlayMontageAndWait</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">FOnMontageEnded</span> <span class="n">MontageEndedDelegate</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><ol><li data-pid="iBLVvSmD">在cpp代码中注册绑定委托的回调函数，并拷贝</li></ol><div class="highlight"><pre><code class="language-cpp"><span class="c1">// 委托的回调函数
</span><span class="c1"></span><span class="kt">void</span> <span class="n">UAbilityTask_PlayMontageAndWait</span><span class="o">::</span><span class="n">OnMontageEnded</span><span class="p">(</span><span class="n">UAnimMontage</span><span class="o">*</span> <span class="n">Montage</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">bInterrupted</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bInterrupted</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ShouldBroadcastAbilityTaskDelegates</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="n">OnCompleted</span><span class="p">.</span><span class="n">Broadcast</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">EndTask</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">UAbilityTask_PlayMontageAndWait</span><span class="o">::</span><span class="n">Activate</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// 注册
</span><span class="c1"></span>    <span class="n">MontageEndedDelegate</span><span class="p">.</span><span class="n">BindUObject</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">UAbilityTask_PlayMontageAndWait</span><span class="o">::</span><span class="n">OnMontageEnded</span><span class="p">);</span>
    <span class="c1">// 委托拷贝给动画实列
</span><span class="c1"></span>    <span class="n">AnimInstance</span><span class="o">-&gt;</span><span class="n">Montage_SetEndDelegate</span><span class="p">(</span><span class="n">MontageEndedDelegate</span><span class="p">,</span> <span class="n">MontageToPlay</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><ol><li data-pid="zAtUaQrr">执行：</li></ol><div class="highlight"><pre><code class="language-cpp"><span class="kt">void</span> <span class="n">UAnimInstance</span><span class="o">::</span><span class="n">TriggerMontageEndedEvent</span><span class="p">(</span><span class="k">const</span> <span class="n">FQueuedMontageEndedEvent</span><span class="o">&amp;</span> <span class="n">MontageEndedEvent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 动画册实例执行委托
</span><span class="c1"></span>    <span class="n">MontageEndedEvent</span><span class="p">.</span><span class="n">Delegate</span><span class="p">.</span><span class="n">ExecuteIfBound</span><span class="p">(</span><span class="n">MontageEndedEvent</span><span class="p">.</span><span class="n">Montage</span><span class="p">,</span> <span class="n">MontageEndedEvent</span><span class="p">.</span><span class="n">bInterrupted</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><h3 id="h_460092901_10" data-into-catalog-status="">3.2 TDelegate的C++实现分析</h3><ol><li data-pid="TR36OGOA">先手动展开一下委托定义的宏</li></ol><div class="highlight"><pre><code class="language-cpp"><span class="n">DECLARE_DELEGATE_TwoParams</span><span class="p">(</span> <span class="n">FOnMontageEnded</span><span class="p">,</span> <span class="k">class</span> <span class="nc">UAnimMontage</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="p">);</span>
<span class="k">typedef</span> <span class="n">TDelegate</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">class</span> <span class="nc">UAnimMontage</span><span class="o">*</span><span class="p">,</span><span class="kt">bool</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">FOnMontageEnded</span><span class="p">;</span>
</code></pre></div><p data-pid="IRBvAC23">根据<b>DelegateSignatureImpl.inl</b>文件中TDelegate的定义</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">InRetValType</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">ParamTypes</span><span class="p">,</span> <span class="k">typename</span> <span class="n">UserPolicy</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">TDelegate</span><span class="o">&lt;</span><span class="n">InRetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="o">&gt;</span> <span class="o">:</span> <span class="k">public</span> <span class="n">TDelegateBase</span><span class="o">&lt;</span><span class="n">UserPolicy</span><span class="o">&gt;</span><span class="p">{};</span>
</code></pre></div><ul><li data-pid="oqIorq5-">模板参数：InRetValType，实例化为void</li><li data-pid="ieSanE0o">可变模板参数：ParamTypes，实例化为class UAnimMontage*和bool</li><li data-pid="HJKPfbq-">模板参数：UserPolicy，实例化为FDefaultDelegateUserPolicy</li></ul><blockquote data-pid="muzg8u7c"> 这里说一下，虽然c++语法上支持可变参ParamTypes个数为无限多，但由于UE自己在<b>DelegateCombinations.inl</b>文件中使用宏进行了包装，ex：DECLARE_DELEGATE_NineParams，使其最多支持9个参数。从实际角度来说9个函数参数足够了，如果实在不够可以扩充一下宏或者将多个参数用结构合并在一起。 </blockquote><p class="ztext-empty-paragraph"><br></p><ul><li data-pid="u7BASTWe">1. 继承的基类<code>TDelegateBase&lt;FDefaultDelegateUserPolicy&gt;</code>本身无成员，也没有什么特别的，只是提供了一些方法，调用其基类UserPolicy::FDelegateExtras的<code>GetDelegateInstanceProtected()</code>方法，得到<b>委托真正实例对象</b>指针。实例结构<b>XXXXDelegateInstance</b>位于我们本章节开头总括图的右侧，通过虚线与TDelegate相连。最后再用指针去调用真正的接口，比如GetHandle()获取句柄，起着打通委托与实例之间中间件的作用。<br> </li><li data-pid="I7vV_AHu">2. TDelegate的根基类缺省默认值是<b>FDelegateBase</b>，我们也可以手动指定，比较重要。FDelegateBase有两个成员，一个是DelegateSize指代分配实例的内存大小，一个是DelegateAllocator指示内存分配器。这个类主要就是完成对委托实例的内存分配与保存，并且提供了<code>Unbind</code>函数用来析构并释放实例的内存。</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">class</span> <span class="nc">FDelegateBase</span>
<span class="p">{</span>
    <span class="n">IDelegateInstance</span><span class="o">*</span> <span class="nf">GetDelegateInstanceProtected</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">Unbind</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
    <span class="k">friend</span> <span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="n">size_t</span> <span class="n">Size</span><span class="p">,</span> <span class="n">FDelegateBase</span><span class="o">&amp;</span> <span class="n">Base</span><span class="p">);</span>
    <span class="kt">void</span><span class="o">*</span> <span class="nf">Allocate</span><span class="p">(</span><span class="n">int32</span> <span class="n">Size</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">FDelegateAllocatorType</span><span class="o">::</span><span class="n">ForElementType</span><span class="o">&lt;</span><span class="n">FAlignedInlineDelegateType</span><span class="o">&gt;</span> <span class="n">DelegateAllocator</span><span class="p">;</span>
    <span class="n">int32</span> <span class="n">DelegateSize</span><span class="p">;</span> 
<span class="p">};</span>
<span class="kr">inline</span> <span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">size_t</span> <span class="n">Size</span><span class="p">,</span> <span class="n">FDelegateBase</span><span class="o">&amp;</span> <span class="n">Base</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Base</span><span class="p">.</span><span class="n">Allocate</span><span class="p">((</span><span class="n">int32</span><span class="p">)</span><span class="n">Size</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><blockquote data-pid="t7EEIvyc"> FDelegateBase涉及内存的分配与释放及获取与类型强转，在<a href="https://zhuanlan.zhihu.com/p/433019649" class="internal" data-za-detail-view-id="1043">《由UE4注册TDelegate的委托让我陷入了C++的沉思》</a>中已经做过了详细的解释，可以查阅。</blockquote><h3 id="h_460092901_11" data-into-catalog-status="">3.3 FDefaultDelegateUserPolicy策略模式</h3><p data-pid="2uCLU5K2">整个委托系统，由于<code>TDelegate</code>，<code>TMulticastDelegate</code>，<code>IBaseDelegateInstance</code>都用运用了策略模式，<b>FDefaultDelegateUserPolicy</b>作为模板的默认参数传入，让这三个类继承FDefaultDelegateUserPolicy中的类型重定义。这个模板默认参数有点像STL容器的第二个默认模板参数----内存分配器，部分人根本没有察觉到，我们也可以手动指定，只是通常不会去改。</p><p data-pid="v8OpzOyo">这个策略类内部有三个using重定义FDelegateInstanceExtras，FDelegateExtras，FMulticastDelegateExtras，我们可以手动替换，但要求必须公有继承于IDelegateInstance，FDelegateBase，TMulticastDelegateBase，否则static_assert对模板手动指定的UserPolicy类型转换检测是通不过的，会造成编译失败。</p><div class="highlight"><pre><code class="language-cpp"><span class="k">struct</span> <span class="nc">FDefaultDelegateUserPolicy</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="n">FDelegateInstanceExtras</span>  <span class="o">=</span> <span class="n">IDelegateInstance</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">FDelegateExtras</span>          <span class="o">=</span> <span class="n">FDelegateBase</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">FMulticastDelegateExtras</span> <span class="o">=</span> <span class="n">TMulticastDelegateBase</span><span class="o">&lt;</span><span class="n">FDefaultDelegateUserPolicy</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div><h3 id="h_460092901_12" data-into-catalog-status="">3.4 绑定</h3><p data-pid="r3Np3gMy">在<a href="https://zhuanlan.zhihu.com/p/433019649" class="internal" data-za-detail-view-id="1043">《由UE4注册TDelegate的委托让我陷入了C++的沉思》</a>中已经做过了详细的解释，但我们还是可以简单介绍一下，以3.1的代码为例。</p><div class="highlight"><pre><code class="language-cpp"><span class="c1">// 注册
</span><span class="c1"></span><span class="n">MontageEndedDelegate</span><span class="p">.</span><span class="n">BindUObject</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">UAbilityTask_PlayMontageAndWait</span><span class="o">::</span><span class="n">OnMontageEnded</span><span class="p">);</span>
</code></pre></div><p data-pid="k_dtsox4">我们看TDelegate模板类的实现，BindUObject这里分为const与非const版本，这例非const版本。如果用错，static_assert也检测导致编译失败，所以对应下面的代码，这里模板参较多些，还是嵌套在模板类中，为了帮助新手，简单说一下函数要点。</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">UserClass</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">VarTypes</span><span class="o">&gt;</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">BindUObject</span><span class="p">(</span><span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="k">typename</span> <span class="n">TMemFunPtrType</span><span class="o">&lt;</span><span class="nb">false</span><span class="p">,</span> <span class="n">UserClass</span><span class="p">,</span> <span class="n">RetValType</span> <span class="p">(</span><span class="n">ParamTypes</span><span class="p">...,</span> <span class="n">VarTypes</span><span class="p">...)</span><span class="o">&gt;::</span><span class="n">Type</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static_assert</span><span class="p">(</span><span class="o">!</span><span class="n">TIsConst</span><span class="o">&lt;</span><span class="n">UserClass</span><span class="o">&gt;::</span><span class="n">Value</span><span class="p">,</span> <span class="s">"Attempting to bind a delegate with a const object pointer and non-const member function."</span><span class="p">);</span>

    <span class="o">*</span><span class="k">this</span> <span class="o">=</span> <span class="n">CreateUObject</span><span class="p">(</span><span class="n">InUserObject</span><span class="p">,</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">Vars</span><span class="p">...);</span>
<span class="p">}</span>
</code></pre></div><blockquote data-pid="yrBxGZst"><b>重要！！！</b>，3.2中已经确定了TDelegate的类模板参数，明确了委托函数原型是<code>void(class UAnimMontage*,bool)</code>，但实际绑了定的是一个成员函数，类型并不相同。<br> <br> 传给BindUObject的第一个参数this指针，从这个参数可以推断出模板参：UserClass为UAbilityTask_PlayMontageAndWait。<br><br> 可变参VarTypes...是除函数声明两个参数外额外绑定的参数，就是2.2小节中说的payload参数，这是不必有。举例一下：<code>void ClassA::MyTestFun(class UAnimMontage*,bool,int,float)</code>如果想将这个函数绑定到我们的委托中，实际多了三个参数，this指针参数被单独处理了，多了int参数转到第一个VarTypes中，多了float参数转到第二个VarTypes，且在函数注册时一定要给出int与float的值，实例化到tuple中，如<code>MontageEndedDelegate.BindUObject(this, &amp;UAbilityTask_PlayMontageAndWait::OnMontageEnded,100,99.f);</code>。<br><br> 还有RetValType是从TDelegate模板类传过来的，本身支持返回类型，但本例是void；<br><br> 可变参ParamTypes...也是从TDelegate模板类传过来的，本例就是class UAnimMontage*和bool<br> <br> TMemFunPtrType是<b>DelegateInstanceInterface.h</b>中转为类成员函数指针的重定义，将其重定义为Type，也比较简单，本身经过模板特化会自动选择带不带const版本，我们传入的false表示非const版本。到此函数用到的细节我们都说了，希望对新人有一定帮助。<br> </blockquote><h3 id="h_460092901_13" data-into-catalog-status="">3.5 创建</h3><p data-pid="PG5GT81T">我们分析不完所有的，就还拿我们这个为例分析简要分析，代码会转到下面这里。本函数主要内容就是创建DelegateInstance对象并关联上TDelegate，可以让TDelegate调用。</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">UserClass</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">VarTypes</span><span class="o">&gt;</span>
<span class="n">UE_NODISCARD</span> <span class="kr">inline</span> <span class="k">static</span> <span class="n">TDelegate</span><span class="o">&lt;</span><span class="n">RetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="o">&gt;</span> <span class="n">CreateUObject</span><span class="p">(</span><span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="k">typename</span> <span class="n">TMemFunPtrType</span><span class="o">&lt;</span><span class="nb">false</span><span class="p">,</span> <span class="n">UserClass</span><span class="p">,</span> <span class="n">RetValType</span> <span class="p">(</span><span class="n">ParamTypes</span><span class="p">...,</span> <span class="n">VarTypes</span><span class="p">...)</span><span class="o">&gt;::</span><span class="n">Type</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static_assert</span><span class="p">(</span><span class="o">!</span><span class="n">TIsConst</span><span class="o">&lt;</span><span class="n">UserClass</span><span class="o">&gt;::</span><span class="n">Value</span><span class="p">,</span> <span class="s">"Attempting to bind a delegate with a const object pointer and non-const member function."</span><span class="p">);</span>

    <span class="n">TDelegate</span><span class="o">&lt;</span><span class="n">RetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="o">&gt;</span> <span class="n">Result</span><span class="p">;</span>
    <span class="n">TBaseUObjectMethodDelegateInstance</span><span class="o">&lt;</span><span class="nb">false</span><span class="p">,</span> <span class="n">UserClass</span><span class="p">,</span> <span class="n">FuncType</span><span class="p">,</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">(</span><span class="n">Result</span><span class="p">,</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">Vars</span><span class="p">...);</span>
    <span class="k">return</span> <span class="n">Result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><blockquote data-pid="afzsOpbA"> 这个里面模板参数3.4小节已经全部解释完毕，就简述功能了，不过这里多个两个：<b>UserPolicy</b>来源于TDelegate在模板参，这里就是FDefaultDelegateUserPolicy。<b>FuncType</b>是TDelegate的内部的重定义，也就是RetValType(ParamTypes...)函数指针原型。<br>  栈上创建一个TDelegate对象Result，然后转到DelegateInstance的创建，这一步将this指针，成员函数地址，<b>扩展的函数参数保存到Instance对象中payload中</b>，并藉由两次new重载，打通了TDelegate对象（Result）与DelegateInstance对象联系，最后返回委托。更加细节的创建与转换，还麻烦参考<a href="https://zhuanlan.zhihu.com/p/433019649" class="internal">《由UE4注册TDelegate的委托让我陷入了C++的沉思》</a>，这文章就是针对这个技术点的。<br> <br> </blockquote><p data-pid="k3RzW1Tk">限于篇幅，我们不可能将所有Bind与Create都讲一遍，但总体思路是一致的。</p><h3 id="h_460092901_14" data-into-catalog-status="">3.6 执行</h3><p data-pid="zVbvPxqS">到了执行就比较简单了,总共有两个版本</p><div class="highlight"><pre><code class="language-cpp"><span class="n">FORCEINLINE</span> <span class="n">RetValType</span> <span class="nf">Execute</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...</span> <span class="n">Params</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="n">DelegateInstanceInterfaceType</span><span class="o">*</span> <span class="n">LocalDelegateInstance</span> <span class="o">=</span> <span class="n">GetDelegateInstanceProtected</span><span class="p">();</span>
    <span class="n">checkSlow</span><span class="p">(</span><span class="n">LocalDelegateInstance</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">LocalDelegateInstance</span><span class="o">-&gt;</span><span class="n">Execute</span><span class="p">(</span><span class="n">Params</span><span class="p">...);</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span>
    <span class="k">typename</span> <span class="n">DummyRetValType</span> <span class="o">=</span> <span class="n">RetValType</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">enable_if_t</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">is_void</span><span class="o">&lt;</span><span class="n">DummyRetValType</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;*</span> <span class="o">=</span> <span class="k">nullptr</span>
<span class="o">&gt;</span>
<span class="kr">inline</span> <span class="kt">bool</span> <span class="n">ExecuteIfBound</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...</span> <span class="n">Params</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">DelegateInstanceInterfaceType</span><span class="o">*</span> <span class="n">Ptr</span> <span class="o">=</span> <span class="n">GetDelegateInstanceProtected</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Ptr</span><span class="o">-&gt;</span><span class="n">ExecuteIfSafe</span><span class="p">(</span><span class="n">Params</span><span class="p">...);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><ul><li data-pid="QOh9MYG8"><b>Execute</b>版本比较简单，获取DelegateInstance对象的指针，转移到Instance的对函数调用，如果函数指针对象无效，可能会触发崩溃，为了安全建议，先用IsBound()判断，同时单播这个版本，支持RetValType型返回值。</li><li data-pid="TNGyXerY"><b>ExecuteIfBound</b>版本麻烦一点点，这是一个模板函数，运用了模板的SFINAE技术确保返回类型是void。然后最大的特点是安全，只有指针有效，才调用。同时这个函数将返回值转为bool了，成功调用返回true</li></ul><h3 id="h_460092901_15" data-into-catalog-status="">3.7 内嵌眼花缭乱的模板类</h3><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-10b887bbbd3fd5ae2ef98ce2014dd824_b.jpg" data-caption="" data-size="normal" data-rawwidth="1999" data-rawheight="1140" class="origin_image zh-lightbox-thumb" width="1999" data-original="https://pic1.zhimg.com/v2-10b887bbbd3fd5ae2ef98ce2014dd824_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1999&#39; height=&#39;1140&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1999" data-rawheight="1140" class="origin_image zh-lightbox-thumb lazy" width="1999" data-original="https://pic1.zhimg.com/v2-10b887bbbd3fd5ae2ef98ce2014dd824_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-10b887bbbd3fd5ae2ef98ce2014dd824_b.jpg"></figure><p data-pid="XfiEw2wn"> 估计一些不熟悉C++的看到TDelegate类内部这样的代码，估计就晕了，这是什么鬼！！！</p><p data-pid="hzGQvAxI">关了这部分，我查了一下源码，的确用的不多，我们只有在Widgets的模块中，也是宏定义中有用到，看起来也有点复杂,如下面代码</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">UserClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Var1Type</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Var2Type</span> <span class="o">&gt;</span>   \
<span class="n">WidgetArgsType</span><span class="o">&amp;</span> <span class="n">EventName</span><span class="err">##</span><span class="n">_UObject</span><span class="p">(</span> <span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="k">typename</span> <span class="n">DelegateName</span><span class="o">::</span><span class="k">template</span> <span class="n">TUObjectMethodDelegate_TwoVars_Const</span><span class="o">&lt;</span> <span class="n">UserClass</span><span class="p">,</span> <span class="n">Var1Type</span><span class="p">,</span> <span class="n">Var2Type</span> <span class="o">&gt;::</span><span class="n">FMethodPtr</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">Var1Type</span> <span class="n">Var1</span><span class="p">,</span> <span class="n">Var2Type</span> <span class="n">Var2</span> <span class="p">)</span>  \
<span class="p">{</span> \
    <span class="n">_</span><span class="err">##</span><span class="n">EventName</span> <span class="o">=</span> <span class="n">DelegateName</span><span class="o">::</span><span class="n">CreateUObject</span><span class="p">(</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">Var1</span><span class="p">,</span> <span class="n">Var2</span> <span class="p">);</span> \
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> \
<span class="p">}</span> \
</code></pre></div><p data-pid="ap19kY13">我只能说说个人的理解，这里要提前用到第四章节DelegateInstance的知识。从C++设计层面来说，TDelegate模板类综合看来不过是继承了FDelegate,并没有真正保存委托实例。TDelegate委托虽然有函数原型的签名，但UE内部做了签名转换，让我们近乎自由的绑定可调用对象，这<b>导致我们只知道委托的类型，比如宏中的DelegateName，根本无法知道它可能绑定的DelegateInstance对象的类型</b>。图片中密密麻麻的类就是做这个的，这样我给一个确定委托后，只要我再补一些扩展参数，就能结合委托本身模板参数，确定得到一个DelegateInstance实例的类型或者实例内部定义的类型，<code>typename DelegateName::template TUObjectMethodDelegate_TwoVars_Const&lt; UserClass, Var1Type, Var2Type &gt;::FMethodPtr</code>像这样不过是元编程常见的写法罢了。不过话说回来，你非不要这样写，模板参数显示传入，拆开重写一遍也是可以的，只是不够精练，有点low，达不到C++应有的水平罢了。</p><h2 id="h_460092901_16" data-into-catalog-status="">四、DelegateInstance的C++实现</h2><p data-pid="HG1elPNg">前面说了TDelegate的细节，从本质来说，他只是一个空壳，但是<b>支持多种类型Instance并且良好和Instance交互</b>，真正的内容还要看看Instance。</p><h3 id="h_460092901_17" data-into-catalog-status="">4.1 TBaseUObjectMethodDelegateInstance的细节</h3><p data-pid="VIvtTaGY">这里以前文中TBaseUObjectMethodDelegateInstance为例，如果前文细看了，到这一步也没有什么太多难度了。</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="kt">bool</span> <span class="n">bConst</span><span class="p">,</span> <span class="k">class</span> <span class="nc">UserClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">WrappedRetValType</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">ParamTypes</span><span class="p">,</span> <span class="k">typename</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">VarTypes</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">TBaseUObjectMethodDelegateInstance</span><span class="o">&lt;</span><span class="n">bConst</span><span class="p">,</span> <span class="n">UserClass</span><span class="p">,</span> <span class="n">WrappedRetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span><span class="o">&gt;</span> <span class="o">:</span> <span class="k">public</span> <span class="n">TCommonDelegateInstanceState</span><span class="o">&lt;</span><span class="n">WrappedRetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="n">TBaseUObjectMethodDelegateInstance</span><span class="p">(</span><span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="n">FMethodPtr</span> <span class="n">InMethodPtr</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span><span class="err">；</span>
<span class="kt">void</span> <span class="n">CreateCopy</span><span class="p">(</span><span class="n">FDelegateBase</span><span class="o">&amp;</span> <span class="n">Base</span><span class="p">)</span> <span class="k">final</span> <span class="err">；</span>
<span class="n">RetValType</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...</span> <span class="n">Params</span><span class="p">)</span> <span class="k">const</span> <span class="k">final</span> <span class="err">；</span>
<span class="kt">bool</span> <span class="n">ExecuteIfSafe</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...</span> <span class="n">Params</span><span class="p">)</span> <span class="k">const</span> <span class="k">final</span> <span class="err">；</span>
<span class="n">FORCEINLINE</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">Create</span><span class="p">(</span><span class="n">FDelegateBase</span><span class="o">&amp;</span> <span class="n">Base</span><span class="p">,</span> <span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="n">FMethodPtr</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">new</span> <span class="p">(</span><span class="n">Base</span><span class="p">)</span> <span class="n">UnwrappedThisType</span><span class="p">(</span><span class="n">InFunc</span><span class="p">,</span> <span class="n">Vars</span><span class="p">...);</span>
<span class="p">}</span>
<span class="k">protected</span><span class="o">:</span>
    <span class="n">TWeakObjectPtr</span><span class="o">&lt;</span><span class="n">UserClass</span><span class="o">&gt;</span> <span class="n">UserObject</span><span class="p">;</span>
    <span class="n">FMethodPtr</span> <span class="n">MethodPtr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><ul><li data-pid="DAP7Br6a">TBaseUObjectMethodDelegateInstance的模板参，我们3.4小节，3.5小节都解析过了，没有什么特别好说的。</li><li data-pid="0hi8jTbF">成员上UserObject使用<b>TWeakObjectPtr</b>保存了UObject对象的智能指针弱引用，构造时发生</li><li data-pid="uK44ZdYg">成员MethodPtr保存了UObject类的函数指针对象，构造时发生，注意这里FMethodPtr类型实际是一个重定义：<code>using FMethodPtr = typename TMemFunPtrType&lt;bConst, UserClass, RetValType(ParamTypes..., VarTypes...)&gt;::Type;</code>,这个结构我们3.4小节提了，就是一个转换后的签名，表示类成员函数。</li></ul><p data-pid="j4XyiEsq">成员函数上，也有几个比较重要的：  </p><ul><li data-pid="zXzf4_0B"><i><b>Execute</b>：执行，非安全版，<b>模拟C++17中std::tuple及std::apply(...)函数</b>相对比较简单，可以将tuple中参数传入并调用函数,并支持返回值。从语法来上说，它们考虑到了模板内部处理时，object指针对象可能已经转换const版本，所以进行擦除const修饰，并使用了const_cast将其转为非const版本指针。 </i> </li></ul><blockquote data-pid="IN-e9Sxu">如果这点你继续看进去，可能领悟到C++模板的精妙，tuple加invoke两个点，还是有技术含量的。 </blockquote><ul><li data-pid="kD4KCRwf"><i><b>ExecuteIfSafe</b>：执行，安全版，相比上面Execute，多了对弱引用获取对象安全检测，只有检查通过，才会进行函数调用。 </i> </li><li data-pid="Vr8xzt8b"><b>Create</b>：<b>一个非常非常重要的静态成员函数</b>，利用new的重载及TBaseFunctorDelegateInstance的构造函数，传引用Base分配我们Instance内存，因为这个Base实际就是各种TDelegate，这样TDelegate就和Instance打通了。在<a href="https://zhuanlan.zhihu.com/p/433019649" class="internal">《由UE4注册TDelegate的委托让我陷入了C++的沉思》</a>重点讨论过，有兴趣参考。 </li><li data-pid="ko0X_o8L"><b>CreateCopy</b>：虽是普通成员函数，但实质还是Create换个形式，关键还是new的重载。</li></ul><h3 id="h_460092901_18" data-into-catalog-status="">4.2 TCommonDelegateInstanceState的细节</h3><p data-pid="TYgFLEOi">从我们最开始的缩略图看，所有DelegateInstance都派生于<b>TCommonDelegateInstanceState</b>，以我个人理解，不得不说老外起名就是好啊，这个State太妙了，因为这个类就是为payload而生，带状态带缓存服务的，</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">InRetValType</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">ParamTypes</span><span class="p">,</span> <span class="k">typename</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">VarTypes</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">TCommonDelegateInstanceState</span><span class="o">&lt;</span><span class="n">InRetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span><span class="o">&gt;</span> <span class="o">:</span> <span class="n">IBaseDelegateInstance</span><span class="o">&lt;</span><span class="n">InRetValType</span><span class="p">(</span><span class="n">ParamTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">using</span> <span class="n">RetValType</span> <span class="o">=</span> <span class="n">InRetValType</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">TCommonDelegateInstanceState</span><span class="p">(</span><span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">Payload</span><span class="p">(</span><span class="n">Vars</span><span class="p">...)</span>
        <span class="p">,</span> <span class="n">Handle</span> <span class="p">(</span><span class="n">FDelegateHandle</span><span class="o">::</span><span class="n">GenerateNewHandle</span><span class="p">){}</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="n">FDelegateHandle</span> <span class="nf">GetHandle</span><span class="p">()</span> <span class="k">const</span> <span class="k">final</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Handle</span><span class="p">;</span>
    <span class="p">}</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="n">TTuple</span><span class="o">&lt;</span><span class="n">VarTypes</span><span class="p">...</span><span class="o">&gt;</span> <span class="n">Payload</span><span class="p">;</span>
    <span class="n">FDelegateHandle</span> <span class="n">Handle</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div><p data-pid="3pKtlial">这个模板类非常简单，模板参数已经分析了很多遍，不再累述。explicit显式的构造函数，将我们前面讨论的<b>额外函数参数</b>保存到UE的tuple容器中，也就是Payload，然后产生DelegateInstance实例的句柄，内部就是uint64 ID。了解C++的都知道，有了tuple的助力，那就如虎添翼，支持任意类型参数的保存，还支持转发到函数调用，std::bind也是供助这个实现。以前写过stl::tuple分析，有兴趣参考，UE的还没有分析过。<a href="https://zhuanlan.zhihu.com/p/397720700" class="internal">《C++中VS2019下STL的std::tuple元组深入剖析》</a></p><h3 id="h_460092901_19" data-into-catalog-status="">4.3 IBaseDelegateInstance与IDelegateInstance</h3><p data-pid="CMaosKS4">再向上看一层，也就是TCommonDelegateInstanceState的基类IBaseDelegateInstance</p><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">RetType</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">ArgTypes</span><span class="p">,</span> <span class="k">typename</span> <span class="n">UserPolicy</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="nc">IBaseDelegateInstance</span><span class="o">&lt;</span><span class="n">RetType</span><span class="p">(</span><span class="n">ArgTypes</span><span class="p">...),</span> <span class="n">UserPolicy</span><span class="o">&gt;</span> <span class="o">:</span> <span class="k">public</span> <span class="n">UserPolicy</span><span class="o">::</span><span class="n">FDelegateInstanceExtras</span>
<span class="p">{</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">CreateCopy</span><span class="p">(</span><span class="n">FDelegateBase</span><span class="o">&amp;</span> <span class="n">Base</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="n">RetType</span> <span class="nf">Execute</span><span class="p">(</span><span class="n">ArgTypes</span><span class="p">...)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">bool</span> <span class="nf">ExecuteIfSafe</span><span class="p">(</span><span class="n">ArgTypes</span><span class="p">...)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div><p data-pid="lcpz62s2">这个模板类非常简单，没有任何成员，还只是纯虚函数，提供了接口，接口我们也已经讨论过了，模板参数已经分析过了。</p><p data-pid="GF1EH7zd"><b>IDelegateInstance</b>更是所有Instance的虚基类，它不再是模板类，它只是提供接口及类型转换上便利，同<code>FDelegate</code>，<code>TDelegateBase&lt;UserPolicy&gt;</code>，<code>TMulticastDelegateBase&lt;UserPolicy&gt;</code>打交道，用基类指针太方便了，类型擦除方便啊，这是常见的C++设计。</p><h2 id="h_460092901_20" data-into-catalog-status="">五、TMulticastDelegate多播</h2><p data-pid="adwFaQ8m">仔细了解了单播委托后，实际再了解多播就非常简单了，我们也不用详细分析了，点出不同点或者一些技术特性就行了。 </p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-9b81d8f217c630de7aaaa28ae22d6268_b.jpg" data-caption="" data-size="normal" data-rawwidth="1527" data-rawheight="1353" class="origin_image zh-lightbox-thumb" width="1527" data-original="https://pic1.zhimg.com/v2-9b81d8f217c630de7aaaa28ae22d6268_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1527&#39; height=&#39;1353&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1527" data-rawheight="1353" class="origin_image zh-lightbox-thumb lazy" width="1527" data-original="https://pic1.zhimg.com/v2-9b81d8f217c630de7aaaa28ae22d6268_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-9b81d8f217c630de7aaaa28ae22d6268_b.jpg"></figure><ul><li data-pid="k8XYTC3m"><i>用宏<code>DECLARE_MULTICAST_DELEGATE</code>和<code>DECLARE_MULTICAST_DELEGATE_&lt;Num&gt;Params</code>定义,后面表示函数参数个数 </i> </li><li data-pid="Ew9D1l7B">多播定义时函数的返回值必为void,否则static_assert编译检查失败 </li><li data-pid="TyjB-yrR"><i>多播TMulticastDelegate本身相比TDelegate来说，继承关系还更简单，那个因为它充分利用了单播已有的结构或信息。结合图示来说，TMulticastDelegate来身不具有任何新加成员，成员都放到了基类TMulticastDelegateBase中了， </i> </li><li data-pid="4I9VbrCh">多播最重要的成员是<code>TInvocationListType</code>类型的数组InvocationList，我们所有委托都保存在这里。TInvocationListType是一个C++上的数组的重定义,数组元素类型就是<code>TDelegateBase&lt;UserPolicy&gt;</code>，由前面的单播已知这个结构和DelegateInstance关联。</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">using</span> <span class="n">InvocationListType</span> <span class="o">=</span> <span class="n">TArray</span><span class="o">&lt;</span><span class="n">TDelegateBase</span><span class="o">&lt;</span><span class="n">UserPolicy</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">FMulticastInvocationListAllocatorType</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div><ul><li data-pid="E86Zm3Yn">多播正如字面意思，就是这个委托可以绑定多个回调函数，我们原来TDelegate用BindXXXXX开头绑定注册都换成了AddXXXX开头的注册，毕竞TDelegate只能绑一个用Bind词表达准确，TMulticastDelegate可以绑多个，用Add也更符合。</li><li data-pid="njCJ8PzE">随意分析一个Add添加绑定:<b>AddUObject</b></li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">UserClass</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">VarTypes</span><span class="o">&gt;</span>
<span class="kr">inline</span> <span class="n">FDelegateHandle</span> <span class="n">AddUObject</span><span class="p">(</span><span class="n">UserClass</span><span class="o">*</span> <span class="n">InUserObject</span><span class="p">,</span> <span class="k">typename</span> <span class="n">TMemFunPtrType</span><span class="o">&lt;</span><span class="nb">false</span><span class="p">,</span> <span class="n">UserClass</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="n">ParamTypes</span><span class="p">...,</span> <span class="n">VarTypes</span><span class="p">...)</span><span class="o">&gt;::</span><span class="n">Type</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">...</span> <span class="n">Vars</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static_assert</span><span class="p">(</span><span class="o">!</span><span class="n">TIsConst</span><span class="o">&lt;</span><span class="n">UserClass</span><span class="o">&gt;::</span><span class="n">Value</span><span class="p">,</span> <span class="s">"Attempting to bind a delegate with a const object pointer and non-const member function."</span><span class="p">);</span>

    <span class="k">return</span> <span class="nf">Add</span><span class="p">(</span><span class="n">FDelegate</span><span class="o">::</span><span class="n">CreateUObject</span><span class="p">(</span><span class="n">InUserObject</span><span class="p">,</span> <span class="n">InFunc</span><span class="p">,</span> <span class="n">Vars</span><span class="p">...));</span>
<span class="p">}</span>
</code></pre></div><blockquote data-pid="ZQJ2CHhN"> 我们已经知道，委托声明时函数的签名是普通函数，这里绑定的成员函数，所以和单播一样，也要进行一些类型转换,这里要求成员函数的返回值类型是void；AddUObject注册结束后，返回委托实例的句柄。<br> <br>模板参数：UserClass可以从InUserObject推断，是Object所对应的类型，注意这里有const与非const版本检测<br><br> 可变模板参数：VarTypes同TDelegate一样，是成员函数额外补的参数，会放入payload中，可以有，也可以不添加，不再累述。<br><br> TMemFunPtrType前面也讲过了，主要用于转换成成员函数，不再累述。<br> <br> 其中FDelegate::CreateUObject这句可能有点让人看不懂，那是因为在模板类TMulticastDelegate中有个重定义：<code>using FDelegate = TDelegate&lt;void(ParamTypes...), UserPolicy&gt;;</code>,看到了吗？多播供助已有的单播结构，调用其静态成员函数创建一个TDelegate单播委托并返回，这样代码不就是很好的复用了吗！设计的还是非常不错的，模板也用的好。<br><br>  将生成TDelegate传给TMulticastDelegate的Add函数，Add函数内部再调用基类的<code>Super::AddDelegateInstance</code>，将其添加到InvocationList中，这样数组就维护了我们的委托及实例了。 </blockquote><ul><li data-pid="h8nvoAMX">执行也比较简单，<b>Broadcast</b>通过循环遍历我们的数组，不过这里UE增加了安全执行的调用<code>(DelegateInstanceInterfaceType*)DelegateInstanceInterface)-&gt;ExecuteIfSafe(Params...)</code></li><li data-pid="WfxSV5-3">我再提一点C++模板的知识，在模板类的继承中，我们是<b>无法直接使用模板基类的函数</b>，可以通过<b>using，this-&gt;,或者显式传入参数调用三种方式</b>，这里UE使用了using方法,并且可以添加public,private控制权限，我们可以看一点点例子，不知为什么，有时我看到UE的模板代码能让我越看越兴奋。</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">public</span><span class="o">:</span>
    <span class="c1">// Make sure TMulticastDelegateBase's public functions are publicly exposed through the TMulticastDelegate API
</span><span class="c1"></span>    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">Clear</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">IsBound</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">IsBoundToObject</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">RemoveAll</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="c1">// Make sure TMulticastDelegateBase's protected functions are not accidentally exposed through the TMulticastDelegate API
</span><span class="c1"></span>    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">AddDelegateInstance</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">RemoveDelegateInstance</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">Super</span><span class="o">::</span><span class="n">CompactInvocationList</span><span class="p">;</span>
</code></pre></div><h2 id="h_460092901_21" data-into-catalog-status="">六、TBaseDynamicDelegate动态委托</h2><p data-pid="lFaXvlBN">仔细了解了单播与多播委托后，实际再了解动态委托就非常简单了，我们也不用详细分析了，提一些技术点就行了。 </p><ul><li data-pid="2tiMIGrL"><i>动态委托支持单播与多播，对UObject支持及蓝图及序列化的支持，可以理解相当于为UE本身专门定制的。 </i> 相比前面介绍的单播与多播两种，<b>这种委托能在蓝图使用，可以说这是最大的优势吧</b>，并且绑定利用UFunction的序列化技术，只需要函数名称就可以了，相对多了一些查找消耗。 </li><li data-pid="8M77RcIh"><i>用宏<code>DECLARE_DYNAMIC_DELEGATE</code>及<code>DECLARE_DYNAMIC_MULTICAST_DELEGATE</code>宏进行定义，分别表示支持动态的单播与多播，同时可以支持含参数个数的宏：<code>DECLARE_DYNAMIC_DELEGATE_&lt;Num&gt;Param</code>定义,Num表示函数参数个数 </i> </li><li data-pid="zf15iD3k"><b>TBaseDynamicDelegate</b>的基类是<code>TScriptDelegate&lt;TWeakPtr&gt;</code>,本身无成员，接口也比较简单，基本不用分析。内部通过<code>__Internal_BindDynamic</code>函数进行注册绑定，但实际被宏<code>BindDynamic</code>包装，我们使用宏<code>BindDynamic</code>来进行注册。</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TWeakPtr</span> <span class="o">=</span> <span class="n">FWeakObjectPtr</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">TScriptDelegate</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">UObjectTemplate</span><span class="o">&gt;</span>
    <span class="kt">void</span> <span class="n">ProcessDelegate</span><span class="p">(</span> <span class="kt">void</span><span class="o">*</span> <span class="n">Parameters</span> <span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<span class="k">protected</span><span class="o">:</span>
    <span class="n">TWeakPtr</span> <span class="n">Object</span><span class="p">;</span>
    <span class="n">FName</span> <span class="n">FunctionName</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre></div><blockquote data-pid="o9pgaaFB"> TScriptDelegate默认的成员Object是UObject的弱引用智能指针，FunctionName是我们要绑定的函数名称，注意这个函数一定要是UFunction标记或者蓝图中的函数，简言之就是该函数能能序列化。当注册绑定时会将Object与FunctionName进行赋值。<br><br> 虽然我们的执行在派生类被<code>Execute()</code>函数包装了一次，详情见<b>Delegate.h</b>文件中<code>FUNC_DECLARE_DYNAMIC_DELEGATE</code>,<code>FUNC_DECLARE_DYNAMIC_DELEGATE_RETVAL</code>两个宏，宏里面的展开式进行了安全检测。不过话说回来，但真正的执行，还是会调用到基类的<code>ProcessDelegate</code>函数，执行的时间，会进行查找，所以效率上来说，是前面两种C++版效率低一些。 </blockquote><ul><li data-pid="9HvySPXz"><b>TBaseDynamicMulticastDelegate</b>的基类是<code>TMulticastScriptDelegate&lt;TWeakPtr&gt;</code>,本身无成员，接口也比较简单，基本不用分析。内部通过<code>__Internal_AddDynamic</code>和<code>__Internal_AddUniqueDynamic</code>函数进行注册绑定,后面的能够确保唯一性，但实际被宏<code>AddDynamic</code>和<code>AddUniqueDynamic</code>包装，我们使用宏<code>AddDynamic</code>和<code>AddUniqueDynamic</code>来进行注册。移除的话内部使用<code>__Internal_RemoveDynamic</code>，同样被宏<code>RemoveDynamic</code>包装，这才是真正调用的地方。</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">UObjectTemplate</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">ProcessMulticastDelegate</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">Parameters</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">typedef</span> <span class="n">TArray</span><span class="o">&lt;</span> <span class="n">TScriptDelegate</span><span class="o">&lt;</span><span class="n">TWeakPtr</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">FInvocationList</span><span class="p">;</span>

    <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">UObjectTemplate</span><span class="o">&gt;</span>
    <span class="kt">void</span> <span class="n">ProcessDelegate</span><span class="p">(</span> <span class="kt">void</span><span class="o">*</span> <span class="n">Parameters</span> <span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<span class="k">protected</span><span class="o">:</span>
    <span class="k">mutable</span> <span class="n">FInvocationList</span> <span class="n">InvocationList</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre></div><blockquote data-pid="3Gne6Ruj"> 默认的成员InvocationList是<code>TArray&lt; TScriptDelegate&lt;TWeakPtr&gt; &gt;</code>是一个数组，做法也等同TMulticastDelegate，不再累述了。<br><br> 虽然我们的执行在派生类被<code>Broadcast()</code>函数包装了一次，详情见<b>Delegate.h</b>文件中<code>FUNC_DECLARE_DYNAMIC_MULTICAST_DELEGATE</code>宏，宏里面的展开式进行了安全检测。不过话说回来，但真正的执行，还是会调用到基类的<code>ProcessMulticastDelegate</code>函数。 </blockquote><ul><li data-pid="VoV4CRDN">关于序列化，因为基类TScriptDelegate，都重载了<code>&lt;&lt;</code>操作符。</li></ul><h2 id="h_460092901_22" data-into-catalog-status="">结语</h2><p data-pid="hXuj8dMQ">到此我们已经全部分析完毕，可能有纰漏，欢迎联系rayhunter,未经许可，禁止转载。</p><div class="RichText-LinkCardContainer"><a target="_blank" href="https://zhuanlan.zhihu.com/p/427575094" data-draft-node="block" data-draft-type="link-card" data-text="UE4反射基础一：揭秘UBT生成代码、UObject注册、UClass及CDO生成" class="LinkCard new css-1wr1m8"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a></div><p></p></div></div></div><div role="button" tabindex="0" class="ContentItem-time">编辑于 2022-01-21 10:33</div><div class="Reward"><div><div class="Reward-tagline">「真诚赞赏，手留余香」</div><button class="Reward-rewardBtn">赞赏</button></div><div class="Reward-countZero">还没有人赞赏，快来当第一个赞赏的人吧！</div></div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19824201&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19824201" target="_blank"><div class="Popover"><div id="Popover2-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover2-content">虚幻引擎</div></div></a></span></div><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19584970&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19584970" target="_blank"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover3-content">C++</div></div></a></span></div><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19557297&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19557297" target="_blank"><div class="Popover"><div id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover4-content">代理</div></div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 690px; bottom: 0px; left: 445.667px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;460092901&quot;}}}"><span><button aria-label="赞同 62 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" data-new-api="AgreeFill24" data-old-api="TriangleUp" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>赞同 62</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" data-new-api="OpposeFill24" data-old-api="TriangleDown" class="Zi Zi--TriangleDown" fill="currentColor"><path d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="Comment" class="Zi Zi--Comment Button-zi" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>3 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover5-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="PaperplaneFill24" data-old-api="Share" class="Zi Zi--Share Button-zi" fill="currentColor"><path d="M19.47 1.914a.8.8 0 011.204.778l-1.872 16.386a.9.9 0 01-1.204.743l-4.615-1.692a.7.7 0 00-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 01.179-.504l5.808-7.148a.595.595 0 00-.897-.781l-5.93 6.354a1.1 1.1 0 01-1.258.252L2.57 13.46a.8.8 0 01-.08-1.415l16.98-10.13z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="HeartFill24" data-old-api="Heart" class="Zi Zi--Heart Button-zi" fill="currentColor"><path d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 01-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 01-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="StarFill24" data-old-api="Star" class="Zi Zi--Star Button-zi" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 00.165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 00-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 00-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 00-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 00.164-.12l2.378-4.122z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="TrayFullFill24" data-old-api="Deliver" class="Zi Zi--Deliver Button-zi" fill="currentColor"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 01.75-.75h6.857a.75.75 0 010 1.5H8.571a.75.75 0 01-.75-.75zm1.144-4a.75.75 0 01.75-.75h4.571a.75.75 0 010 1.5H9.715a.75.75 0 01-.75-.75z"></path><path d="M7.527 3.15a2.35 2.35 0 00-2.309 1.91L3.165 15.84a.85.85 0 00-.015.16v2.5a2.35 2.35 0 002.35 2.35h13a2.35 2.35 0 002.35-2.35V16a.848.848 0 00-.015-.16L18.78 5.06a2.35 2.35 0 00-2.308-1.91H7.527zm0 1.7a.65.65 0 00-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 00-.64-.528H7.528z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover6-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover6-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots" class="Zi Zi--Dots Button-zi" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></span></button></div></div></div></div><div class="Post-SideActions" style="opacity: 1;"><button class="like"><div class="Post-SideActions-icon"><svg width="16" height="16" viewBox="0 0 24 24" data-new-api="AgreeFill24" data-old-api="TriangleUp" class="Zi Zi--TriangleUp Post-SideActions-upIcon" fill="currentColor"><path d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div><div class="likeCount"><div class="likeCount-inner" data-previous="已赞同 63">赞同 62</div></div></button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover21-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover21-content"><img class="ShareMenu-fakeQRCode" src="./一文理解透UE委托Delegate - 知乎_files/qrcode" alt="微信二维码"><button><div class="Post-SideActions-icon"><span style="display: inline-flex; align-items: center;">​<svg width="20" height="20" viewBox="0 0 24 24" data-new-api="PaperplaneFill24" data-old-api="Share" class="Zi Zi--Share" fill="currentColor"><path d="M19.47 1.914a.8.8 0 011.204.778l-1.872 16.386a.9.9 0 01-1.204.743l-4.615-1.692a.7.7 0 00-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 01.179-.504l5.808-7.148a.595.595 0 00-.897-.781l-5.93 6.354a1.1 1.1 0 01-1.258.252L2.57 13.46a.8.8 0 01-.08-1.415l16.98-10.13z"></path></svg></span></div>分享</button></div></div></div></div><div class="Sticky--holder" style="position: static; inset: auto auto 0px 0px; display: block; float: none; margin: 0px 0px 10px; height: 54px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-1oi6kgx" src="./一文理解透UE委托Delegate - 知乎_files/v2-ef69d369588e9764f9252225e6dc29ce_l.jpg" srcset="https://picx.zhimg.com/v2-ef69d369588e9764f9252225e6dc29ce_l.jpg?source=32738c0c 2x"><div class="css-x0pxoz"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-ip4bff Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-8fr6s" style="white-space: pre-wrap;">评论千万条，友善第一条</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-8fr6s" class="notranslate public-DraftEditor-content" contenteditable="true" role="textbox" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word;"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="8fr6s" data-offset-key="f18m3-0-0"><div data-offset-key="f18m3-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="f18m3-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-z07uxh"><div class="css-we6n55"><div class="css-vpssrj"><div class="css-1k10w8f">3 条评论</div></div><div class="css-59erns"></div><div class="css-1hnxfhy"><div class="css-gjiv4z">默认</div><div class="css-1v9si9f">时间</div></div></div><div class="css-840pn3"><div class="css-1frn93x"><div class="css-vurnku"><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="Popover"><div id="Popover13-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover13-content"><a href="https://www.zhihu.com/people/397ca569cfd3f0031449f90a21a32055" target="_blank" class="css-hxc9jr"><img class="Avatar css-1qchsfe" src="./一文理解透UE委托Delegate - 知乎_files/v2-0de9e34c0f45ef1ae000f76263a5dbdf_l.jpg" srcset="https://pica.zhimg.com/v2-0de9e34c0f45ef1ae000f76263a5dbdf_l.jpg?source=06d4cd63 2x" alt="花一椿" loading="lazy"></a></div></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="Popover"><div id="Popover14-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover14-content"><a href="https://www.zhihu.com/people/397ca569cfd3f0031449f90a21a32055" target="_blank" class="css-1rd0h6f">花一椿</a></div></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><img src="./一文理解透UE委托Delegate - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></div><div class="CommentContent css-1ygdre8">看委托的概念介绍感觉就是qt的信号槽</div><div class="css-dbby2p"><div class="css-82fsyv"><div class="css-12cl38p">01-22</div></div><div class="css-18opwoy"><button type="button" class="Button  css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="ChatBubbleFill24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ThumbFill24" data-old-api="ThumbFill24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 012.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 01-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 012.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 003.19-2.191c.115-.296.173-.611.173-.928v-.553z"></path></svg></span>1</button></div></div></div></div><div><div class="css-8j5fyx"><div class="css-1jll2aj"><div class="Popover"><div id="Popover15-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover15-content"><a href="https://www.zhihu.com/people/7b5e1d9541265b56c58a48969d6b4e4d" target="_blank" class="css-hxc9jr"><img class="Avatar css-1qchsfe" src="./一文理解透UE委托Delegate - 知乎_files/7353717666ea56b82d1b39a5d6acf7de_l.jpg" srcset="https://pica.zhimg.com/7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=06d4cd63 2x" alt="rayhunter" loading="lazy"></a></div></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="Popover"><div id="Popover16-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover16-content"><a href="https://www.zhihu.com/people/7b5e1d9541265b56c58a48969d6b4e4d" target="_blank" class="css-1rd0h6f">rayhunter</a></div></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-h9ndtl" href="">作者</span><span class="css-18biwo">​<svg viewBox="0 0 24 24" class="css-paut93" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#0066FF"></path><svg width="12" height="12" viewBox="0 0 24 24" data-new-api="CheckFill24" data-old-api="Check" fill="#fff" x="6" y="6" class="Zi Zi--Check"><path d="M21.864 5.347a1.25 1.25 0 01.04 1.767L10.976 18.537a1.35 1.35 0 01-1.965-.014L2.584 11.6a1.25 1.25 0 011.832-1.702l5.598 6.029L20.096 5.386a1.25 1.25 0 011.767-.04z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></svg></span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></div><div class="CommentContent css-1ygdre8">我对qt不熟悉，UE的委托比传统意义上的强大，今天简单看了一下QT少量代码，不敢直接下结论，发现这点有可能UE真的借鉴了QT了，至少有些宏部分好像<img src="./一文理解透UE委托Delegate - 知乎_files/v2-3846906ea3ded1fabbf1a98c891527fb.png" class="sticker" alt="[惊喜]"></div><div class="css-dbby2p"><div class="css-82fsyv"><div class="css-12cl38p">01-31</div></div><div class="css-18opwoy"><button type="button" class="Button  css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="ChatBubbleFill24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ThumbFill24" data-old-api="ThumbFill24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 012.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 01-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 012.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 003.19-2.191c.115-.296.173-.611.173-.928v-.553z"></path></svg></span>赞</button></div></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="Popover"><div id="Popover17-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover17-content"><a href="https://www.zhihu.com/people/01e237cbb7ab2898778341dfd79841d8" target="_blank" class="css-hxc9jr"><img class="Avatar css-1qchsfe" src="./一文理解透UE委托Delegate - 知乎_files/v2-30c205846653d476a55174740b91fb50_l.jpg" srcset="https://pic3.zhimg.com/v2-30c205846653d476a55174740b91fb50_l.jpg?source=06d4cd63 2x" alt="Blurry Light" loading="lazy"></a></div></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="Popover"><div id="Popover18-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover18-content"><a href="https://www.zhihu.com/people/01e237cbb7ab2898778341dfd79841d8" target="_blank" class="css-1rd0h6f">Blurry Light</a></div></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></div><div class="CommentContent css-1ygdre8"><p>TWeakObjectPtr 应当不影响UObject的生命周期吧?</p></div><div class="css-dbby2p"><div class="css-82fsyv"><div class="css-12cl38p">08-17</div></div><div class="css-18opwoy"><button type="button" class="Button  css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="ChatBubbleFill24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ThumbFill24" data-old-api="ThumbFill24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 012.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 01-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 012.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 003.19-2.191c.115-.296.173-.611.173-.928v-.553z"></path></svg></span>赞</button></div></div></div></div></div><div></div></div></div></div></div></div></div></div><div class="PostIndex-Contributions" data-za-detail-view-path-module="ColumnList" data-za-detail-view-path-module_name="文章被以下专栏收录" data-za-extra-module="{}"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="https://www.zhihu.com/column/c_1405665457299308544"><div class="Popover"><div id="Popover7-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover7-content"><img class="Avatar Avatar--medium Avatar--round" width="40" height="40" src="./一文理解透UE委托Delegate - 知乎_files/4b70deef7_xs.jpg" srcset="https://pic1.zhimg.com/4b70deef7_l.jpg?source=172ae18b 2x" alt="游戏引擎"></div></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><span><a class="ColumnLink ColumnItem-Title" href="https://www.zhihu.com/column/c_1405665457299308544"><div class="Popover"><div id="Popover8-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover8-content">游戏引擎</div></div></a></span></h2></div></div></div></ul></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1581px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" data-new-api="ArrowLeftSmall24" data-old-api="ArrowLeft" fill="#d3d3d3" class="Zi Zi--ArrowLeft"><path d="M10.752 12l4.025-3.78a.684.684 0 000-1.01.796.796 0 00-1.075 0l-4.42 4.15a.866.866 0 000 1.28l4.42 4.15a.796.796 0 001.075 0 .684.684 0 000-1.01L10.752 12z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/348033601" class="PostItem"><div><img src="./一文理解透UE委托Delegate - 知乎_files/v2-13ce209fbd35890de6ef656bd3f1efb9_250x0.jpg" srcset="https://pic3.zhimg.com/v2-13ce209fbd35890de6ef656bd3f1efb9_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="2022头部按摩仪、按摩爪推荐，小白该如何正确选购头部睡眠按摩器？"><h1 class="PostItem-Title">2022头部按摩仪、按摩爪推荐，小白该如何正确选购头部睡眠按摩器？</h1><div class="PostItem-Footer"><span>三宝妈妈</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/87664444" class="PostItem"><div><img src="./一文理解透UE委托Delegate - 知乎_files/v2-cb41adc8bae7aa8fb5c43a1edb5fa9c9_250x0.jpg" srcset="https://pic4.zhimg.com/v2-cb41adc8bae7aa8fb5c43a1edb5fa9c9_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="40岁油腻男，花50就搞定了俩岛国美少女"><h1 class="PostItem-Title">40岁油腻男，花50就搞定了俩岛国美少女</h1><div class="PostItem-Footer"><span>电影派Mr</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/44444743" class="PostItem"><div><img src="./一文理解透UE委托Delegate - 知乎_files/v2-f7d55b03ee6a7311615c6f57c9eb09ec_250x0.jpg" srcset="https://picx.zhimg.com/v2-f7d55b03ee6a7311615c6f57c9eb09ec_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="营养入门：食物分类——蔬菜和水果"><h1 class="PostItem-Title">营养入门：食物分类——蔬菜和水果</h1><div class="PostItem-Footer"><span>吕印飞</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/27827104" class="PostItem"><div><h1 class="PostItem-Title">靳东与刘奕君，白昼与黑夜</h1><p class="PostItem-Summary">靳东与刘奕君，就像白昼与黑夜。 当然没有褒贬倾向。当然只限于表演角色。 不知道是否凑巧。在山影系的剧里，他俩总是恰好处在明暗两面。 《琅琊榜》，蔺晨与谢玉。《伪装者》，明楼与王天…</p><div class="PostItem-Footer"><span>张佳玮</span><span class="PostItem-FooterTitle">发表于张佳玮写字...</span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" data-new-api="ArrowRightSmall24" data-old-api="ArrowRight" fill="#d3d3d3" class="Zi Zi--ArrowRight"><path d="M13.248 12l-4.025 3.78a.684.684 0 000 1.01.796.796 0 001.075 0l4.42-4.15a.867.867 0 000-1.28l-4.42-4.15a.796.796 0 00-1.075 0 .684.684 0 000 1.01L13.248 12z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="ArrowShapeUpwardFill24" data-old-api="BackToTop" aria-label="回到顶部" class="Zi Zi--BackToTop" fill="currentColor"><path d="M13.204 3.107a1.75 1.75 0 00-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0016.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","allowSignUp":true}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"club":{"tags":{},"admins":{"data":[]},"members":{"data":[]},"profile":{},"checkin":{},"comments":{"paging":{},"loading":{},"meta":{},"ids":{}},"postList":{"paging":{},"loading":{},"ids":{}},"recommend":{"data":[]},"silences":{"data":[]},"application":{"profile":null}},"entities":{"users":{"9b939bd116cd066ce372288d50538da8":{"uid":1437579071195046000,"userType":"people","id":"9b939bd116cd066ce372288d50538da8"},"zhou-zhi-long-16":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de.jpg?source=172ae18b","uid":"555417237251469312","userType":"people","isFollowing":false,"urlToken":"zhou-zhi-long-16","id":"7b5e1d9541265b56c58a48969d6b4e4d","description":"只会一点点C++，一点点汇编，一点点图形学......","name":"rayhunter","isAdvertiser":false,"headline":"C++元编程低能儿,你们别光收藏，也要点赞啊！","gender":1,"url":"\u002Fpeople\u002F7b5e1d9541265b56c58a48969d6b4e4d","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"腾讯游戏 游戏客户端开发工程师"}],"badgeV2":{"title":"腾讯游戏 游戏客户端开发工程师","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"腾讯游戏 游戏客户端开发工程师","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"腾讯游戏 游戏客户端开发工程师","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png?source=32738c0c"},"exposedMedal":{"medalId":"1463836052717301760","medalName":"知「势」之星","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e66f695db706a1c8c79b8097c1565da2_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e66f695db706a1c8c79b8097c1565da2_l.png?source=172ae18b","description":"「知势榜」上榜答主即可获得","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"460092901":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGpRA2R6CFx1ClFNgfJERpdg&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"id":460092901,"title":"一文理解透UE委托Delegate","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901","imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-faf6f604d3facd256ac1a8841b8a72bd_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-faf6f604d3facd256ac1a8841b8a72bd_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-e350004ea12d6e3b7b05e707e6abc0c6_200x112.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2300\" data-rawheight=\"1959\" data-watermark=\"watermark\" data-original-src=\"v2-e350004ea12d6e3b7b05e707e6abc0c6\" data-watermark-src=\"v2-1e159439edd6b5bc632b9defa04cf236\" data-private-watermark-src=\"\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-e350004ea12d6e3b7b05e707e6abc0c6_r.png\" class=\"origin_image inline-img zh-lightbox-thumb\"\u002F\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E5%BC%95%E8%A8%80\" class=\"internal\"\u003E引言\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%B8%80%E7%90%86%E8%A7%A3%E5%A7%94%E6%89%98\" class=\"internal\"\u003E一、理解委托\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#11-%E5%88%9D%E8%AF%86%E5%A7%94%E6%89%98\" class=\"internal\"\u003E1.1 初识委托\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#12-%E7%AE%80%E5%8D%95%E5%AF%B9%E5%A7%94%E6%89%98%E7%9A%84%E6%80%9D%E8%80%83\" class=\"internal\"\u003E1.2 简单对委托的思考\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%BA%8Cue%E5%A7%94%E6%89%98%E7%9A%84%E6%A6%82%E8%A6%81\" class=\"internal\"\u003E二、UE委托的概要\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#21-%E4%B8%89%E5%A4%A7%E7%B1%BB%E5%9E%8B\" class=\"internal\"\u003E2.1 三大类型\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#22-%E6%94%AF%E6%8C%81%E7%BB%91%E5%AE%9A%E7%B1%BB%E5%9E%8B\" class=\"internal\"\u003E2.2 支持绑定类型\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#23-ue%E5%A7%94%E6%89%98%E7%89%B9%E6%80%A7\" class=\"internal\"\u003E2.3 UE委托特性\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%B8%89tdelegate%E5%8D%95%E6%92%ADc%E5%AE%9E%E7%8E%B0\" class=\"internal\"\u003E三、TDelegate单播C++实现\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#31%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8\" class=\"internal\"\u003E3.1定义与使用\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#32-tdelegate%E7%9A%84c%E5%AE%9E%E7%8E%B0%E5%88%86%E6%9E%90\" class=\"internal\"\u003E3.2 TDelegate的C++实现分析\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#33-fdefaultdelegateuserpolicy%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F\" class=\"internal\"\u003E3.3 FDefaultDelegateUserPolicy策略模式\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#34-%E7%BB%91%E5%AE%9A\" class=\"internal\"\u003E3.4 绑定\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#35-%E5%88%9B%E5%BB%BA\" class=\"internal\"\u003E3.5 创建\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#36-%E6%89%A7%E8%A1%8C\" class=\"internal\"\u003E3.6 执行\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#37-%E5%86%85%E5%B5%8C%E7%9C%BC%E8%8A%B1%E7%BC%AD%E4%B9%B1%E7%9A%84%E6%A8%A1%E6%9D%BF%E7%B1%BB\" class=\"internal\"\u003E3.7 内…\u003C\u002Fa\u003E","created":1642697149,"updated":1642732421,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de.jpg?source=172ae18b","uid":"555417237251469312","userType":"people","isFollowing":false,"urlToken":"zhou-zhi-long-16","id":"7b5e1d9541265b56c58a48969d6b4e4d","description":"只会一点点C++，一点点汇编，一点点图形学......","name":"rayhunter","isAdvertiser":false,"headline":"C++元编程低能儿,你们别光收藏，也要点赞啊！","gender":1,"url":"\u002Fpeople\u002F7b5e1d9541265b56c58a48969d6b4e4d","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"腾讯游戏 游戏客户端开发工程师"}],"badgeV2":{"title":"腾讯游戏 游戏客户端开发工程师","mergedBadges":[{"type":"identity","detailType":"identity","title":"认证","description":"腾讯游戏 游戏客户端开发工程师","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"","nightIcon":""}],"detailBadges":[{"type":"identity","detailType":"identity_people","title":"已认证的个人","description":"腾讯游戏 游戏客户端开发工程师","url":"https:\u002F\u002Fwww.zhihu.com\u002Faccount\u002Fverification\u002Fintro","sources":[],"icon":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-235258cecb8a0f184c4d38483cd6f6b6_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-45e870b8f0982bcd7537ea4627afbd00_l.png?source=32738c0c"},"exposedMedal":{"medalId":"1463836052717301760","medalName":"知「势」之星","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e66f695db706a1c8c79b8097c1565da2_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e66f695db706a1c8c79b8097c1565da2_l.png?source=172ae18b","description":"「知势榜」上榜答主即可获得","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"","imageWidth":818,"imageHeight":619,"content":"\u003Cul\u003E\u003Cul\u003E\u003Cli data-pid=\"rY5GosHe\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E5%BC%95%E8%A8%80\" class=\"internal\"\u003E引言\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"tcrqWZ73\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%B8%80%E7%90%86%E8%A7%A3%E5%A7%94%E6%89%98\" class=\"internal\"\u003E一、理解委托\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cul\u003E\u003Cli data-pid=\"0x0RvDd0\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#11-%E5%88%9D%E8%AF%86%E5%A7%94%E6%89%98\" class=\"internal\"\u003E1.1 初识委托\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"RiuHu_Bi\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#12-%E7%AE%80%E5%8D%95%E5%AF%B9%E5%A7%94%E6%89%98%E7%9A%84%E6%80%9D%E8%80%83\" class=\"internal\"\u003E1.2 简单对委托的思考\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cli data-pid=\"p3ozvPBO\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%BA%8Cue%E5%A7%94%E6%89%98%E7%9A%84%E6%A6%82%E8%A6%81\" class=\"internal\"\u003E二、UE委托的概要\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cul\u003E\u003Cli data-pid=\"8koXvEMi\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#21-%E4%B8%89%E5%A4%A7%E7%B1%BB%E5%9E%8B\" class=\"internal\"\u003E2.1 三大类型\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"LpYge60H\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#22-%E6%94%AF%E6%8C%81%E7%BB%91%E5%AE%9A%E7%B1%BB%E5%9E%8B\" class=\"internal\"\u003E2.2 支持绑定类型\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"Bamf3H1_\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#23-ue%E5%A7%94%E6%89%98%E7%89%B9%E6%80%A7\" class=\"internal\"\u003E2.3 UE委托特性\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cli data-pid=\"5W3My3lV\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%B8%89tdelegate%E5%8D%95%E6%92%ADc%E5%AE%9E%E7%8E%B0\" class=\"internal\"\u003E三、TDelegate单播C++实现\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cul\u003E\u003Cli data-pid=\"r0LxABxO\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#31%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8\" class=\"internal\"\u003E3.1定义与使用\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"29b_fVWN\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#32-tdelegate%E7%9A%84c%E5%AE%9E%E7%8E%B0%E5%88%86%E6%9E%90\" class=\"internal\"\u003E3.2 TDelegate的C++实现分析\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"WRH2LxI0\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#33-fdefaultdelegateuserpolicy%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F\" class=\"internal\"\u003E3.3 FDefaultDelegateUserPolicy策略模式\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"oEfoTupM\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#34-%E7%BB%91%E5%AE%9A\" class=\"internal\"\u003E3.4 绑定\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"vhKTn0qv\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#35-%E5%88%9B%E5%BB%BA\" class=\"internal\"\u003E3.5 创建\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"arKTjEAk\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#36-%E6%89%A7%E8%A1%8C\" class=\"internal\"\u003E3.6 执行\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"fzYo66yZ\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#37-%E5%86%85%E5%B5%8C%E7%9C%BC%E8%8A%B1%E7%BC%AD%E4%B9%B1%E7%9A%84%E6%A8%A1%E6%9D%BF%E7%B1%BB\" class=\"internal\"\u003E3.7 内嵌眼花缭乱的模板类\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cli data-pid=\"2BKNRXe9\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E5%9B%9Bdelegateinstance%E7%9A%84c%E5%AE%9E%E7%8E%B0\" class=\"internal\"\u003E四、DelegateInstance的C++实现\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cul\u003E\u003Cli data-pid=\"y4sNsQDJ\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#41-tbaseuobjectmethoddelegateinstance%E7%9A%84%E7%BB%86%E8%8A%82\" class=\"internal\"\u003E4.1 TBaseUObjectMethodDelegateInstance的细节\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"ZKZUqD02\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#42-tcommondelegateinstancestate%E7%9A%84%E7%BB%86%E8%8A%82\" class=\"internal\"\u003E4.2 TCommonDelegateInstanceState的细节\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"LviFdl7n\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#43-ibasedelegateinstance%E4%B8%8Eidelegateinstance\" class=\"internal\"\u003E4.3 IBaseDelegateInstance与IDelegateInstance\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cli data-pid=\"6NGes-L_\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E4%BA%94tmulticastdelegate%E5%A4%9A%E6%92%AD\" class=\"internal\"\u003E五、TMulticastDelegate多播\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"9VGebyRH\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E5%85%ADtbasedynamicdelegate%E5%8A%A8%E6%80%81%E5%A7%94%E6%89%98\" class=\"internal\"\u003E六、TBaseDynamicDelegate动态委托\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"hde0QKHt\"\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901\u002Fedit#%E7%BB%93%E8%AF%AD\" class=\"internal\"\u003E结语\u003C\u002Fa\u003E \u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Ful\u003E\u003Ch2\u003E引言\u003C\u002Fh2\u003E\u003Cp data-pid=\"RotiFcWW\"\u003E写完\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F446500670\" class=\"internal\"\u003E《UE4智能指针及与STL的对比》\u003C\u002Fa\u003E后，好久没有写C++专有文章了，想写一篇了，但话题只能在UE内。由于UE的委托还是比较偏纯C++设计，加上内部有不少宏和模板，想要完全理解，可能对C++新手不是特别友好。我个人作为一名C++元编程爱好者，想在这里谈谈个人浅见，如果还能帮助到大家那再好不过了。上次我写了一篇《由UE4注册TDelegate的委托让我陷入了C++的沉思》介绍委托的部分知识点，重点分析了函数签名类型转换与委拖部分结构和借new重载转换，还入选了UE的社区周报，本文就想在此基础上全面介绍委托，如果想深入的了解强列建议两篇一起读。\u003C\u002Fp\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" data-draft-node=\"block\" data-draft-type=\"link-card\" data-image=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-faf6f604d3facd256ac1a8841b8a72bd_720w.jpg\" data-entity-type=\"article\" data-entity-data=\"null\" class=\"internal\"\u003E由UE4注册TDelegate的委托让我陷入了C++的沉思\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F446500670\" data-draft-node=\"block\" data-draft-type=\"link-card\" data-image=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1bc66b075acb68438e160ec77134b2e4_720w.jpg\" data-entity-type=\"article\" data-entity-data=\"null\" class=\"internal\"\u003EUE4智能指针及与STL的对比\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F397720700\" data-draft-node=\"block\" data-draft-type=\"link-card\" data-image=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1bc66b075acb68438e160ec77134b2e4_180x120.jpg\" data-image-width=\"1200\" data-image-height=\"500\" class=\"internal\"\u003Erayhunter：C++中VS2019下STL的std::tuple元组深入剖析\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F472749525\u002Fanswer\u002F2084936755\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\"internal\"\u003EC++代码可以魔法到什么程度？\u003C\u002Fa\u003E\u003Ch2\u003E一、理解委托\u003C\u002Fh2\u003E\u003Cp data-pid=\"2UzPxv7f\"\u003E第一章节非常简单，适合完全不了解委托的新同学，已经了解过委托的建议直接跳过。\u003C\u002Fp\u003E\u003Ch3\u003E1.1 初识委托\u003C\u002Fh3\u003E\u003Cp data-pid=\"0nGcnGhq\"\u003EC++原生并没有委托，不过像C#语言原生就有，但C++几乎是无所不能，像智能指针，内存池及GC非常重要的设计，就由我们自己实现，委托也不例外。不过委托这词还是有点抽象，用个例子类比一下。\u003C\u002Fp\u003E\u003Cp data-pid=\"We6k_1z-\"\u003E行军打仗，侦察兵负责侦察，炮兵负责攻击，侦察兵将发现的敌军据点报告给炮兵，炮兵实施火力打击。从程序语言设计层面考虑：模块A代表侦察兵；模块B代表炮兵。A，B模块本身无直接关联，相互独立解耦，侦查兵发现敌方据点后并不直接或者说根本无法对其进行进攻，委拖就像侦查兵身上配备的无线电，非常小巧，把据点位置告之炮兵，炮兵进行真正火力打击。委托的注册就像炮兵本身有个固定频率的电台，提前告之侦察兵，就一流程就是委托的注册，发现敌方据点后可以向这个特定的频率发送通知。更进一步，侦察兵只把发现的据点信息告之炮兵叫单播委托；如果信息化，狙击以及冲锋三个小队都关心敌方哨兵情况，告之侦察兵，如果发现哨兵立马通知我们（就是多播注册），当侦察兵实际勘察发现敌方哨兵时，立马通知这三个小队，三个小队可以按自己的方法处理收到的消息，这叫多播委托。\u003C\u002Fp\u003E\u003Cp data-pid=\"7MJ3kXV4\"\u003E上面是简单的实例来理解委托，我们从非常简单的C++代码来理解一下委托。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegateType\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EArtilleryAction\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Eprintf\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E&#34;Drop a bomb on the (%d,%d) position\u003C\u002Fspan\u003E\u003Cspan class=\"se\"\u003E\\r\\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EScout\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EScout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDelegateType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArtilleryDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E{}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EFindInformation\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArtilleryDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Erand\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Erand\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E());\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprivate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EDelegateType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EArtilleryDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EScout\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EOneScout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArtilleryAction\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EOneScout\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFindInformation\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"yCGlouHM\"\u003E我们将\u003Ccode\u003Evoid (*)(int x, int y)\u003C\u002Fcode\u003E无返回值且接受两个int型参数的函数指针类型重定义为：\u003Cb\u003EDelegateType\u003C\u002Fb\u003E，就是一种超级简单的委托类型。然后写了Scout侦察兵类，只有一个成员ArtilleryDelegate，就是刚定义的DelegateType委托类型，在Scout构造函数中提供了委托的初始化赋值，即对委托进行绑定注册，在我们的main函数中，将委托绑定到了\u003Ccode\u003Evoid ArtilleryAction(int x, int y)\u003C\u002Fcode\u003E函数中了。最后当然类中还给了一个简单测试函数：\u003Ccode\u003EFindInformation\u003C\u002Fcode\u003E,表示侦察兵发现敌方据点坐标信息时，将信息传给已经绑定委托回调函数，调用后会打印：Drop a bomb on the （xx,xx） Position，总的来说这就是委托的简单模型，Scout类只是按它的功能发现信息，传递发现的信息，并不关心信息到底谁处理，怎么处理。这样设计很容易将模块解耦和组合起来，比如注册时也可以换成其它的符合注册条件的函数，给我们比较大的自由。\u003C\u002Fp\u003E\u003Ch3\u003E1.2 简单对委托的思考\u003C\u002Fh3\u003E\u003Cp data-pid=\"vfuzaavm\"\u003E有了这些基础知识，我先提一些想法，也是UE设计要面临的，自己提前考虑一下： \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"i7_1sp-S\"\u003E\u003Ci\u003E委托只能是简单的函数指针吗？ \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"cXtuByOQ\"\u003E委托能提前保存函数参数吗？类似std::bind可以将参数提前缓存起来 \u003C\u002Fli\u003E\u003Cli data-pid=\"yeaMlVF2\"\u003E\u003Ci\u003E委托能对不同的函数类型进行转换吗 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"1iMz82Tn\"\u003E委托如果都支持上面功能，怎么设计，成员数据怎么保存 \u003C\u002Fli\u003E\u003Cli data-pid=\"-o_qK5yQ\"\u003E\u003Ci\u003E委托如果支持成员函数，怎么处理成员对象时效安全问题 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"8mqIQaE9\"\u003E委托怎么设计支持多播 \u003C\u002Fli\u003E\u003Cli data-pid=\"0Vzf0iYY\"\u003E 委托对UE专有UObject怎么进行反射处理\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003E二、UE委托的概要\u003C\u002Fh2\u003E\u003Ch3\u003E2.1 三大类型\u003C\u002Fh3\u003E\u003Cp data-pid=\"_lVJIns6\"\u003EUE的委托分为三大类，具体的枚举分类可以参见：DelegateCombinations.h文件  \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"VIFDvtAE\"\u003E\u003Ci\u003E\u003Cb\u003E1.单播委托:\u003C\u002Fb\u003E TDelegate模板类，通常用\u003Ccode\u003EDECLARE_DELEGATE\u003C\u002Fcode\u003E及\u003Ccode\u003EDECLARE_DELEGATE_XXXXParams\u003C\u002Fcode\u003E宏进行声明，后面的宏表示带XXXX个参数 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"QugeV6nB\"\u003E\u003Cb\u003E2.多播委托:\u003C\u002Fb\u003E TMulticastDelegate模板类，通常用\u003Ccode\u003EDECLARE_MULTICAST_DELEGATE\u003C\u002Fcode\u003E及\u003Ccode\u003EDECLARE_MULTICAST_DELEGATE_&lt;Num&gt;Params\u003C\u002Fcode\u003E宏进行声明，后面的宏表示带XXXX个参数  \u003C\u002Fli\u003E\u003Cli data-pid=\"-3V_iDSA\"\u003E\u003Ci\u003E\u003Cb\u003E3.动态委托:\u003C\u002Fb\u003E 继承于TBaseDynamicDelegate，TBaseDynamicMulticastDelegate模板类，通常用\u003Ccode\u003EDECLARE_DYNAMIC_DELEGATE\u003C\u002Fcode\u003E及\u003Ccode\u003EDECLARE_DYNAMIC_MULTICAST_DELEGATE\u003C\u002Fcode\u003E宏进行声明，分别表示单播与多播，另外还有包含参数个数的宏如\u003Ccode\u003EDECLARE_DYNAMIC_DELEGATE_OneParam\u003C\u002Fcode\u003E，其本质集成了UObject的反射系统，让其可以注册蓝图实现的函数及支持序列化存储到本机，UFunction只需给函数名称及蓝图支持是其最大的特性，概念上并未逃出前两类，性能和功能弱于前两类。 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"9hGqucI_\"\u003E\u003Cb\u003E2.1 Event:\u003C\u002Fb\u003E 其继承多播，不单独讨论了。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"Q5DrubWZ\"\u003E以单播为例，我们可以看一下表格的映射关系\u003C\u002Fp\u003E\u003Cp data-pid=\"HgTlAgbC\"\u003E | \u003C\u002Fp\u003E\u003Ch3\u003E2.2 支持绑定类型\u003C\u002Fh3\u003E\u003Ctable data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth\u003E函数签名类型\u003C\u002Fth\u003E\u003Cth\u003E宏声明\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003Evoid Function()\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE( DelegateName )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003Evoid Function(  &lt;Param1&gt;)\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_OneParam( DelegateName, Param1Type )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003Evoid Function( &lt;Param1&gt;,&lt;Parm2&gt;  )\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_TwoParams( DelegateName, Param1Type, Param2Type )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003Evoid Function(&lt;Param1 &gt;, &lt;Parm2&gt; ,...)\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_&lt;Num&gt;Params( DelegateName, Param1Type, Param2Type, ... )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E&lt;RetVal&gt; Function()\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_RetVal( RetValType, DelegateName )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E&lt;RetVal&gt; Function(&lt;Parm1&gt;)\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_RetVal_OneParam( RetValType, DelegateName, Param1Type )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E&lt;RetVal&gt; Function(&lt;Parm1&gt;,&lt;Parm2&gt;)\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_RetVal_TwoParams( RetValType, DelegateName, Param1Type, Param2Type )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E&lt;RetVal&gt; Function(&lt;Param1&gt;,&lt;Parm2&gt;,...)\u003C\u002Ftd\u003E\u003Ctd\u003EDECLARE_DELEGATE_RetVal_&lt;Num&gt;Params( RetValType, DelegateName, Param1Type, Param2Type, ... )\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003Cp data-pid=\"0rxyUlyI\"\u003EUE的委托很强大，一但2.1中类型声明确定后，只要能将要绑定的类型转换为声明的类型都能进行注册绑定，这个在\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" class=\"internal\"\u003E《由UE4注册TDelegate的委托让我陷入了C++的沉思》\u003C\u002Fa\u003E有分析，后面也会有一定的讨论。下面的表列举了单播可以绑定的类型，单播是\u003Cb\u003EBind开头\u003C\u002Fb\u003E，如果是多播注册，只需将\u003Cb\u003EBind换成Add\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cblockquote data-pid=\"vgYu4mHb\"\u003E 这里先简单说一下，UE的委托类似std::bind可带有tuple保存信息，官方称为\u003Cb\u003Epayload\u003C\u002Fb\u003E，比如声明委托函数原类型是\u003Ccode\u003Evoid()(int)\u003C\u002Fcode\u003E型，比如想绑定注册\u003Ccode\u003Evoid MyClass::Test(int，int，string)\u003C\u002Fcode\u003E函数，明显类型是不匹配的。因为待注册的函数首先是一个成员函数，会隐藏第一个参数this指针，后面还多了两个参数int，string;但只需将this指针保存并使得后面两个变量值，比如18与“helloworld”也能提前保存到\u003Cb\u003Epayload\u003C\u002Fb\u003E中，调用时再还原，也是可以转换成功的，当然还要考虑指针的有效性问题，这背后肯定有复杂的设计。\u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Ctable data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth\u003E方式\u003C\u002Fth\u003E\u003Cth\u003E用途\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindStatic(&amp;GlobalFunctionName)\u003C\u002Ftd\u003E\u003Ctd\u003E绑定静态函数，要么是普通全局函数要么是静态成员函数\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindUObject(UObject, &amp;UClass::Function)\u003C\u002Ftd\u003E\u003Ctd\u003ETWeakObjectPtr为安全性设计要点，绑定UObject类成员函数，object必有效\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindSP(SharedPtr, &amp;FClass::Function)\u003C\u002Ftd\u003E\u003Ctd\u003ETWeakPtr为安全性设计要点，绑定普通类成员函数，注意是F开头，指针对象必有效\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindThreadSafeSP(SharedPtr, &amp;FClass::Function)\u003C\u002Ftd\u003E\u003Ctd\u003ETWeakPtr为安全性设计要点，绑定普通类成员函数，注意是F开头，指针对象必有效，只是线程安全版，安全版问题可以参考开头链接：《UE4智能指针及与STL的对比》\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindRaw(RawPtr, &amp;FClass::Function)\u003C\u002Ftd\u003E\u003Ctd\u003E绑定普通类成员函数，注意是F开头，这次没有智能指针帮助，没有绑定对象内存的安全检查处理，一但对象内存回收，我们必手动处理Unbind或者移除，不然可能crash\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindLambda(Lambda)\u003C\u002Ftd\u003E\u003Ctd\u003E绑定lambda表达式，没有安全检查，自己处理好指针或引用的延迟调用问题\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindWeakLambda(UObject, Lambda)\u003C\u002Ftd\u003E\u003Ctd\u003E绑定lambda表达式，UObject有效性可以确保，但Lambda的其它引用或指针就不确保了\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindUFunction(UObject, FName(&#34;FunctionName&#34;))\u003C\u002Ftd\u003E\u003Ctd\u003E同时支持UObject的普通委托和Dynamic委托，因为它是用UFunction名称查询的，借了UE的序列化\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003EBindDynamic(UObject, &amp;UClass::FunctionName)\u003C\u002Ftd\u003E\u003Ctd\u003E仅仅可用于Dynamic委托，成员函数FunctionName必须有UFUNCTION宏声明过\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003Ch3\u003E2.3 UE委托特性\u003C\u002Fh3\u003E\u003Col\u003E\u003Cli data-pid=\"XUtP9br4\"\u003E1.委托内部特性\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cul\u003E\u003Cli data-pid=\"RIPd4U75\"\u003E支持回调函数带返回值\u003C\u002Fli\u003E\u003Cli data-pid=\"UTYYwHre\"\u003E内部最高支持4个\u003Cb\u003Epayload\u003C\u002Fb\u003E，如果4个参数还不够你用的话，请考虑将部分参数合为结构体或者类\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cblockquote data-pid=\"thsgBdrC\"\u003E 这个我细看了一下，实际上C++模板及tuple设计都是可变参，支持无限多个。只是UE在TDelegate模板类中对DelegateInstance实例模板类反查只提供了4个参数，所以建议为4个，如果不需要反查，可以传无限多。\u003C\u002Fblockquote\u003E\u003Cul\u003E\u003Cli data-pid=\"EXaE1F32\"\u003E委托类型支持多参数，可以见2.1的声明定义，暂时最多9个，请考虑将部分参数合为结构体或者\u003C\u002Fli\u003E\u003Cli data-pid=\"qvRhtIvA\"\u003E支持const函数，比用const成员函数与非const成员函数\u003C\u002Fli\u003E\u003Cli data-pid=\"CYbvl9kP\"\u003E强大的函数签名类型转换\u003C\u002Fli\u003E\u003Cli data-pid=\"bnX2JHRf\"\u003E委托本体与委托实例解耦及交互设计\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cblockquote data-pid=\"B0uCCqxJ\"\u003E  个人理解最后两点为精华，无论从C++模板语法层面还是从设计使用上，都是非常赞的\u003C\u002Fblockquote\u003E\u003Col\u003E\u003Cli data-pid=\"3BroY-CN\"\u003E多播委托通过\u003Ccode\u003EBroadcast()\u003C\u002Fcode\u003E一次触发所有注册的回调函数执行，不支持函数带有返回值\u003C\u002Fli\u003E\u003Cli data-pid=\"Vv_Evyei\"\u003EDynamic动态委托主要就是集成了UObject的反射系统，让其可以注册蓝图实现的函数及支持序列化存储到本机。当然也可以绑定原生C++函数代码，前提是这个函数被\u003Cb\u003EUFUNCTION\u003C\u002Fb\u003E标记（因为UFUNCTION标记过，这个函数就可以进行反射与序列化了）\u003C\u002Fli\u003E\u003Cli data-pid=\"LywvGrA3\"\u003EUE的委拖内部通过\u003Cb\u003Epayload\u003C\u002Fb\u003E保存数据，实质是UE自己实现的TTuple，tuple本身可以支持任意类型变量，所以这里可以让委托变得异常强大，有了这个可以轻松处理不同类型的函数转换。\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Ch2\u003E三、TDelegate单播C++实现\u003C\u002Fh2\u003E\u003Cp data-pid=\"BJZdjqAe\"\u003E先看结构图,图可能直接看不清，双击查看原图，画这个图费了我不少时间： \u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-1e159439edd6b5bc632b9defa04cf236_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2300\" data-rawheight=\"1959\" class=\"origin_image zh-lightbox-thumb\" width=\"2300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-1e159439edd6b5bc632b9defa04cf236_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2300&#39; height=&#39;1959&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2300\" data-rawheight=\"1959\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-1e159439edd6b5bc632b9defa04cf236_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-1e159439edd6b5bc632b9defa04cf236_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"Aiv9l9a_\"\u003E 总括一下：TDelegate是UE提供的单播委托，声明委托时目前限定了最多可携带9个参数。支持多种可调用对象（普通函数，成员函数，仿函数，lambda等）到声明函数类型进行转换，同时转换的时还支持额外预保存payload参数，类似std:bind一样。TDelegate委托自己没有成员，使用了策略模式继承于基类FDelegateBase。基类FDelegateBase通过new两次重载提供对委托实例的内存分配，并且提供释放及访问方法，这样将委托本体与真正实例解耦开，委托本身不直接保存实例对象，实例由于有多种类型，通过中间层也可以很好的解决了类型擦除与转换的问题，委托本体的size也比较小，只有12字节，由于对齐原因，占16字节。\u003C\u002Fp\u003E\u003Ch3\u003E3.1定义与使用\u003C\u002Fh3\u003E\u003Col\u003E\u003Cli data-pid=\"Dw97t3YP\"\u003E定义单播委托FOnMontageEnded类型的实现\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003EDECLARE_DELEGATE_TwoParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUAnimMontage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Col\u003E\u003Cli data-pid=\"dr1V9o3p\"\u003E在\u003Ccode\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fcode\u003E类中定义委托对象MontageEndedDelegate，作为类成员对象\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprivate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EFOnMontageEnded\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMontageEndedDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Col\u003E\u003Cli data-pid=\"iBLVvSmD\"\u003E在cpp代码中注册绑定委托的回调函数，并拷贝\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F 委托的回调函数\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUAnimMontage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMontage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EbInterrupted\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EbInterrupted\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EShouldBroadcastAbilityTaskDelegates\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E())\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EOnCompleted\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EBroadcast\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003EEndTask\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EActivate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F 注册\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"n\"\u003EMontageEndedDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EBindUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F 委托拷贝给动画实列\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"n\"\u003EAnimInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E-&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMontage_SetEndDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMontageEndedDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMontageToPlay\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Col\u003E\u003Cli data-pid=\"zAtUaQrr\"\u003E执行：\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUAnimInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETriggerMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFQueuedMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F 动画册实例执行委托\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"n\"\u003EMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EExecuteIfBound\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMontage\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMontageEndedEvent\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EbInterrupted\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E3.2 TDelegate的C++实现分析\u003C\u002Fh3\u003E\u003Col\u003E\u003Cli data-pid=\"TR36OGOA\"\u003E先手动展开一下委托定义的宏\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003EDECLARE_DELEGATE_TwoParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUAnimMontage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Etypedef\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUAnimMontage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"IRBvAC23\"\u003E根据\u003Cb\u003EDelegateSignatureImpl.inl\u003C\u002Fb\u003E文件中TDelegate的定义\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003ETDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E{};\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"oqIorq5-\"\u003E模板参数：InRetValType，实例化为void\u003C\u002Fli\u003E\u003Cli data-pid=\"ieSanE0o\"\u003E可变模板参数：ParamTypes，实例化为class UAnimMontage*和bool\u003C\u002Fli\u003E\u003Cli data-pid=\"HJKPfbq-\"\u003E模板参数：UserPolicy，实例化为FDefaultDelegateUserPolicy\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cblockquote data-pid=\"muzg8u7c\"\u003E 这里说一下，虽然c++语法上支持可变参ParamTypes个数为无限多，但由于UE自己在\u003Cb\u003EDelegateCombinations.inl\u003C\u002Fb\u003E文件中使用宏进行了包装，ex：DECLARE_DELEGATE_NineParams，使其最多支持9个参数。从实际角度来说9个函数参数足够了，如果实在不够可以扩充一下宏或者将多个参数用结构合并在一起。 \u003C\u002Fblockquote\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"u7BASTWe\"\u003E1. 继承的基类\u003Ccode\u003ETDelegateBase&lt;FDefaultDelegateUserPolicy&gt;\u003C\u002Fcode\u003E本身无成员，也没有什么特别的，只是提供了一些方法，调用其基类UserPolicy::FDelegateExtras的\u003Ccode\u003EGetDelegateInstanceProtected()\u003C\u002Fcode\u003E方法，得到\u003Cb\u003E委托真正实例对象\u003C\u002Fb\u003E指针。实例结构\u003Cb\u003EXXXXDelegateInstance\u003C\u002Fb\u003E位于我们本章节开头总括图的右侧，通过虚线与TDelegate相连。最后再用指针去调用真正的接口，比如GetHandle()获取句柄，起着打通委托与实例之间中间件的作用。\u003Cbr\u002F\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"I7vV_AHu\"\u003E2. TDelegate的根基类缺省默认值是\u003Cb\u003EFDelegateBase\u003C\u002Fb\u003E，我们也可以手动指定，比较重要。FDelegateBase有两个成员，一个是DelegateSize指代分配实例的内存大小，一个是DelegateAllocator指示内存分配器。这个类主要就是完成对委托实例的内存分配与保存，并且提供了\u003Ccode\u003EUnbind\u003C\u002Fcode\u003E函数用来析构并释放实例的内存。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EFDelegateBase\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EIDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EGetDelegateInstanceProtected\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EUnbind\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprivate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Efriend\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eoperator\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Esize_t\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EAllocate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eint32\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprivate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EFDelegateAllocatorType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EForElementType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFAlignedInlineDelegateType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegateAllocator\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Eint32\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegateSize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \n\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\u003Cspan class=\"kr\"\u003Einline\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eoperator\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Enew\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Esize_t\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EAllocate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eint32\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ESize\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"t7EEIvyc\"\u003E FDelegateBase涉及内存的分配与释放及获取与类型强转，在\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" class=\"internal\"\u003E《由UE4注册TDelegate的委托让我陷入了C++的沉思》\u003C\u002Fa\u003E中已经做过了详细的解释，可以查阅。\u003C\u002Fblockquote\u003E\u003Ch3\u003E3.3 FDefaultDelegateUserPolicy策略模式\u003C\u002Fh3\u003E\u003Cp data-pid=\"2uCLU5K2\"\u003E整个委托系统，由于\u003Ccode\u003ETDelegate\u003C\u002Fcode\u003E，\u003Ccode\u003ETMulticastDelegate\u003C\u002Fcode\u003E，\u003Ccode\u003EIBaseDelegateInstance\u003C\u002Fcode\u003E都用运用了策略模式，\u003Cb\u003EFDefaultDelegateUserPolicy\u003C\u002Fb\u003E作为模板的默认参数传入，让这三个类继承FDefaultDelegateUserPolicy中的类型重定义。这个模板默认参数有点像STL容器的第二个默认模板参数----内存分配器，部分人根本没有察觉到，我们也可以手动指定，只是通常不会去改。\u003C\u002Fp\u003E\u003Cp data-pid=\"v8OpzOyo\"\u003E这个策略类内部有三个using重定义FDelegateInstanceExtras，FDelegateExtras，FMulticastDelegateExtras，我们可以手动替换，但要求必须公有继承于IDelegateInstance，FDelegateBase，TMulticastDelegateBase，否则static_assert对模板手动指定的UserPolicy类型转换检测是通不过的，会造成编译失败。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EFDefaultDelegateUserPolicy\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateInstanceExtras\u003C\u002Fspan\u003E  \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EIDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateExtras\u003C\u002Fspan\u003E          \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFMulticastDelegateExtras\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETMulticastDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDefaultDelegateUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E3.4 绑定\u003C\u002Fh3\u003E\u003Cp data-pid=\"r3Np3gMy\"\u003E在\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" class=\"internal\"\u003E《由UE4注册TDelegate的委托让我陷入了C++的沉思》\u003C\u002Fa\u003E中已经做过了详细的解释，但我们还是可以简单介绍一下，以3.1的代码为例。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F 注册\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMontageEndedDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EBindUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUAbilityTask_PlayMontageAndWait\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EOnMontageEnded\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"k_dtsox4\"\u003E我们看TDelegate模板类的实现，BindUObject这里分为const与非const版本，这例非const版本。如果用错，static_assert也检测导致编译失败，所以对应下面的代码，这里模板参较多些，还是嵌套在模板类中，为了帮助新手，简单说一下函数要点。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"kr\"\u003Einline\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBindUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETMemFunPtrType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"nb\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Estatic_assert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETIsConst\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EValue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;Attempting to bind a delegate with a const object pointer and non-const member function.&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Ethis\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECreateUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"yrBxGZst\"\u003E\u003Cb\u003E重要！！！\u003C\u002Fb\u003E，3.2中已经确定了TDelegate的类模板参数，明确了委托函数原型是\u003Ccode\u003Evoid(class UAnimMontage*,bool)\u003C\u002Fcode\u003E，但实际绑了定的是一个成员函数，类型并不相同。\u003Cbr\u002F\u003E \u003Cbr\u002F\u003E 传给BindUObject的第一个参数this指针，从这个参数可以推断出模板参：UserClass为UAbilityTask_PlayMontageAndWait。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 可变参VarTypes...是除函数声明两个参数外额外绑定的参数，就是2.2小节中说的payload参数，这是不必有。举例一下：\u003Ccode\u003Evoid ClassA::MyTestFun(class UAnimMontage*,bool,int,float)\u003C\u002Fcode\u003E如果想将这个函数绑定到我们的委托中，实际多了三个参数，this指针参数被单独处理了，多了int参数转到第一个VarTypes中，多了float参数转到第二个VarTypes，且在函数注册时一定要给出int与float的值，实例化到tuple中，如\u003Ccode\u003EMontageEndedDelegate.BindUObject(this, &amp;UAbilityTask_PlayMontageAndWait::OnMontageEnded,100,99.f);\u003C\u002Fcode\u003E。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 还有RetValType是从TDelegate模板类传过来的，本身支持返回类型，但本例是void；\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 可变参ParamTypes...也是从TDelegate模板类传过来的，本例就是class UAnimMontage*和bool\u003Cbr\u002F\u003E \u003Cbr\u002F\u003E TMemFunPtrType是\u003Cb\u003EDelegateInstanceInterface.h\u003C\u002Fb\u003E中转为类成员函数指针的重定义，将其重定义为Type，也比较简单，本身经过模板特化会自动选择带不带const版本，我们传入的false表示非const版本。到此函数用到的细节我们都说了，希望对新人有一定帮助。\u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Ch3\u003E3.5 创建\u003C\u002Fh3\u003E\u003Cp data-pid=\"PG5GT81T\"\u003E我们分析不完所有的，就还拿我们这个为例分析简要分析，代码会转到下面这里。本函数主要内容就是创建DelegateInstance对象并关联上TDelegate，可以让TDelegate调用。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003EUE_NODISCARD\u003C\u002Fspan\u003E \u003Cspan class=\"kr\"\u003Einline\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECreateUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETMemFunPtrType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"nb\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Estatic_assert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETIsConst\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EValue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;Attempting to bind a delegate with a const object pointer and non-const member function.&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003ETDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EResult\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003ETBaseUObjectMethodDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"nb\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFuncType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECreate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EResult\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EResult\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"afzsOpbA\"\u003E 这个里面模板参数3.4小节已经全部解释完毕，就简述功能了，不过这里多个两个：\u003Cb\u003EUserPolicy\u003C\u002Fb\u003E来源于TDelegate在模板参，这里就是FDefaultDelegateUserPolicy。\u003Cb\u003EFuncType\u003C\u002Fb\u003E是TDelegate的内部的重定义，也就是RetValType(ParamTypes...)函数指针原型。\u003Cbr\u002F\u003E  栈上创建一个TDelegate对象Result，然后转到DelegateInstance的创建，这一步将this指针，成员函数地址，\u003Cb\u003E扩展的函数参数保存到Instance对象中payload中\u003C\u002Fb\u003E，并藉由两次new重载，打通了TDelegate对象（Result）与DelegateInstance对象联系，最后返回委托。更加细节的创建与转换，还麻烦参考\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" class=\"internal\"\u003E《由UE4注册TDelegate的委托让我陷入了C++的沉思》\u003C\u002Fa\u003E，这文章就是针对这个技术点的。\u003Cbr\u002F\u003E \u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Cp data-pid=\"k3RzW1Tk\"\u003E限于篇幅，我们不可能将所有Bind与Create都讲一遍，但总体思路是一致的。\u003C\u002Fp\u003E\u003Ch3\u003E3.6 执行\u003C\u002Fh3\u003E\u003Cp data-pid=\"zVbvPxqS\"\u003E到了执行就比较简单了,总共有两个版本\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003EFORCEINLINE\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EExecute\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EDelegateInstanceInterfaceType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ELocalDelegateInstance\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EGetDelegateInstanceProtected\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EcheckSlow\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ELocalDelegateInstance\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enullptr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ELocalDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E-&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EExecute\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDummyRetValType\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003Estd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eenable_if_t\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Estd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eis_void\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDummyRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;*\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enullptr\u003C\u002Fspan\u003E\n\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"kr\"\u003Einline\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EExecuteIfBound\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDelegateInstanceInterfaceType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EPtr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EGetDelegateInstanceProtected\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E())\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EPtr\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E-&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EExecuteIfSafe\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nb\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"QOh9MYG8\"\u003E\u003Cb\u003EExecute\u003C\u002Fb\u003E版本比较简单，获取DelegateInstance对象的指针，转移到Instance的对函数调用，如果函数指针对象无效，可能会触发崩溃，为了安全建议，先用IsBound()判断，同时单播这个版本，支持RetValType型返回值。\u003C\u002Fli\u003E\u003Cli data-pid=\"TNGyXerY\"\u003E\u003Cb\u003EExecuteIfBound\u003C\u002Fb\u003E版本麻烦一点点，这是一个模板函数，运用了模板的SFINAE技术确保返回类型是void。然后最大的特点是安全，只有指针有效，才调用。同时这个函数将返回值转为bool了，成功调用返回true\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003E3.7 内嵌眼花缭乱的模板类\u003C\u002Fh3\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10b887bbbd3fd5ae2ef98ce2014dd824_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1999\" data-rawheight=\"1140\" class=\"origin_image zh-lightbox-thumb\" width=\"1999\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10b887bbbd3fd5ae2ef98ce2014dd824_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1999&#39; height=&#39;1140&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1999\" data-rawheight=\"1140\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1999\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10b887bbbd3fd5ae2ef98ce2014dd824_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10b887bbbd3fd5ae2ef98ce2014dd824_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"XfiEw2wn\"\u003E 估计一些不熟悉C++的看到TDelegate类内部这样的代码，估计就晕了，这是什么鬼！！！\u003C\u002Fp\u003E\u003Cp data-pid=\"hzGQvAxI\"\u003E关了这部分，我查了一下源码，的确用的不多，我们只有在Widgets的模块中，也是宏定义中有用到，看起来也有点复杂,如下面代码\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar1Type\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar2Type\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E   \\\n\u003Cspan class=\"n\"\u003EWidgetArgsType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EEventName\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E##\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_UObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegateName\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETUObjectMethodDelegate_TwoVars_Const\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar1Type\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar2Type\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFMethodPtr\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar1Type\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar2Type\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar2\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E  \\\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E \\\n    \u003Cspan class=\"n\"\u003E_\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E##\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EEventName\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EDelegateName\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECreateUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVar2\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \\\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \\\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E \\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"ap19kY13\"\u003E我只能说说个人的理解，这里要提前用到第四章节DelegateInstance的知识。从C++设计层面来说，TDelegate模板类综合看来不过是继承了FDelegate,并没有真正保存委托实例。TDelegate委托虽然有函数原型的签名，但UE内部做了签名转换，让我们近乎自由的绑定可调用对象，这\u003Cb\u003E导致我们只知道委托的类型，比如宏中的DelegateName，根本无法知道它可能绑定的DelegateInstance对象的类型\u003C\u002Fb\u003E。图片中密密麻麻的类就是做这个的，这样我给一个确定委托后，只要我再补一些扩展参数，就能结合委托本身模板参数，确定得到一个DelegateInstance实例的类型或者实例内部定义的类型，\u003Ccode\u003Etypename DelegateName::template TUObjectMethodDelegate_TwoVars_Const&lt; UserClass, Var1Type, Var2Type &gt;::FMethodPtr\u003C\u002Fcode\u003E像这样不过是元编程常见的写法罢了。不过话说回来，你非不要这样写，模板参数显示传入，拆开重写一遍也是可以的，只是不够精练，有点low，达不到C++应有的水平罢了。\u003C\u002Fp\u003E\u003Ch2\u003E四、DelegateInstance的C++实现\u003C\u002Fh2\u003E\u003Cp data-pid=\"HG1elPNg\"\u003E前面说了TDelegate的细节，从本质来说，他只是一个空壳，但是\u003Cb\u003E支持多种类型Instance并且良好和Instance交互\u003C\u002Fb\u003E，真正的内容还要看看Instance。\u003C\u002Fp\u003E\u003Ch3\u003E4.1 TBaseUObjectMethodDelegateInstance的细节\u003C\u002Fh3\u003E\u003Cp data-pid=\"VIvtTaGY\"\u003E这里以前文中TBaseUObjectMethodDelegateInstance为例，如果前文细看了，到这一步也没有什么太多难度了。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EbConst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EWrappedRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003ETBaseUObjectMethodDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EbConst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EWrappedRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETCommonDelegateInstanceState\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EWrappedRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ETBaseUObjectMethodDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFMethodPtr\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInMethodPtr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E；\u003C\u002Fspan\u003E\n\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECreateCopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"err\"\u003E；\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EExecute\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"err\"\u003E；\u003C\u002Fspan\u003E\n\u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EExecuteIfSafe\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParams\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"err\"\u003E；\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003EFORCEINLINE\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECreate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFMethodPtr\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUnwrappedThisType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...);\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprotected\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003ETWeakObjectPtr\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EFMethodPtr\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EMethodPtr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"DAP7Br6a\"\u003ETBaseUObjectMethodDelegateInstance的模板参，我们3.4小节，3.5小节都解析过了，没有什么特别好说的。\u003C\u002Fli\u003E\u003Cli data-pid=\"0hi8jTbF\"\u003E成员上UserObject使用\u003Cb\u003ETWeakObjectPtr\u003C\u002Fb\u003E保存了UObject对象的智能指针弱引用，构造时发生\u003C\u002Fli\u003E\u003Cli data-pid=\"uK44ZdYg\"\u003E成员MethodPtr保存了UObject类的函数指针对象，构造时发生，注意这里FMethodPtr类型实际是一个重定义：\u003Ccode\u003Eusing FMethodPtr = typename TMemFunPtrType&lt;bConst, UserClass, RetValType(ParamTypes..., VarTypes...)&gt;::Type;\u003C\u002Fcode\u003E,这个结构我们3.4小节提了，就是一个转换后的签名，表示类成员函数。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"j4XyiEsq\"\u003E成员函数上，也有几个比较重要的：  \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"zXzf4_0B\"\u003E\u003Ci\u003E\u003Cb\u003EExecute\u003C\u002Fb\u003E：执行，非安全版，\u003Cb\u003E模拟C++17中std::tuple及std::apply(...)函数\u003C\u002Fb\u003E相对比较简单，可以将tuple中参数传入并调用函数,并支持返回值。从语法来上说，它们考虑到了模板内部处理时，object指针对象可能已经转换const版本，所以进行擦除const修饰，并使用了const_cast将其转为非const版本指针。 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cblockquote data-pid=\"IN-e9Sxu\"\u003E如果这点你继续看进去，可能领悟到C++模板的精妙，tuple加invoke两个点，还是有技术含量的。 \u003C\u002Fblockquote\u003E\u003Cul\u003E\u003Cli data-pid=\"kD4KCRwf\"\u003E\u003Ci\u003E\u003Cb\u003EExecuteIfSafe\u003C\u002Fb\u003E：执行，安全版，相比上面Execute，多了对弱引用获取对象安全检测，只有检查通过，才会进行函数调用。 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"Vr8xzt8b\"\u003E\u003Cb\u003ECreate\u003C\u002Fb\u003E：\u003Cb\u003E一个非常非常重要的静态成员函数\u003C\u002Fb\u003E，利用new的重载及TBaseFunctorDelegateInstance的构造函数，传引用Base分配我们Instance内存，因为这个Base实际就是各种TDelegate，这样TDelegate就和Instance打通了。在\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F433019649\" class=\"internal\"\u003E《由UE4注册TDelegate的委托让我陷入了C++的沉思》\u003C\u002Fa\u003E重点讨论过，有兴趣参考。 \u003C\u002Fli\u003E\u003Cli data-pid=\"ko0X_o8L\"\u003E\u003Cb\u003ECreateCopy\u003C\u002Fb\u003E：虽是普通成员函数，但实质还是Create换个形式，关键还是new的重载。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003E4.2 TCommonDelegateInstanceState的细节\u003C\u002Fh3\u003E\u003Cp data-pid=\"TYgFLEOi\"\u003E从我们最开始的缩略图看，所有DelegateInstance都派生于\u003Cb\u003ETCommonDelegateInstanceState\u003C\u002Fb\u003E，以我个人理解，不得不说老外起名就是好啊，这个State太妙了，因为这个类就是为payload而生，带状态带缓存服务的，\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003ETCommonDelegateInstanceState\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EIBaseDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetValType\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInRetValType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eexplicit\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETCommonDelegateInstanceState\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EPayload\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EHandle\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegateHandle\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EGenerateNewHandle\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E){}\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"n\"\u003EFDelegateHandle\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EGetHandle\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Efinal\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EHandle\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Eprotected\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003ETTuple\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EPayload\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EFDelegateHandle\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EHandle\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"3pKtlial\"\u003E这个模板类非常简单，模板参数已经分析了很多遍，不再累述。explicit显式的构造函数，将我们前面讨论的\u003Cb\u003E额外函数参数\u003C\u002Fb\u003E保存到UE的tuple容器中，也就是Payload，然后产生DelegateInstance实例的句柄，内部就是uint64 ID。了解C++的都知道，有了tuple的助力，那就如虎添翼，支持任意类型参数的保存，还支持转发到函数调用，std::bind也是供助这个实现。以前写过stl::tuple分析，有兴趣参考，UE的还没有分析过。\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F397720700\" class=\"internal\"\u003E《C++中VS2019下STL的std::tuple元组深入剖析》\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Ch3\u003E4.3 IBaseDelegateInstance与IDelegateInstance\u003C\u002Fh3\u003E\u003Cp data-pid=\"CMaosKS4\"\u003E再向上看一层，也就是TCommonDelegateInstanceState的基类IBaseDelegateInstance\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EArgTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EIBaseDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ERetType\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArgTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegateInstanceExtras\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Evirtual\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ECreateCopy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBase\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Evirtual\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERetType\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EExecute\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArgTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Evirtual\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Ebool\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EExecuteIfSafe\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EArgTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E};\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"lcpz62s2\"\u003E这个模板类非常简单，没有任何成员，还只是纯虚函数，提供了接口，接口我们也已经讨论过了，模板参数已经分析过了。\u003C\u002Fp\u003E\u003Cp data-pid=\"GF1EH7zd\"\u003E\u003Cb\u003EIDelegateInstance\u003C\u002Fb\u003E更是所有Instance的虚基类，它不再是模板类，它只是提供接口及类型转换上便利，同\u003Ccode\u003EFDelegate\u003C\u002Fcode\u003E，\u003Ccode\u003ETDelegateBase&lt;UserPolicy&gt;\u003C\u002Fcode\u003E，\u003Ccode\u003ETMulticastDelegateBase&lt;UserPolicy&gt;\u003C\u002Fcode\u003E打交道，用基类指针太方便了，类型擦除方便啊，这是常见的C++设计。\u003C\u002Fp\u003E\u003Ch2\u003E五、TMulticastDelegate多播\u003C\u002Fh2\u003E\u003Cp data-pid=\"adwFaQ8m\"\u003E仔细了解了单播委托后，实际再了解多播就非常简单了，我们也不用详细分析了，点出不同点或者一些技术特性就行了。 \u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b81d8f217c630de7aaaa28ae22d6268_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1527\" data-rawheight=\"1353\" class=\"origin_image zh-lightbox-thumb\" width=\"1527\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b81d8f217c630de7aaaa28ae22d6268_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1527&#39; height=&#39;1353&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1527\" data-rawheight=\"1353\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1527\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b81d8f217c630de7aaaa28ae22d6268_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b81d8f217c630de7aaaa28ae22d6268_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cul\u003E\u003Cli data-pid=\"k8XYTC3m\"\u003E\u003Ci\u003E用宏\u003Ccode\u003EDECLARE_MULTICAST_DELEGATE\u003C\u002Fcode\u003E和\u003Ccode\u003EDECLARE_MULTICAST_DELEGATE_&lt;Num&gt;Params\u003C\u002Fcode\u003E定义,后面表示函数参数个数 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"Ew9D1l7B\"\u003E多播定义时函数的返回值必为void,否则static_assert编译检查失败 \u003C\u002Fli\u003E\u003Cli data-pid=\"TyjB-yrR\"\u003E\u003Ci\u003E多播TMulticastDelegate本身相比TDelegate来说，继承关系还更简单，那个因为它充分利用了单播已有的结构或信息。结合图示来说，TMulticastDelegate来身不具有任何新加成员，成员都放到了基类TMulticastDelegateBase中了， \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"4I9VbrCh\"\u003E多播最重要的成员是\u003Ccode\u003ETInvocationListType\u003C\u002Fcode\u003E类型的数组InvocationList，我们所有委托都保存在这里。TInvocationListType是一个C++上的数组的重定义,数组元素类型就是\u003Ccode\u003ETDelegateBase&lt;UserPolicy&gt;\u003C\u002Fcode\u003E，由前面的单播已知这个结构和DelegateInstance关联。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInvocationListType\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETArray\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETDelegateBase\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserPolicy\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFMulticastInvocationListAllocatorType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"E86Zm3Yn\"\u003E多播正如字面意思，就是这个委托可以绑定多个回调函数，我们原来TDelegate用BindXXXXX开头绑定注册都换成了AddXXXX开头的注册，毕竞TDelegate只能绑一个用Bind词表达准确，TMulticastDelegate可以绑多个，用Add也更符合。\u003C\u002Fli\u003E\u003Cli data-pid=\"njCJ8PzE\"\u003E随意分析一个Add添加绑定:\u003Cb\u003EAddUObject\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"kr\"\u003Einline\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFDelegateHandle\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EAddUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETMemFunPtrType\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"nb\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EParamTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...)\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EType\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVarTypes\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Estatic_assert\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETIsConst\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EUserClass\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EValue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;Attempting to bind a delegate with a const object pointer and non-const member function.&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EAdd\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EFDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECreateUObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EInUserObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInFunc\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EVars\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E...));\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"ZQJ2CHhN\"\u003E 我们已经知道，委托声明时函数的签名是普通函数，这里绑定的成员函数，所以和单播一样，也要进行一些类型转换,这里要求成员函数的返回值类型是void；AddUObject注册结束后，返回委托实例的句柄。\u003Cbr\u002F\u003E \u003Cbr\u002F\u003E模板参数：UserClass可以从InUserObject推断，是Object所对应的类型，注意这里有const与非const版本检测\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 可变模板参数：VarTypes同TDelegate一样，是成员函数额外补的参数，会放入payload中，可以有，也可以不添加，不再累述。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E TMemFunPtrType前面也讲过了，主要用于转换成成员函数，不再累述。\u003Cbr\u002F\u003E \u003Cbr\u002F\u003E 其中FDelegate::CreateUObject这句可能有点让人看不懂，那是因为在模板类TMulticastDelegate中有个重定义：\u003Ccode\u003Eusing FDelegate = TDelegate&lt;void(ParamTypes...), UserPolicy&gt;;\u003C\u002Fcode\u003E,看到了吗？多播供助已有的单播结构，调用其静态成员函数创建一个TDelegate单播委托并返回，这样代码不就是很好的复用了吗！设计的还是非常不错的，模板也用的好。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E  将生成TDelegate传给TMulticastDelegate的Add函数，Add函数内部再调用基类的\u003Ccode\u003ESuper::AddDelegateInstance\u003C\u002Fcode\u003E，将其添加到InvocationList中，这样数组就维护了我们的委托及实例了。 \u003C\u002Fblockquote\u003E\u003Cul\u003E\u003Cli data-pid=\"h8nvoAMX\"\u003E执行也比较简单，\u003Cb\u003EBroadcast\u003C\u002Fb\u003E通过循环遍历我们的数组，不过这里UE增加了安全执行的调用\u003Ccode\u003E(DelegateInstanceInterfaceType*)DelegateInstanceInterface)-&gt;ExecuteIfSafe(Params...)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"WfxSV5-3\"\u003E我再提一点C++模板的知识，在模板类的继承中，我们是\u003Cb\u003E无法直接使用模板基类的函数\u003C\u002Fb\u003E，可以通过\u003Cb\u003Eusing，this-&gt;,或者显式传入参数调用三种方式\u003C\u002Fb\u003E，这里UE使用了using方法,并且可以添加public,private控制权限，我们可以看一点点例子，不知为什么，有时我看到UE的模板代码能让我越看越兴奋。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F Make sure TMulticastDelegateBase&#39;s public functions are publicly exposed through the TMulticastDelegate API\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EClear\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIsBound\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIsBoundToObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ERemoveAll\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"k\"\u003Eprivate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"c1\"\u003E\u002F\u002F Make sure TMulticastDelegateBase&#39;s protected functions are not accidentally exposed through the TMulticastDelegate API\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EAddDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ERemoveDelegateInstance\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Eusing\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESuper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E::\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ECompactInvocationList\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch2\u003E六、TBaseDynamicDelegate动态委托\u003C\u002Fh2\u003E\u003Cp data-pid=\"lFaXvlBN\"\u003E仔细了解了单播与多播委托后，实际再了解动态委托就非常简单了，我们也不用详细分析了，提一些技术点就行了。 \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"2tiMIGrL\"\u003E\u003Ci\u003E动态委托支持单播与多播，对UObject支持及蓝图及序列化的支持，可以理解相当于为UE本身专门定制的。 \u003C\u002Fi\u003E 相比前面介绍的单播与多播两种，\u003Cb\u003E这种委托能在蓝图使用，可以说这是最大的优势吧\u003C\u002Fb\u003E，并且绑定利用UFunction的序列化技术，只需要函数名称就可以了，相对多了一些查找消耗。 \u003C\u002Fli\u003E\u003Cli data-pid=\"8M77RcIh\"\u003E\u003Ci\u003E用宏\u003Ccode\u003EDECLARE_DYNAMIC_DELEGATE\u003C\u002Fcode\u003E及\u003Ccode\u003EDECLARE_DYNAMIC_MULTICAST_DELEGATE\u003C\u002Fcode\u003E宏进行定义，分别表示支持动态的单播与多播，同时可以支持含参数个数的宏：\u003Ccode\u003EDECLARE_DYNAMIC_DELEGATE_&lt;Num&gt;Param\u003C\u002Fcode\u003E定义,Num表示函数参数个数 \u003C\u002Fi\u003E \u003C\u002Fli\u003E\u003Cli data-pid=\"zf15iD3k\"\u003E\u003Cb\u003ETBaseDynamicDelegate\u003C\u002Fb\u003E的基类是\u003Ccode\u003ETScriptDelegate&lt;TWeakPtr&gt;\u003C\u002Fcode\u003E,本身无成员，接口也比较简单，基本不用分析。内部通过\u003Ccode\u003E__Internal_BindDynamic\u003C\u002Fcode\u003E函数进行注册绑定，但实际被宏\u003Ccode\u003EBindDynamic\u003C\u002Fcode\u003E包装，我们使用宏\u003Ccode\u003EBindDynamic\u003C\u002Fcode\u003E来进行注册。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Etypename\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETWeakPtr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFWeakObjectPtr\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003ETScriptDelegate\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUObjectTemplate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EProcessDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParameters\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprotected\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003ETWeakPtr\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"n\"\u003EFName\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFunctionName\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"o9pgaaFB\"\u003E TScriptDelegate默认的成员Object是UObject的弱引用智能指针，FunctionName是我们要绑定的函数名称，注意这个函数一定要是UFunction标记或者蓝图中的函数，简言之就是该函数能能序列化。当注册绑定时会将Object与FunctionName进行赋值。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 虽然我们的执行在派生类被\u003Ccode\u003EExecute()\u003C\u002Fcode\u003E函数包装了一次，详情见\u003Cb\u003EDelegate.h\u003C\u002Fb\u003E文件中\u003Ccode\u003EFUNC_DECLARE_DYNAMIC_DELEGATE\u003C\u002Fcode\u003E,\u003Ccode\u003EFUNC_DECLARE_DYNAMIC_DELEGATE_RETVAL\u003C\u002Fcode\u003E两个宏，宏里面的展开式进行了安全检测。不过话说回来，但真正的执行，还是会调用到基类的\u003Ccode\u003EProcessDelegate\u003C\u002Fcode\u003E函数，执行的时间，会进行查找，所以效率上来说，是前面两种C++版效率低一些。 \u003C\u002Fblockquote\u003E\u003Cul\u003E\u003Cli data-pid=\"9HvySPXz\"\u003E\u003Cb\u003ETBaseDynamicMulticastDelegate\u003C\u002Fb\u003E的基类是\u003Ccode\u003ETMulticastScriptDelegate&lt;TWeakPtr&gt;\u003C\u002Fcode\u003E,本身无成员，接口也比较简单，基本不用分析。内部通过\u003Ccode\u003E__Internal_AddDynamic\u003C\u002Fcode\u003E和\u003Ccode\u003E__Internal_AddUniqueDynamic\u003C\u002Fcode\u003E函数进行注册绑定,后面的能够确保唯一性，但实际被宏\u003Ccode\u003EAddDynamic\u003C\u002Fcode\u003E和\u003Ccode\u003EAddUniqueDynamic\u003C\u002Fcode\u003E包装，我们使用宏\u003Ccode\u003EAddDynamic\u003C\u002Fcode\u003E和\u003Ccode\u003EAddUniqueDynamic\u003C\u002Fcode\u003E来进行注册。移除的话内部使用\u003Ccode\u003E__Internal_RemoveDynamic\u003C\u002Fcode\u003E，同样被宏\u003Ccode\u003ERemoveDynamic\u003C\u002Fcode\u003E包装，这才是真正调用的地方。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUObjectTemplate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EProcessMulticastDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParameters\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Epublic\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Etypedef\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETArray\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ETScriptDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETWeakPtr\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFInvocationList\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"k\"\u003Etemplate\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"k\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"nc\"\u003EUObjectTemplate\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EProcessDelegate\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EParameters\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"k\"\u003Eprotected\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"k\"\u003Emutable\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EFInvocationList\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EInvocationList\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E \n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"3Gne6Ruj\"\u003E 默认的成员InvocationList是\u003Ccode\u003ETArray&lt; TScriptDelegate&lt;TWeakPtr&gt; &gt;\u003C\u002Fcode\u003E是一个数组，做法也等同TMulticastDelegate，不再累述了。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E 虽然我们的执行在派生类被\u003Ccode\u003EBroadcast()\u003C\u002Fcode\u003E函数包装了一次，详情见\u003Cb\u003EDelegate.h\u003C\u002Fb\u003E文件中\u003Ccode\u003EFUNC_DECLARE_DYNAMIC_MULTICAST_DELEGATE\u003C\u002Fcode\u003E宏，宏里面的展开式进行了安全检测。不过话说回来，但真正的执行，还是会调用到基类的\u003Ccode\u003EProcessMulticastDelegate\u003C\u002Fcode\u003E函数。 \u003C\u002Fblockquote\u003E\u003Cul\u003E\u003Cli data-pid=\"VoV4CRDN\"\u003E关于序列化，因为基类TScriptDelegate，都重载了\u003Ccode\u003E&lt;&lt;\u003C\u002Fcode\u003E操作符。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003E结语\u003C\u002Fh2\u003E\u003Cp data-pid=\"hXuj8dMQ\"\u003E到此我们已经全部分析完毕，可能有纰漏，欢迎联系rayhunter,未经许可，禁止转载。\u003C\u002Fp\u003E\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F427575094\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\"internal\"\u003EUE4反射基础一：揭秘UBT生成代码、UObject注册、UClass及CDO生成\u003C\u002Fa\u003E\u003Cp\u003E\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19824201","type":"topic","id":"19824201","name":"虚幻引擎"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19584970","type":"topic","id":"19584970","name":"C++"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19557297","type":"topic","id":"19557297","name":"代理"}],"voteupCount":62,"voting":0,"heavyUpStatus":"allow_heavy_up","column":{"description":"","canManage":false,"intro":"","isFollowing":false,"urlToken":"c_1405665457299308544","id":"c_1405665457299308544","articlesCount":19,"acceptSubmission":false,"title":"游戏引擎","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1405665457299308544","commentPermission":"all","created":1627916761,"updated":1627916761,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpica.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de.jpg?source=172ae18b","uid":"555417237251469312","userType":"people","isFollowing":false,"urlToken":"zhou-zhi-long-16","id":"7b5e1d9541265b56c58a48969d6b4e4d","description":"只会一点点C++，一点点汇编，一点点图形学......","name":"rayhunter","isAdvertiser":false,"headline":"C++元编程低能儿,你们别光收藏，也要点赞啊！","gender":1,"url":"\u002Fpeople\u002F7b5e1d9541265b56c58a48969d6b4e4d","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":4,"type":"column"},"commentCount":3,"contributions":[{"id":36976059,"state":"accepted","type":"first_publish","column":{"description":"","canManage":false,"intro":"","isFollowing":false,"urlToken":"c_1405665457299308544","id":"c_1405665457299308544","articlesCount":19,"acceptSubmission":false,"title":"游戏引擎","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1405665457299308544","commentPermission":"all","created":1627916761,"updated":1627916761,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpica.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de.jpg?source=172ae18b","uid":"555417237251469312","userType":"people","isFollowing":false,"urlToken":"zhou-zhi-long-16","id":"7b5e1d9541265b56c58a48969d6b4e4d","description":"只会一点点C++，一点点汇编，一点点图形学......","name":"rayhunter","isAdvertiser":false,"headline":"C++元编程低能儿,你们别光收藏，也要点赞啊！","gender":1,"url":"\u002Fpeople\u002F7b5e1d9541265b56c58a48969d6b4e4d","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":4,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":true,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"favlistsCount":139,"isNormal":true,"status":0,"shareText":"一文理解透UE委托Delegate - 来自知乎专栏「游戏引擎」，作者: rayhunter https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":9,"hasColumn":true,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"cryFaceCount":0,"cryFaceHasSet":false,"hugCount":0,"hugHasSet":false,"likeCount":9,"likeHasSet":false,"onlookerCount":0,"onlookerHasSet":false},"abParam":{"shangyebiaoshi":"1"},"attachedInfo":"kgIkCgkxOTAzNzMwNDYSCTQ2MDA5MjkwMRgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":true}},"canReference":false,"reactionInstruction":{},"entityWords":[{"name":"const成员函数","mention":"const成员函数","matchorder":1,"begin":14058,"end":14067,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJZChFjb25zdOaIkOWRmOWHveaVsBIETWF0aBjqbSDzbSgBNQAAAAA6B2FydGljbGVAAEgAUiQ5MDMxN2Q2ZS01Y2VhLTQ5ODgtYTZmYy01ZDE2YTJjNjI5Mjg=","isOnAB":false,"isNatural":1},{"name":"纯虚函数","mention":"纯虚函数","matchorder":1,"begin":50845,"end":50849,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJWCgznuq\u002FomZrlh73mlbASBE1hdGgYnY0DIKGNAygBNQAAAAA6B2FydGljbGVAAEgAUiQ5MDMxN2Q2ZS01Y2VhLTQ5ODgtYTZmYy01ZDE2YTJjNjI5Mjg=","isOnAB":false,"isNatural":1},{"name":"静态成员函数","mention":"静态成员函数","matchorder":1,"begin":12590,"end":12596,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJaChLpnZnmgIHmiJDlkZjlh73mlbASBE1hdGgYrmIgtGIoATUAAAAAOgdhcnRpY2xlQABIAFIkOTAzMTdkNmUtNWNlYS00OTg4LWE2ZmMtNWQxNmEyYzYyOTI4","isOnAB":false,"isNatural":1},{"name":"模板函数","mention":"模板函数","matchorder":1,"begin":36524,"end":36528,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJbCgzmqKHmnb\u002Flh73mlbASCU90aGVyVGVybRisnQIgsJ0CKAE1AAAAADoHYXJ0aWNsZUAASABSJDkwMzE3ZDZlLTVjZWEtNDk4OC1hNmZjLTVkMTZhMmM2MjkyOA==","isOnAB":false,"isNatural":1},{"name":"类型擦除","mention":"类型擦除","matchorder":1,"begin":15352,"end":15356,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0,"attachedInfoBytes":"sgJYCgznsbvlnovmk6bpmaQSCENvbXB1dGVyGPh3IPx3KAE1AAAAADoHYXJ0aWNsZUAASABSJDkwMzE3ZDZlLTVjZWEtNDk4OC1hNmZjLTVkMTZhMmM2MjkyOA==","isOnAB":false,"isNatural":1},{"name":"交互设计","mention":"交互设计","matchorder":1,"begin":14159,"end":14163,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0,"attachedInfoBytes":"sgJXCgzkuqTkupLorr7orqESB1Vua25vd24Yz24g024oATUAAAAAOgdhcnRpY2xlQABIAFIkOTAzMTdkNmUtNWNlYS00OTg4LWE2ZmMtNWQxNmEyYzYyOTI4","isOnAB":false,"isNatural":1},{"name":"类成员函数","mention":"类成员函数","matchorder":6,"begin":12698,"end":12703,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJXCg\u002FnsbvmiJDlkZjlh73mlbASBE1hdGgYmmMgn2MoBjUAAAAAOgdhcnRpY2xlQABIAFIkOTAzMTdkNmUtNWNlYS00OTg4LWE2ZmMtNWQxNmEyYzYyOTI4","isOnAB":false,"isNatural":1},{"name":"lambda表达式","mention":"lambda表达式","matchorder":1,"begin":13171,"end":13180,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0,"attachedInfoBytes":"sgJcCg9sYW1iZGHooajovr7lvI8SCUNvbW1vZGl0eRjzZiD8ZigBNQAAAAA6B2FydGljbGVAAEgAUiQ5MDMxN2Q2ZS01Y2VhLTQ5ODgtYTZmYy01ZDE2YTJjNjI5Mjg=","isOnAB":false,"isNatural":1},{"name":"payload","mention":"payload","matchorder":2,"begin":12087,"end":12094,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJUCgdwYXlsb2FkEglPdGhlclRlcm0Yt14gvl4oAjUAAAAAOgdhcnRpY2xlQABIAFIkOTAzMTdkNmUtNWNlYS00OTg4LWE2ZmMtNWQxNmEyYzYyOTI4","isOnAB":false,"isNatural":1},{"name":"虚基类","mention":"虚基类","matchorder":1,"begin":50943,"end":50946,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0,"attachedInfoBytes":"sgJXCgnomZrln7rnsbsSCENvbXB1dGVyGP+NAyCCjgMoATUAAAAAOgdhcnRpY2xlQABIAFIkOTAzMTdkNmUtNWNlYS00OTg4LWE2ZmMtNWQxNmEyYzYyOTI4","isOnAB":false,"isNatural":1},{"name":"uint64","mention":"uint64","matchorder":1,"begin":48641,"end":48647,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJQCgZ1aW50NjQSBE1hdGgYgfwCIIf8AigBNQAAAAA6B2FydGljbGVAAEgAUiQ5MDMxN2Q2ZS01Y2VhLTQ5ODgtYTZmYy01ZDE2YTJjNjI5Mjg=","isOnAB":false,"isNatural":1},{"name":"invoke","mention":"invoke","matchorder":1,"begin":44955,"end":44961,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJVCgZpbnZva2USCU90aGVyVGVybRib3wIgod8CKAE1AAAAADoHYXJ0aWNsZUAASABSJDkwMzE3ZDZlLTVjZWEtNDk4OC1hNmZjLTVkMTZhMmM2MjkyOA==","isOnAB":false,"isNatural":1}]}},"columns":{"c_1405665457299308544":{"description":"","canManage":false,"intro":"","isFollowing":false,"urlToken":"c_1405665457299308544","id":"c_1405665457299308544","articlesCount":19,"acceptSubmission":false,"title":"游戏引擎","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1405665457299308544","commentPermission":"all","created":1627916761,"updated":1627916761,"imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpica.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de.jpg?source=172ae18b","uid":"555417237251469312","userType":"people","isFollowing":false,"urlToken":"zhou-zhi-long-16","id":"7b5e1d9541265b56c58a48969d6b4e4d","description":"只会一点点C++，一点点汇编，一点点图形学......","name":"rayhunter","isAdvertiser":false,"headline":"C++元编程低能儿,你们别光收藏，也要点赞啊！","gender":1,"url":"\u002Fpeople\u002F7b5e1d9541265b56c58a48969d6b4e4d","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F7353717666ea56b82d1b39a5d6acf7de_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":4,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{},"zvideos":{},"zvideoContributions":{},"briefs":{},"eduCourses":{}},"currentUser":"9b939bd116cd066ce372288d50538da8","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{"params":[{"id":"vessay_v2_sdk","type":"Int","value":"1","layerId":"Qtkm"},{"id":"pc_ppt_publish","type":"Int","value":"1","layerId":"pc_ppt_publish"},{"id":"helpcenter_pc","type":"Int","value":"1","layerId":"helpcenter_pc"},{"id":"pc_comment","type":"Int","value":"1","layerId":"EsOR"},{"id":"pc_follow","type":"Int","value":"1","layerId":"pc_follow"},{"id":"pc_player_rp","type":"Int","value":"0","layerId":"pc_player_rp"},{"id":"use_biz_comment","type":"Int","value":"1","layerId":"use_biz_comment"}],"experiments":[{"expId":"pc_ppt_publish-2_v2","expPrefix":"pc_ppt_publish","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"helpcenter_pc-2_v11","expPrefix":"helpcenter_pc","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"pc_comment-2_v4","expPrefix":"pc_comment","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"pc_follow-3_v5","expPrefix":"pc_follow","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"pc_player_rp-1_v1","expPrefix":"pc_player_rp","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"use_biz_comment-2_v5","expPrefix":"use_biz_comment","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false}],"chains":[{"chainId":"_all_"}],"encodedParams":"CtQBGwA\u002FAEcAtABpAWoBdAE7AswC1wLYAk8DUAOgA6EDogO3A\u002FMD9AMzBIwEjQSmBNYEEQUyBVEFiwWMBZ4FMAYxBn4G6wYnB3cHeAfYB9wH3QcnCGcIdAh2CHkIxQjaCD8JQglUCVUJYAmNCcMJxAnFCcYJxwnICckJygnLCcwJ0QnlCfEJ9AkECkkKZQprCpgKpQqpCr4KxArUCt0K7Qr9Cv4KKQs7CzwLQwtGC3ELdguFC4cLjQu5C8AL1wvgC+UL5gssDDgMcQyPDKwMwwzJDPgMtQsSagAAAAEAAQACAwAAAAAAAAAAAAAABAQABAABAQAAAQABAAAAAAAAAgIABAAABgAAAAEAAAAAAAAAAAAAAAAAAAAABwMAAAAAAQAAAAEBAQAHAAEBAAEAAAAAAAUAAAIAAAAGAQAAAAAAAAM="},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F105.0.0.0 Safari\u002F537.36 Edg\u002F105.0.1343.27"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F460092901","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F460092901","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"https:\u002F\u002Fwww.bing.com\u002F","xUDId":"ADAds6PjzxOPTmBuqv67KXaBAfLOjNtmuyk=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"上海","countryName":"中国","regionName":"上海","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"newRights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{},"videoSupport":{},"textBenefit":{},"mcnManage":{},"tasks":{},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"scoreInfo":{},"recentlyCreated":[],"analysis":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"announcement":{},"bannerList":[],"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"creatorsRecommendInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"income":{"aggregation":{}}},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"concernedUpvoters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"room":{"meta":{},"isFetching":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"c_1405665457299308544",null]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false}},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"club":{},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]}},"fetchHost":"www.zhihu.com","subAppName":"column"}</script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/vendor.4bb309fcb0b4b803488b.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_09e9ad9b.7ecaffb5e5e7b964c1e5.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_330004dc.c475248f53a2a41d1aaa.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_79b5cf47.2e14e141df7aa7169c59.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_29107295.cbb422fac870dbff6194.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.lib_0ad37f8a.adad3b5ab7b95dd51ffc.js.download"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/column.app.1552bd8b4930aa16be5e.js.download"></script><script defer="" src="./一文理解透UE委托Delegate - 知乎_files/aria.js.download"></script><script src="./一文理解透UE委托Delegate - 知乎_files/hm.js.download" async=""></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/zap.js.download"></script><script src="./一文理解透UE委托Delegate - 知乎_files/push.js.download"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/js"></script><script crossorigin="" src="./一文理解透UE委托Delegate - 知乎_files/emoticon.js.download"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete20-0" id="Popover19-toggle" aria-haspopup="true" aria-owns="Popover19-content" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="ArrowUpDown24" data-old-api="Select" fill="#afbdcf" class="Zi Zi--Select"><path d="M12.53 3.47a.75.75 0 00-1.06 0l-5 5a.75.75 0 001.06 1.06L12 5.06l4.47 4.47a.75.75 0 101.06-1.06l-5-5zm-5 11a.75.75 0 00-1.06 1.06l5 5a.75.75 0 001.06 0l5-5a.75.75 0 10-1.06-1.06L12 18.94l-4.47-4.47z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>