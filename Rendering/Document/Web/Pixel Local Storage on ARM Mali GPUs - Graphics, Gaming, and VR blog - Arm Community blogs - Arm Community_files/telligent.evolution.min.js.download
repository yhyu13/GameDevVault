(function(){var ca,u;(function(g){var f={},k=function(m){var n=f[m];if(n==g)throw"Module not defined or loaded: "+m;if(n.compiled)return n.compiled;var e=[];if(n.dependencies&&0<n.dependencies.length)for(var d=0;d<n.dependencies.length;d++)e.push(k(n.dependencies[d]));n.compiled=n.factory.apply(this,e.concat(n.extraArguments));if(!n.compiled)throw"Module defined but not loadable: "+m;return n.compiled};ca=function(f,n){var e=f,d=n,c=2;e.splice||(d=e,e=g,c--);for(var c=Array.prototype.slice.call(arguments,
c),b=[],a=0;a<e.length;a++)b.push(k(e[a]));d.apply(this,b.concat(c))};u=function(k,n,e){var d=n,c=e,b=3;d.splice||(c=d,d=g,b--);b=Array.prototype.slice.call(arguments,b);f[k]={dependencies:d,factory:c,extraArguments:b||[]}}})();u("components","component.bookmark component.collapseexpand component.like component.links component.moderate component.page component.rate component.searchresult component.tag component.theater component.webpreview component.tourtip component.viewhtml component.previewhtml component.masonry component.resizedimage component.tip component.select component.poll component.convertcontent component.feature component.forumvotes component.forumqualityvotes component.vote component.squeezetext component.code component.loading component.presentcontent component.presentservice component.userpresence component.agodate component.html component.scheduledfile".split(" "),
function(){return{}});u("component.agodate",["module.ui"],function(g,f,k,m){function n(c){c=f(c);c.html(d.formatAgoDate(d.parseDate(c.attr("data-dateutc"))))}function e(){f(".ui-agodate").each(function(){n(this)})}var d=f.telligent.evolution;f.telligent.evolution.ui.components.agodate={setup:function(){k.setInterval(e,15E3)},add:function(c,b){n(c)}};return{}},jQuery,window);u("component.bookmark",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.bookmark={setup:function(){},add:function(g,
e){g.empty();var d={contentId:e.contentid,contentTypeId:e.contenttypeid,typeId:e.bookmarktypeid,initialState:"true"==e.value,contentTypeName:e.contenttypename,onBookmark:function(c,b,a,l){f.telligent.evolution.post({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}&ContentTypeId={ContentTypeId}"+(a?"&TypeId="+a:""),data:{ContentId:c,ContentTypeId:b},dataType:"json",success:function(a){l()}})},onUnbookmark:function(c,b,a,l){f.telligent.evolution.del({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/bookmark.json?ContentId={ContentId}"+(a?"&TypeId="+a:""),data:{ContentId:c},dataType:"json",success:function(a){l()}})}};e.configuration.deleteBookmarkText&&(d.deleteBookmarkText=e.configuration.deleteBookmarkText);e.configuration.addBookmarkText&&(d.addBookmarkText=e.configuration.addBookmarkText);e.configuration.processingText&&(d.processingText=e.configuration.processingText);e.configuration.addBookmarkCssClass&&(d.addBookmarkCssClass=e.configuration.addBookmarkCssClass);e.configuration.deleteBookmarkCssClass&&
(d.deleteBookmarkCssClass=e.configuration.deleteBookmarkCssClass);e.configuration.processingCssClass&&(d.processingCssClass=e.configuration.processingCssClass);f(g).evolutionBookmark(d)}};return{}},jQuery,window);u("component.code",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.code={setup:function(){},add:function(g,e){var d={};f(g).data("_code_init")||(f(g).data("_code_init",!0),e.mode&&(d.mode=e.mode),e.theme!==m&&(d.theme=e.theme),e.minlines!==m&&(d.minLines=parseInt(e.minlines,
10)),e.maxlines!==m&&(d.maxLines=parseInt(e.maxlines,10)),e.readonly&&(d.readOnly="true"===e.readonly?!0:!1),e.gutter&&(d.gutter="true"===e.gutter?!0:!1),e.wordwrap&&(d.wordWrap="true"===e.wordwrap?!0:!1),e.enablefullscreen&&(d.enableFullScreen="false"===e.enablefullscreen?!1:!0),e.sourcecomparison&&(d.sourceComparison=sourceComparison),f(g).evolutionCodeEditor(d))}};return{}},jQuery,window);u("component.collapseexpand",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.collapseexpand=
{setup:function(){},add:function(g,e){var d=f("<a></a>").attr({href:"#"}).text(e.collapsetext),c=!1;d.on("click",function(){c?(g.slideUp(),d.text(e.collapsetext)):(g.slideDown(),d.text(e.expandtext));c=!c;return!1});g.removeClass().before(d).hide()}};return{}},jQuery,window);u("component.convertcontent",["module.ui","lib.util"],function(g,f,k,m,n){k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=
k.telligent.evolution.ui.components||{};k.telligent.evolution.ui.components.convertcontent={setup:function(){},add:function(e,d){var c=k('<a href="#">'+d.label+"</a>");k(e).empty().append(c);c.on("click.convertcontent",function(b){b.preventDefault();m.location="#_cptype=panel&_cpcontexttype=Explicit&_cppanelid=63f2015f-0f61-49e0-ac07-598d70cdcbff&sourceContentId="+d.sourcecontentid+"&sourceContentTypeId="+d.sourcecontenttypeid;return!1})}};return{}},jQuery,window);u("component.feature",["module.ui"],
function(g,f,k,m){f.telligent.evolution.messaging.subscribe("ui-feature",function(g){(g.typeId?f('.ui-feature[data-contentid="'+g.contentId+'"][data-contenttypeid="'+g.contentTypeId+'"][data-typeid="'+g.typeId+'"]'):f('.ui-feature[data-contentid="'+g.contentId+'"][data-contenttypeid="'+g.contentTypeId+'"]')).attr("data-value",g.value.toString())});f.telligent.evolution.ui.components.feature={setup:function(){},add:function(g,e){g.empty();var d={contentId:e.contentid,contentTypeId:e.contenttypeid,
typeId:e.typeid,panelUrl:e.panelurl,initialState:"true"==e.value,contentTypeName:e.contenttypename};e.configuration.editFeatureText&&(d.editFeatureText=e.configuration.editFeatureText);e.configuration.addFeatureText&&(d.addFeatureText=e.configuration.addFeatureText);e.configuration.processingText&&(d.processingText=e.configuration.processingText);e.configuration.addFeatureCssClass&&(d.addFeatureCssClass=e.configuration.addFeatureCssClass);e.configuration.editFeatureCssClass&&(d.editFeatureCssClass=
e.configuration.editFeatureCssClass);e.configuration.processingCssClass&&(d.processingCssClass=e.configuration.processingCssClass);f(g).evolutionFeature(d)}};return{}},jQuery,window);u("component.forumqualityvotes",["module.ui","module.messaging"],function(g,f,k,m,n){function e(a){var l=k.extend({},b.defaults,a||{}),d=k.telligent.evolution.template.compile(l.votersTemplate),e=k.telligent.evolution.template.compile(l.votersPopupTemplate),q=function(a,b,h){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/forums/threads/{ThreadId}/votes.json",data:{ThreadId:a.id,VoteType:"Quality",PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"}).then(function(a){a.Votes=a.ForumThreadVotes;k.telligent.evolution.batch(function(){k.each(a.Votes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).then(function(a){b.userAvatarHtml=
a.Html})})}).then(function(){h({voters:k.map(a.Votes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})})},h=function(a,b){var h=0,g=k(d(k.extend(a,{noVotesText:c.noVotesText}))),f=k.telligent.evolution.ui.data(k(b).closest(l.delegatedSelector)),n=k(e({voters:g,hasMorePages:a.hasMorePages,showMoreText:l.modalShowMoreText})),z=n.find("ul"),A=n.find(".show-more");z.html(g);A.on("click",
function(a){a.preventDefault();h++;q(f,h,function(a){z.append(d(a));a.hasMorePages?A.show():A.hide();z.scrollTop(z[0].scrollHeight)})});k.glowModal({title:l.modalTitleText,html:n,width:450,height:"100%"})};(function(){k(l.containerSelector).on("click",l.popupSelector,function(a){a.preventDefault();var b=k(this);a=k.telligent.evolution.ui.data(k(b).closest(l.delegatedSelector));q(a,0,function(a){h(a,b)});return!1})})()}function d(a){return k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a,VoteType:"Quality"}}).then(function(a){return null==a.ForumThreadVote?null:a.ForumThreadVote.Value})}var c={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',voteTemplate:' <div class="thread-vote updownvote">  \t  <span class="vote-indicator ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= tipTextThread %></span>      <a href="#" class="vote up ui-tip <% if(voted == "true") { %>selected<% } %>" data-tip="<%= upvoteText %>" data-messagename="ui.forumqualityvotes.vote.message" data-threadid="<%= id %>" data-value="true"><%= upvoteText %></a>      <span class="score ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= scoreformatted %></span>      <a href="#" class="vote down ui-tip <% if(voted == "false") { %>selected<% } %>" data-tip="<%= downvoteText %>" data-messagename="ui.forumqualityvotes.vote.message" data-threadid="<%= id %>" data-value="false"><%= downvoteText %></a>  </div> ',
anonymousVoteTemplate:' <div class="thread-vote updownvote">  \t  <span class="vote-indicator ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= tipTextThread %></span>      <a href="<%= loginurl %>" class="vote up ui-tip" data-tip="<%= logintext %>"><%= logintext %></a>      <span class="score ui-tip voter-popup" data-tip="<%= tipTextThread %>"><%= scoreformatted %></span>      <a href="<%= loginurl %>" class="vote down ui-tip" data-tip="<%= logintext %>"><%= logintext %></a>  </div> ',noVotesText:"No Votes",
modalTitleText:"People who voted on this thread",tipTextThread:"View Voters",modalShowMoreText:"More",containerSelector:".content-fragment",delegatedSelector:".ui-forumqualityvotes",popupSelector:".voter-popup",upVoteText:"Vote Up",downVoteText:"Vote Down",logintext:"Login to vote on this thread",loginurl:""},b={setup:function(){e({})},add:function(a,l){a=k(this);var p=k.extend({},b.defaults,l||{});l.loginurl&&""!=l.loginurl?(anonymousVoteTemplate=k.telligent.evolution.template.compile(p.anonymousVoteTemplate),
a.html(k(anonymousVoteTemplate(k.extend(l,{id:l.id,tipTextThread:c.tipTextThread,score:l.score,scoreformatted:0<l.score?"+"+l.score:l.score,logintext:c.logintext,loginurl:l.loginurl}))))):(voteTemplate=k.telligent.evolution.template.compile(p.voteTemplate),a.html(k(voteTemplate(k.extend(l,{id:l.id,voted:l.voted,tipTextThread:c.tipTextThread,upvoteText:p.upVoteText,score:l.score,scoreformatted:0<l.score?"+"+l.score:l.score,downvoteText:p.downVoteText})))),f.subscribe("ui.forumqualityvotes.vote.message",
function(a){a=k(a.target);k.fn.evolutionTip.hide();a.hasClass("selected")?k.telligent.evolution.del({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a.data("threadid"),VoteType:"Quality"}}):k.telligent.evolution.post({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/vote.json",data:{ThreadId:a.data("threadid"),VoteType:"Quality",Value:a.data("value")}})}));f.subscribe("forumThread.voted",function(b){if(a.data("id")==
b.threadId&&"Quality"==b.voteType){var l=a;if(0<l.length){var h=l.find(".thread-vote .vote.up"),c=l.find(".thread-vote .vote.down"),p=l.find(".thread-vote .score"),e=0<b.count?"+"+b.count:b.count;p.html(e);l.attr("data-score",e).attr("data-scoreformatted",e);d(b.threadId).then(function(a){null==a?(h.removeClass("selected"),c.removeClass("selected"),l.attr("data-value","")):a?(h.addClass("selected"),c.removeClass("selected"),l.attr("data-value",a)):a||(h.removeClass("selected"),c.addClass("selected"),
l.attr("data-value",a))})}}});p=k.map((l.presentservices||"").split(","),function(a){a=a.split("|");var b={};2<=a.length&&(b={ContentId:a[0],ContentTypeId:a[1]},2<a.length&&(b.TypeId=a[2]));return b});k.telligent.evolution.presence.register({node:a.get(0),contents:p})},defaults:c};k.telligent.evolution.ui.components.forumqualityvotes=b;return{}},jQuery,window);u("component.forumvotes",["module.ui","module.messaging"],function(g,f,k,m,n){function e(b){var a=k.extend({},c.defaults,b||{}),l=k.telligent.evolution.template.compile(a.votersTemplate),
p=k.telligent.evolution.template.compile(a.votersPopupTemplate),e=function(a,b,l){("thread"==a.type?k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/{ThreadId}/votes.json",data:{ThreadId:a.id,PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"}):k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/forums/threads/replies/{ReplyId}/votes.json",
data:{ReplyId:a.id,PageSize:a.pageSize,PageIndex:b,SortBy:"Date",SortOrder:"Descending",PageSize:a.pageSize||20,PageIndex:b||0},cache:!1,dataType:"json"})).then(function(a){a.Votes=a.ForumThreadVotes||a.ForumReplyVotes;k.telligent.evolution.batch(function(){k.each(a.Votes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).then(function(a){b.userAvatarHtml=
a.Html})})}).then(function(){l({voters:k.map(a.Votes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})})},q=function(b,c){var q=0,g=k(l(k.extend(b,{noVotesText:d.noVotesText}))),r=k.telligent.evolution.ui.data(k(c).closest(a.delegatedSelector)),f=k(p({voters:g,hasMorePages:b.hasMorePages,showMoreText:a.modalShowMoreText})),n=f.find("ul"),z=f.find(".show-more");n.html(g);z.on("click",
function(a){a.preventDefault();q++;e(r,q,function(a){n.append(l(a));a.hasMorePages?z.show():z.hide();n.scrollTop(n[0].scrollHeight)})});k.glowModal({title:"thread"==r.type?a.modalTitleTextThread:a.modalTitleTextReply,html:f,width:450,height:"100%"})};(function(){k(a.containerSelector).on("click",a.delegatedSelector,function(b){b.preventDefault();var l=k(this);b=k.telligent.evolution.ui.data(k(l).closest(a.delegatedSelector));e(b,0,function(a){q(a,l)});return!1})})()}var d={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',noVotesText:"No Votes",modalTitleTextThread:"People who had this question",modalTitleTextReply:"People helped by this answer",modalShowMoreText:"More",containerSelector:".content-fragment",delegatedSelector:".ui-forumvotes"},
c={setup:function(){e({})},add:function(b,a){b.attr("data-tip","thread"==a.type?c.defaults.modalTitleTextThread:c.defaults.modalTitleTextReply).addClass("ui-tip");f.subscribe("ui-forumvote",function(l){if(l.id==a.id&&l.type==a.type){var c=0<l.count?"+"+l.count:l.count;k(b).html(c).attr("data-count",c);l.voted?k(b).attr("data-voted","true"):k(b).attr("data-voted","false")}});f.subscribe("forumThread.voted",function(a){a.threadId==k(b).data("id")&&"Interest"==a.voteType&&(a=0<a.count?"+"+a.count:a.count,
k(b).html(a).attr("data-count",a))});var l=k.map((a.presentservices||"").split(","),function(a){a=a.split("|");var b={};2<=a.length&&(b={ContentId:a[0],ContentTypeId:a[1]},2<a.length&&(b.TypeId=a[2]));return b});k.telligent.evolution.presence.register({node:b.get(0),contents:l})},defaults:d};k.telligent.evolution.ui.components.forumvotes=c;return{}},jQuery,window);u("component.html",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.html={setup:function(){},add:function(g,e){var d=
{};f(g).is("textarea")&&!f(g).data("_html_init")&&(f(g).data("_html_init",!0),e.width&&(d.width=e.width),e.height&&(d.height=e.height),e.contenttypeid&&(d.contentTypeId=e.contenttypeid),e.placeholder&&(d.placeholder=e.placeholder),e.enablefileupload&&(d.enableFileUpload="true"===e.enablefileupload?!0:!1),e.submittable&&(d.submittable="true"===e.submittable?!0:!1),e.entertosubmitprompt&&(d.enterToSubmitPrompt=e.entertosubmitprompt),e.submitlabel&&(d.submitLabel=e.submitlabel),e.beforesubmithtml&&(d.beforeSubmitHtml=
e.beforesubmithtml),e.aftersubmithtml&&(d.afterSubmitHtml=e.aftersubmithtml),e.autoresize&&(d.autoResize="true"===e.autoresize?!0:!1),e.enableentertosubmittoggle&&(d.enableEnterToSubmitToggle="true"===e.enableentertosubmittoggle?!0:!1),f(g).evolutionHtmlEditor(d))}};return{}},jQuery,window);u("component.like",["module.ui","module.messaging"],function(g,f,k,m,n){var e=function(d,c,b,a){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:d,
ContentTypeId:c,TypeId:b,SortBy:"Date",SortOrder:"Descending",PageSize:1,PageIndex:0},cache:!1,dataType:"json",success:function(b){a.call(this,{count:b.TotalCount,latestLike:0<b.Likes.length?b.Likes[0]:null})}})};k.telligent.evolution.messaging.subscribe("ui.like",function(d){(d.typeId?k('.ui-like[data-contentid="'+d.contentId+'"][data-contenttypeid="'+d.contentTypeId+'"][data-configuration*="LikeTypeId='+d.typeId+'"]'):k('.ui-like[data-contentid="'+d.contentId+'"][data-contenttypeid="'+d.contentTypeId+
'"]')).attr("data-initialstate",d.liked.toString()).attr("data-initialcount",d.count.toString()).attr("data-initialmessage",d.message.toString())});k.telligent.evolution.ui.components.like={setup:function(){k.fn.evolutionLike.delegatePopups({containerSelector:".content-fragment",delegatedSelector:".ui-like",onList:function(d,c,b,a,l,p){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:d,ContentTypeId:c,TypeId:b,SortBy:"Date",SortOrder:"Descending",
PageSize:l||20,PageIndex:p||0},cache:!1,dataType:"json",success:function(b){k.telligent.evolution.batch(function(){k.each(b.Likes,function(a,b){k.telligent.evolution.get({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.User.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).then(function(a){b.userAvatarHtml=a.Html})})}).then(function(){a({likers:k.map(b.Likes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarHtml:a.userAvatarHtml}}),
hasMorePages:(b.PageIndex+1)*b.PageSize<b.TotalCount})})}})},onOptions:function(d){d=k.telligent.evolution.ui.data(d);return{contentId:d.contentid,contentTypeId:d.contenttypeid,typeId:d.configuration.LikeTypeId}}})},add:function(d,c){var b="true"===c.readonly;k(d).evolutionLike({contentId:c.contentid,contentTypeId:c.contenttypeid,initialState:c.initialstate,initialMessage:c.initialmessage,initialCount:c.initialcount,format:b?c.format.replace("{toggle}",""):c.format,typeId:c.configuration.LikeTypeId,
onLike:function(a,b,c,d){k.fn.evolutionTip.hide();var q={ContentId:a,ContentTypeId:b};null!==c&&0<c.length&&(q.TypeId=c);k.telligent.evolution.post({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:q,cache:!1,dataType:"json",success:function(h){e(a,b,c,d)}})},onUnlike:function(a,b,c,d){k.fn.evolutionTip.hide();var q={ContentId:a};null!==c&&0<c.length&&(q.TypeId=c);k.telligent.evolution.del({url:k.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",data:q,cache:!1,
dataType:"json",success:function(h){e(a,b,c,d)}})}})}};return{}},jQuery,window);u("component.links",["module.ui","lib.dynamicLinks","lib.sheetProvider","lib.util"],function(g,f,k,m,n,e,d){function c(l,c,h){!0===l.data("linkshown")?(l.data("linkshown",!1),n.fn.uilinks.hide()):(n.telligent.evolution.messaging.publish(s.show),n(window).width()<w.minWidth?a(c,h):b(l,c))}function b(a,b){a.css({position:"relative "});for(var l=n(document.createElement("ul")),c=0;c<b.length;c++){var h=n(document.createElement("li"));
h.append(n(b[c].element).css("float","none").get(0));l.append(h)}v||(v=n("<div></div>").glowPopUpPanel({cssClass:"links-popup-panel",zIndex:1500,hideOnDocumentClick:!0,position:"updown"}));v.glowPopUpPanel("hide",!0).glowPopUpPanel("html",l).one("glowPopUpPanelShown",function(){a.data("linkshown",!0);var b=!1;l.on("mouseenter",function(){b=!0});l.on("glowDelayedMouseLeave",500,function(){b&&(n.fn.uilinks.hide(),a.data("linkshown",!1))})}).one("glowPopUpPanelHidden",function(){a.data("linkshown",!1)}).off(".uilinks").on("glowPopUpPanelShowing.uilinks",
function(b,l){a.addClass("links-expanded").attr("data-position",l.position)}).on("glowPopUpPanelHiding.uilinks",function(b,l){a.removeClass("links-expanded").attr("data-position","")}).glowPopUpPanel("show",a)}function a(a,b){var c=a.slice(0);c.push(b);k.actionSheet.show({links:n.map(c,function(a){return a.element})});k.actionSheet.content().on("click","a",function(a){k.actionSheet.hide()});b.element.on("click",function(a){a.preventDefault();k.actionSheet.hide();n.telligent.evolution.messaging.publish(s.hide);
return!1});var h=n.telligent.evolution.messaging.subscribe("sheet.closed",function(){n.each(a,function(a,b){l(n(b.element))});n.telligent.evolution.messaging.unsubscribe(h)})}function l(a){a.is('[class^="ui-"]')&&!a.hasClass("ui-tourtip")?a.empty().remove():a.detach()}function p(a,b,l){clearTimeout(a.reflowWaitTimeout);n(e).width()<b.width()?(a.reflowWaitCheckCount++,10>a.reflowWaitCheckCount&&(a.reflowWaitTimeout=setTimeout(function(){p(a,b,l)},250))):l.render()}function t(a,b){var d=a.find("> li, > ul > li"),
p=b.maxlinks,e=b.minlinks,v=null;a.removeClass("ui-links");var t={parent:a,links:[],onShowMore:function(a,b){c(v,a,b)}};p&&(t.maxLinks=parseInt(p,10));e&&(t.minLinks=parseInt(e,10));t.direction=b.direction;for(p=0;p<d.length;p++){var e=n(d[p]),g=e.children();l(g);var k=g.is("[data-selected]");g.is("[data-more]")?(v=g,t.moreLink={element:g,selected:k,className:e.get(0).className}):g.is("[data-cancel]")?t.cancelLink={element:g,selected:k,className:e.get(0).className}:t.links.push({element:g,selected:k,
className:e.get(0).className})}t.onLinksChange=function(b){n.telligent.evolution.messaging.publish(s.change,n.extend({},b,{target:a}))};a.empty();var G=new f(t);a.show();b.reflowWaitCheckCount=0;b.reflowWaitTimeout=null;var I=m.scrollParent(a);m.isPartiallyVisible(I,a)?q(a,b,G):(w.delayedInits.push({container:I,attempt:function(){return m.isInDom(a)?!b.finalized&&m.isPartiallyVisible(I,a)?(q(a,b,G),!1):!0:!1}}),h(I))}function q(a,b,l){b.finalized=!0;p(b,a,l);a.data("_dynamic_links",l);var c=function(b,
h){m.isInDom(a)?h.oldWidth!=h.newWidth&&l.render():n(window).off("resized",c)};b=a.closest(".layout-region");if(0<b.length)b.on("resized",c);else n(window).on("resized",c);var h=n.telligent.evolution.messaging.subscribe("mobile.orientationchange",function(){m.isInDom(a)?e.setTimeout(function(){l.render()},300):n.telligent.evolution.messaging.unsubscribe(h)})}function h(a){a.data("_delayed_uilinks_monitored")||(a.data("_delayed_uilinks_monitored",!0),a.on("scroll._delayed_uilinks",m.requestAnimationFrameThrottle(n.fn.uilinks.forceRender)),
a.on("resized._delayed_uilinks",m.requestAnimationFrameThrottle(n.fn.uilinks.forceRender)),w.delayedInitContainers.push(a))}var v,s={show:"ui.links.show",hide:"ui.links.hide",change:"ui.links.change"};n.fn.uilinks=function(){var a=this.data("_dynamic_links"),b=Array.prototype.slice.call(arguments,0),l=b[0];if(!a)return this;if("add"==l)return l=b[1],b=n.extend({},{className:null,selected:!1},b[2]||{}),a.addLink({element:l,className:b.className,selected:b.selected}).element;if("insert"==l){var l=b[1],
h=b[2],b=n.extend({},{className:null,selected:!1},b[3]||{});return a.addLink({element:l,className:b.className,selected:b.selected},h).element}if("remove"==l)a.removeLink(b[1]);else if("show"==l)b=b[1]||a.moreLink().element,c(b,a.links(!0),a.cancelLink());else if("hide"==l)n.fn.uilinks.hide();else if("resize"==l)a.resize();else{if("isVisible"==l)return l=b[1],a.isVisible(l);if("update"==l)return l=b[1],b=n.extend({},{index:null,className:null,selected:null},b[2]||{}),a.update(l,b);if("links"==l)return n.map(a.links(),
function(a){return a.element});if("list"==l)return b=b[1]||{},a.links(b&&!0===b.hidden);"reconfigure"==l&&(l=b[1]||{},h=g.data(this),b={},h.minlinks&&(b.minLinks=h.minlinks),h.maxlinks&&(b.maxLinks=h.maxlinks),h.direction&&(b.direction=h.direction),n.extend(b,l),a.reconfigure(b))}return this};n.fn.uilinks.hide=function(){n.telligent.evolution.messaging.publish(s.hide);k.actionSheet.hide();v&&v.glowPopUpPanel("hide")};n.fn.uilinks.forceRender=function(){for(var a=[],b=0;b<w.delayedInits.length;b++)w.delayedInits[b].attempt()||
a.push(b);a.reverse();for(b=0;b<a.length;b++)w.delayedInits.splice(a[b],1);if(0===w.delayedInits.length)for(a=0;a<w.delayedInitContainers.length;a++)w.delayedInitContainers[a].off("._delayed_uilinks").data("_delayed_uilinks_monitored",!1)};var w={setup:function(){w.delayedInits=[];w.delayedInitContainers=[]},add:function(a,b){a=n(a);t(a,b)},minWidth:570};n.telligent=n.telligent||{};n.telligent.evolution=n.telligent.evolution||{};n.telligent.evolution.ui=n.telligent.evolution.ui||{};n.telligent.evolution.ui.components=
n.telligent.evolution.ui.components||{};return n.telligent.evolution.ui.components.links=w},jQuery,window);u("component.loading",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.loading={setup:function(){},add:function(g,e){function d(){var c=g.css("color");if(c){var b=parseInt(e.width,10);isNaN(b)&&(b=48);var a=parseInt(e.height,10);isNaN(a)&&(a=48);var l=Math.min(b/3,a);g.css({display:"block",width:b+"px",height:a+"px",margin:"0 auto",padding:(a-l)/2+"px 0","text-align":"center",
"box-sizing":"border-box"}).html(f(['<div class="spinner"><div class="bounce1" style="width:',l,"px;height:",l,"px;background-color:",c,';"></div><div class="bounce2" style="width:',l,"px;height:",l,"px;background-color:",c,';"></div><div class="bounce3" style="width:',l,"px;height:",l,"px;background-color:",c,';"></div></div>'].join("")))}else k.setTimeout(function(){d()},50)}d()}};return{}},jQuery,window);u("component.masonry",["module.ui","plugin.evolutionMasonry"],function(g,f,k,m,n){g={setup:function(){},
add:function(e,d){k(e).data("_evolutionMasonry")||(k(e).data("_evolutionMasonry",!0),k(e).evolutionMasonry({columnClass:d.columnclass||k.fn.evolutionMasonry.defaults.columnClass}).css({visibility:"visible"}))}};k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=k.telligent.evolution.ui.components||{};return k.telligent.evolution.ui.components.masonry=g},jQuery,window);u("component.moderate",
["module.ui"],function(g,f,k,m){var n=function(e,d,c){f.telligent.evolution.post({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/abusereports.json",data:{ContentId:e,ContentTypeId:d},cache:!1,dataType:"json",success:function(b){c(b)}})};f.telligent.evolution.ui.components.moderate={setup:function(){},add:function(e,d){e=f(e);var c={contentId:d.contentid,contentTypeId:d.contenttypeid,supportsAbuse:"true"===d.supportsabuse,initialState:"true"===d.initialstate,onReport:n};if(d.configuration&&
d.configuration.AdditionalLinks){var b=JSON.parse(d.configuration.AdditionalLinks);if(!c.supportsAbuse&&0===b.length)return;c.onGetAdditionalLinks=function(a){a(b)}}else if(d.configuration&&d.configuration.AdditionalLinksUrl){if(!c.supportsAbuse&&0===d.configuration.AdditionalLinksUrl.length)return;c.onGetAdditionalLinks=function(a){f.telligent.evolution.get({url:d.configuration.AdditionalLinksUrl,cache:!1,dataType:"json",success:function(b){a(b.links||[])}})}}if(c.supportsAbuse||c.onGetAdditionalLinks)d.configuration&&
d.configuration.LinkClassName&&(c.linkClassName=d.configuration.LinkClassName),e.evolutionModerate(c)}};return{}},jQuery,window);u("component.page",["module.ui"],function(g,f,k,m){var n={};f.telligent.evolution.ui.components.page={setup:function(){},add:function(e,d){var c={currentPage:parseInt(d.currentpage,10),pageSize:parseInt(d.pagesize,10),totalItems:parseInt(d.totalitems,10),showPrevious:"undefined"===typeof d.configuration.ShowPrevious?!1:"true"===d.configuration.ShowPrevious,showNext:"undefined"===
typeof d.configuration.ShowNext?!1:"true"===d.configuration.ShowNext,showFirst:"undefined"===typeof d.configuration.ShowFirst?!0:"true"===d.configuration.ShowFirst,showLast:"undefined"===typeof d.configuration.ShowLast?!0:"true"===d.configuration.ShowLast,showIndividualPages:"undefined"===typeof d.configuration.ShowIndividualPages?!0:"true"===d.configuration.ShowIndividualPages,numberOfPagesToDisplay:"undefined"===typeof d.configuration.NumberOfPagesToDisplay?5:parseInt(d.configuration.NumberOfPagesToDisplay,
10),pageKey:d.pagekey,hash:d.configuration.Target,baseUrl:d.configuration.BaseUrl||window.location.href,template:"undefined"!==typeof d.configuration.Template?d.configuration.Template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
d.pagedcontenturl&&(n[d.pagedcontentpagingevent]={onPage:function(a,b,c){c=c||{};c[d.pagekey]=a;a=f.telligent.evolution.url.modify({url:d.pagedcontenturl,query:c});f.telligent.evolution.get({url:a,cache:!1,success:function(a){b(a)}})}},f.extend(c,{onPage:function(a,b,c){n[d.pagedcontentpagingevent].onPage(a,b,c)},refreshOnAnyHashChange:"true"===d.loadonanyhashchange,pagedContentContainer:"#"+d.pagedcontentwrapperid,pagedContentPagingEvent:d.pagedcontentpagingevent,pagedContentPagedEvent:d.pagedcontentpagedevent,
transition:d.configuration.Transition,transitionDuration:"undefined"===typeof d.configuration.TransitionDuration?200:parseInt(d.configuration.TransitionDuration,10)}));f(e).evolutionPager(c);if("true"===d.loadingindicator){var b=f("#"+d.pagedcontentwrapperid),a=f("<div></div>").css({backgroundColor:"#fff",position:"absolute",opacity:0.75,zIndex:1});f.telligent.evolution.messaging.subscribe(d.pagedcontentpagingevent,function(){var l=b.offset();a.hide().appendTo("body").css({width:b.width(),height:b.height(),
top:l.top,left:l.left}).show()});f.telligent.evolution.messaging.subscribe(d.pagedcontentpagedevent,function(){a.hide()})}}};return{}},jQuery,window);u("component.poll",["module.ui"],function(g,f,k,m){f.telligent.evolution.messaging.subscribe("socket.connected",function(){if(f.telligent.evolution.sockets.polls)f.telligent.evolution.sockets.polls.on("updated",function(a){f.telligent.evolution.messaging.publish("polls.updated",a)})});var n="Vote",e="Voting Ends: {0}",d="View Results",c="Voting Ended: {0}",
b="Your vote was received, check back when the poll expires to view the result.",a="Total Votes : {0}",l="You voted for '{0}'.",p="User Vote Report",t="Vote",q="You have already voted for '{0}'.",h="Please login to vote",v=function(a,b,l){var c=a.data("pollview");"vote"!=c&&("results"!=c?(c=w(a,b,l),a.data("pollview","vote"),a.html(c)):l.canShowResults&&f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+b.Id+"/summary.json",cache:!1,success:function(c){c=s(a,
b,c.VoteSummary,l);a.data("pollview","results");a.html(c)}}))},s=function(b,h,d,q){b=f("<div></div>").addClass("poll results");var s=0,v=f("<div></div>").addClass("poll-header"),g=f('<div class="poll-content"></div>'),w=f('<ul class="poll-answers-container"><ul>');v.append(f("<h4></h4>").addClass("poll-question").html(h.Question));b.append(v);h.RenderedDescription&&g.append(f("<div></div>").addClass("poll-description").html(h.RenderedDescription));f.each(d.Summary,function(a,b){s+=d.Summary[a].VoteCount});
f.each(d.Summary,function(a,b){var l=d.Summary[a],c=0==s?0:Math.round(l.VoteCount*(100/s));w.append(f('<li><div class="poll-answer">'+l.PollOption.Option+' <span class="poll-result-value">'+c+'%</span></div><div class="poll-graph-container"><div class="poll-graph" style="width:'+c+'%;"></div></div></li>').attr("data-polloptionid",l.PollOption.OptionId))});g.append(w);b.append(g);v=f('<div class="poll-footer"></div>');g=f('<ul class="poll-footer-attributes"></ul>');if(null!=q.expiredDate){var r=new Date>
q.expiredDate?c:e,x=f("<li></li>").addClass("poll-expires");g.append(x);f.telligent.evolution.language.formatDateAndTime(new Date(q.expiredDate),function(a){x.html(r.replace("{0}",a))})}var n=f("<li></li>");g.append(n);f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+h.Id+"/vote.json",cache:!1,success:function(a){if(null==a.Errors){if(a.OptionId){var b=null;f.each(h.Options,function(l,c){c.OptionId==a.OptionId&&(b=c.Option)});b?(w.find('li[data-polloptionid="'+
a.OptionId+'"]').addClass("selected"),n.addClass("poll-voted").html(l.replace("{0}",b))):n.remove()}}else n.remove()}});g.append(f("<li></li>").addClass("poll-votecount").html(a.replace("{0}",s)));q.canVote&&g.append(f("<li></li>").html('<a href="javascript:void(0)" class="poll-view-vote">'+t+"</a>"));q.reporturl&&(q=f("<li></li>").addClass("poll-report").html(f("<a></a>").attr("href",q.reporturl).html(p)),g.append(q));v.append(g);b.append(v);return b},w=function(b,l,c){b=f("<div></div>").addClass("poll voting").css("visibility",
"none");var s=f.telligent.evolution.user.accessing.isSystemAccount,v=f("<div></div>").addClass("poll-header"),t=f('<div class="poll-content"></div>'),g=f('<ul class="poll-answers-container"></ul>');v.append(f("<h4></h4>").addClass("poll-question").html(l.Question));b.append(v);l.RenderedDescription&&t.append(f("<div></div>").addClass("poll-description").html(l.RenderedDescription));f.each(l.Options,function(a,b){var h=f("<li></li>"),d=f("<span></span>").addClass("poll-input").html(f('<input type="radio" />').val(b.OptionId).attr("name",
l.Id).addClass("options-"+l.Id).attr("id",l.Id+"-"+b.OptionId)),p=f('<label for="'+l.Id+"-"+b.OptionId+'"></label>').addClass("poll-answer").html(b.Option);c.readOnly||h.append(d);h.append(p);g.append(h)});t.append(g);c.canVote&&t.append(f('<a href="#"></a>').addClass("button poll-vote").html(n));b.append(t);var v=f('<div class="poll-footer"></div>'),w=f('<ul class="poll-footer-attributes"></ul>');if(null!=l.ExpiredDate){var r=f("<li></li>").addClass("poll-expires");w.append(r);f.telligent.evolution.language.formatDateAndTime(new Date(l.ExpiredDate),
function(a){r.html(e.replace("{0}",a))})}f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+l.Id+"/vote.json",cache:!1,success:function(b){if(b.OptionId){var e=null;f.each(l.Options,function(a,l){l.OptionId==b.OptionId&&(e=l.Option)});w.append(f("<li></li>").addClass("poll-alreadyvoted").html(q.replace("{0}",e)))}null==b.Errors?f("#"+l.Id+"-"+b.OptionId).prop("checked",!0):alert(b.Errors);if(c.canShowResults){var v=f("<li></li>").addClass("poll-votecount");
w.append(v);w.append(f("<li></li>").html('<a href="javascript:void(0)" class="poll-view-results">'+d+"</a>"));f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+l.Id+"/summary.json",cache:!1,success:function(b){if(null==b.Errors){var l=0;f.each(b.VoteSummary.VoteCount,function(a,c){l+=b.VoteSummary.VoteCount[a]});v.html(a.replace("{0}",l))}else alert(b.Errors)}})}if(s){var t=f("<li></li>").html(f("<a></a>").attr("href",c.loginurl).html(h));w.append(t)}c.reporturl&&
(t=f("<li></li>").html(f("<a></a>").attr("href",c.reporturl).html(p)),w.append(t))}});v.append(w);b.append(v);return b},r=function(a,l,c){a.on("click",".poll-view-results",function(){f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+l.Id+"/summary.json",success:function(b){null==b.Errors?a.evolutionTransform({opacity:0},{duration:200,complete:function(){var h=s(a,l,b.VoteSummary,c);a.data("pollview","results");a.html(h);a.evolutionTransform({opacity:1},{duration:200})}}):
alert(b.Errors)}});return!1});a.on("click",".poll-view-vote",function(){a.evolutionTransform({opacity:0},{duration:200,complete:function(){var b=w(a,l,c);a.data("pollview","vote");a.html(b);a.evolutionTransform({opacity:1},{duration:200})}});return!1});a.on("click",".button.poll-vote",function(){var h=f(".options-"+l.Id+":checked").val();f.telligent.evolution.post({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+l.Id+"/vote.json",data:{OptionId:h},success:function(h){f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/poll/"+l.Id+"/summary.json",cache:!1,success:function(b){null==b.Errors?a.evolutionTransform({opacity:0},{duration:200,complete:function(){if(c.showResultsBeforeExpiration||c.expiredDate>new Date)c.canShowResults=!0;if(c.canShowResults){var h=s(a,l,b.VoteSummary,c);a.data("pollview","results");a.html(h);a.evolutionTransform({opacity:1},{duration:200})}}}):alert(b.Errors)},error:function(a){f.telligent.evolution.notifications.show(b,{type:"success",duration:5E3})}})}});return!1})},x=function(a,
b){return f.Deferred(function(l){a.readOnly?(a.canVote=!1,a.canShowResults=a.showResultsBeforeExpiration||a.expiredDate<new Date,l.resolve(!1)):!a.showResultsBeforeExpiration&&a.expiredDate>new Date?(a.canVote=!0,a.canShowResults=!1,l.resolve(!0)):(a.canVote=null==a.expiredDate||a.expiredDate>new Date,a.canVote?f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/poll/"+b+"/vote.json",cache:!1,success:function(b){null==b.Errors?b.OptionId?(a.canShowResults=!0,l.resolve(!1)):
(a.canShowResults=a.showResultsBeforeVote,l.resolve(!0)):(a.canShowResults=a.showResultsBeforeVote,l.resolve(!1))},error:function(){a.canShowResults=a.showResultsBeforeVote;l.resolve(!1)}}):(a.canShowResults=!0,l.resolve(!1)))}).promise()},y=function(s){s&&(s=f.telligent.evolution.url.parseQuery(s),null!=s.voteButton&&(n=s.voteButton),null!=s.expiredText&&(e=s.expiredText),null!=s.viewResults&&(d=s.viewResults),null!=s.alreadyExpiredText&&(c=s.alreadyExpiredText),null!=s.voteMessage&&(b=s.voteMessage),
null!=s.voteCountText&&(a=s.voteCountText),null!=s.votedOnText&&(l=s.votedOnText),null!=s.alreadyVotedOnText&&(q=s.alreadyVotedOnText),null!=s.userVoteReport&&(p=s.userVoteReport),null!=s.anonymousUserLoginText&&(h=s.anonymousUserLoginText),null!=s.viewVote&&(t=s.viewVote))};f.telligent.evolution.ui.components.poll={setup:function(){},add:function(a,b){y(b.resources);var l=b.pollid,c=null;if(l){var h={reporturl:b.reporturl,loginurl:b.loginurl,readOnly:"True"===b.readonly};f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/poll/"+l+".json",success:function(b){b.Poll&&(h.showResultsBeforeExpiration=b.Poll.ShowResultsBeforeExpiration,h.showResultsBeforeVote=b.Poll.ShowResultsBeforeVote,h.expiredDate=null==b.Poll.ExpiredDate?null:f.telligent.evolution.parseDate(b.Poll.ExpiredDate),x(h,l).then(function(d){null==b.Errors?(!d&&h.canShowResults&&a.data("pollview","results"),v(a,b.Poll,h),r(a,b.Poll,h),f.telligent.evolution.messaging.subscribe("polls.updated",function(d){l==d.pollId&&(k.clearTimeout(c),c=k.setTimeout(function(){v(a,
b.Poll,h)},1E3))})):alert(b.Errors)}))}})}}};return{}},jQuery,window);u("component.presentcontent",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.presentcontent={setup:function(){},add:function(g,e){var d=f.map((e.presentcontents||"").split(","),function(c){c=c.split("|");var b={};2<=c.length&&(b={ContentId:c[0],ContentTypeId:c[1]},2<c.length&&(b.TypeId=c[2]));return b});f.telligent.evolution.presence.register({node:g.get(0),contents:d})}};return{}},jQuery,window);u("component.presentservice",
["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.presentservice={setup:function(){},add:function(g,e){var d=f.map((e.presentservices||"").split(","),function(c){c=c.split("|");var b={};2<=c.length&&(b={ContentId:c[0],ContentTypeId:c[1]},2<c.length&&(b.TypeId=c[2]));return b});f.telligent.evolution.presence.register({node:g.get(0),contents:d})}};return{}},jQuery,window);u("component.previewhtml",["module.ui"],function(g,f,k,m){function n(d,c,b,a){d={url:d,width:0,height:0,outputIsPersisted:!1};
c&&(d.width=c);b&&(d.height=b);a&&(d.outputIsPersisted=a);return f.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/preview.json",data:d})}function e(d,c){var b=d.parent().width();b>c.width&&(b=c.width);n(c.url,b,c.height,c.persist).then(function(a){d.html(a.Html)})}f.telligent.evolution.ui.components.previewhtml={setup:function(){},add:function(d,c){e(d,c);f(window).on("resized",function(){e(d,c)})}};return{}},jQuery,window);u("component.rate",["module.ui"],
function(g,f,k,m){f.telligent.evolution.ui.components.rate={setup:function(){},add:function(g,e){var d=f.extend({},{isReadOnly:"true"===e.readonly,value:parseFloat(e.initialvalue),ratingCount:parseFloat(e.initialcount)});d.value*=f.fn.evolutionStarRating.defaults.maxRating;d.onRate=function(c){e.contentid&&e.contenttypeid&&(c/=f.fn.evolutionStarRating.defaults.maxRating,c={ContentId:e.contentid,ContentTypeId:e.contenttypeid,Value:c},e.ratingtypeid&&(c.TypeId=e.ratingtypeid),f.telligent.evolution.post({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/ratings.json",data:c,success:function(b){b={ContentId:e.contentid};e.ratingtypeid&&(b.TypeId=e.ratingtypeid);f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/rateditem.json",data:b,success:function(a){a&&a.RatedItem&&a.RatedItem.AverageValue?f(g).evolutionStarRating("option",{value:a.RatedItem.AverageValue*f.fn.evolutionStarRating.defaults.maxRating,ratingCount:a.RatedItem.Count}):f(g).evolutionStarRating("option",{value:0,ratingCount:0})}})}}))};0==
d.ratingCount&&d.isReadOnly||f(g).evolutionStarRating(d)}};return{}},jQuery,window);u("component.resizedimage",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.resizedimage={setup:function(){},add:function(g,e){g.removeClass("ui-resizedimage");f.telligent.evolution.media.previewHtml(e.src,{width:e.width||0,height:e.height||0,resizeMethod:e.resizemethod||"ZoomAndCrop",success:function(d){d=f(d.html);d.attr("style")&&g.attr("style",d.attr("style"));g.attr("src",d.attr("src"))}})}};
return{}},jQuery,window);u("component.scheduledfile",["module.ui","module.messaging"],function(g,f,k,m,n){function e(c){f.subscribe("scheduledFile.complete","messages-"+c.progressKey,function(b){b.progressKey===c.progressKey&&(c.indicator.evolutionProgressIndicator("complete",b),d(c))});f.subscribe("scheduledFile.error","messages-"+c.progressKey,function(b){b.progressKey===c.progressKey&&(c.indicator.evolutionProgressIndicator("error",b?b.message:null),d(c))});f.subscribe("scheduledFile.progress",
"messages-"+c.progressKey,function(b){b.progressKey===c.progressKey&&c.indicator.evolutionProgressIndicator("progress",b)})}function d(c){setTimeout(function(){f.unsubscribe("messages-"+c.progressKey)},100)}k.telligent.evolution.ui.components.scheduledfile={setup:function(){},add:function(c,b){k.telligent.evolution.scheduledFile.monitor(b.progresskey);var a=k.extend({},{progressKey:b.progresskey,percentComplete:b.percentcomplete,log:JSON.parse(b.log),indicator:k(c).evolutionProgressIndicator({includePercentComplete:"true"==
b.includepercentcomplete,includeLatestMessage:"true"==b.includelatestmessage,includeAllMessages:"true"==b.includeallmessages,warnBeforeUnload:"false"==b.durable,showPending:"scheduled"==b.state})});a.percentComplete&&0<a.percentComplete&&a.indicator.evolutionProgressIndicator("progress",{percentComplete:parseFloat(a.percentComplete)});if(a.log)for(var l=0;l<a.log.length;l++)a.indicator.evolutionProgressIndicator("progress",{message:a.log[l]});e(a)}};return{}},jQuery,window);u("component.searchresult",
["module.ui","module.template"],function(g,f,k,m,n){var e=k.telligent.evolution.template.compile('<% foreach(properties, function(property) { %> <li class="property-item"><%= property %></li> <% }); %> '),d=function(c,b){k.telligent.evolution.get({url:c,dataType:"json",success:function(a){a&&b(e(a))}})};k.telligent.evolution.ui.components.searchresult={setup:function(){},add:function(c,b){if(b.detailsurl){var a=null,l=c.find("ul.details"),p=l.html();c.on("mouseenter",function(c){null!==a?l.html(a):
d(b.detailsurl,function(b){a=b;l.html(a)})}).on("mouseleave",function(a){l.html(p)})}}};return{}},jQuery,window);u("component.select",["module.ui","module.messaging"],function(g,f,k,m,n){function e(d){if(d.is("select")&&k(window).width()>(k.telligent.evolution.theme.getReflowBreakpoint()||670))if(d.data("renderedUiSelect"))d.hide(),d.data("renderedUiSelect").show();else{var c="uiselect "+d.get(0).className.replace("ui-select-enabled","");0<d.closest(".view,.filter,.sort").length&&(c+=" options-slim");
d.show().glowDropDownList({selectedItemWidth:"auto",selectedItemHeight:"auto",itemsWidth:"auto",itemsHeight:"auto",buttonImageUrl:null,className:c,activeClassName:"active"});c=d.prevAll(".uiselect").first();d.data("renderedUiSelect",c)}else d.show(),(d=d.data("renderedUiSelect"))&&d.hide()}k.telligent.evolution.ui.components.select={setup:function(){f.subscribe("reflow.reflowend",function(){k(".ui-select-enabled").each(function(){e(k(this))})})},add:function(d,c){d.removeClass("ui-select").addClass("ui-select-enabled");
e(d)}};return{}},jQuery,window);u("component.squeezetext",["module.ui","plugin.evolutionSqueezeText"],function(g,f,k,m,n){g={setup:function(){},add:function(e,d){k(e).evolutionSqueezeText({minSize:parseFloat(d.minsize)||k.fn.evolutionSqueezeText.defaults.minSize,minSpacing:parseFloat(d.minspacing)||k.fn.evolutionSqueezeText.defaults.minSpacing,enableSpacing:d.enablespacing!==n?"true"===d.enablespacing:k.fn.evolutionSqueezeText.defaults.enableSpacing,resetOnFailure:d.resetonfailure!==n?"true"===d.resetonfailure:
k.fn.evolutionSqueezeText.defaults.resetOnFailure,truncateOnFailure:d.truncateonfailure!==n?"true"===d.truncateonfailure:k.fn.evolutionSqueezeText.defaults.truncateOnFailure,onFailure:function(){k(this).attr("data-tip",k(this).text()).evolutionTip()}})}};k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.ui=k.telligent.evolution.ui||{};k.telligent.evolution.ui.components=k.telligent.evolution.ui.components||{};return k.telligent.evolution.ui.components.squeezetext=
g},jQuery,window);u("component.tag",["module.ui"],function(g,f,k,m){var n=function(e,d,c){var b=f(c);b.html("");if(e){var a=!0;f.each(e.split(/,/),function(l,c){var e=f.trim(c);e&&(a?a=!1:b.append(", "),d?b.append(f("<a>").attr("rel","nofollow tag").attr("href",d.replace(/{tag}/g,f.telligent.evolution.url.encodePathComponent(f.telligent.evolution.html.decode(e)))).text(e)):b.append(e))})}};f.telligent.evolution.ui.components.tag={setup:function(){},add:function(e,d){var c=jQuery("<span></span>");
f(e).append(c);n(d.tags,d.urlformat,c);var b=null;"true"!==d.readonly&&(b=f('<a href="javascript:void(0);" class="internal-link edit-tags"></a>'),f(e).append(b),b.evolutionInlineTagEditor({allTags:f.grep(d.selectabletags.split(","),function(a){return a}),currentTags:f.grep(d.tags.split(","),function(a){return a}),onSave:function(a,b){var p={Tags:a&&0<a.length?a.join(","):"",ContentId:d.contentid,ContentTypeId:d.contenttypeid};d.tagtypeid&&(p.TypeId=d.tagtypeid);f.telligent.evolution.put({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/contenttags.json",data:p,success:function(a){n(p.Tags,d.urlformat,c);b()}})}}))}};return{}},jQuery,window);u("component.theater",["module.ui"],function(g,f,k,m){var n=function(e,d){f.telligent.evolution.get({url:e,cache:!1,success:function(c){d(c)}})};f.telligent.evolution.ui.components.theater={setup:function(){},add:function(e,d){e=f(e);e.on("click",function(c){!0!==e.data("disabletheater")&&(c.preventDefault(),f.evolutionTheater.show({content:function(b){n(d.theaterurl,b)},loaded:function(b){}}))})}};
return{}},jQuery,window);u("component.tip",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.tip={setup:function(){},add:function(g,e){f(g).evolutionTip({attribute:e.tipcontent||f.fn.evolutionTip.defaults.attribute,horizontal:e.tiphorizontal,vertical:e.tipvertical})}};return{}},jQuery,window);u("component.tourtip",["module.ui","module.tourtips"],function(g,f,k,m,n){k.telligent.evolution.ui.components.tourtip={setup:function(){},add:function(e,d){k.telligent.evolution.tourTips.register({key:d.tourtipkey,
message:d.tourtipmessage,index:d.tourtipindex,element:e.get(0)})}};return{}},jQuery,window);u("component.userpresence",["module.ui","module.messaging","lib.util"],function(g,f,k,m,n,e){var d;m.telligent.evolution.ui.components.userpresence={setup:function(){d=m("body")},add:function(c,b){var a=b.presentlabel,l=b.notpresentlabel;m.telligent.evolution.sockets&&m.telligent.evolution.sockets.presence&&(m.telligent.evolution.presence.register({node:d,contents:[{ContentId:b.contentid,ContentTypeId:b.contenttypeid}]}),
f.subscribe("user.presenceChanged",function(d){d&&b.userid==d.userId&&(!0===d.present?c.show().html(a).attr("data-tip",a).addClass("present"):!1===d.present?c.show().html(l).attr("data-tip",l).removeClass("present"):c.hide())}))}};return{}},jQuery,window);u("component.viewhtml",["module.ui","module.messaging"],function(g,f,k,m,n){function e(a,b,c,d){a={url:a,width:0,height:0,outputIsPersisted:!1};b&&(a.width=b);c&&(a.height=c);d&&(a.outputIsPersisted=d);return k.telligent.evolution.get({url:jQuery.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/ui/view.json",data:a})}function d(a,b,p){m.clearTimeout(b.reflowWaitTimeout);if("none"==a.css("display")||"none"==a.parent().css("display")||document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)m.setTimeout(function(){d(a,b,p)},499);else if(!p||"viewable"==b.resizedBy){var t=k(m).width(),q=a.parent().width(),h=a.parent().height(),v="parent",s=h;if(t<q)b.reflowWaitCheckCount++,10>b.reflowWaitCheckCount&&(b.reflowWaitTimeout=
setTimeout(function(){d(a,b,p)},250));else{0==q&&(q=a.parents(".layout-region-inner").width());q>b.width&&(q=b.width);if(0==h||"parent"!=b.resizedBy||h>c)s=c,h=Math.round(0.8*c),v="viewable";h>b.height&&0<b.height&&(s=h=b.height,v="configured");b.resizedBy=v;if(s!=b.lastHeight||q!=b.lastHeight){var v=a.width(),g=a.height();if(!(q==b.lastWidth&&s<=b.lastHeight&&(g<=s||0==s)||s==b.lastHeight&&q<=b.lastWidth&&(v<=q||0==q))){var f=[],x=!0;a.children().each(function(){k(this);var a=(this.nodeName||"").toLowerCase();
"video"==a||"audio"==a||"embed"==a||"object"==a?f.push(this):"script"!=a&&("style"!=a&&"meta"!=a)&&(x=!1)});x&&0<a.children().length?(k.each(f,function(){var a=k(this),b=a.width()||1,c=a.height()||1;b/q>c/h?a.attr({width:q+"px !important",height:c*q/b+"px !important"}):a.attr({width:b*h/c+"px !important",height:h+"px !important"})}),a.trigger("rendered")):(""==b.lastHtml&&a.html(k('<div><span class="ui-loading"></span></div>').css({display:"inline-block",width:q?q+"px":0.8*t+"px",height:h?h+"px":
0.8*c+"px",display:"flex","align-items":"center","justify-content":"center"})),e(b.url,q,h,b.persist).then(function(c){b.lastHtml!=c.Html&&(a.html(c.Html),b.lastHtml=c.Html,a.trigger("rendered"))}));b.lastHeight=s;b.lastWidth=q}}}}}var c,b=!1;k.telligent.evolution.ui.components.viewhtml={setup:function(){c=k(window).height();k(window).on("resized",function(){b||(c=k(window).height())});k.telligent.evolution.messaging.subscribe("window.scrollableheight",function(a){c=a.height;b=!0})},add:function(a,
b){b.resizedBy="parent";b.lastWidth=-1;b.lastHeight=-1;b.lastHtml="";b.reflowWaitCheckCount=0;b.reflowWaitTimeout=null;d(a,b,!1);k(window).on("resized",function(){d(a,b,!1)});k.telligent.evolution.messaging.subscribe("window.scrollableheight",function(c){d(a,b,!0)})}};return{}},jQuery,window);u("component.vote",["module.ui"],function(g,f,k,m){function n(d){return f.Deferred(function(c){f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/vote.json",data:{IdeaId:d,
UserId:f.telligent.evolution.user.accessing.id},error:function(){c.resolve(null)}}).then(function(b){c.resolve(b.Vote.TotalVotes)})}).promise()}function e(d,c,b){b.contentId==d.contentid&&n(b.contentId).then(function(a){f(c).evolutionUpDownVoting("option",{yesVotes:b.yesVotes,noVotes:b.noVotes,voteCount:b.totalVotes,score:b.score,userVote:a})})}f.telligent.evolution.ui.components.vote={setup:function(){},add:function(d,c){var b=f.extend({},{isReadOnly:"true"===c.readonly,yesVotes:parseInt(c.initialyesvotes),
noVotes:parseInt(c.initialnovotes),voteCount:parseInt(c.initialvotes),score:parseInt(c.initialscore),allowMultipleVotes:"true"===c.allowmultiplevotes,userVote:c.initialuservotetotal,canUserUpVote:"true"===c.canuserupvote,canUserDownVote:"true"===c.canuserdownvote,isUserRegistered:"true"===c.isuserregistered,isUserGroupMember:"true"===c.isusergroupmember,loginUrl:c.loginurl});f.telligent.evolution.messaging.subscribe("ideaVote.created",function(a){e(c,d,a)});f.telligent.evolution.messaging.subscribe("ideaVote.deleted",
function(a){e(c,d,a)});b.onVote=function(a,b){c.contentid&&f.telligent.evolution.post({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v3/ideas/vote.json",data:{IdeaId:c.contentid,Value:b},success:function(a){a&&a.Vote&&a.Vote.Idea?f(d).evolutionUpDownVoting("option",{yesVotes:a.Vote.Idea.YesVotes,noVotes:a.Vote.Idea.NoVotes,voteCount:a.Vote.Idea.TotalVotes,score:a.Vote.Idea.Score,userVote:a.Vote.TotalVotes}):f(d).evolutionUpDownVoting("option",{yesVotes:0,noVotes:0,voteCount:0,score:0,userVote:null})}})};
b.onDeleteVote=function(){c.contentid&&f.telligent.evolution.del({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/vote.json",data:{IdeaId:c.contentid},success:function(a){f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ideas/idea.json",data:{Id:c.contentid},success:function(a){a&&a.Idea?f(d).evolutionUpDownVoting("option",{yesVotes:a.Idea.YesVotes,noVotes:a.Idea.NoVotes,voteCount:a.Idea.TotalVotes,score:a.Idea.Score,userVote:0}):f(d).evolutionUpDownVoting("option",
{yesVotes:0,noVotes:0,voteCount:0,score:0,userVote:null})}})}})};0==b.voteCount&&b.isReadOnly||f(d).evolutionUpDownVoting(b)}};return{}},jQuery,window);u("component.webpreview",["module.ui"],function(g,f,k,m){f.telligent.evolution.ui.components.webpreview={setup:function(){},add:function(g,e){var d=e.configuration.url,c,b;"undefined"!==typeof e.configuration.maximagewidth&&(c=e.configuration.maximagewidth);"undefined"!==typeof e.configuration.maximageheight&&(b=e.configuration.maximageheight);g.hasClass("preview")||
(g.parents(".ui-theater").data("disabletheater",!0),0>e.configuration.url.indexOf(f.telligent.evolution.site.getBaseUrl(!0))&&g.parents(".ui-theater").attr("target","_blank"));f.telligent.evolution.preview.load(d,{maxImageWidth:c,maxImageHeight:b,success:function(a){a&&(a.excerpt||a.imageUrl)&&(a=f.telligent.evolution.preview.render(a,{template:f.telligent.evolution.preview.defaults.template}),"undefined"!==typeof a&&(null!==a&&0<a.length)&&g.html(a))}})}};return{}},jQuery,window);u("composers",["composer.hashtags",
"composer.mentions","composer.urlhighlight","composer.autocomplete"],function(){return{}});u("composer.autocomplete",["plugin.evolutionComposer"],function(g,f,k,m){var n={},e=null,d=function(){};g=function(){return{init:function(b){d=b.settings.onSuggestionList||f.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionList;selectSuggestion=b.settings.onSuggestionSelect||f.fn.evolutionComposer.plugins.autocomplete.defaults.onSuggestionSelect;b.input.on(c.selectedEventName,function(){selectSuggestion(c.selection());
b.release()})},onTransform:function(b){},shouldActivate:function(b){return(b=b.currentWord())&&b.value&&3<=b.value.length?!0:!1},onActivate:function(b){b.data("_autocomplete_composer_active",!0);f(document).on("click.autocomplete",function(a){b.release();f(document).off(".autocomplete")})},onDeactivate:function(b){b.data("_autocomplete_composer_active",!1);c.hide();b.input.trigger("focus")},val:function(b,a){return b},onkeydown:function(b,a){if(27===a.which)return b.release(),!1;if(9==a.which)b.release();
else{if(13===a.which){var l=c.selection();l&&selectSuggestion(l);b.release();return!1}if(38===a.which)return c.moveHighlightUp(),!1;if(40===a.which)return c.moveHighlightDown(),!1}return!0},onkeypress:function(b,a){return!0},oninput:function(b,a){clearTimeout(e);c.loading(b.input);e=setTimeout(function(){var a=b.val();if(1<a.length){var p=function(a){null!==a&&0<a.length?c.show(b.input,a,b.settings.suggestionHeader):b.release()};"undefined"!==typeof n[a]?b.data("_autocomplete_composer_active")&&p(n[a]):
d(a,function(c){b.data("_autocomplete_composer_active")&&(n[a]=c,b.val()==a&&p(c))})}else b.release()},500);return!0},defaults:{}}}();var c=function(){var b=null,a=null,c=null,d=null,e=null,q=function(h){d=h;if(null===b){b=f('<div class="composer-suggestion-selector popup-list content"></div>').hide().appendTo(f("body"));c=f('<span class="heading"></span>').appendTo(b);a=f('<ul class="content-list content suggestions"></ul>').appendTo(b);e=f('<li class="loading">...</li>');var q=0,g=["<strong>&bull;</strong>&bull;&bull;",
"&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){q+=1;3===q&&(q=0);e.get(0).innerHTML=g[q]},175);b.on("click","li",function(a){null!==d&&(b.find("li.highlight").removeClass("highlight"),f(this).addClass("highlight"),d.trigger(v.selectedEventName))})}},h=function(){if(null!==d){var a=d.offset(),c=f(d);b.css({width:c.outerWidth()-2,top:a.top+c.outerHeight()-1,left:a.left})}},v={selectedEventName:"SUGGESTION_SELECTED",show:function(d,p,e){c.html(e);
q(d);h();b.hide();a.empty();f.each(p,function(b,c){var h=f('<li class="content-item suggestion">'+c.viewHtml+"</li>");h.data("suggestionData",c);a.append(h)});b.show()},hide:function(){null!==b&&(b.hide(),a.empty())},loading:function(c){q(c);h();b.hide();a.empty().append(e);b.show()},moveHighlightUp:function(){var a=b.find("li.suggestion");if(0!==a.length){var c=a.length;f.each(a,function(a,b){f(b).hasClass("highlight")&&(c=a,f(b).removeClass("highlight"))});0>c-1&&(c=a.length);f(a.get(c-1)).addClass("highlight")}},
moveHighlightDown:function(){var a=b.find("li.suggestion");if(0!==a.length){var c=-1;f.each(a,function(a,b){f(b).hasClass("highlight")&&(c=a,f(b).removeClass("highlight"))});c+1>=a.length&&(c=-1);f(a.get(c+1)).addClass("highlight")}},selection:function(){var a=b.find("li.suggestion");if(0===a.length)return null;var c=a.filter("li.suggestion.highlight");return null!==c&&0<c.length?c.data("suggestionData"):f(a.get(0)).data("suggestionData")}};return v}();f.fn.evolutionComposer.plugins.autocomplete=
g;f.fn.evolutionComposer.plugins.autocomplete.defaults={onSuggestionList:function(b,a){a(null)},onSuggestionSelect:function(b){}};return{}},jQuery,window);u("composer.hashtags",["plugin.evolutionComposer","lib.globalConfiguration","module.rest"],function(g,f,k,m,n,e){g=function(){for(var c=null,b=!1,a={},l=function(a){var b=a.data("_tagged_tags");if("undefined"===typeof b||null===b)b=[],a.data("_tagged_tags",b);return b},p=function(a){return a.currentWord({additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})},
e=function(a,b,c,h,s){var e=l(a)||[];e[e.length]=b;c&&(c=p(a),a.replace(c.start,c.stop+1,b.decodedName+(h?" ":"")),b=c.start+(b.decodedName+(h?" ":"")).length,h=a.input.get(0),h.setSelectionRange?h.setSelectionRange(b,b):h.createTextRange&&(h=h.createTextRange(),h.collapse(!0),h.moveEnd("character",b),h.moveStart("character",b),h.select()));q(a);a.data("_hashtag_composer_active",!1);d.hide();a.input.trigger("focus");s&&a.release()},q=function(a){var b=l(a).reverse(),c=a.val();a.clearHighlights(a.settings.highlightClass||
s);var h={};m.each(b,function(l,d){if(d&&null!==d.decodedName&&0<d.decodedName.length){var p=c.indexOf(d.decodedName);if(0>p||h[p])b.splice(l,1);else for(;0<=p;)a.addHighlight({start:p,stop:d.decodedName.length+p,className:a.settings.highlightClass||s}),h[p]=!0,p=c.indexOf(d.decodedName,p+1)}});a.renderHighlights()},h=function(a){return 2<a.length&&0===a.indexOf("#")&&!c.test(a.substr(1))&&isNaN(parseInt(a[1],10))},v=function(a){return m.Deferred(function(c){k.get({url:f.baseUrl+"tinymce/apis/hashtags",
cache:!0,data:{t:"m",contenttypeid:a||""}}).then(function(a){(b=a&&"true"===a.supported)?c.resolve():c.reject()})["catch"](function(){c.reject()})}).promise()},s="composer-hashtag-highlight",g=function(){},r=null,x=null,n=/\[tag:([^\]]+)\]/gi,c=RegExp("["+"-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".replace("]","\\]")+"]","i"),z=0;33>z;z++)a["-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".charCodeAt(z)]=!0;return{init:function(a){v(a.settings.contentTypeId).then(function(){g=a.settings.onTagList||m.fn.evolutionComposer.plugins.hashtags.defaults.onTagList;
a.input.on(d.selectedEventName,function(){e(a,d.selection(),!0,!0,!0)});a.input.on("blur",function(){setTimeout(function(){a.data("_hashtag_composer_active")&&a.release()},500)})})},onTransform:function(a,b){if(b)for(var c=a.val(),h=n.exec(c);null!==h&&0<=h.index&&null!==h&&1<h.length;){var l={token:"[tag:"+h[1]+"]",name:"#"+h[1],decodedName:"#"+m.telligent.evolution.html.decode(h[1])};a.val(a.val().replace(h[0],l.name));e(a,l,!1);h=n.exec(c)}q(a)},shouldActivate:function(a){return b?h(p(a).value):
!1},onActivate:function(a){a.data("_hashtag_composer_active",!0);m(document).on("click.ui-composer-hashtags",function(){a.release();m(document).off(".ui-composer-hashtags")})},onDeactivate:function(a){var b=p(a);h(b.value)&&e(a,{decodedName:b.value,name:b.value,token:"[tag:"+b.value.substr(1)+"]"},!0,!1,!1);a.data("_hashtag_composer_active",!1);d.hide();a.input.trigger("focus")},val:function(a,c){if(!b)return a;var h=l(c);m.each(h,function(b,c){a=a.replace(RegExp(m.telligent.evolution.regex.encode(c.decodedName),
"g"),c.token)});return a},onkeydown:function(a,c){if(!b)return!0;if(27===c.which||32===c.which)a.release();else if(13===c.which||9===c.which){var h=d.selection();if(h)return e(a,h,!0,!0,!0),!1;a.release()}else{if(38===c.which)return d.moveHighlightUp(),!1;if(40===c.which)return d.moveHighlightDown(),!1}return!0},onkeypress:function(c,h){if(!b)return!0;"undefined"!==typeof a[h.which]&&c.release();return!0},oninput:function(a,c){if(!b)return!0;if(!h(p(a).value))return a.release(),!0;if(a.currentWord().value==
x&&a.data("_hashtag_composer_active"))return!0;clearTimeout(r);d.loading(a.input);r=setTimeout(function(){var b=x=a.currentWord().value;h(b)?2<=b.length&&g(b.substr(1),function(c){if(a.data("_hashtag_composer_active")){c&&(c=m.map(c,function(a){return{name:a.name,token:a.token,decodedName:m.telligent.evolution.html.decode(a.name)}}));var l=p(a).value;l==b&&h(l)&&null!==c&&0<c.length?d.show(a.input,c,b):d.hide()}}):a.release()},500);return!0}}}();var d=function(){var c=null,b=null,a=null,l=function(l){b=
l;if(null===c){c=m('<ul class="composer-hashtag-selector"></ul>').hide().appendTo(m("body"));a=m('<li class="loading">...</li>');var h=0,d=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){h+=1;3===h&&(h=0);a.get(0).innerHTML=d[h]},175);c.on("click","li",function(a){null!==b&&(c.find("li.highlight").removeClass("highlight"),m(this).addClass("highlight"),b.trigger(e.selectedEventName))})}},d=function(){if(null!==
b){var a=b.offset(),h=m(b);c.css({width:h.outerWidth()-2,top:a.top+h.outerHeight()-1,left:a.left})}},e={selectedEventName:"HASHTAG_SELECTED",show:function(a,b,e){l(a);d();c.hide().empty();var s=RegExp(m.telligent.evolution.regex.encode(m.telligent.evolution.html.encode(e)),"i");m.each(b,function(a,b){var h=b.name.match(s),h=null!==h?m("<li>"+b.name.replace(s,"<strong>"+h[0]+"</strong>")+"</li>"):m("<li>"+b.name+"</li>");h.data("tagData",b);c.append(h)});c.show()},hide:function(){null!==c&&c.hide().empty()},
loading:function(b){l(b);d();c.hide().empty().append(a).show()},moveHighlightUp:function(){var a=c.find("li");if(0!==a.length){var b=a.length;m.each(a,function(a,c){m(c).hasClass("highlight")&&(b=a,m(c).removeClass("highlight"))});0>b-1&&(b=a.length);m(a.get(b-1)).addClass("highlight")}},moveHighlightDown:function(){var a=c.find("li");if(0!==a.length){var b=-1;m.each(a,function(a,c){m(c).hasClass("highlight")&&(b=a,m(c).removeClass("highlight"))});b+1>=a.length&&(b=-1);m(a.get(b+1)).addClass("highlight")}},
selection:function(){var a=c.find("li");if(0===a.length)return null;var b=a.filter("li.highlight");return null!==b&&0<b.length?b.data("tagData"):m(a.get(0)).data("tagData")}};return e}();m.fn.evolutionComposer.plugins.hashtags=g;m.fn.evolutionComposer.plugins.hashtags.defaults={onTagList:function(c,b){m.telligent.evolution.get({url:m.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/hashtags.json?IncludeFields=Token,PreviewHtml",data:{QueryText:c,PageSize:5},cache:!1,dataType:"json",success:function(a){a.HashTags&&
0<a.HashTags.length?(a=m.map(a.HashTags,function(a){return{name:a.PreviewHtml,token:a.Token}}),b(a)):b(null)}})}};return{}},jQuery,window);u("composer.mentions",["plugin.evolutionComposer","lib.globalConfiguration","module.rest"],function(g,f,k,m,n,e){g=function(){var c={};allowedSpacesKey="_allowed_spaces";isActiveKey="_hashtag_composer_active";caretPosition=0;supported=!1;getMentions=function(b){var a=b.data("_mentioned_mentionables");if("undefined"===typeof a||null===a)a=[],b.data("_mentioned_mentionables",
a);return a};setCursorPosition=function(b,a){var c=b.input.get(0);c.setSelectionRange?c.setSelectionRange(a,a):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveEnd("character",a),c.moveStart("character",a),c.select())};mentionMentionable=function(b,a,c){var d=getMentions(b)||[];d[d.length]=a;c&&(c=effectiveCurrentWord(b),b.replace(c.start,c.stop+1,a.decodedName+" "),allowedSpaces(b,0),setCursorPosition(b,c.start+(a.decodedName+" ").length));b.release();updateHighlights(b)};updateHighlights=
function(b){var a=getMentions(b),c=b.val();b.clearHighlights(b.settings.highlightClass||mentionHighlightClass);m.each(a,function(d,e){if(e&&null!==e.decodedName&&0<e.decodedName.length){var q=c.indexOf(e.decodedName);if(0>q)a.splice(d,1);else for(;0<=q;)b.addHighlight({start:q,stop:e.decodedName.length+q,className:b.settings.highlightClass||mentionHighlightClass}),q=c.indexOf(e.decodedName,q+1)}});b.renderHighlights()};mentionHighlightClass="composer-mentionable-mention-highlight";getMentionables=
function(){};getContent=getMentionablesTimeout=null;allowedSpaces=function(b,a){return"undefined"!==typeof a?(b.data("_allowed_spaces",a),a):b.data("_allowed_spaces")||0};effectiveCurrentWord=function(b){var a=b.val().substring(0,caretPosition),l=null;m.each(c,function(b,c){if(null!==c&&0<c.length&&a.match("@"+m.telligent.evolution.regex.encode(b)+"$"))return l="@"+b,!1});if(null!==l){var d=a.length-l.length;allowedSpaces(b,l.split(" ").length-1);return{value:l,start:d,stop:d+l.length}}return b.currentWord({caretPosition:caretPosition,
allowedWhiteSpaceBeforeCaret:allowedSpaces(b),additionalWhiteSpaceSymbols:"()\"'<>.,".split("")})};collectRawTokens=function(b){for(var a=b.val(),c=[];null!==(tokens=rToken.exec(a));)c.push({match:tokens,contentTypeId:tokens[2],contentId:tokens[1]});0<c.length&&getContent&&getContent(c,function(a){m.each(a,function(a,c){var h={token:c.match[0],name:c.name,decodedName:m.trim(c.name)};b.val(b.val().replace(h.token,h.name));mentionMentionable(b,h,!1)});b.input.trigger("input")})};initSupported=function(b){return m.Deferred(function(a){k.get({url:f.baseUrl+
"tinymce/apis/mentions",cache:!0,data:{t:"m",contenttypeid:b||""}}).then(function(b){(supported=b&&"true"===b.supported)?a.resolve():a.reject()})["catch"](function(){a.reject()})}).promise()};rToken=/\[mention:([^:]+):([^\]]+)\]/gi;return{init:function(b){initSupported(b.settings.contentTypeId).then(function(){getMentionables=b.settings.onMentionableList||m.fn.evolutionComposer.plugins.mentions.defaults.onMentionableList;getContent=b.settings.onListContent||m.fn.evolutionComposer.plugins.mentions.defaults.onListContent;
b.input.on(d.selectedEventName,function(){mentionMentionable(b,d.selection(),!0)});b.input.on({blur:function(){setTimeout(function(){b.data(isActiveKey)&&b.release()},500)},keydown:function(){caretPosition=b.caretPosition()+1}})})},onTransform:function(b,a){a&&collectRawTokens(b);updateHighlights(b)},shouldActivate:function(b){return supported&&0===effectiveCurrentWord(b).value.indexOf("@")},onActivate:function(b){b.data(isActiveKey,!0);m(document).on("click.mentions",function(){b.release();m(document).off(".mentions")})},
onDeactivate:function(b){b.data(isActiveKey,!1);d.hide();b.input.trigger("focus");allowedSpaces(b,0)},val:function(b,a){if(!supported)return b;var c=getMentions(a);m.each(c,function(a,c){b=b.replace(c.decodedName,c.token)});return b},onkeydown:function(b,a){if(!supported)return!0;if(32===a.which)allowedSpaces(b,allowedSpaces(b)+1);else{if(27===a.which)return b.release(),!1;if(13===a.which||9===a.which){var c=d.selection();c?mentionMentionable(b,c,!0):b.release();return!1}if(38===a.which)return d.moveHighlightUp(),
!1;if(40===a.which)return d.moveHighlightDown(),!1}return!0},onkeypress:function(b,a){return!0},oninput:function(b,a){if(!supported)return!0;clearTimeout(getMentionablesTimeout);d.loading(b.input);getMentionablesTimeout=setTimeout(function(){var a=effectiveCurrentWord(b).value.substring(1);if(1<a.length){var p=function(c){null!==c&&0<c.length?d.show(b.input,c,a):b.release()};"undefined"!==typeof c[a]?b.data(isActiveKey)&&p(c[a]):getMentionables(a,function(d){b.data(isActiveKey)&&(d&&(d=m.map(d,function(a){return{name:a.name,
token:a.token,decodedName:m.trim(m.telligent.evolution.html.decode(a.name))}})),c[a]=d,effectiveCurrentWord(b).value.substring(1)==a&&p(d))})}else b.release()},500);return!0}}}();var d=function(){var c=null,b=null,a=null,d=function(d){b=d;if(null===c){c=m('<ul class="composer-mentionable-selector"></ul>').hide().appendTo(m("body"));a=m('<li class="loading">...</li>');var h=0,l=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){h+=
1;3===h&&(h=0);a.get(0).innerHTML=l[h]},175);c.on("click","li",function(a){null!==b&&(c.find("li.highlight").removeClass("highlight"),m(this).addClass("highlight"),b.trigger(e.selectedEventName))})}},p=function(){if(null!==b){var a=b.offset(),h=m(b);c.css({width:h.outerWidth()-2,top:a.top+h.outerHeight()-1,left:a.left})}},e={selectedEventName:"MENTIONABLE_SELECTED",show:function(a,b,e){d(a);p();c.hide().empty();var s=RegExp(m.telligent.evolution.regex.encode(m.telligent.evolution.html.encode(e)),
"i");m.each(b,function(a,b){var h=b.name.match(s),h=null!==h?m("<li>"+b.name.replace(s,"<strong>"+h[0]+"</strong>")+"</li>"):m("<li>"+b.name+"</li>");h.data("mentionableData",b);c.append(h)});c.show()},hide:function(){null!==c&&c.hide().empty()},loading:function(b){d(b);p();c.hide().empty().append(a).show()},moveHighlightUp:function(){var a=c.find("li");if(0!==a.length){var b=a.length;m.each(a,function(a,c){m(c).hasClass("highlight")&&(b=a,m(c).removeClass("highlight"))});0>b-1&&(b=a.length);m(a.get(b-
1)).addClass("highlight")}},moveHighlightDown:function(){var a=c.find("li");if(0!==a.length){var b=-1;m.each(a,function(a,c){m(c).hasClass("highlight")&&(b=a,m(c).removeClass("highlight"))});b+1>=a.length&&(b=-1);m(a.get(b+1)).addClass("highlight")}},selection:function(){var a=c.find("li");if(0===a.length)return null;var b=a.filter("li.highlight");return null!==b&&0<b.length?b.data("mentionableData"):m(a.get(0)).data("mentionableData")}};return e}();m.fn.evolutionComposer.plugins.mentions=g;m.fn.evolutionComposer.plugins.mentions.defaults=
{onListContent:function(c,b){m.telligent.evolution.batch(function(){m.each(c,function(a,b){m.telligent.evolution.get({url:m.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/genericcontent/{contentId}/{contentTypeId}.json",data:{contentId:b.contentId,contentTypeId:b.contentTypeId}}).then(function(a){b.name=a.Content.HtmlName})})}).then(function(){b(c)})},onMentionableList:function(c,b){m.telligent.evolution.get({url:m.fn.evolutionComposer.plugins.mentions.defaults.mentionablesEndpoint,data:{QueryText:c,
PageSize:20},cache:!1,dataType:"json",success:function(a){a.Mentionables&&0<a.Mentionables.length?(a=m.map(a.Mentionables,function(a){return{name:a.PreviewHtml,token:a.Token}}),b(a)):b(null)}})},mentionablesEndpoint:m.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/mentionables.json?IncludeFields=Token,PreviewHtml"};return{}},jQuery,window);u("composer.urlhighlight",["plugin.evolutionComposer"],function(g,f,k,m){var n=/(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;g=function(){var e=
{init:function(d){d.highlighClassName=d.highlighClassName||e.defaults.highlighClassName},onTransform:function(d){var c;c=(d.val()||"").match(n);c=null!==c&&0<c.length?c[0]:null;if(null!==c){var b;b=d.data("_composer_urlpreview_data");if(null===b||"undefined"===typeof b)b={},d.data("_composer_urlpreview_data",b);var a=d.val().indexOf(c);if(0<=a&&"undefined"===typeof b.lastRange||b.lastRange.start!==a||b.lastRange.stop!==a+c.length)b.lastRange={start:a,stop:a+c.length},d.clearHighlights(d.highlighClassName),
d.addHighlight({start:a,stop:a+c.length,className:d.highlighClassName}),d.renderHighlights()}else d.clearHighlights(d.highlighClassName)},shouldActivate:function(d){return!1},val:function(d,c){return d},onkeydown:function(d,c){return!0},oninput:function(d,c){return!0},defaults:{highlighClassName:"composer-url-highlight",loadingText:"..."}};return e}();f.fn.evolutionComposer.plugins.urlhighlight=g;return{}},jQuery,window);u("events","events.gestures events.hashchange events.notifications events.systemnotifications events.pointers events.scroll events.textinput events.resized events.comments events.presence events.activitystories events.wake events.forums events.quote events.rendered events.likes events.ideaVotes events.mutate".split(" "),
function(){return{}});u("events.activitystories",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.activitystories&&(f.telligent.evolution.sockets.activitystories.on("created",function(f){g.publish("activitystory.created",f)}),f.telligent.evolution.sockets.activitystories.on("updated",function(f){g.publish("activitystory.updated",f)}),f.telligent.evolution.sockets.activitystories.on("deleted",function(f){g.publish("activitystory.deleted",
f)}))});return{}},jQuery,window);u("events.comments",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.comments&&(f.telligent.evolution.sockets.comments.on("created",function(f){g.publish("comment.created",f)}),f.telligent.evolution.sockets.comments.on("updated",function(f){g.publish("comment.updated",f)}),f.telligent.evolution.sockets.comments.on("deleted",function(f){g.publish("comment.deleted",f)}),f.telligent.evolution.sockets.comments.on("typing",
function(f){g.publish("comment.typing",f)}),f.telligent.evolution.sockets.comments.on("voted",function(f){g.publish("comment.voted",f)}),f.telligent.evolution.sockets.comments.on("presenceChanged",function(f){g.publish("comments.presenceChanged",f)}))});return{}},jQuery,window);u("events.forums",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.forums&&(f.telligent.evolution.sockets.forums.on("thread.updated",function(f){g.publish("forumThread.updated",
f)}),f.telligent.evolution.sockets.forums.on("created",function(f){g.publish("forumReply.created",f)}),f.telligent.evolution.sockets.forums.on("updated",function(f){g.publish("forumReply.updated",f)}),f.telligent.evolution.sockets.forums.on("deleted",function(f){g.publish("forumReply.deleted",f)}),f.telligent.evolution.sockets.forums.on("typing",function(f){g.publish("forumReply.typing",f)}),f.telligent.evolution.sockets.forums.on("voted",function(f){g.publish("forumReply.voted",f)}),f.telligent.evolution.sockets.forums.on("presenceChanged",
function(f){g.publish("forumThread.presenceChanged",f)}),f.telligent.evolution.sockets.forums.on("threadvoted",function(f){g.publish("forumThread.voted",f)}))});return{}},jQuery,window);u("events.gestures",["events.pointers","lib.util"],function(g,f,k,m){function n(a){return(new Date).getTime()-(a||(new Date).getTime())}function e(a,b,c,h){a=180*Math.atan2(b-h,c-a)/Math.PI;0>a&&(a+=360);return a}function d(a){if(315<a||45>=a)return"right";if(45<a&&135>=a)return"up";if(135<a&&225>=a)return"left";if(225<
a&&315>=a)return"down"}function c(a,b,c){if(a.selector){var h=k(b.originalEvent.target);if(h.is(a.selector)||0<h.closest(a.selector).length)return c.call(this,b)}else return c.call(this,b)}function b(a,b,c,h){c.target=a.target;h?b.trigger(c):b&&b.triggerHandler(c);return a.cancelBubble==p?!0:a.cancelBubble}function a(a,p){var v;a.on(h.start+l,function(h){return c(p,h,function(){v&&m.clearTimeout(v.tapHoldDurationout);v={startTime:(new Date).getTime(),startPageX:h&&h.pointers&&1<=h.pointers.length?
h.pointers[0].pageX:0,startPageY:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0,held:!1,tapHoldDurationout:null,lastTap:v?v.lastTap:0};v.tapHoldDurationout=m.setTimeout(function(){v.held=!0;b(h,a,{type:t.taphold,pointers:h.pointers,originalEvent:h,duration:n(v.startTime||(new Date).getTime())})},q.tapHoldDuration)})});a.on(h.move+l,function(h){return c(p,h,function(){if(v){var c=Math.abs(Math.sqrt(Math.pow((h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0)-v.startPageX,2)+Math.pow((h&&
h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0)-v.startPageY,2)));v.tapHoldDurationout&&c>=q.tapHoldMaxDistance&&m.clearTimeout(v.tapHoldDurationout);if(v.panning||h&&h.pointers&&1===h.pointers.length&&c>q.panMinDistance){var c=e(v.startPageX,v.startPageY,h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0,h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0),l=d(c),c={type:t.panStart,pointers:h?h.pointers:[],originalEvent:h,angle:c,direction:l,pageX:h&&h.pointers&&1<=h.pointers.length?
h.pointers[0].pageX:0,pageY:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0};v.panning||(v.panning=!0,b(h,a,c,!0));c.type=t.pan;b(h,a,c,!0)}}})});a.on(h.end+l,function(h){return c(p,h,function(){if(v){m.clearTimeout(v.tapHoldDurationout);var c=n(v.startTime||(new Date).getTime()),l=Math.abs(Math.sqrt(Math.pow((h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0)-v.startPageX,2)+Math.pow((h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0)-v.startPageY,2)));if(!v.held&&c<=q.tapMaxDuration&&
l<=q.tapMaxDistance)c={type:t.tap,pointers:h?h.pointers:[],originalEvent:h,duration:c},b(h,a,c),l=(new Date).getTime(),v.lastTap&&l-v.lastTap<=q.doubleTapMaxDuration?(c.type=t.doubleTap,b(h,a,c),v.lastTap=0):v.lastTap=l;else if(v.panning&&b(h,a,{type:t.panEnd,pointers:h?h.pointers:[],originalEvent:h,pageX:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0,pageY:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0},!0),h&&h.pointers&&1===h.pointers.length&&l/c>=q.swipeMinVelocity){var p=
e(v.startPageX,v.startPageY,h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0,h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0),l=d(p),c={type:t.swipe,pointers:h?h.pointers:[],originalEvent:h,duration:c,angle:p,direction:l,pageX:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageX:0,pageY:h&&h.pointers&&1<=h.pointers.length?h.pointers[0].pageY:0};b(h,a,c,!0);c.type+=l;b(h,a,c,!0)}else v={}}})})}var l="._gesture_events_namespace",p,t={tap:"tap",taphold:"taphold",doubleTap:"doubletap",
swipe:"swipe",swipeUp:"swipeup",swipeDown:"swipedown",swipeRight:"swiperight",swipeLeft:"swipeleft",panStart:"panstart",pan:"pan",panEnd:"panend"},q={tapHoldDuration:400,tapHoldMaxDistance:1,tapMaxDuration:350,tapMaxDistance:10,swipeMinVelocity:0.5,panMinDistance:10,doubleTapMaxDuration:250},h={start:"pointerstart",move:"pointermove",end:"pointerend"};if(k.telligent&&k.telligent.evolution&&k.telligent.evolution._SUPPRESS_GESTURES)return{eventNamespace:l.substring(1)};window.onorientationchange===
p&&(k.event.special.orientationchange={setup:function(){var a=k(window),b,c=function(){a.trigger("orientationchange")};window.addEventListener("resize",f.requestAnimationFrameThrottle(function(a){m.clearTimeout(b);b=m.setTimeout(c,100)}),!1)}});var v={"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"};k.each(t,function(b,c){k.event.special[c]=
{add:function(b){var h=k(this);c===t.taphold&&h.css(v);h.data("._gesture_events_bound")||(h.data("._gesture_events_bound",!0),a(h,b))},remove:function(a){a=k(this);a.off(l);a.removeData("._gesture_events_bound")}}});k.gestures={defaults:q};return{eventNamespace:l.substring(1)}},jQuery,window);u("events.hashchange",function(g,f){var k="onhashchange"in f&&(void 0===document.documentMode||7<document.documentMode),m=f.location.href,n=g(f),e;k||(g.event.special.hashchange={setup:function(){e||(e=setInterval(function(){f.location.href!==
m&&(m=f.location.href,n.trigger("hashchange"))},g.hashChangeSettings.interval))}});g.hashChangeSettings={interval:10};return{}},jQuery,window);u("events.ideaVotes",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.ideaVotes&&(f.telligent.evolution.sockets.ideaVotes.on("created",function(f){g.publish("ideaVote.created",f)}),f.telligent.evolution.sockets.ideaVotes.on("deleted",function(f){g.publish("ideaVote.deleted",f)}))});return{}},jQuery,
window);u("events.textinput",function(g,f,k){var m="oninput"in document.createElement("input")&&"oninput"in document.createElement("textarea");g.event.special.textinput={setup:function(){var f=g(this);if(m)f.on("input",function(d){f.trigger("textinput",{which:d.which})});else{var e;f.on({keydown:function(d){e=f.val()},keyup:function(d){var c=f.val();c!==e&&f.trigger("textinput",{which:d.which});e=c}})}}};return{}},jQuery,window);u("events.likes",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",
function(){f.telligent.evolution.sockets.likes&&(f.telligent.evolution.sockets.likes.on("created",function(f){g.publish("like.created",f)}),f.telligent.evolution.sockets.likes.on("deleted",function(f){g.publish("like.deleted",f)}))});return{}},jQuery,window);u("events.mutate",function(g,f){g.event.special.mutate={add:function(f){if(MutationObserver){var m=g(this);m.data("_mutation_observed")||(m.data("_mutation_observed",!0),(new MutationObserver(function(g){m.trigger("mutate",g)})).observe(this,
{childList:!0,characterData:!1,attributes:!1}))}}};return{}},jQuery,window);u("events.notifications",["module.messaging"],function(g,f,k){function m(b){if(!(e&&b&&b.typeId&&d))return!1;for(var a=0;a<d.length;a++)if(!d[a](b))return!0;var c=e[b.typeId];if(!c)return!1;for(a=0;a<c.length;a++)if(!c[a](b))return!0;return!1}var n=0,e={},d=[],c={addFilter:function(b,a){if(b)return"function"===typeof b&&(a=b,b=null),a=a||function(){return!1},n++,a.filterId=n,b?(e[b]=e[b]||[],e[b].push(a)):d.push(a),n},removeFilter:function(b,
a){if(b){var c=e[b];c&&(a?(c=f.grep(c,function(b){return b.filterId!=a}),e[b]=c,d=f.grep(d,function(b){return b.filterId!=a})):delete e[b])}},clearFilters:function(){e={};d=[];n=0}};return{initiate:function(){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.notifications&&(f.telligent.evolution.sockets.notifications.on("received",function(b){m(b)&&(b.suppress=!0);g.publish("notification.raised",b)}),f.telligent.evolution.sockets.notifications.on("read",function(b){m(b)&&(b.suppress=
!0);g.publish("notification.read",b)}))});f.telligent=f.telligent||{};f.telligent.evolution=f.telligent.evolution||{};f.telligent.evolution.notifications=f.extend(f.telligent.evolution.notifications||{},c)}}},jQuery,window);u("events.pointers",["lib.util","lib.events"],function(g,f,k,m,n){function e(a,b){this.pageX=a;this.pageY=b}function d(a){return[new e(a.pageX,a.pageY)]}function c(a){if(!a||!a.length)return[];for(var b=[],c=0;c<a.length;c++)b[b.length]=new e(a[c].pageX,a[c].pageY);return b}function b(a){return[new e(a.originalEvent.pageX,
a.originalEvent.pageY)]}function a(a,b,c,h){a&&a.length&&a.triggerHandler({type:b,pointers:c,originalEvent:h,target:h.target})}function l(a,b,c,h){if(a.selector){if(c=k(c.target),c.is(a.selector)||0<c.closest(a.selector).length)return h.call(this,b)}else h.call(this,b)}function p(){var a={pointermove:"tepointermove",pointerstart:"tepointerstart",pointerend:"tepointerend"};k.fn.on=k.fn.bind=t(k.fn.on,a,!0);k.fn.trigger=t(k.fn.trigger,a,!1);k.fn.off=k.fn.unbind=t(k.fn.off,a,!1)}function t(a,b,c){return function(){var h=
Array.prototype.slice.call(arguments,0);if(c&&1===h.length&&k.isPlainObject(h[0])){var d=h[0];k.each(b,function(a,b){d[a]!=n&&(d[b]=d[a],delete d[a])});return a.call(this,d)}if("string"!=typeof h[0])return a.apply(this,h);eventParts=h[0].split(".",2);if(2==eventParts.length&&"_pointer_events_namespace"==eventParts[1])return a.apply(this,h);b[eventParts[0]]&&(eventParts[0]=b[eventParts[0]],h[0]=eventParts.join("."));return a.apply(this,h)}}var q={start:"pointerstart",testart:"tepointerstart",move:"pointermove",
temove:"tepointermove",end:"pointerend",teend:"tepointerend"};m={pointerMoveThrottle:10};if(k.telligent&&k.telligent.evolution&&k.telligent.evolution._SUPPRESS_POINTERS)return{eventNamespace:"_pointer_events_namespace"};var h=window.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup",cancel:"pointercancel"}:{down:"MSPointerDown",move:"MSPointerMove",up:"MSPointerUp",cancel:"MSPointerCancel"},v=[{test:function(){return"onmspointerdown"in window||"onpointerdown"in window},add:function(c,
d){var p=!1;c.on(h.down+"._pointer_events_namespace",function(h){h.button&&0<h.button||l(d,h,h.originalEvent,function(){a(c,q.testart,b(h),h);p=!0})});c.on(h.move+"._pointer_events_namespace",g.requestAnimationFrameThrottle(function(h){l(d,h,h.originalEvent,function(){p&&a(c,q.temove,b(h),h)})}));c.on(h.up+"._pointer_events_namespace",function(h){h.button&&0<h.button||l(d,h,h.originalEvent,function(){p=!1;a(c,q.teend,b(h),h)})});c.on(h.cancel+"._pointer_events_namespace",function(h){l(d,h,h.originalEvent,
function(){p=!1;a(c,q.teend,b(h),h)})})},remove:function(a){a.off("._pointer_events_namespace")}},{test:function(){return"ontouchstart"in window},add:function(b,h){var d=!1,p=!0;h&&(h.data&&h.data.passive!==n)&&(p=h.data.passive);var e=b.get(0);e&&(f.addHandler(e,"touchstart._pointer_events_namespace",function(p){l(h,p,p,function(){a(b,q.testart,c(p.touches),p);d=!0})},{passive:p}),f.addHandler(e,"touchmove._pointer_events_namespace",g.requestAnimationFrameThrottle(function(p){l(h,p,p,function(){d&&
a(b,q.temove,c(p.touches),p)})}),{passive:p}),f.addHandler(e,"touchend._pointer_events_namespace",function(p){l(h,p,p,function(){d=!1;a(b,q.teend,c(p.changedTouches),p)})},{passive:p}),f.addHandler(e,"touchcancel._pointer_events_namespace",function(p){l(h,p,p,function(){d=!1;a(b,q.teend,c(p.changedTouches),p)})},{passive:p}))},remove:function(a){(a=a.get(0))&&f.removeHandler(a,"._pointer_events_namespace")}},{test:function(){return"onmousedown"in document},add:function(b,c){var h=!1;b.on("mousedown._pointer_events_namespace",
function(p){1===p.which&&l(c,p,p.originalEvent,function(){a(b,q.testart,d(p),p);h=!0})});b.on("mousemove._pointer_events_namespace",g.requestAnimationFrameThrottle(function(p){l(c,p,p.originalEvent,function(){h&&a(b,q.temove,d(p),p)})}));b.on("mouseup._pointer_events_namespace",function(p){1===p.which&&l(c,p,p.originalEvent,function(){h=!1;a(b,q.teend,d(p),p)})});b.on("mouseleave._pointer_events_namespace",function(p){l(c,p,p.originalEvent,function(){h&&a(b,q.teend,d(p),p);h=!1})})},remove:function(a){a.off("._pointer_events_namespace")}}],
s,w=0;for(;w<v.length;w++)!s&&v[w].test()&&(s=v[w]);if(s){for(var r in q)k.event.special[q[r]]={add:function(a){var b=k(this);b.data("._pointer_events_bound")||(b.data("._pointer_events_bound",!0),s.add(b,a))},remove:function(a){a=k(this);s.remove(a);a.removeData("._pointer_events_bound")}};k.pointer={defaults:m};p();return{eventNamespace:"_pointer_events_namespace"}}},jQuery,window);u("events.presence",["module.messaging"],function(g,f,k){g.subscribe("socket.connected",function(){f.telligent.evolution.sockets.presence&&
(f.telligent.evolution.sockets.presence.on("userPresenceChanged",function(f){g.publish("user.presenceChanged",f)}),f.telligent.evolution.sockets.usersPresence.on("usersPresenceChanged",function(f){g.publish("users.presenceChanged",f)}))});return{}},jQuery,window);u("events.quote",function(g,f){function k(){if(!c){g(document).on("selectionchange._evolution_quote",function(){d()});if(!("onselectionchange"in document))g(document).on("mousemove._evolution_quote",function(){d()});g(document).on("customizepage._evolution_quote",
function(){m()});l=g('<a href="#" class="evolution-quote-handle"></a>').html(g.event.special.quote.defaults.quoteText).hide().on("click",function(a){null!=b&&(g(b.element).trigger(g.Event("quote",{quotedHtml:b.html})),t=!1,l.hide(),f.getSelection?f.getSelection().empty?f.getSelection().empty():f.getSelection().removeAllRanges&&f.getSelection().removeAllRanges():document.selection&&document.selection.empty());return!1}).on("mouseout",function(a){t=!1}).on("mouseover mousemove",function(a){t||(a.buttons&&
0!=a.buttons?l.hide():t=!0)}).appendTo(g("body"));c=!0}}function m(){!c||0<a.length||(g(document).off("._evolution_quote"),l.remove(),l=null,c=!1)}function n(b){for(var c=0;c<a.length;c++)if(a[c].parentElement==b||g.contains(a[c].parentElement,b)){if(!a[c].selector)return!0;c=g(a[c].selector,g(a[c].parentElement));return 0<c.filter(b).length||0<c.find(b).length}return!1}function e(){if(window.getSelection){var a=window.getSelection();if(a&&0<a.rangeCount&&0<a.toString().length){var b=a.anchorNode;
if(null!=b&&null!=a.focusNode)for(;!g.contains(b,a.focusNode);)b=b.parentNode;var a=a.getRangeAt(0),c=null,d=null,l=null,p=null,e=null;if(null!=a){var t=a.getClientRects();if(t&&0<t.length)for(var f=0;f<t.length;f++){e=t[f];if(null==d||e.top<d)d=e.top;if(null==c||e.left<c)c=e.left;if(null==l||e.left+e.width>l)l=e.left+e.width;if(null==p||e.top+e.height>p)p=e.top+e.height}e=document.createElement("div");e.appendChild(a.cloneContents());e=e.innerHTML}return{html:e,element:b,left:c,top:d,width:null!=
c&&null!=l?l-c:null,height:null!=d&&null!=p?p-d:null}}}else if(document.selection&&(b=document.selection.createRange())&&b.text)return e=b.getBoundingClientRect(),{html:b.htmlText,element:b.parentElement(),left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top};return null}function d(){var a=e();a&&null!=a.html&&0<a.html.length&&a.element&&n(a.element)?(f.clearTimeout(p),b=a,l.show().css({position:"absolute",left:a.left+g(f).scrollLeft()+"px",top:a.top+a.height+g(f).scrollTop()+"px"})):
(f.clearTimeout(p),p=f.setTimeout(function(){b=null;c&&l&&(t=!1,l.hide())},250))}var c=!1,b=null,a=[],l,p=null,t=!1;g.event.special.quote={setup:function(){},add:function(b){a.push({parentElement:this,selector:b.selector});k()},remove:function(b){var c=this,d=!1;a=g.grep(a,function(a){if(d||a.parentElement!=c||a.selector!=b.selector)return!0;if(!d)return d=!0,!1});m()},teardown:function(){},defaults:{quoteText:"Quote"}};return{}},jQuery,window);u("events.rendered",function(g,f,k){var m={},n=function(e){e&&
m[e]!=k&&(m[e]--,0===m[e]&&g(e).trigger(g.Event("rendered")))};g.event.special.rendered={setup:function(){m[this]=0},add:function(e){},remove:function(e){},teardown:function(){delete m[this]},noBubble:!0};return{incrementLoading:function(e){e.get&&(e=e.get(0));e&&m[e]!=k&&m[e]++},decrementLoading:function(e){e.get?n(e.get(0)):n(e)}}},jQuery,window);u("events.resized",["lib.util"],function(g,f,k,m){var n=0;f.event.special.resized={setup:function(e){e=f("<div></div>").css({position:"absolute",width:"100px",
height:"100px",overflow:"scroll",left:"-200px"});f("body").append(e);try{var d=e.get(0);n=d.offsetWidth-d.clientWidth}catch(c){n=0}e.remove()},add:function(){function e(){v=a.width();w=a[0].scrollWidth;s=a.height();r=a[0].scrollHeight;if(Math.abs(v-p)>n||Math.abs(s-t)>n||Math.abs(w-q)>n||Math.abs(r-h)>n){var b={oldWidth:p,oldHeight:t,oldScrollWidth:q,oldScrollHeight:h,newWidth:v,newHeight:s,newScrollWidth:w,newScrollHeight:r};p=v;t=s;q=w;h=r;c.trigger("resized",b)}}function d(){k.clearTimeout(l);
l=k.setTimeout(e,f.event.special.resized.defaults.throttle)}var c=f(this);if(!c.data("_resized_init")){c.data("_resized_init",!0);var b=this===document||this===k,a=b?f(window):c,l,p=0,t=0,q=0,h=0,v,s,w,r,p=a.width(),t=a.height(),q=a.get(0).scrollWidth,h=a.get(0).scrollHeight;if(b)a.on("resize",g.requestAnimationFrameThrottle(d));else a.data("_resized_init",{intervalHandle:k.setInterval(e,1E3)})}},teardown:function(){var e=this===document||this===k,d=e?f(window):f(this);e||((e=d.data("initDataKey"))&&
e.intervalHandle&&k.clearInterval(e.intervalHandle),d.data("initDataKey",!1))}};f.event.special.resized.defaults={throttle:25};return{}},jQuery,window);u("events.scroll",["lib.events"],function(g,f,k){(function(){var k={};f.event.special.scrollend={setup:function(g){k=f.extend({padding:150,delay:250,initialLoadAttempts:10,initialLoadDelay:1E3},g)},add:function(){var n=f(this);if(!n.data("_scrollend_init")){n.data("_scrollend_init",!0);var e=this===document,d=e?f(window):n,c=!1,b=-1,a=0,l=!1,p=function(){return e?
f("body").prop("scrollHeight")||d.height()+1:d.prop("scrollHeight")||d.height()+1};g.addHandler(d.get(0),"scroll",function(){c=!0},{passive:!0});setInterval(function(){if(c){var a;a=e?f(n).height()-f(n).scrollTop()-f(d).height()<=k.padding:n.scrollTop()+n.innerHeight()+k.padding>=n[0].scrollHeight;a?n.trigger("scrollend"):c=!1}},k.delay);setInterval(function(){if(l){var c=d.height();c>b&&(b=c,p()<=b&&(a=0,l=!1))}else b=d.height(),p()<=b+10&&a<k.initialLoadAttempts?(a++,n.trigger("scrollend")):l=!0},
k.initialLoadDelay)}}}})();(function(){var k={};f.event.special.scrolltop={setup:function(g){k=f.extend({padding:150,delay:250},g)},add:function(){var n=f(this);if(!n.data("_scrolltop_init")){n.data("_scrolltop_init",!0);var e=this===document?f(window):n,d=!1;g.addHandler(e.get(0),"scroll",function(){d=!0},{passive:!0});setInterval(function(){d&&(n.scrollTop()<=k.padding&&n.trigger("scrolltop"),d=!1)},k.delay)}}}})();return{}},jQuery,window);u("events.systemnotifications",["module.messaging"],function(g,
f,k){f.telligent.evolution.messaging.subscribe("socket.connected",function(){f.telligent.evolution.sockets.systemnotifications&&(f.telligent.evolution.sockets.systemnotifications.on("received",function(g){f.telligent.evolution.messaging.publish("systemnotification.raised",g)}),f.telligent.evolution.sockets.systemnotifications.on("resolved",function(g){f.telligent.evolution.messaging.publish("systemnotification.resolved",g)}))});return{}},jQuery,window);u("events.wake",["lib.backgroundTimer"],function(g,
f,k,m){f.event.special.wake={setup:function(n){var e=(new Date).getTime();g.setInterval(function(){var d=(new Date).getTime();4E3<d-e&&f(k).trigger("wake");e=d},2E3)}};return{}},jQuery,window);u("lib","lib.actionSheet lib.dynamicLinks lib.messageLinks lib.scrollFix lib.sheet lib.sheetProvider lib.util lib.touchEventAdapter lib.globalConfiguration lib.storageProxy lib.lruCache lib.scrollable lib.backgroundTimer lib.reflow lib.storageShim lib.imagePreview lib.legacyFormFilter lib.jsSupport lib.events lib.cookies lib.jQueryShim lib.keyboardActive".split(" "),
function(){return{}});u("lib.actionSheet",function(g,f,k){function m(e,d){var c=g(document.createElement("li"));c.append(d);e.append(c)}function n(e,d){var c=g(document.createElement("ul"));c.addClass("action-sheet");for(var b=0;b<d.length;b++)m(c,d[b]);c.on("click","a",function(a){e.sheet.hide()});e.sheet.show(c);e.content=c}return function(e){e=e||{};e.sheet=e.sheet;return{show:function(d){d=d||{};d.links=d.links||[];n(e,d.links||[])},hide:function(){e.sheet.hide()},content:function(){return e.content}}}},
jQuery,window);u("lib.backgroundTimer",function(g,f){var k=null,m=g.self!==g.top;if(g.Worker&&g.Blob&&!m)try{var n=g.URL.createObjectURL(new Blob(["\t\t\t\tvar ids = {};\t\t\t\tonmessage = function(e) {\t\t\t\t\tvar name = e.data.name,\t\t\t\t\t\tid = e.data.id,\t\t\t\t\t\tduration = e.data.duration;\t\t\t\t\tif (name === 'st') {\t\t\t\t\t\tids[id] = setTimeout(function(){\t\t\t\t\t\t\tpostMessage(id);\t\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t\t}\t\t\t\t\t\t}, duration);\t\t\t\t\t} else if (name === 'ct') {\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\tclearTimeout(ids[id]);\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t}\t\t\t\t\t} else if (name === 'si') {\t\t\t\t\t\tids[id] = setInterval(function(){\t\t\t\t\t\t\tpostMessage(id);\t\t\t\t\t\t}, duration);\t\t\t\t\t} else if (name === 'ci') {\t\t\t\t\t\tif(ids[id]) {\t\t\t\t\t\t\tclearInterval(ids[id]);\t\t\t\t\t\t\tdelete ids[id];\t\t\t\t\t\t}\t\t\t\t\t}\t\t\t\t}\t\t\t"])),
e=new Worker(n),d=0,c={},k={setTimeout:function(a,b){d++;c[d]=a;e.postMessage({name:"st",id:d,duration:b});return d},clearTimeout:function(a){delete c[a];e.postMessage({name:"ct",id:a})},setInterval:function(a,b){d++;c[d]=a;e.postMessage({name:"si",id:d,duration:b});return d},clearInterval:function(a){delete c[a];e.postMessage({name:"ci",id:a})}};e.onmessage=function(a){if(a.data&&c[a.data])c[a.data]()}}catch(b){}k||(k={setTimeout:function(a,b){return g.setTimeout(a,b)},clearTimeout:function(a){return g.clearTimeout(a)},
setInterval:function(a,b){return g.setInterval(a,b)},clearInterval:function(a){return g.clearInterval(a)}});return k},window);u("lib.cookies",["module.url","lib.globalConfiguration"],function(g,f,k,m,n){function e(b){document.cookie=g.encode(b)+"=;path="+f.baseUrl+";Max-Age=-999;"}var d=function(){var b=/[.*+?^${}()|[\]\\]/g;return function(a){return a.replace(b,"\\$&")}}(),c={set:function(b,a){null===a||a===n?e(b):document.cookie="https:"==m.location.protocol?g.encode(b)+"="+g.encode(a)+";path="+
f.baseUrl+";SameSite="+f.cookieSameSiteSetting+";secure":g.encode(b)+"="+g.encode(a)+";path="+f.baseUrl+";SameSite="+f.cookieSameSiteSetting},get:function(b){return(b=document.cookie.match("(^|;)\\s*"+d(b)+"\\s*=\\s*([^;]+)"))?b.pop():null},remove:function(b){e(b)}};k.telligent||(k.telligent={});k.telligent.evolution||(k.telligent.evolution={});return k.telligent.evolution.cookies=c},jQuery,window);u("lib.crossWindowBus",["lib.backgroundTimer"],function(g,f,k,m){function n(a,b){this.key=a;if("BroadcastChannel"in
k)this.channel=new BroadcastChannel(this.key),this.channel.onmessage=function(a){b(a.data)};else f(k).on("storage",function(c){if(c.originalEvent&&c.originalEvent.key===a&&c.originalEvent.newValue&&0<c.originalEvent.newValue.length)try{var d=JSON.parse(c.originalEvent.newValue);d&&b(d)}catch(e){}})}function e(a,b,c){return{source:b.source,local:b.source===a.id,broadcast:c}}function d(a,b,c,d){var q={name:c,data:d,source:a.id,target:b,salt:Math.floor(1E5*Math.random())};a.transport.send(q);a.includeLocal&&
(a.receive&&b===a.id)&&g.setTimeout(function(){a.receive(c,d,e(a,q,!1))},0)}function c(a,b,c){var d={name:b,data:c,source:a.id,salt:Math.floor(1E5*Math.random())};a.transport.send(d);a.includeLocal&&a.receive&&g.setTimeout(function(){a.receive(b,c,e(a,d,!0))},0)}var b={key:"__cwb",receive:null,includeLocal:!1};n.prototype.send=function(a){this.channel?this.channel.postMessage(a):localStorage.setItem(this.key,JSON.stringify(a))};return function(a){var l=f.extend({},b,a||{},{id:Math.floor(1E5*Math.random())});
l.transport=new n(l.key,function(a){try{a.source!=l.id&&(a.target!==m&&a.target===l.id?l.receive(a.name,a.data,e(l,a,!1)):a.target===m&&l.receive(a.name,a.data,e(l,a,!0)))}catch(b){}});return{id:function(){return l.id},broadcast:function(a,b){c(l,a,b)},send:function(a,b,c){d(l,a,b,c)}}}},jQuery,window);u("lib.devicePixelRatio",["lib.cookies"],function(g,f,k,m){function n(){return Math.round(window.devicePixelRatio||1)||1}return{setCookie:function(e){g.set(".te.dpr",n())},getRatio:n}},jQuery,window);
u("lib.dynamicLinks",["lib.scrollFix","lib.actionSheet"],function(g,f,k,m,n){function e(a){var b=k.extend({},h);"vertical"!=a.direction&&(b.display="flex");return b}function d(a){var b=a.css("white-space"),c;if("nowrap"===b)c=a.outerWidth(!0);else{var h=a.get(0)&&!!a.get(0).style["white-space"];a.css("white-space","nowrap");c=a.outerWidth(!0);h?a.css("white-space",b):a.css("white-space","")}return c}function c(a){return a.scrollWidth>a.clientWidth}function b(a){var b,h,d;b=e(a);if("vertical"==a.direction){if(a.listWrapper||
(a.listWrapper=k(document.createElement("div")).addClass("container").appendTo(a.parent)),!a.list){a.list=k(document.createElement("ul")).appendTo(a.listWrapper).css(b);for(b=0;b<a.links.length;b++)(h=a.links[b])&&h.element&&(d=k(document.createElement("li")).append(h.element),h.listItem=d,a.list.append(d),h.isOverflowed=!1);a.moreLink!=n&&(d=k(document.createElement("li")).append(a.moreLink.element),a.moreLink.listItem=d,a.list.append(d))}}else{a.parent.css({overflow:"hidden"});a.listWrapper||(a.listWrapper=
k(document.createElement("div")).css(q).addClass("container").appendTo(a.parent));if(!a.list){a.list=k(document.createElement("ul")).appendTo(a.listWrapper).css(b);for(b=0;b<a.links.length;b++)(h=a.links[b])&&h.element&&(d=k('<li class="'+h.className+'"></li>').append(h.element),h.listItem=d,a.list.append(d),h.isOverflowed=!1);a.moreLink!=n&&(d=k(document.createElement("li")).append(a.moreLink.element),a.moreLink.listItem=d,a.list.append(d))}a.list.hide();a.parentWidth=a.listWrapper.width();a.list.show();
if(c(a.listWrapper.get(0)))a.listWrapper.on("pan swipe pointerend",function(a){"left"!=a.direction&&"right"!=a.direction||a.stopPropagation()});g.preventBounce(a.listWrapper)}}function a(a){var b,c,h,l,p;a.lastAdditionalLinkCount===n&&(a.lastAdditionalLinkCount=0);a.additionalLinks=[];a.accumulatedWidth=0;a.preScrollTo=0;if("vertical"==a.direction){for(c=0;c<a.links.length;c++)h=a.links[c],c>a.maxLinks-1?(a.additionalLinks.push(h),h.listItem.hide(),h.isOverflowed=!0):(h.isOverflowed&&(h.listItem.append(h.element).show(),
h.isOverflowed=!1),h.listItem.addClass(h.className).appendTo(a.list));a.moreLink&&a.list.append(a.moreLink.listItem.append(a.moreLink.element).show())}else{for(c=a.moreLinkWidth=0;c<a.links.length;c++){h=a.links[c];if(!h.element)return;h.isOverflowed&&(h.listItem.append(h.element).show(),h.isOverflowed=!1);h.listItem.appendTo(a.list)}a.moreLink&&(a.list.append(a.moreLink.listItem.append(a.moreLink.element).show()),a.moreLinkWidth=d(a.moreLink.element));for(p=c=0;c<a.links.length;c++)h=a.links[c],
b=h.listItem,l=d(h.element),h.selected&&(a.preScrollTo=a.accumulatedWidth),a.accumulatedWidth+l>a.parentWidth&&p+1<=a.minLinks?a.accumulatedWidth+=l:0<a.additionalLinks.length||(a.accumulatedWidth+l+a.moreLinkWidth>a.parentWidth||p+1>a.maxLinks)&&p+1>a.minLinks?(h.element.detach(),h.isOverflowed=!0,b.hide(),a.additionalLinks.push(h)):a.accumulatedWidth+=l,p++}}function l(a){if("vertical"==a.direction){if(0<a.additionalLinks.length&&a.moreLink&&a.onShowMore)a.moreLink.element.off(t).on("click"+t,function(b){a.onShowMore(a.additionalLinks,
a.cancelLink);return!1});else a.moreLink&&(a.moreLink.element.detach(),a.moreLink.listItem.hide());a.list.css({visibility:"visible"})}else{0<a.additionalLinks.length&&a.moreLink&&a.onShowMore?(a.moreLink.listItem.addClass(a.moreLink.className),a.accumulatedWidth+=a.moreLinkWidth,a.moreLink.element.off(t).on("click"+t,function(b){a.onShowMore(a.additionalLinks,a.cancelLink);return!1})):a.moreLink&&(a.moreLink.element.detach(),a.moreLink.listItem.hide());a.list.css({width:a.accumulatedWidth>a.parentWidth?
a.accumulatedWidth:a.parentWidth});k(a.listWrapper).get(0).scrollLeft=a.preScrollTo-a.preScrollOffset;var b=a.list.height();0!=b&&(a.parent.css({height:b}),a.listWrapper.css({height:b+20}));a.listWrapper.css({visibility:"visible"})}if(a.lastAdditionalLinkCount!=a.additionalLinks.length&&(a.lastAdditionalLinkCount=a.additionalLinks.length,a.onLinksChange))a.onLinksChange({visible:a.links.length-a.additionalLinks.length,hidden:a.additionalLinks.length})}function p(c){k.telligent.evolution.ui.suppress(function(){b(c)});
a(c);k.telligent.evolution.ui.suppress(function(){l(c)})}var t="._dynamicLinks",q={overflow:"hidden","overflow-x":"auto"},h={visible:"hidden","list-style":"none",padding:"0px",margin:"0px",overflow:"hidden"},v=function(a){var b=k.extend({},v.defaults,a||{});return{render:function(){p(b)},addLink:function(a,c){a.element=k(a.element);c!=n?b.links.splice(c,0,a):b.links[b.links.length]=a;b.list&&(a&&a.element)&&(listItem=k('<li class="'+a.className+'"></li>').append(a.element),a.listItem=listItem,b.list.append(listItem),
a.isOverflowed=!1);p(b);return a},removeLink:function(a){"string"===typeof a||a instanceof String?b.links=k.grep(b.links,function(b){return k(b.element).is(a)?(b.listItem?b.listItem.remove():b.element&&b.element.remove(),!1):!0}):(a=k(a).get(0),b.links=k.grep(b.links,function(b){if(b.element.get(0)!==a)return!0;b.listItem?b.listItem.remove():b.element&&b.element.remove();return!1}));p(b)},links:function(a){return a?b.additionalLinks:b.links},cancelLink:function(){return b.cancelLink},moreLink:function(){return b.moreLink},
resize:function(){p(b)},isVisible:function(a){a=k(a).get(0);for(var c=0;c<(b.additionalLinks||[]).length;c++)if(b.additionalLinks[c].element.get(0)===a)return!1;return!0},update:function(a,c){var h=null,d=0;if("string"===typeof a||a instanceof String)for(var l=0;l<b.links.length;l++){if(b.links[l].element.is(a)){d=l;h=b.links[l];break}}else for(a=k(a).get(0),l=0;l<b.links.length;l++)if(b.links[l].element.get(0)===a){d=l;h=b.links[l];break}h&&(null!==c.className&&(h.className=c.className),null!==c.selected&&
(h.selected=c.selected),null!==c.index&&b.links.splice(c.index,0,b.links.splice(d,1)[0]),h&&h.element&&(h.element.detach(),h.listItem.remove(),listItem=k('<li class="'+h.className+'"></li>').append(h.element),h.listItem=listItem,b.list.append(listItem),h.isOverflowed=!1),p(b))},reconfigure:function(a){var c=!1;a.maxLinks!==n&&(b.maxLinks=a.maxLinks,c=!0);a.minLinks!==n&&(b.minLinks=a.minLinks,c=!0);a.direction!==n&&(b.direction=a.direction,c=!0);c&&p(b)}}};v.defaults={preScrollOffset:10,minLinks:0,
maxLinks:50,direction:"vertical",parent:null,links:[],moreLink:null,cancelLink:null,onShowMore:function(a,b){}};return v},jQuery,window);u("lib.events",function(g,f,k){function m(b){var a=!1;return a=b===k||null===b?!1:"boolean"===typeof b?b:!e.capture&&b.capture?b.capture:e.passive?b:!1}function n(b,a,c){delete b.byId[a.id];b.byEventName[a.fullEventName]=(b.byEventName[a.fullEventName]||[]).filter(c);0===b.byEventName[a.fullEventName].length&&delete b.byEventName[a.fullEventName];b.byEventName[a.eventName]=
(b.byEventName[a.eventName]||[]).filter(c);0===b.byEventName[a.eventName].length&&delete b.byEventName[a.eventName];a.nameSpace&&(b.byNameSpace[a.nameSpace]=(b.byEventName[a.nameSpace]||[]).filter(c),0===b.byNameSpace[a.nameSpace].length&&delete b.byNameSpace[a.nameSpace])}var e={capture:!1,passive:!1,once:!1};try{var d={};Object.defineProperty(d,"passive",{get:function(){e.passive=!0}});Object.defineProperty(d,"capture",{get:function(){e.capture=!0}});Object.defineProperty(d,"once",{get:function(){e.once=
!0}});f.addEventListener("testOptions",null,d);f.removeEventListener("testOptions",null,d)}catch(c){}return{addHandler:function(b,a,c,d){d=m(d===k?null:d);var e=a.split(".",2),q=e[0];a={callback:c,nameSpace:1<e.length?e[1]:null,eventName:q,fullEventName:a,options:d,id:0};e=g(b).data("_event_handlers")||{byEventName:{},byNameSpace:{},byId:{},count:0};e.count++;a.id=e.count;e.byEventName[a.eventName]=e.byEventName[a.eventName]||[];e.byEventName[a.eventName].push(a);e.byEventName[a.fullEventName]=e.byEventName[a.fullEventName]||
[];e.byEventName[a.fullEventName].push(a);e.byId[a.id]=a;a.nameSpace&&(e.byNameSpace[a.nameSpace]=e.byNameSpace[a.nameSpace]||[],e.byNameSpace[a.nameSpace].push(a));g(b).data("_event_handlers",e);b.addEventListener?b.addEventListener(q,c,d):b.attachEvent&&b.attachEvent("on"+q,c);return a.id},removeHandler:function(b,a,c,d){function e(a){return a.callback===c}function q(a){return a.callback!==c}if(c){if(b.removeEventListener(a,c,m(d===k?null:d)),d=g(b).data("_event_handlers")){var h=null;(a=(d.byEventName[a]||
[]).filter(e))&&1==a.length&&(h=a[0]);h&&(n(d,h,q),g(b).data("_event_handlers",d))}}else if(Number.isInteger(a)){if(d=g(b).data("_event_handlers"))if(h=d.byId[a])b.removeEventListener(h.eventName,h.callback,h.options),n(d,h,q),g(b).data("_event_handlers",d)}else if(a&&""!=a){d=(a||"").split(".",2);var h=d[0],v=1<d.length?d[1]:null;if(d=g(b).data("_event_handlers")){var s=null;null!==v&&"."+v!==a?s=d.byEventName[a]:null!==v?s=d.byNameSpace[v]:null!==h&&(s=d.byEventName[h]);if(s){a=[];for(v=0;v<s.length;v++)h=
s[v],b.removeEventListener(h.eventName,h.callback,h.options),a.push(h);for(v=0;v<a.length;v++)h=a[v],n(d,h,q);g(b).data("_event_handlers",d)}}}else if(d=g(b).data("_event_handlers")){for(s in d.byId)d.byId.hasOwnProperty(s)&&(h=d.byId[s],b.removeEventListener(h.eventName,h.callback,h.options));g(b).removeData("_event_handlers")}}}},jQuery,window);u("lib.globalConfiguration",function(){return{baseUrl:"",authorizationCookieName:"AuthorizationCookie",defaultErrorMessage:"An error occured while communicating with the server.",
isRemote:!1,remoteUrlEncodePattern:"",accessingUserId:0,accessingUserIsSystemAccount:!0,dateMinuteInFutureFormat:"in a few seconds",dateMinutesInFutureFormat:"in {0} minutes",dateHourInFutureFormat:"in over an hour",dateHoursInFutureFormat:"in {0} hours",dateDayInFutureFormat:"in {0} day",dateDaysInFutureFormat:"in {0} days",dateMonthInFutureFormat:"in {0} month",dateMonthsInFutureFormat:"in {0} months",dateYearInFutureFormat:"in over {0} year",dateYearsInFutureFormat:"in over {0} years",dateNowAgoFormat:"now",
dateMinuteAgoFormat:"a few seconds ago",dateMinutesAgoFormat:"{0} minutes ago",dateHourAgoFormat:"{0} hour ago",dateHoursAgoFormat:"{0} hours ago",dateDayAgoFormat:"{0} day ago",dateDaysAgoFormat:"{0} days ago",dateMonthAgoFormat:"{0} month ago",dateMonthsAgoFormat:"{0} months ago",dateYearAgoFormat:"over {0} year ago",dateYearsAgoFormat:"over {0} years ago",reflowBreakpoint:670,previewZoomIn:"Zoom In",previewZoomOut:"Zoom Out",previewClose:"Close",scheduledFileStatusUrl:"",enableGlobalForm:!1,collapseExpandedItem:"Collapse",
nonDurableProgressTip:"Progress will cancel if you leave.",nonDurableProgressLabel:"Please wait\u2026"}});u("lib.imagePreview",["lib.globalConfiguration"],function(g,f,k,m){function n(a,b){if(0!==a.indexOf(f.telligent.evolution.site.getBaseUrl())&&0!==a.indexOf(f.telligent.evolution.site.getBaseUrl(!0)))return null;var c;c=b?C.exec(a):K.exec(a);return null!=c?c[1]:null}function e(){if(t.height()<p||t.width()<l)return d(r),!0;w.css({"max-width":"100%","max-height":"100%"});return!1}function d(a){a?
(r=!0,w.css({"max-width":"none","max-height":"none",cursor:"move",position:"absolute",left:"0px",top:"0px","z-index":"1"}).addClass("zoomed"),q.hide(),h.show()):(r=!1,w.css({"max-width":"100%","max-height":"100%",cursor:"auto",position:""}).removeClass("zoomed"),q.show(),h.hide())}function c(){f(document).off(".imageviewer");t.css("opacity","0");var a=t;window.setTimeout(function(){a.remove()},100);f("body").css("overflow","")}function b(a){var b,c=a.parents("a").first();if(0<c.length&&c.data("imagepreviewurl")){if(b=
n(c.data("imagepreviewurl")||"",!1),!b)return!1}else if(b=n(a.attr("src")||"",!0),!b||a.hasClass("ui-ignoreimagepreview")||0<c.length&&0>(c.attr("href")||"").indexOf(b))return!1;return b}function a(a){f(".viewer img, .content-fragment-content .content .content img, .user-defined-markup img, .post-attachment-viewer img",a).each(function(){var a=f(this);a.data("_cursor_applied")||(a.data("_cursor_applied",!0),b(a)&&a.css({cursor:"zoom-in"}))})}var l,p,t,q,h,v,s,w,r=!1,x=!1,y,z,A,B,C=/\/resized-image(?:\.ashx)?\/__size\/[0-9]+x[0-9]+\/(.+)/i,
K=/\/cfs\-file(?:\.ashx)?\/(.+)/i,D=g.previewZoomIn,G=g.previewZoomOut,I=g.previewClose;return{register:function(){D=g.previewZoomIn;G=g.previewZoomOut;I=g.previewClose;a(f("body"));var n;f("body").on("mutate",function(b){clearTimeout(n);n=setTimeout(function(){a(f("body"))},500)});f("body").on("click",".viewer img, .content-fragment-content .content .content img, .user-defined-markup img, .post-attachment-viewer img",function(a){a=f(a.target);if(a=b(a)){p=l=0;r=!1;t=f('<div class="image-viewer"></div>').css("opacity",
"0").on("click",function(){c();return!1});q=f('<a href="#" class="zoom-in"></a>').html(D).hide().on("click",function(){d(!0);return!1});h=f('<a href="#" class="zoom-out"></a>').html(G).hide().on("click",function(){d(!1);return!1});v=f('<a href="#" class="close"></a>').html(I).on("click",function(){c();return!1});var g=f('<div class="image-viewer-inner"></div>');s=f('<span class="ui-loading"></span>');w=f('<img src="'+f.telligent.evolution.site.getBaseUrl()+"cfs-file/"+a+'" />').hide().css({"-webkit-touch-callout":"none",
"-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",opacity:"0","max-width":"none","max-height":"none"}).on("load",function(){s.hide().remove();w.show();l=w.outerWidth(!0);p=w.outerHeight(!0);e();w.css("opacity","1")}).on("click",function(a){a.stopPropagation();a.preventDefault()}).on("doubletap",function(a){e()&&(r=!r,d(r));return!1}).on("mousemove pan",function(a){x&&(t.scrollTop(A+(y-a.pageY)),t.scrollLeft(B+(z-a.pageX)))}).on("mousedown panstart",
function(a){r&&(x=!0,A=t.scrollTop(),B=t.scrollLeft(),y=a.pageY,z=a.pageX,a.preventDefault())}).on("mouseup panend",function(){x=!1});f("body").css("overflow","hidden");f(document).off(".imageviewer").on("pointerstart.imageviewer",".image-viewer",function(a){a=this.scrollTop;var b=this.scrollHeight,c=a+this.offsetHeight;0===a?this.scrollTop=1:c===b&&(this.scrollTop=a-1)}).on("pointermove.imageviewer",{passive:!1},function(a){for(var b=a.target,c=!1;null!==b;){if(b.classList&&b.classList.contains("image-viewer")){c=
!0;break}b=b.parentNode}c||a.preventDefault()});g.append(s).append(w);t.append(q).append(h).append(v).append(g);f("body").append(t);t.css("opacity","1");return!1}})}}},jQuery,window);u("lib.jQueryShim",function(g,f,k){return{shim:function(){}}},jQuery,window);u("lib.jsSupport",["lib.cookies"],function(g,f,k,m){return{setCookie:function(f){g.set(".te.js",1)}}},jQuery,window);u("lib.keyboardActive",function(g,f,k){var m=!1,n=function(){m?g("body").addClass("keyboard-active"):g("body").removeClass("keyboard-active")};
return{init:function(){g(f.document).on("keydown",function(e){m||(m=!0,n())}).on("mousedown mouseup mousemove",function(e){m&&(m=!1,n())})}}},jQuery,window);u("lib.legacyFormFilter",["lib.util","lib.globalConfiguration"],function(g,f,k,m,n){var e=!1,d=/\<form(\s|>)/i,c=function(b){try{e=!0;if("string"==typeof b){if(!d.test(b))return e=!1,b;var a=document.createElement("div");a.innerHTML=b;b=a.childNodes}var c=k(b),p=c.find("form"),a=!1;0<p.length&&(p.children().unwrap(),a=!0);if(0<c.filter("form").length){var a=
!0,g=[];c.each(function(){var a=k(this);a.is("form")?a.children().each(function(){g.push(this)}):g.push(this)});c=k(g)}e=!1;return a?c:b}catch(q){return e=!1,b}};return{init:function(){f.enableGlobalForm&&k.each("html append prepend after before replaceWith".split(" "),function(b,a){k.fn[a]=g.wrap(k.fn[a],{filterArguments:function(a){var b=arguments;!e&&0<b.length&&(b[0]=c(b[0]));return b}})})}}},jQuery,window);u("lib.lruCache",function(g,f,k){var m={size:10,load:function(){},persist:function(g){}};
return function(f){function e(){var b=c.load();b||(b={},c.persist(b));return b}var d,c=g.extend({},m,f||{load:function(){return d},persist:function(b){d=b}});return{size:function(){return c.size},get:function(b){var a=e();return a[b]!==k?(a[b].lastAccess=(new Date).getTime(),c.persist(a),a[b].value):null},set:function(b,a){var d=e();if(d[b]!==k)d[b].lastAccess=(new Date).getTime(),d[b].value=a;else{var p;if(Object.keys)p=Object.keys(d);else{p=[];for(var g in d)d.hasOwnProperty(g)&&p.push(g)}if(p.length>=
c.size){p=null;for(var q in d)null==p?p=q:d[q].lastAccess<d[p].lastAccess&&(p=q);null!==p&&delete d[p]}d[b]={lastAccess:(new Date).getTime(),value:a}}c.persist(d)},del:function(b){var a=e();delete a[b];c.persist(a)}}}},jQuery,window);u("lib.messageLinks",function(g,f,k){return function(f){f=f||{};var n=g(f.parent);return{handle:function(e){n.on(e||"click","a[data-messagename], [data-href]",function(d){null!=g(this).data("messagename")&&0<g(this).data("messagename").length?(d.preventDefault(),d.stopPropagation(),
d.stopImmediatePropagation(),g.telligent.evolution.messaging.publish(g(this).data("messagename"),{target:this}),0<g(this).closest(".links-popup-panel").length&&g.fn.uilinks.hide()):"a"!==d.target.tagName.toLowerCase()&&0<g(this).data("href").length&&(d.preventDefault(),d.stopPropagation(),d.stopImmediatePropagation(),location.href=g(this).data("href"))})}}}},jQuery,window);u("lib.reflow",["module.messaging","lib.cookies"],function(g,f,k,m,n){function e(a){var b=a.singleColumnContainers.first().is(":visible"),
d=k(m).width();b&&d>a.minWidth?c(a,"originalRegion",function(a,b){return a.originalOrder-b.originalOrder},function(){a.containers.show();a.singleColumnContainers.hide()}):!b&&d<=a.minWidth&&c(a,"singleColumnRegion",function(a,b){return a.responsiveOrder==b.responsiveOrder?a.regionOrder==b.regionOrder?a.originalOrder-b.originalOrder:a.regionOrder-b.regionOrder:a.responsiveOrder-b.responsiveOrder},function(){a.singleColumnContainers.show();a.containers.hide()})}function d(a){if(!a.fragments){a.fragments=
[];for(var b=a.singleColumnContainers.first().is(":visible")?a.singleColumnContainers:a.containers,c=0;c<b.length;c++)k(".content-fragment",b[c]).each(function(){var b=(k(this).data("reflow")||"").split(",");5===b.length&&a.fragments.push({fragment:k(this),originalRegion:k("#"+b[0]+" .layout-region-inner").first(),singleColumnRegion:k("#"+b[1]),responsiveOrder:parseInt(b[2],10),regionOrder:parseInt(b[3],10),originalOrder:parseInt(b[4],10)})})}}function c(a,b,c,e){d(a);if(!a.reflowing){g.publish("reflow.reflowstart",
{target:"originalRegion"==b?a.singleColumnContainers:a.containers});a.reflowing=!0;a.fragments.sort(c);for(c=0;c<a.fragments.length;c++)a.fragments[c].fragment.appendTo(a.fragments[c][b]);e();a.reflowing=!1;g.publish("reflow.reflowend",{target:"originalRegion"==b?a.containers:a.singleColumnContainers})}}function b(){f.set(".te.w",k(m).width())}return{monitor:function(a){var c=[];a=k(".header-fragments.evolution-reflow-container:not(.single-column)");0<a.length&&c.push({containers:a,singleColumnContainers:k(".header-fragments.evolution-reflow-container.single-column"),
minWidth:parseInt(a.data("reflow-width"),10)});var d=k(".content-fragment-page.evolution-reflow-container:not(.single-column)");0<a.length&&c.push({containers:d,singleColumnContainers:k(".content-fragment-page.evolution-reflow-container.single-column"),minWidth:parseInt(d.data("reflow-width"),10)});d=k(".footer-fragments.evolution-reflow-container:not(.single-column)");0<a.length&&c.push({containers:d,singleColumnContainers:k(".footer-fragments.evolution-reflow-container.single-column"),minWidth:parseInt(d.data("reflow-width"),
10)});b();0<c.length&&(k.each(c,function(a,b){e(b)}),k(m).on("resized",function(){b();k.each(c,function(a,b){e(b)})}))}}},jQuery,window);u("lib.scrollable",["module.messaging"],function(g,f,k,m){function n(a){a.indicator||(a.indicator=a.buildIndicator(),e(a))}function e(a){n(a);a.indicator.css({visibility:"hidden"}).appendTo(a.element())}function d(a,b){n(a);a.indicator.css({visibility:"visible"}).appendTo(a.element())}function c(a){n(a);a.indicator.css({visibility:"hidden"})}function b(b,d){b&&(b.element().off(".scrollable"),
c(b),b.subscription&&g.unsubscribe(b.subscription),a(b))}function a(a){a.loader&&(a.loader.reject(),a.loader=null)}function l(a,b,d){d||(a.disable=!0);a.currentlyLoading=!1;e(a);a&&(2<a.preFillAttempts&&d&&!t(a)?(a.preFillAttempts--,p(a,b)):(n(a),a.indicator.appendTo(a.element())),c(a))}function p(b,c){b.currentlyLoading||(b.currentlyLoading=!0,b.pageIndex++,d(b,c),a(b),b.loader=b.loadCallback(b.pageIndex),b.loader.then(function(a){l(b,c,!0)})["catch"](function(){l(b,c,!1)}))}function t(a){for(var b=
a.element().children(),c=0,d=0;d<b.length;d++){var l=f(b[d]).css("float");"right"!==l&&"left"!==l&&f(b[d]).is(":visible")&&"hidden"!=f(b[d]).css("visibility")&&(c+=f(b[d]).outerHeight())}c-=a.indicator?a.indicator.outerHeight():0;return c>a.container.height()}function q(c){var l={pageIndex:c.initialPageIndex,subscription:null,currentlyLoading:!1,loadCallback:c.load,region:c.region,preFillAttempts:c.preFillAttempts,element:c.element,container:c.container,scrollEndMessage:c.scrollEndMessage,buildIndicator:c.buildIndicator,
initialized:!1};b(l,c.region);var e=function(){0>=l.pageIndex||!t(l)?p(l,!0):n(l)};(function(){l.initialized||(l.initialized=!0,l.subscription=g.subscribe(l.scrollEndMessage,f.telligent.evolution.administration.panelNameSpace(),function(){l.disable||p(l)}),e(),l.element().on("swipeup.scrollable",function(){l.disable||d(l)}))})();var q=null;return{reset:function(){k.clearTimeout(q);q=k.setTimeout(function(){a(l);l.currentlyLoading=!1;l.pageIndex=-1;l.disable=!1;l.preFillAttempts=c.preFillAttempts;
l.initialized&&e()},250)},loadNextPage:function(a){p(l,a)}}}return{register:function(a,b){b=b||{};b.region=a;return q(b)}}},jQuery,window);u("lib.scrollFix",function(g,f,k){function m(g){var e,d=g.get(0);g.on("pointerstart",function(c){e=d.scrollTop;0>=e&&(d.scrollTop=1);e+d.offsetHeight>=d.scrollHeight&&(d.scrollTop=d.scrollHeight-d.offsetHeight-1);originalScrollLeft=d.scrollLeft;0>=originalScrollLeft&&(d.scrollLeft=1);originalScrollLeft+d.offsetWidth>=d.scrollWidth&&(d.scrollLeft=d.scrollWidth-
d.offsetWidth-1)})}return{preventBounce:function(f){f=f||g("body").children().first();m(f)},fix:function(g){g.on("touchmove.scrollfix mousemove.scrollfix mspointermove.scrollfix",function(e){e.originalEvent.preventDefault()})},unfix:function(g){g.off(".scrollfix")}}},jQuery,window);u("lib.sheet",["lib.scrollFix","module.messaging"],function(g,f,k,m,n){function e(a){a.inited||(a.inited=!0,a.backDrop=k(document.createElement("div")).css({backgroundColor:a.backgroundColor,opacity:0.01,zIndex:1E4,position:"fixed",
top:0,left:0,display:"none","-webkit-transform":"translate3d(0,0,0)","-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent),a.sheet=k(document.createElement("div")).css({zIndex:10001,position:"fixed",left:0,top:0,display:"none","-webkit-transform":"translate3d(0,0,0)","-webkit-backface-visibility":"hidden",transform:"translate3d(0,0,0)"}).appendTo(a.parent).addClass(a.cssClass),a.sheet.on("click","a",function(){var a=k(this);(a=a.attr("href")||a.closest("[href]").attr("href"))&&
(1<a.length&&k.telligent&&k.telligent.evolution&&k.telligent.evolution.mobile)&&k.telligent.evolution.mobile.load(a)}),l(a))}function d(a){a.windowWidth=0<window.innerWidth?window.innerWidth:screen.width;a.windowHeight=0<window.innerHeight?window.innerHeight:screen.height;a.visible?(a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight})):(a.backDrop&&a.backDrop.css({width:a.windowWidth,height:a.windowHeight}),a.sheet&&
a.sheet.css({width:a.windowWidth,maxHeight:a.maxHeightPerent*a.windowHeight}))}function c(a,b,c){c=c||a.animationDuration;a.backDrop.evolutionTransform({opacity:a.backDrop.css("opacity")}).evolutionTransform({opacity:0.01+b*a.backgroundOpacity},{duration:c,easing:a.animationEasing});a.sheet.evolutionTransform({y:a.windowHeight-b*a.sheet.outerHeight(),x:0},{duration:c,easing:a.animationEasing});1<=b?a.onOpened&&(m.clearTimeout(a.openedTimeout),a.openedTimeout=m.setTimeout(function(){a.onOpened.apply(this);
m.clearTimeout(a.openedTimeout)},c)):0>=b&&a.onClosed&&(m.clearTimeout(a.closedTimeout),a.closedTimeout=m.setTimeout(function(){a.onClosed.apply(this);m.clearTimeout(a.closedTimeout)},c))}function b(a,b){a.visible||(k("body").css({height:"100%",overflow:"scroll"}),a.visible=!0,a.onOpening&&a.onOpening.apply(this),e(a),d(a),a.sheet.empty().append(b),a.sheet.evolutionTransform({y:a.windowHeight,x:0}),a.backDrop.get(0).style.display="block",a.sheet.get(0).style.display="block",c(a,1))}function a(a,b){a.visible&&
(k("body").css({height:"100%",overflow:"visible"}),a.visible=!1,b=b||a.animationDuration,a.onClosing&&a.onClosing.apply(this),c(a,0),m.setTimeout(function(){a.visible||(a.visible=!1,a.backDrop.get(0).style.display="none",a.sheet.get(0).style.display="none")},b))}function l(b){b.backDrop.on("tap",function(){a(b)})}return function(c){c=c||{};c.maxHeightPerent=c.maxHeightPerent||0.85;c.parent=k(c.parent);c.cssClass=c.cssClass||"sheet";c.backgroundColor=c.backgroundColor||"#333";c.backgroundOpacity=c.backgroundOpacity||
0.5;c.animationDuration=c.animationDuration||250;c.animationEasing=c.animationEasing||"cubic-bezier(0.160, 0.060, 0.450, 0.940)";c.visible=!1;k.telligent.evolution.messaging.subscribe("mobile.orientationchange",function(){m.setTimeout(function(){d(c)},300)});return{show:function(a){b(c,a)},hide:function(){a(c)}}}},jQuery,window);u("lib.sheetProvider",function(g,f,k){return{}},jQuery,window);u("lib.shortcutRegistry",function(g,f,k){function m(a){return a&&a.scope&&document.activeElement?a.scope==document.activeElement||
a.scope.contains(document.activeElement):!0}function n(b,c,d){a="number"==typeof c.which?c.which:c.keyCode;matchingRoute=null;for(var e=0;e<b.routes.length;e++)if(b.routes[e].handler.direction===d&&b.routes[e].keyCode===a&&c.altKey===b.routes[e].altKey&&c.ctrlKey===b.routes[e].ctrlKey&&c.metaKey===b.routes[e].metaKey&&c.shiftKey===b.routes[e].shiftKey&&m(b.routes[e].handler)){matchingRoute=b.routes[e];break}return matchingRoute?(b=matchingRoute.handler.callback.apply(this,[{target:c.target,isInput:g(c.target).is("input,textarea")||
c.target&&c.target.activeElement&&g(c.target.activeElement).is("iframe"),event:c,combination:matchingRoute.combination}]),b===k?!0:b):!0}function e(a){a.inited||(a.inited=!0,a.previous=null,g(document).on("keydown.keyboardRegistrar",function(b){return n(a,b,c.down)}),g(document).on("keyup.keyboardRegistrar",function(b){return n(a,b,c.up)}))}function d(a){g(document).off("keyboardRegistrar");a.routes=[];a.handlers=[]}var c={up:1,down:2},b={LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RET:13,ESC:27,COMMA:188,
SLASH:191,PERIOD:190,SHIFT:16,ALT:18,OPT:18,CTRL:17,META:91,CMD:91},a;return function(a){var p=a||{};p.routes=[];p.handlers=[];p.inited=!1;return{register:function(a,d,h){h=h||{};e(p);if(a&&d){d={description:h.description||null,callback:d,direction:c[h.direction]||c.down,namespace:h.namespace||null,scope:g(h.scope||null).get(0),routes:[]};a=Array.isArray(a)?a:[a];for(h=0;h<a.length;h++){for(var l={combination:a[h],keyCode:null,keyCharacter:null,altKey:!1,metaKey:!1,shiftKey:!1,ctrlKey:!1,handler:d},
f=a[h].toUpperCase().split("+"),w=0;w<f.length;w++){var r=g.trim(f[w]);l.keyCharacter=r;"ALT"!==r&&"OPT"!==r||1==f.length&&l.handler.direction==c.up?"META"!==r&&"CMD"!==r||1==f.length&&l.handler.direction==c.up?"CTRL"!==r||1==f.length&&l.handler.direction==c.up?"SHIFT"!==r||1==f.length&&l.handler.direction==c.up?l.keyCode=b[r]?b[r]:r.charCodeAt(0):l.shiftKey=!0:l.ctrlKey=!0:l.metaKey=!0:l.altKey=!0}d.routes.push(l);p.routes.push(l);l.id=p.routes.length}p.handlers.push(d);d.id=p.handlers.length;return l.id}},
unregister:function(a){if(a===k)p.routes=[],p.handlers=[];else if("string"===typeof a)p.routes=p.routes.filter(function(b){if(b.handler.namespace){if("string"==typeof b.handler.namespace)return b.handler.namespace!==a;if(Array.isArray(b.handler.namespace))return!b.handler.namespace.includes(a)}else return!0}),p.handlers=p.handlers.filter(function(b){if(b.namespace){if("string"==typeof b.namespace)return b.namespace!==a;if(Array.isArray(b.namespace))return!b.namespace.includes(a)}else return!0});else{var b=
p.routes[a];b&&(p.handlers.splice(b.handler.id-1,1),p.routes.splice(a-1,1))}p.routes&&0!==p.routes.length&&a||d(p)},list:function(a){return a&&a.scoped?(p.handlers||[]).filter(function(a){return m(a)}):p.handlers},captureFocus:function(){p.focusedElement=document.activeElement},refocus:function(){if(p.focusedElement)try{g(p.focusedElement).is("iframe")?setTimeout(function(){p.focusedElement&&(g(p.focusedElement.contentWindow.document).find("body[contenteditable]").get(0).focus(),p.focusedElement=
null)},1):(p.focusedElement.focus(),p.focusedElement=null)}catch(a){}}}}},jQuery,window);u("lib.storageProxy",["lib.storageShim"],function(g,f,k){function m(g){this._contextualStore=g.isSystemAccount?k.sessionStorage:k.localStorage;this._user=g}g.shim();m.prototype.set=function(g,e){this._contextualStore&&this._contextualStore.setItem("tc:"+((this._user.isSystemAccount?"":this._user.id+":")+g),JSON.stringify(e))};m.prototype.get=function(g){if(this._contextualStore)return JSON.parse(this._contextualStore.getItem("tc:"+
((this._user.isSystemAccount?"":this._user.id+":")+g)))};m.prototype.del=function(g){this._contextualStore&&this._contextualStore.removeItem("tc:"+((this._user.isSystemAccount?"":this._user.id+":")+g))};m.prototype.empty=function(){this._contextualStore&&this._contextualStore.clear()};return m},jQuery,window);u("lib.storageShim",function(g,f,k){function m(){Storage.prototype.setItem=function(d,c){n[d]=c};Storage.prototype.getItem=function(d){d=n[d];return d===k?null:d};Storage.prototype.removeItem=
function(d){delete n[d]};Storage.prototype.clear=function(){n={}}}var n={},e=!1;return{shim:function(){if(!e){e=!0;var d;try{localStorage.setItem("_te","_te"),localStorage.removeItem("_te"),d=!0}catch(c){d=!1}d||m()}}}},jQuery,window);u("lib.touchEventAdapter",["lib.util","events.gestures","events.pointers"],function(g,f,k,m,n,e){function d(){m.fn.on=m.fn.bind=c(m.fn.on,b,!0);m.fn.trigger=c(m.fn.trigger,b,!1);m.fn.off=m.fn.unbind=c(m.fn.off,b,!1)}function c(a,b,c){return function(){var h=Array.prototype.slice.call(arguments,
0);if(c&&1===h.length&&m.isPlainObject(h[0])){var d=h[0];m.each(b,function(a,b){d[a]!=e&&(d[b]=d[a],delete d[a])});return a.call(this,d)}if("string"!=typeof h[0])return a.apply(this,h);for(var l=[],g=h[0].split(" "),r=0;r<g.length;r++)if(g[r]&&0<g[r].length){var n=g[r].split(".",2);if(2==n.length&&(n[1]==f.eventNamespace||n[1]==k.eventNamespace))return a.apply(this,h);n[0]=b[n[0]]||n[0];l.push(n.join("."))}h[0]=l.join(" ");return a.apply(this,h)}}var b={mouseenter:"taphold",mouseover:"taphold",mouseleave:"pointerend",
mouseup:"pointerend"},a="ontouchstart"in n||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;g=/windows nt/.test(navigator.userAgent.toLowerCase());var l="MouseEvent"in n&&(!("ontouchstart"in n)||g);return{adapt:function(){return n._evolution_adapt_mouse_touch_events!==e?n._evolution_adapt_mouse_touch_events?(d(),!0):!1:a&&!l?(d(),!0):!1}}},jQuery,window);u("lib.util",function(g,f){function k(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var m=function(){var g=/[.*+?^${}()|[\]\\]/g;
return function(e){return e.replace(g,"\\$&")}}();return{requestAnimationFrameThrottle:function(g){if(!window.requestAnimationFrame)return g;var e;return function(){var d=arguments;e&&window.cancelAnimationFrame(e);e=window.requestAnimationFrame(function(){g.apply(void 0,d)})}},throttle:function(f,e){var d,c;return function(){var b=this,a=(new Date).getTime(),l=arguments;d&&d+(e||50)>a?(g.clearTimeout(c),c=g.setTimeout(function(){d=a;f.apply(b,l)},e||50)):(d=a,f.apply(b,l))}},debounce:function(g,
e){var d;return function(){var c=this,b=arguments;clearTimeout(d);d=setTimeout(function(){g.apply(c,b)},e||10)}},wrap:function(g,e){return function(){var d=arguments;try{e.filterArguments&&(d=e.filterArguments.apply(this,d))}catch(c){}try{e.before&&e.before.apply(this,d)}catch(b){}var a=g.apply(this,d);try{e.after&&e.after.apply(this,d)}catch(l){}try{e.filterResponse&&(a=e.filterResponse.apply(this,a))}catch(p){}return a}},guid:function(){return k()+k()+"-"+k()+"-"+k()+"-"+k()+"-"+k()+k()+k()},isArray:function(g){return Array.isArray?
Array.isArray(g):"[object Array]"===Object.prototype.toString.call(g)},indexOf:function(g,e,d){if(Array.prototype.indexOf)return g.indexOf(e,d);if(null==g)throw new TypeError('"this" is null or not defined');g=Object(g);var c=g.length>>>0;if(0===c)return-1;d=+d||0;Infinity===Math.abs(d)&&(d=0);if(d>=c)return-1;for(d=Math.max(0<=d?d:c-Math.abs(d),0);d<c;){if(d in g&&g[d]===e)return d;d++}return-1},isPartiallyVisible:function(f,e,d){d=d||0;if(f==document||f instanceof jQuery&&(f.get(0)==document||f.is("body"))){var c=
e instanceof jQuery?e.get(0).getBoundingClientRect():e.getBoundingClientRect();return 0<c.top-d&&c.top+d<=(g.innerHeight||document.documentElement.clientHeight)||0<c.bottom-d&&c.bottom+d<=(g.innerHeight||document.documentElement.clientHeight)}f=$(f);c=e.offset().top;e=c+e.height();var b=f.offset().top;f=b+f.height();return c+d>=b&&c-d<=f||e-d<=f&&e+d>=b},isFullyVisible:function(f,e,d){d=d||0;if(f==document||f instanceof jQuery&&(f.get(0)==document||f.is("body"))){var c=e instanceof jQuery?e.get(0).getBoundingClientRect():
e.getBoundingClientRect();return 0<c.top-d&&c.top+d<=(g.innerHeight||document.documentElement.clientHeight)&&0<c.bottom-d&&c.bottom+d<=(g.innerHeight||document.documentElement.clientHeight)}f=$(f);c=e.offset().top;e=c+e.height();var b=f.offset().top;f=b+f.height();return c+d>=b&&e-d<=f},scrollParent:function(g,e){g=$(g);var d=g.css("position"),c="absolute"===d,b=e?/(auto|scroll|hidden)/:/(auto|scroll)/,a=g.parents().filter(function(){var a=$(this);return c&&"static"===a.css("position")?!1:b.test(a.css("overflow")+
a.css("overflow-y")+a.css("overflow-x"))}).eq(0);return"fixed"!==d&&a.length?a:$(g[0].ownerDocument||document)},isInDom:function(g){return g?g instanceof jQuery?document.contains?document.contains(g[0]):document.body.contains(g[0]):document.contains?document.contains(g):document.body.contains(g):!1},compileReplacer:function(g){var e=[];$.each(g,function(a,b){e.push(m(a))});var d="("+e.join("|")+")",c=RegExp(d),b=RegExp(d,"g"),a=function(a){return g[a]};return function(d){return d&&c.test(d)?d.replace(b,
a):d}},escapeRegEx:m}},window);u("modules","module.emailDigest module.administrationToolbar module.configuration module.editableGroup module.html module.language module.media module.messaging module.navigationConfirmation module.notifications module.preview module.regex module.sockets module.template module.ui module.url module.tourtips module.rest module.administration module.administrationContextManager module.themePreview module.presence module.systemNotifications module.javaScript module.scriptRendering module.scheduledFile".split(" "),
function(){return{}});u("module.administration",["module.messaging","module.url","lib.util","lib.scrollable"],function(g,f,k,m,n,e,d){function c(a){l(a,!0);x(a,!0);a.customPanelHashKey=H+Math.floor(1E9*Math.random());a.currentPanelOffset=0;a.rootPanelNode=a.panelNode;a.rootPanelId=a.panelId;var b=f.hashData();delete b[a.customPanelHashKey];a.rootUrl="#"+f.serializeQuery(b);b={panelId:a.panelId,name:a.panelName,content:n.Deferred(function(b){b.resolve(a.panelNode)}).promise(),cssClass:"",header:"",
root:!0,offset:0,url:a.rootUrl,renderedNode:a.panelNode};a.stack.push(b);a.rootPanelNode.data("namespace",q(a,a.currentPanelOffset));O(a,a.panelNode);if(a.onTitle&&a.panelName)a.onTitle(a.panelName)}function b(a,b){if(a.stack&&1<a.stack.length){var c=a.stack[a.currentPanelOffset].renderedNode;a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:1*c.outerWidth(!0)},{duration:a.transitionDuration,easing:a.transitionEasing,complete:function(){c.remove()}});t(a,F.panelHidden,
c,{direction:"none"});t(a,F.panelUnloaded,c);for(var d=a.currentPanelOffset-1;0<=d;d--){var l=a.stack[d].renderedNode;t(a,F.panelUnloaded,l);l.remove()}}else 1==a.stack.length&&(d=a.stack[0].renderedNode,t(a,F.panelHidden,d,{direction:"none"}),t(a,F.panelUnloaded,d),d.remove());n.fn.evolutionTip.hide();C(a);h(a);x(a);if(a.onDispose)a.onDispose()}function a(a){var b=f.hashData();if(b&&b[a.customPanelHashKey]!==d){b=parseInt(b[a.customPanelHashKey],10);if(b>a.stack.length-1)return!1;b=a.stack[b];b.url=
e.location.href;s(a,b);return!0}return 0<=e.location.href.indexOf(a.rootUrl)?(s(a,a.stack[0]),!0):!1}function l(a,b){a.stack=[];a.currentPanelOffset=0;a.rootPanelNode=null;a.rootPanelId=null;a.rootUrl=null}function p(a,b,c){b=b?[]:[u];if(c)for(c=a.currentPanelOffset;0<=c;c--)b.push(q(a,c));else b.push(q(a,a.currentPanelOffset));return b}function t(a,b,c,h){a.sleeping||(h=h||{},c&&(a=c.data("namespace")||"",g.publish(b,n.extend({},h,{panelId:a}))))}function q(a,b){var c=u;a.rootPanelId&&(c=c+":"+a.rootPanelId,
b&&(c=c+":"+b));return c}function h(a){a.suppressedNameSpaces=p(a,!0,!0);for(var b=0;b<a.suppressedNameSpaces.length;b++)g.unsubscribe(a.suppressedNameSpaces[b]),n.telligent.evolution.shortcuts.unregister(a.suppressedNameSpaces[b])}function v(a){a&&(g.unsubscribe(a),n.telligent.evolution.shortcuts.unregister(a))}function s(a,b){for(var c=a.stack[a.currentPanelOffset].renderedNode,h=a.stack.length;h>=(b.offset||0)+2;h--)a.stack.pop();var d={direction:b.offset>a.currentPanelOffset?"forward":"backward",
panel:b};if(b.renderedNode)d.renderedNode=b.renderedNode,d.scrollTop=b.scrollTop,w(a,d,c);else{if(a.onOpening)a.onOpening();var l=a.stack[a.currentPanelOffset];a.onRendering&&(c=l.renderedNode,a.onRendering(c),n.fn.uilinks.hide());h=f.hashData();l.root?delete h[a.customPanelHashKey]:h[a.customPanelHashKey]=l.offset;var e="#"+f.serializeQuery(h);b.content.then(function(h){if(a.onOpened)a.onOpened();d.templatableContent={name:b.name,content:h,panelId:b.panelId,cssClass:b.cssClass||"",backUrl:e,backLabel:l.name};
w(a,d,c)})["catch"](function(){if(a.onOpened)a.onOpened();if(a.onRendered)a.onRendered();window.location=e})}}function w(a,b,c){var h,d;a.currentPanelOffset=b.panel.offset;var l=C(a,b.panel.size);b.renderedNode?(h=b.renderedNode,d=!1):(n.telligent.evolution.ui.suppress(function(){var c=n.extend({contentClass:"",panelId:"",rootPanelId:a.rootPanelId,namespace:q(a,b.panel.offset),description:"",name:""},b.templatableContent);h=n(a.template(c));b.templatableContent.content&&"string"!==typeof b.templatableContent.content&&
h.find(a.panelContentSelector).first().append(b.templatableContent.content)}),d=!0,b.panel.renderedNode=h,a.onRendering&&(a.onRendering(h),n.fn.uilinks.hide()));if(a.onTitle&&b.panel&&b.panel.name)a.onTitle(b.panel.name);O(a,h);if(b.direction&&"forward"==b.direction){if(c!==h){n.fn.evolutionTip.hide();a.loadingPanel=!0;t(a,F.panelHidden,c,{direction:"forward"});a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:-1*c.outerWidth(!0)},{duration:a.transitionDuration,easing:a.transitionEasing});
a.container.one("rendered",function(){d&&t(a,F.panelLoaded,h)});h.css({position:"absolute",top:0,width:l||a.container.width(),height:a.container.height()}).appendTo(a.container);h.evolutionTransform({left:1*a.container.width()},{duration:0}).evolutionTransform({left:0},{duration:a.transitionDuration,easing:a.transitionEasing,complete:function(){t(a,F.panelShown,h);r(a)}});if(a.onRendered)a.onRendered(h);n.fn.evolutionTip.hide()}}else if(c!==h){n.fn.evolutionTip.hide();a.loadingPanel=!0;t(a,F.panelHidden,
c,{direction:"backward"});t(a,F.panelUnloaded,c);a.onRendering&&(a.onRendering(c),n.fn.uilinks.hide());c.evolutionTransform({left:1*(l||c.outerWidth(!0))},{duration:a.transitionDuration,easing:a.transitionEasing});h.css({position:"absolute",top:0,width:l||a.container.width(),height:a.container.height()});d&&t(a,F.panelLoaded,h);if(a.onRendered)a.onRendered(h);h.evolutionTransform({left:-1*a.container.width()},{duration:0}).evolutionTransform({left:0},{duration:a.transitionDuration,easing:a.transitionEasing,
complete:function(){t(a,F.panelShown,h);r(a)}});n.fn.evolutionTip.hide()}b.scrollTop&&(h.find(a.panelContentSelector).first().get(0).scrollTop=b.scrollTop);x(a)}function r(a){a.loadingPanel=!1;if(a.onAnimated)a.onAnimated();if(a.delayedOpen){var b=a.delayedOpen;delete a.delayedOpen;setTimeout(function(){b()},10)}}function x(a,b){var c=a.transitionDuration;clearTimeout(a.panelCleanupTimeout);a.panelCleanupTimeout=setTimeout(function(){var c=null;a.ignoreOnDispose&&(c=a.ignoreOnDispose());(b?a.container.children('[data-rootpanelid!="'+
a.rootPanelId+'"][data-panelid="'+a.rootPanelId+'"]'):a.container.children('[data-rootpanelid="'+a.rootPanelId+'"]')).each(function(){var b=n(this);if(!(b.data("rootpanelid")===d||b&&c&&1==b.length&&1==c.length&&b.get(0)===c.get(0))){var h=b.data("panelid");if(h&&0<h.length){var l=n.grep(a.stack,function(a){return a.panelId&&a.panelId==h});l&&0!=l.length||(v(b.data("namespace")),b.remove())}}})},c)}function y(a){var b=a.stack[a.currentPanelOffset];b.scrollTop=b.renderedNode.find(a.panelContentSelector).first().get(0).scrollTop}
function z(a,b){var c=function(){var c=n.extend({panelId:k.guid(),offset:a.stack.length,name:"",content:"",cssClass:"",header:""},b);y(a);if(!c.content.done){var h=c.content;c.content=n.Deferred(function(a){a.resolve(h)}).promise()}if(!c.header.done){var d=c.header;c.header=n.Deferred(function(a){a.resolve(d)}).promise()}a.stack.push(c);var l=q(a,a.stack.length-1),e=[u,l];c.loaded&&g.subscribe(F.panelLoaded,e,function(b){a.sleeping||b.panelId==l&&c.loaded()});c.unloaded&&g.subscribe(F.panelUnloaded,
e,function(b){a.sleeping||b.panelId==l&&c.unloaded()});c.shown&&g.subscribe(F.panelShown,e,function(b){a.sleeping||b.panelId==l&&c.shown()});c.hidden&&g.subscribe(F.panelHidden,e,function(b){a.sleeping||b.panelId==l&&c.hidden(b)});c.size&&g.subscribe(F.panelLoaded,e,function(b){a.sleeping||b.panelId==l&&B(a,c.size)});if(c.header)var p=g.subscribe(F.panelLoaded,e,function(b){a.sleeping||b.panelId!=l||(setTimeout(function(){g.unsubscribe(p)},a.transitionDuration/2),c.header.then(function(b){if(b){var c=
a.stack[a.currentPanelOffset].renderedNode;c&&(c.find(a.panelHeaderContentSelector).empty().append(b),D(a,c))}})["catch"](function(){if(a.onOpened)a.onOpened();if(a.onRendered)a.onRendered();A(a)}))});e={};e[a.customPanelHashKey]=a.stack.length-1;f.hashData(e)};a.loadingPanel?a.delayedOpen=c:c()}function A(a,b){if(b&&b.all&&a.onCloseAll)a.onCloseAll();else if(0<a.currentPanelOffset){var c=a.stack[a.currentPanelOffset-1];c&&c.url&&(window.location=c.url)}else if(a.onCloseAll)a.onCloseAll()}function B(a,
b,c){if(a){var h=a.stack[a.currentPanelOffset];if(h)return h.size=b,C(a,h.size,c)}}function C(a,b,c){if(a.onResize){b=a.onResize(b||"normal");a=a.stack[a.currentPanelOffset];if(!a)return b;a=a.renderedNode;if(!a)return b;a.width(b);return b}return null}function K(a,b,c){var h={"shell.closed":F.shellClosed,"shell.navigation.refreshing":F.shellNavigationRefreshing,"shell.navigation.refreshed":F.shellNavigationRefreshed,"panel.unloaded":F.panelUnloaded,"panel.loaded":F.panelLoaded,"panel.shown":F.panelShown,
"panel.hidden":F.panelHidden};if(h[b]!==d&&c!==d){var l=q(a,a.currentPanelOffset);g.subscribe(h[b],p(a),function(b){a.sleeping||(b.panelId?b.panelId===l&&c.call(L(a).get(0),b):c.call(L(a).get(0),b))})}}function D(a,b){var c=b.find(a.panelHeaderSelector).outerHeight(!0);b.find(a.panelContentSelector).first().css({top:c})}function G(a,b){if(a){var c=a.stack[a.currentPanelOffset].renderedNode;if(c&&b&&b.load){var h=b.load;b.load=function(b){a.stack[a.currentPanelOffset].scrollablePageIndex=b;return h(b)};
var d=c.find(a.panelContentSelector).first();if(b.immediate)n(d).on("scrollend",function(b){a.sleeping||(g.publish("contextual.panel.scrollend"),b.stopPropagation())});else a.scrollSubscription=g.subscribe(F.panelShown,p(a,!0,!1),function(b){if(!a.sleeping)n(d).on("scrollend",function(b){a.sleeping||(g.publish("contextual.panel.scrollend"),b.stopPropagation())})});b.initialPageIndex=a.stack[a.currentPanelOffset].scrollablePageIndex||b.initialPageIndex||0;b.preFillAttempts=b.preFillAttempts||10;b.container=
n(e);b.element=function(){return d};b.scrollEndMessage="contextual.panel.scrollend";b.buildIndicator=a.buildScrollingIndicator;return m.register("panel",b)}}}function I(a,b){b.on("click",".content-list.expandable .content-item",function(){var b=n(this);b.hasClass("expanded")||(b.closest(".content-list.expandable").find(".content-item.expanded").each(function(){var b=n(this);b.removeClass("expanded");b.find(".expandable").each(function(){var b=n(this),c=b.css("display");b.css({display:"none",height:"auto"});
var h=b.height();b.css({display:c,height:h}).evolutionTransform({height:0},{duration:a.transitionDuration/2.5,easing:a.transitionEasing})})}),b.addClass("expanded"),b.find(".expandable").each(function(){var b=n(this),c=b.css("display");b.css({display:"none",height:"auto"});var h=b.height();b.css({display:c,height:0}).evolutionTransform({height:h},{duration:a.transitionDuration/2.5,easing:a.transitionEasing,complete:function(){b.css({height:"auto"})}})}))})}function O(a,b){b=n(b);b.data("_handlers_activated")||
(b.data("_handlers_activated",!0),I(a,b))}function L(a){var b=a.stack[a.currentPanelOffset].renderedNode,c=b.data("_wrapper");c&&0!=c.length||(c=b.find(a.panelContentSelector).first(),b.data("_wrapper",c));return c}var H="__cpo",u="ADMINISTRATION_SHELL",F={shellClosed:"context.shell.closed",shellNavigationRefreshing:"context.shell.navigation.refreshing",shellNavigationRefreshed:"context.shell.navigation.refreshed",panelLoaded:"administration.panel.loaded",panelUnloaded:"administration.panel.unloaded",
panelShown:"administration.panel.shown",panelHidden:"administration.panel.hidden"},J={container:null,panelNode:null,panelId:null,panelName:null,onRefresh:function(){},onOpening:function(a){},onOpened:function(){},onRendering:function(){},onRendered:function(){},onCloseAll:function(){},onShow:function(){},onHide:function(){},onResize:function(a){},onAnimated:function(){},transitionEasing:"cubic-bezier(0.645, 0.045, 0.355, 1)",transitionDuration:300,template:"",panelContentSelector:".contextual-panel-content",
panelHeaderSelector:".contextual-panel-heading",panelHeaderContentSelector:".custom-panel-heading-content",excludeWhenResizingSelector:".contextual-administration-panel-loading"},V={__init:function(h){var l=n.extend({},J,h||{});currentContext=l;c(l);return{postInit:function(){t(l,F.panelLoaded,l.rootPanelNode);t(l,F.panelShown,l.rootPanelNode)},dispose:function(a){b(l,a)},processHashChange:function(){return a(l)},canProcessHashChange:function(){var a;a=0<=e.location.href.indexOf(l.rootUrl)?(a=f.hashData())&&
a[l.customPanelHashKey]!==d?parseInt(a[l.customPanelHashKey],10)>l.stack.length-1?!1:!0:!0:!1;return a},sleep:function(){y(l);var a=l.stack[l.currentPanelOffset].renderedNode;a&&t(l,F.panelHidden,a,{direction:"none"});l.suppressedNameSpaces=p(l,!0,!0);g.suppress(l.suppressedNameSpaces);l.sleeping=!0},wake:function(){l.suppressedNameSpaces&&g.unsuppress(l.suppressedNameSpaces);l.sleeping=!1;l.suppressedNameSpaces=[];var a=l.stack[l.currentPanelOffset].renderedNode;a&&t(l,F.panelShown,a)},sleeping:function(){return l.sleeping},
currentPanelNode:function(){if(!l||!l.stack||0==l.stack.length)return null;var a=l.stack[l.currentPanelOffset];return a?a.renderedNode:null},currentPanelDetails:function(){if(!l||!l.stack||0==l.stack.length)return null;var a=l.stack[l.currentPanelOffset];return a?a:null},context:function(a){a&&(currentContext=a);return currentContext},refreshingNavigation:function(a){if(!l||!l.stack||0==l.stack.length)return!1;var b=l.stack[l.currentPanelOffset];if(!b)return!1;b=b.renderedNode;"undefined"!==typeof a&&
(!l.refreshingNavigation&&a?t(l,F.shellNavigationRefreshing,b):l.refreshingNavigation&&!a&&t(l,F.shellNavigationRefreshed,b),l.refreshingNavigation=a);return l.refreshingNavigation||!1}}},open:function(a){if(null!==currentContext)return z(currentContext,a)},close:function(a){if(null!==currentContext)return A(currentContext,a)},refresh:function(){if(null!==currentContext){history.replaceState(null,null,document.location.pathname+currentContext.rootUrl);if(currentContext.onRefresh)currentContext.onRefresh();
currentContext.customPanelHashKey=H+Math.floor(1E9*Math.random())}},scrollable:function(a){if(null!==currentContext)return G(currentContext,a)},panelId:function(){if(null!==currentContext)return q(currentContext,currentContext.currentPanelOffset)},panelWrapper:function(){return null===currentContext?n([]):L(currentContext)},panelNameSpace:function(){if(null!==currentContext)return p(currentContext)},header:function(a,b){if(null!==currentContext){var c=currentContext,h=b||{},d=c.stack[c.currentPanelOffset].renderedNode;
h&&!1===h.inherit&&d.find(c.panelHeaderTitleSelector).hide();a?d&&(d.find(c.panelHeaderContentSelector).empty().append(a),D(c,d)):D(c,d);return d.find(c.panelHeaderContentSelector)}},sidebar:function(a){if(null!==currentContext)return n.Deferred(function(b){if(currentContext.onSideBar&&a&&a.content){currentContext.onSideBar(a.content).then(function(){b.resolve()});var c;K(currentContext,"shell.navigation.refreshing",function(){currentContext.sleeping||(c=currentContext.onSideBar(null).detach())});
K(currentContext,"shell.navigation.refreshed",function(){!currentContext.sleeping&&c&&(currentContext.onSideBar(c),c=null)});K(currentContext,"panel.unloaded",function(a){if(!currentContext.sleeping)currentContext.onSideBar("")})}}).promise()},on:function(a,b){if(null!==currentContext)return K(currentContext,a,b)},show:function(){if(null!==currentContext&&currentContext.onShow)currentContext.onShow()},hide:function(){if(null!==currentContext&&currentContext.onHide)currentContext.onHide()},size:function(a){null!==
currentContext&&B(currentContext,a,!0)},loading:function(a,b){if(null!==currentContext)if(a){if(currentContext.onOpening)currentContext.onOpening(b)}else if(currentContext.onOpened)currentContext.onOpened()}};n.telligent=n.telligent||{};n.telligent.evolution=n.telligent.evolution||{};return n.telligent.evolution.administration=V},jQuery,window);u("module.administrationContextManager",["module.administration","module.messaging","module.url","lib.util","lib.scrollable"],function(g,f,k,m,n,e,d,c){function b(a){return a.contexts[a.contexts.length-
1]}var a={onTitle:function(){},onRefresh:function(){},onOpening:function(a){},onOpened:function(){},onRendering:function(){},onRendered:function(){},onCloseAll:function(){},onResize:function(a){},onShow:function(){},onHide:function(){},onAnimated:function(){},onDispose:function(){},onSideBar:function(a){},buildScrollingIndicator:function(){},transitionEasing:"cubic-bezier(0.645, 0.045, 0.355, 1)",transitionDuration:300,template:"",panelContentSelector:".contextual-panel-content",panelHeaderSelector:".contextual-panel-heading",
panelHeaderTitleSelector:".administration-panel-heading-meta",panelHeaderContentSelector:".custom-panel-heading-content",excludeWhenResizingSelector:".contextual-administration-panel-loading"},l={container:null,panelNode:null,panelId:null,panelName:null};f=function(c){var f=e.extend({},a,c||{},{contexts:[]});return{addContext:function(a){var c=b(f);null!=c&&c.sleep();a=e.extend({},l,a||{});var p=a.onCloseAll||f.onCloseAll||function(){};a.onCloseAll=function(){if(1<f.contexts.length){var a=f.contexts[f.contexts.length-
2].currentPanelDetails();a&&a.url?d.location.href=a.url:p()}else p()};c=g.__init(e.extend({},f,a));c.panelNode=a.panelNode;c.panelRequest=a.panelRequest;c.innerContext=c.context();f.contexts.push(c)},canProcessHash:function(a){for(var b=f.contexts.length-1;0<=b;b--)if(f.contexts[b].canProcessHashChange(a))return!0;return!1},processHash:function(a){for(var b=f.contexts.length-1;0<=b;b--){if(f.contexts[b].canProcessHashChange(a))return f.contexts[b].sleeping()&&(f.onNavigateBackToPreviousContext(f.contexts[b].currentPanelNode(),
{onRendering:f.onRendering,onRendered:f.onRendered}),f.contexts[b].context(f.contexts[b].innerContext),f.contexts[b].wake()),f.contexts[b].processHashChange(a),!0;f.contexts[b].sleeping()&&f.contexts[b].wake();f.contexts[b].dispose({refreshing:!0});f.contexts[b].sleep();f.contexts.pop()}return!1},postInit:function(){var a=b(f);null!=a&&a.postInit()},dispose:function(a){if(a&&a.all)for(var c=f.contexts.length-1;0<=c;c--)f.contexts[c].dispose(a),f.contexts.pop();else c=b(f),null!=c&&(c.dispose(a),f.contexts.pop())},
count:function(){return f.contexts.length},currentPanelNode:function(){var a=b(f);return a?a.currentPanelNode():null},currentPanelRequest:function(){var a=b(f);return a?a.panelRequest:null},currentPanelDetails:function(){var a=b(f);return a?a.currentPanelDetails():null},previousPanelDetails:function(){if(1>=f.contexts.length)return null;var a=f.contexts[f.contexts.length-2];return a?a.currentPanelDetails():null},refreshingNavigation:function(a){var c=b(f);return c?c.refreshingNavigation(a):null}}};
return g.__contextManager=f},jQuery,window);u("module.emailDigest",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});var m=function(f,e){0>e||(0<e&&""!=f.subscriptionId&&(""==f.context||"undefined"===f.contextId)?_showMessage(f,f.errorMessage):g.telligent.evolution.post({url:f.emailDigestUrl,data:{subscriptionId:f.subscriptionId,frequency:e,context:f.context,contextId:f.contextId},success:function(d){d=eval("("+d+")");var c=null;"create"==d.action?(f.subscriptionId=
d.subscriptionId,f.frequency=e,1==e?c=f.dailyMessage:7==e&&(c=f.weeklyMessage)):"update"==d.action?(f.frequency=e,1==e?c=f.dailyMessage:7==e&&(c=f.weeklyMessage)):"delete"==d.action&&(f.subscriptionId="",f.frequency=0,"group"==f.context&&(c=f.unsubscribeGroupMessage));d.warnings&&0<d.warnings.length?_showMessage(f,d.warnings[0],"warning"):c&&_showMessage(f,c,"success");d={subscriptionId:f.subscriptionId,frequency:f.frequency,context:f.context,contextId:f.contextId,action:d.action};g(document).trigger("emailDigestSubscriptionChange",
[d])},error:function(d,c,b){_showMessage(f,f.errorMessage,"error")}}))};_showMessage=function(f,e,d){g.telligent.evolution.notifications.show(e,{type:d,duration:5E3})};g.telligent.evolution.emailDigest={register:function(f){g("#"+f.selectPopupId).glowPopUpPanel({cssClass:"Panel",position:"updown",zIndex:100,hideOnDocumentClick:!0});g("#"+f.rollupWrapperId).on("click",function(){var e=g(this),d="",c="",b="";1==f.frequency?d="email-digest-selected":7==f.frequency?c="email-digest-selected":b="email-digest-selected";
var a=e.outerWidth(),l=e.outerHeight(),e=e.offset(),d="<div class='email-digest-selectWrapper' style=\"min-width: "+(a-2)+'px;"><div frequency="1" class="email-digest-selectable '+f.selectableTag+" "+d+'"><span style="display: block; white-space: nowrap;">'+f.popupDaily+'</span></div><div frequency="7" class="email-digest-selectable '+f.selectableTag+" "+c+'"><span style="display: block; white-space: nowrap;">'+f.popupWeekly+'</span></div><div frequency="0" class="email-digest-selectable '+f.selectableTag+
" "+b+'"><span style="display: block; white-space: nowrap;">'+f.popupUnsubscribe+"</span></div></div>";g("#"+f.selectPopupId).glowPopUpPanel("hide").glowPopUpPanel("html",d).glowPopUpPanel("show",e.left+4,e.top+5,a,l-10,!1)});g(document).on("click","."+f.selectableTag,function(){var e=g(this);e.hasClass("email-digest-selected")||(e=e.attr("frequency"),m(f,e))});g(document).on("emailDigestSubscriptionChange",function(e,d){if(d.context==f.context&&d.contextId==f.contextId){var c="";"create"==d.action||
"update"==d.action?("1"==d.frequency?c=f.rollupDaily:"7"==d.frequency&&(c=f.rollupWeekly),f.subscriptionId=d.subscriptionId):(c=f.rollupUnsubscribed,f.subscriptionId="");f.frequency=d.frequency;g("#"+f.rollupTextId).html(c)}})}};return{}},jQuery,window);u("module.administrationToolbar",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.administrationToolbar={get:function(){var f;f=g(".admin-bar");0<f.length||(g("body").prepend(g('<div class="admin-bar-header"></div><div class="admin-bar site"></div><div class="admin-bar-footer"></div>')),
f=g(".admin-bar"));return f}};return{}},jQuery,window);u("module.configuration",["lib.globalConfiguration","plugin.evolutionHtmlEditor"],function(g,f,k,m,n){function e(c,b){return'<time datetime="'+c.toISOString()+'">'+b+"</time>"}var d=k.fn.filter;k.fn.filter=function(){arguments&&(0<arguments.length&&"string"==typeof arguments[0])&&(arguments[0]=arguments[0].replace(/:\[/g,"["));return d.apply(this,arguments)};n={formatDate:function(c){try{return c.toISOString()}catch(b){}return""},parseDate:function(){var c=
function(b,a){var c;c=b.getTimezoneOffset();var d;isNaN(a)?c=new Date(b.getTime()-6E4*c):(d=a/100,d=-(60*(d-d%1)+a%100),c=new Date(b.getTime()+6E4*(d-c)));return c};return function(b){var a,d=new Date;if(null===b||""===b)return d;if(null!=(a=/\/Date\((\d+)(?:([\-\+]\d+))?\)\//.exec(b)))return b=new Date(parseInt(a[1],10)),c(b,parseInt(a[2],10));if(null!=(a=/(\d{4,4})\-(\d{2,2})\-(\d{2,2})(?:T(\d{2,2}):(\d{2,2}):(?:(\d{2,2})(?:\.(\d+))?))([zZ]|([+\-])(((\d\d):(\d\d))|(\d\d\d\d)))?/.exec(b))){b=[d.getFullYear(),
d.getMonth()+1,d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()];for(d=1;d<a.length&&8>d;d++)""!=a[d]&&void 0!=a[d]&&(b[d-1]=parseInt(a[d],10));b=new Date(b[0],b[1]-1,b[2],b[3],b[4],b[5],1E3*parseFloat("."+b[6]));if(a[8]){if("z"==a[8]||"Z"==a[8])return c(b,0);if(a[9]&&a[12]&&a[13])return a=(100*parseInt(a[12],10)+parseInt(a[13],10))*("+"==a[9]?1:-1),c(b,a);if(a[9]&&a[10])return a=(100*parseInt(a[10].substring(0,2),10)+parseInt(a[10].substring(2),10))*("+"==a[9]?1:-1),c(b,
a)}else return b}throw"Invalid date format";}}(),formatAgoDate:function(c){try{var b=(new Date).getTime(),a=Math.abs(b-c.getTime())/1E3,d=a/60,p=d/60,f=p/24,q=f/30.42,h=f/365;return b<c.getTime()?2>Math.round(d)?e(c,g.dateMinuteInFutureFormat.replace("{0}",Math.round(d))):60>Math.round(d)?e(c,g.dateMinutesInFutureFormat.replace("{0}",Math.round(d))):2>Math.round(p)?e(c,g.dateHourInFutureFormat.replace("{0}",Math.round(p))):24>Math.round(p)?e(c,g.dateHoursInFutureFormat.replace("{0}",Math.round(p))):
2>Math.round(f)?e(c,g.dateDayInFutureFormat.replace("{0}",Math.round(f))):30.42>f?e(c,g.dateDaysInFutureFormat.replace("{0}",Math.round(f))):2>Math.round(q)?e(c,g.dateMonthInFutureFormat.replace("{0}",Math.round(q))):12>q?e(g.dateMonthsInFutureFormat.replace("{0}",Math.round(q))):2>Math.round(h)?e(c,g.dateYearInFutureFormat.replace("{0}",Math.round(h))):e(c,g.dateYearsInFutureFormat.replace("{0}",Math.round(h))):10>a?e(c,g.dateNowAgoFormat):2>Math.round(d)?e(c,g.dateMinuteAgoFormat.replace("{0}",
Math.round(d))):60>Math.round(d)?e(c,g.dateMinutesAgoFormat.replace("{0}",Math.round(d))):2>Math.round(p)?e(c,g.dateHourAgoFormat.replace("{0}",Math.round(p))):24>Math.round(p)?e(c,g.dateHoursAgoFormat.replace("{0}",Math.round(p))):2>Math.round(f)?e(c,g.dateDayAgoFormat.replace("{0}",Math.round(f))):30.42>f?e(c,g.dateDaysAgoFormat.replace("{0}",Math.round(f))):2>Math.round(q)?e(c,g.dateMonthAgoFormat.replace("{0}",Math.round(q))):12>q?e(c,g.dateMonthsAgoFormat.replace("{0}",Math.round(q))):2>Math.round(h)?
e(c,g.dateYearAgoFormat.replace("{0}",Math.round(h))):e(c,g.dateYearsAgoFormat.replace("{0}",Math.round(h)))}catch(v){}return""},site:{configure:function(c){k.extend(g,c);k.telligent.evolution.user={accessing:{id:g.accessingUserId,isSystemAccount:g.accessingUserIsSystemAccount,isTemporary:g.accessingUserTemporary}};f.configure({scriptBaseUrl:k.telligent.evolution.site.getBaseUrl()+"tinymce/",versionKey:g.versionKey,contextQueryString:g.contextQueryString,mediaMaxWidth:g.maxMediaWidth,mediaMaxHeight:g.mediaMaxHeight,
defaultMediaWidth:g.defaultMediaWidth,defaultMediaHeight:g.defaultMediaHeight,directionality:g.directionality,language:g.editorLanguage,contentCssUrl:k.telligent.evolution.site.getBaseUrl()+"tinymce/telligent/telligent.tinymce.content.css",directUploadContext:g.directUploadContext,directUploadUrl:g.directUploadUrl,autoLinkPattern:g.autoLinkPattern,editorConfigVersionKey:g.editorConfigVersionKey});k.extend(k.event.special.quote.defaults,{quoteText:g.quoteText});k.fn.glowDateTimeSelector&&(k.extend(k.fn.glowDateTimeSelector.defaults,
{monthNames:g.monthNames,dayNames:g.dayNames,calendarButtonImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"}),k.extend(k.fn.glowDateTimeSelector.dateDefaults,{monthNames:g.monthNames,dayNames:g.dayNames,calendarButtonImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"},g.datePattern||{}),k.extend(k.fn.glowDateTimeSelector.timeDefaults,{monthNames:g.monthNames,dayNames:g.dayNames,calendarButtonImageUrl:k.telligent.evolution.site.getBaseUrl()+
"utility/images/glow/DateTimeSelectorCalendar.gif"},g.timePattern||{}),k.extend(k.fn.glowDateTimeSelector.dateTimeDefaults,{monthNames:g.monthNames,dayNames:g.dayNames,calendarButtonImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"},g.dateTimePattern||{}),k.extend(k.fn.glowDateTimeSelector.monthDefaults,{monthNames:g.monthNames,dayNames:g.dayNames,calendarButtonImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"}));
k.glowModal&&(k.extend(k.glowModal.defaults,{loadingHtmlUrl:"about:blank",windowCssClasses:["modal"],windowTitleCssClasses:["modal-title","modal-title-2","modal-title-3","modal-title-4"],windowCloseCssClasses:["modal-close"],windowContentCssClasses:["modal-content","modal-content-2"],windowMaskCssClasses:["modal-mask"],windowFooterCssClasses:["modal-footer","modal-footer-2","modal-footer-3"],windowResizeCssClasses:["modal-resize"],zIndex:2E4}),m.Telligent_Modal={GetWindowOpener:function(b,a){return k.glowModal.opener(b,
a)},IsShown:function(b){return k.glowModal.visible(b)},Resize:function(b,a,c,d){k.glowModal.resize(b,a,c,d)},MoveTo:function(b,a,c){k.glowModal.moveTo(b,a,c)},Open:function(b,a,c,d,e,f,h,g,s){k.glowModal(b,{width:a,height:c,onClose:d,x:e,y:f,ignoreCloseAndAnimation:h,isManuallyresized:g,openerWindow:s})},Close:function(b,a){k.glowModal.close(b,a)},Refresh:function(b){k.glowModal.refresh(b)}});k.fn.glowDropDownList&&k.extend(k.fn.glowDropDownList.defaults,{buttonImageUrl:k.telligent.evolution.site.getBaseUrl()+
"utility/images/glow/DropDownListButton.gif"});k.fn.glowColorSelector&&k.extend(k.fn.glowColorSelector.defaults,{blendImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorSv.png",hueBlendImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorHue.png",alphaBlendImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/alpha_blend.png",transparentImageUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/transparent.png"});
k.fn.glowMultiUpload&&k.extend(k.fn.glowMultiUpload.defaults,{swfUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:g.silverlightFileUploadEnabled?k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":"",runtimes:g.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"});k.fn.glowUpload&&k.extend(k.fn.glowUpload.defaults,{swfUrl:k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:g.silverlightFileUploadEnabled?
k.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":"",runtimes:g.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"})},getBaseUrl:function(c){if(!0===c){c=m.location.href+"";var b=c.indexOf("/",9);if(0<b)return c.substr(0,b)+g.baseUrl}return g.baseUrl}},theme:{getReflowBreakpoint:function(){var c=null;k(".evolution-reflow-container:not(.single-column)").each(function(){var b=parseInt(k(this).data("reflow-width"));!isNaN(b)&&(null==c||b<c)&&(c=b)});return c}}};
k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.extend(k.telligent.evolution,n);return{}},jQuery,window);u("module.editableGroup",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});var m={},n=function(b,a,c){if(b.isSaving)if(a+1<b.widgets.length){var d=b.widgets[a+1];d.save?(d=d.save(function(){n(b,a+1,c)},function(){e(b,a+1,c)}),!1===d?e(b,a+1,c):!0===d&&n(b,a+1,c)):n(b,a+1,c)}else c.success&&(b.isSaving=!1,c.success())},
e=function(b,a,c){b.isSaving&&(b.isSaving=!1,c.error&&c.error())},d=function(b,a,c){if(b.isValidating){b.widgets[a].valid=!0;var d=0;g.each(b.widgets,function(a,b){!0!==b.valid&&d++});0==d&&(b.isValidating=!1,c.success&&c.success())}},c=function(b,a,c){b.isValidating&&(b.widgets[a].valid=!1,b.isValidating=!1,c.error&&c.error())};g.telligent.evolution.editableGroup={register:function(b,a){var c=m[b];c||(c={widgets:[],isSaving:!1,isValidating:!1},m[b]=c);c.widgets[c.widgets.length]=g.extend({},a||{},
{valid:!1,saved:!1})},save:function(b,a){g.telligent.evolution.editableGroup.validate(b,{success:function(){var c=m[b];c&&0<c.widgets.length?(c.isSaving=!0,n(c,-1,a)):a&&a.success&&a.success()},error:function(){a.error&&a.error()}})},validate:function(b,a){var l=m[b];l&&0<l.widgets.length?(g.each(l.widgets,function(a,b){b.valid=k}),l.isValidating=!0,g.each(l.widgets,function(b,e){if(e.validate){var f=e.validate(function(){d(l,b,a)},function(){c(l,b,a)});!1===f?c(l,b,a):!0===f&&d(l,b,a)}else d(l,b,
a)})):a&&a.success&&a.success()}};return{}},jQuery,window);u("module.html",["lib.util"],function(g,f,k,m){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};k={encode:function(e){var d=g.compileReplacer(n);return function(c){return d.call(this,c)}}(),decode:function(e){var d=/<[^>]*>/g;return function(c){if(!c)return c;c=(c+"").replace(d," ");return f("<div/>").html(c).text()}}()};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});return f.telligent.evolution.html=
k},jQuery,window);u("module.javaScript",["lib.util"],function(g,f,k,m){var n={"\\":"\\\\","\n":"\\n","\r":"\\r","'":"\\'",'"':'\\"',"/":"\\/"};k={encode:function(e){var d=g.compileReplacer(n);return function(c){return d.call(this,c)}}()};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});return f.telligent.evolution.javaScript=k},jQuery,window);u("module.language",function(g,f,k){var m={},n={};agoLastRefresh=(new Date).getTime();buildCacheKey=function(d,c){return d.toString()+
"-"+c};loadFormattedDate=function(d,c,b){var a=m;"agodate"==c&&(6E4<(new Date).getTime()-agoLastRefresh&&(n={},agoLastRefresh=(new Date).getTime()),a=n);var l=a[buildCacheKey(d,c)];"undefined"===typeof l?g.telligent.evolution.get({url:e.defaults.dateEndpoint,data:{date:g.telligent.evolution.formatDate(d),format:c},success:function(l){l&&(b&&"undefined"!==typeof l&&null!==l&&l.formattedDate)&&(a[buildCacheKey(d,c)]=l.formattedDate,b(l.formattedDate))}}):b(l)};var e={formatDate:function(d,c){loadFormattedDate(d,
"date",c)},formatDateAndTime:function(d,c){loadFormattedDate(d,"datetime",c)},formatAgoDate:function(d,c){loadFormattedDate(d,"agodate",c)},defaults:{dateEndpoint:""}};g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.language=e;return{}},jQuery,window);u("module.media",function(g,f,k){var m=function(e,d,c){var b=g.extend({},n.defaults,c||{});e={url:e,view:d};b.width&&(e.width=b.width);b.height&&(e.height=b.height);g.telligent.evolution.get({url:b.endpoint,
data:e,success:function(a){a&&b.success&&b.success(a)},error:function(a,c,d){b.error&&b.error(a,c,d)}})},n={previewHtml:function(e,d){m(e,"preview",d)},viewHtml:function(e,d){m(e,"view",d)},defaults:{endpoint:""}};g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.media=n;return{}},jQuery,window);u("module.messaging",["lib.util","lib.crossWindowBus"],function(g,f,k,m,n){function e(a,b){var c=l[a];if(c)for(var c=c.slice(),d=0;d<c.length;d++)!c[d]||
(!c[d].handler||c[d].suppressed!==n&&c[d].suppressed)||c[d].handler.call(this,b)}function d(a){"undefined"!==typeof p[String(a)]&&(p[String(a)].suppressed=!0)}function c(a){"undefined"!==typeof p[String(a)]&&(p[String(a)].suppressed=!1)}function b(a,b){if("undefined"!==typeof p[String(a)]){var c=p[String(a)],d=l[c.message];subscriptionByNameIndex=g.indexOf(d,c);0<=subscriptionByNameIndex&&d.splice(subscriptionByNameIndex,1);0===d.length&&delete l[c.message];for(d=0;d<c.namespaces.length;d++)if(b!==
c.namespaces[d]){var e=t[c.namespaces[d]],f=g.indexOf(e,a);0<=f&&e.splice(f,1);0===e.length&&delete t[c.namespaces[d]]}delete p[String(a)]}}var a=0,l={},p={},t={},q=new f({key:"__m",includeLocal:!1,receive:e});f={publish:function(a,b,c){if(!a)throw"messageName is required when publishing a message";null!==a&&0!==a.length&&(b=b||{},c&&!0===c.crossWindow&&q.broadcast(a,b),e(a,b))},subscribe:function(b,c,d){if(!b)throw"messageName is required when subscribing to a message";if(null===b||0===b.length)return 0;
"undefined"===typeof l[b]&&(l[b]=[]);var e=c;d==n&&(d=c,e="content");g.isArray(e)||(e=[e]);c={message:b,handler:d,namespaces:e,id:++a};l[b][l[b].length]=c;p[String(c.id)]=c;for(b=0;b<e.length;b++)t[e[b]]||(t[e[b]]=[]),t[e[b]][t[e[b]].length]=c.id;return c.id},unsubscribe:function(a){if(!a)throw"subscriptionId is required when unsubscribing a message";if(isNaN(a)){if(a&&t[a]){for(var c=0;c<t[a].length;c++)b(t[a][c],a);t[a].length=0;delete t[a]}}else b(a)},suppress:function(a){if(!a)throw"subscriptionId is required when suppressing a message";
if(isNaN(a)){if(a)for(messageNamespaces=a,g.isArray(messageNamespaces)||(messageNamespaces=[messageNamespaces]),a=0;a<messageNamespaces.length;a++)if(t[messageNamespaces[a]])for(var b=0;b<t[messageNamespaces[a]].length;b++)d(t[messageNamespaces[a]][b],messageNamespaces[a])}else d(a)},unsuppress:function(a){if(!a)throw"subscriptionId is required when unsuppressing a message";if(isNaN(a)){if(a)for(messageNamespaces=a,g.isArray(messageNamespaces)||(messageNamespaces=[messageNamespaces]),a=0;a<messageNamespaces.length;a++)if(t[messageNamespaces[a]])for(var b=
0;b<t[messageNamespaces[a]].length;b++)c(t[messageNamespaces[a]][b],messageNamespaces[a])}else c(a)}};k.telligent||(k.telligent={});k.telligent.evolution||(k.telligent.evolution={});return k.telligent.evolution.messaging=f},jQuery,window);u("module.navigationConfirmation",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});var m={message:"",enabled:!1,ignoreClick:!1},n=function(){if(!m.ignoreClick)return m.message};g.telligent.evolution.navigationConfirmation=
{configure:function(e){m=g.extend(m,e)},enable:function(){m.enabled||(window.onbeforeunload=n,m.enabled=!0,g(document).on("customizepage",function(){m.ignoreClick=!0}))},register:function(e){g(e).on("click",function(){m.ignoreClick=!0})},ignoreClick:function(){m.ignoreClick=!0}};return{}},jQuery,window);u("module.notifications","lib.util lib.storageProxy module.messaging module.sockets.sharedObjectProxyState lib.globalConfiguration module.rest events.notifications".split(" "),function(g,f,k,m,n,e,
d,c,b,a){function l(){if(U){var a="",d="undefined"!=typeof InstallTrigger||!!b.opera||0<=navigator.userAgent.indexOf("Opera");if(W&&!P)if(R=c('head link[rel~="icon"][href]').first(),0<R.length){P=R.attr("href");N=R.attr("type");try{Q=document.createElement("canvas"),T=document.createElement("img"),T.onload=function(){Q.height=0<T.height?T.height:32;Q.width=0<T.width?T.width:32;M=Q.getContext("2d")},c(T).attr({crossOrigin:"anonymous",src:P})}catch(h){W=!1}}else W=!1;if(W)if(M)try{M.clearRect(0,0,Q.width,
Q.height);M.drawImage(T,0,0,Q.width,Q.height);if(V){if(0<u||0<L)a=Math.max(u,L),99<a&&(a="99+")}else 0<L?(a=L,99<a&&(a="99+")):0<u&&(a="+");if(0===a||""===a)if(d){var e=c('<link type="'+N+'" rel="icon"></link>');c("head").append(e);e.attr("href",P);R.remove();R=e}else R.attr({href:P,type:N});else{var a=a+"",p=!1,f=0.4*Q.width,g=0.4*Q.height,q=0.6*Q.width,v=0.6*Q.height;2===a.length?(f-=0.4*q,q*=1.4,p=!0):3<=a.length&&(f-=0.65*q,q*=1.65,p=!0);M.beginPath();M.font="bold "+Math.floor(v*(2<a.length?0.85:
1))+"px sans-serif";M.textAlign="center";p?(M.moveTo(f+q/2,g),M.lineTo(f+q-v/2,g),M.quadraticCurveTo(f+q,g,f+q,g+v/2),M.lineTo(f+q,g+v-v/2),M.quadraticCurveTo(f+q,g+v,f+q-v/2,g+v),M.lineTo(f+v/2,g+v),M.quadraticCurveTo(f,g+v,f,g+v-v/2),M.lineTo(f,g+v/2),M.quadraticCurveTo(f,g,f+v/2,g)):M.arc(f+q/2,g+v/2,v/2,0,2*Math.PI);M.fillStyle="rgba(221,0,0,1)";M.fill();M.closePath();M.beginPath();M.stroke();M.fillStyle="rgba(255,255,255,1)";M.fillText(a,Math.floor(f+q/2),Math.floor(g+v-0.15*v));M.closePath();
d?(e=c('<link type="image/png" rel="icon"></link>'),c("head").append(e),e.attr("href",Q.toDataURL("image/png")),R.remove(),R=e):R.attr({href:Q.toDataURL("image/png"),type:"image/png"})}}catch(s){W=!1}else b.clearTimeout(X),X=b.setTimeout(function(){l()},250)}}function p(){if(U){var a=document.title.replace(J,"")+"",b=0;if(V){if(0<u||0<L)b=Math.max(u,L),99<b&&(b="99+"),a="("+b+") "+a}else 0<L?(b=L,99<b&&(b="99+"),a="("+b+") "+a):0<u&&(a="(+) "+a);document.title=a}}function t(a,b,d){var h=0;a+="";if("+"==
a.substr(0,1)){h=parseInt(a.substr(1),10);if(isNaN(h))return;b?H[d]=(H[d]||0)+h:F[d]=(F[d]||0)+h}else if("-"==a.substr(0,1)){h=parseInt(a.substr(1),10);if(isNaN(h))return;b?H[d]=(H[d]||0)-h:F[d]=(F[d]||0)-h}else{h=parseInt(a,10);if(isNaN(h))return;b?H[d]=h:F[d]=h}L=0;c.each(H,function(a,b){0>b&&(H[a]=b=0);L+=b});u=0;c.each(F,function(a,b){0>b&&(F[a]=b=0);u+=b});k.publish("notification.unreadchange",{local:L,global:u});p();l()}function q(){b.clearTimeout(Y);var a=!m.hasMultipleWindows();V!=a&&(V=a,
p(),l());Y=b.setTimeout(function(){q()},1E3)}function h(){c.telligent.evolution.user&&(c.telligent.evolution.user.accessing&&!c.telligent.evolution.user.accessing.isSystemAccount&&!c.telligent.evolution.user.accessing.isTemporary)&&(b.clearTimeout(da),da=b.setTimeout(function(){e.get({url:n.baseUrl+"api.ashx/v2/notifications.json",cache:!1,data:{IsRead:!1,PageSize:1,PageIndex:0}}).then(function(a){t(a.TotalCount,!1,"notifications")})},1E3))}function v(a){var d=c.extend({},Z.defaults,a||{},{removalSuppressed:!1,
notifications:[]});d.verticalAlignment="bottom";0<=d.placement.indexOf("top")&&(d.verticalAlignment="top");d.horizontalAlignment="left";0<=d.placement.indexOf("right")&&(d.horizontalAlignment="right");d.storage=new f({id:c.telligent.evolution.user.accessing.id,isSystemAccount:c.telligent.evolution.user.accessing.isSystemAccount});d.template=c.telligent.evolution.template.compile(d.template);b.top==b&&((a=d.storage.get(O))&&9E4>(new Date).getTime()-a.updated&&c.each(a.notifications,function(a,b){var c=
r(d,b.message,b);C(d,x(d,c))}),d.storage.del(O));return d}function s(a){var b=c.extend({},{updated:(new Date).getTime(),notifications:[]},S.storage.get(O)||{});c.each(a.notifications,function(a,c){var d=c.duration,h=w(c);c.shownTime&&(d-=b.updated-c.shownTime);1<d&&!(h&&c.shownTime&&!(2>b.updated-c.shownTime)||c&&ba&&!0===ba[c.id])&&b.notifications.unshift({duration:h?Math.min(d,Z.show.defaults.duration):d,width:c.width,type:c.type,cssClass:c.cssClass,id:c.id,message:c.message})});0==b.notifications.length?
a.storage.del(O):a.storage.set(O,b)}function w(a){return a&&(a.type&&"error"==a.type||a.cssClass&&"error"==a.cssClass)}function r(a,b,d){d&&(!d.duration&&w(d))&&(d.duration=a.errorDuration);a=c.extend({},Z.show.defaults,d||{});a.message=b;a.cssClass=a.type||"";a.id||(a.id=g.guid());return a}function x(a,b){var d=c.grep(a.notifications,function(a){return a.id===b.id});if(null!==d&&1===d.length)return d=d[0],z(a,d,!0).then(function(){d.view.remove();d.message=b.message;d.cssClass=b.cssClass;d.duration=
b.duration;K(a,d);d.suppressPositionAnimation=!0;y(a);A(a,d,!0);D(a,d)}),d;a.notifications.length===a.limit&&B(a,a.notifications[a.notifications.length-1]);a.notifications.unshift(b);K(a,b);y(a);A(a,b);D(a,b);return b}function y(a){var b=a.margin,d=0<c.grep(a.notifications,function(a){!0===a.suppressPositionAnimation}).length;c.each(a.notifications,function(c,h){if(d){var l={opacity:0};l[a.verticalAlignment]=b+"px";h.view.css(l);h.suppressPositionAnimation=!1}else l={},l[a.verticalAlignment]=b,h.view.evolutionTransform(l,
{duration:a.animationDuration});0<h.measuredHeight&&(b+=h.measuredHeight+a.margin)})}function z(a,b,d){b.onHide&&b.onHide.apply(b);return c.Deferred(function(c){!0!==d?b.view.evolutionTransform({opacity:0},{duration:a.animationDuration,complete:function(){b.view.css({display:"none"});c.resolve()}}):c.resolve()}).promise()}function A(a,b,d){c("body").addClass("with-notifications");b.onShow&&b.onShow.apply(b);return c.Deferred(function(c){!0!==d?(b.view.is(":visible")||b.view.css({display:"block",opacity:0}),
b.view.evolutionTransform({opacity:a.opacity},{duration:a.animationDuration,complete:function(){c.resolve()}})):(b.view.css({display:"block",opacity:a.opacity}),c.resolve())}).promise()}function B(a,b){b.removing=!0;z(a,b).then(function(){b.view.remove();b.measuredHeight=0;a.notifications=c.grep(a.notifications,function(a){return a!==b});y(a);a.notifications&&0!==a.notifications.length||c("body").removeClass("with-notifications")})}function C(a,c){b.clearTimeout(c.removeTimeout);b.clearInterval(c.hideSupressedWaitInterval);
c.hideSupressedWaitInterval=b.setTimeout(function(){a.removalSuppressed?c.hideSupressedWaitInterval=b.setInterval(function(){a.removalSuppressed||(b.clearInterval(c.hideSupressedWaitInterval),B(a,c))},1E3):B(a,c)},c.duration);c.shownTime=(new Date).getTime()}function K(a,b){var d={position:"fixed",zIndex:1E4,width:b.width};d[a.horizontalAlignment]=a.margin+a.horizontalOffset+"px";d[a.verticalAlignment]=a.margin+a.verticalOffset+"px";b.active=!!b.onClick;b.view=c(a.template(b)).css(d).hide().appendTo(a.parent);
b.measuredHeight=b.view.outerHeight()}function D(a,c){c.view.find("a.close").on("click",function(b){b.preventDefault();b.stopPropagation();c.onClose?(b=c.onClose.apply(c))?b.then(function(){B(a,c)}):B(a,c):B(a,c)});c.view.on("click",function(){c.onClick&&c.onClick.apply(c)});c.view.on("mouseenter",function(){a.entered=!0;a.removalSuppressed=!0;c.removing&&(c.view.stop(),c.removing=!1,A(a,c),y(a),C(a,c));c.onOver&&c.onOver.apply(c)});c.view.on("mouseleave",function(){a.entered=!1;b.setTimeout(function(){a.entered||
(a.removalSuppressed=!1)},500);c.onOut&&c.onOut.apply(c)})}function G(){c(b).on("unload",function(){S&&s(S)});k.subscribe("notification.read",function(a){var b=parseInt(a.unreadCount,10);isNaN(b)||t(a.unreadCount,!1,"notifications")});k.subscribe("notification.raised",function(a){t("+1",!1,"notifications");h()})}function I(){U=U&&!c("body").hasClass("administration");b.setTimeout(function(){S||(S=v())},500);h();q()}var O="notifications",L=0,H={},u=0,F={},J=/^(\([0-9\+]+\)\s+)+/,V=!0,Y=null,W=!0,R=
null,P=null,N=null,T=null,Q=null,M=null,X=null,U=!b.parent||b.parent==b,ba={__disconnect_notification:!0,__systemnotification:!0},da=null,S,aa={error:[]},ea=function(a,b){aa[a]&&(aa[a]=aa[a].filter(function(a,c,d){return a!=b}))},ca=function(a){(a=aa[a])&&c.each(a,function(a,b){try{b()}catch(c){}})},Z={show:function(a,b){S||(S=v());b&&b.type&&ca(b.type);var c=r(S,a,b);C(S,x(S,c));return c.id},hide:function(a){if(S&&a)if("function"===typeof a)c.each(S.notifications,function(a,b){B(S,b)}),a();else{var b=
c.grep(S.notifications,function(b){return b.id===a});b&&0!=b.length&&B(S,b[0])}},unread:function(a,b){if(void 0===a)return{local:L,global:u};b=b||{};t(a,!0===b.isLocal,b.namespace||"unknown")}};Z.show.defaults={duration:5E3,width:200,type:"",id:null,onClick:null,onClose:null,onShow:null,onHide:null,onOver:null,onOut:null};Z.defaults={template:'<div class="push-notification <%: cssClass %> <% if(active) { %>active<% } %>">  <a href="#" class="close">x</a>   <%= message %> </div> ',parent:"body",margin:5,
errorDuration:5E3,verticalOffset:0,horizontalOffset:0,animationDuration:250,placement:"bottomleft",opacity:0.95,limit:10};c.telligent=c.telligent||{};c.telligent.evolution=c.telligent.evolution||{};c.telligent.evolution.notifications=c.extend(c.telligent.evolution.notifications||{},Z);return c.extend({initiate:function(){G();I();d.initiate()},on:function(a,b){ea(a,b);aa[a]&&aa[a].push(b)},off:function(a,b){ea(a,b)}},c.telligent.evolution.notifications)},jQuery,window);u("lib.crossWindowPresentContentRegistrar",
["lib.storageProxy"],function(g,f,k,m){function n(c){var b={};c=c.split(":");2<=c.length&&(b.ContentId=c[0],b.ContentTypeId=c[1],2<c.length&&(b.TypeId=c[2]));return b}function e(c){k.setInterval(function(){var b=c.storage.get(c.key)||[],a={},d=(new Date).getTime();f.each(b,function(b,e){d-e<c.expiration&&(a[b]=e)});c.storage.set(c.key,a)},c.garbageCollectInterval)}var d={key:"__cwpcr",expiration:4E3,garbageCollectInterval:3E4,user:{}};return function(c){var b=f.extend({},d,c||{});b.storage=new g(b.user);
e(b);return{setVisibleContents:function(a){if(a){for(var c=b.storage.get(b.key)||[],d=(new Date).getTime(),e=0;e<a.length;e++)c[a[e].ContentId+":"+a[e].ContentTypeId+":"+(a[e].TypeId||"")]=d;b.storage.set(b.key,c)}},getUniqueVisibleContent:function(){var a=b.storage.get(b.key)||[],c=[],d=(new Date).getTime();f.each(a,function(a,e){d-e<b.expiration&&c.push(n(a))});return c}}}},jQuery,window);u("lib.crossWindowPresentContentRegistrarSingleton",["lib.crossWindowPresentContentRegistrar"],function(g,f,
k,m){var n=null;return{get:function(e){return n?n:n=new g(f.extend({user:f.telligent.evolution.user.accessing,expiration:4E3},e||{}))}}},jQuery,window);u("module.presence",["lib.crossWindowPresentContentRegistrarSingleton","lib.crossWindowBus","lib.util"],function(g,f,k,m,n,e){function d(c){c=[];for(var d=a.length;d--;)if(0<a[d].node.closest("body").length){var l;(l=a[d].isRoot)||(l=a[d].node.get(0).getBoundingClientRect(),l=(0<l.height||0<l.width)&&0<=l.bottom&&0<=l.right&&l.top<=(n.innerHeight||
document.documentElement.clientHeight)&&l.left<=(n.innerWidth||document.documentElement.clientWidth));if(l)for(l=0;l<a[d].contents.length;l++)c.push({ContentId:a[d].contents[l].ContentId,ContentTypeId:a[d].contents[l].ContentTypeId,TypeId:a[d].contents[l].TypeId})}else a.splice(d,1);0<c.length&&b&&b.setVisibleContents(c)}function c(){b=g.get();n.setInterval(function(){d(!1)},2E3);p=k.debounce(function(){d(!0)},250);t=k.debounce(function(){try{m.telligent.evolution.sockets.present()}catch(a){}},500);
m(n).on("scroll resized",k.requestAnimationFrameThrottle(function(){p();t()}))}var b=null,a=[],l=!0,p,t,l=!0;m(function(){c();setTimeout(function(){l=!1},4E3)});f={register:function(b){b.node=m(b.node);b.isRoot=b.node.is("body");a.push(b);l||(p(),t())}};m.telligent=m.telligent||{};m.telligent.evolution=m.telligent.evolution||{};m.telligent.evolution.presence=m.telligent.evolution.presence||f;return f},jQuery,window);u("module.preview",function(g,f,k){var m=function(e,d){var c=g.extend({},n.defaults,
d||{});g.telligent.evolution.get({url:c.endpoint,data:{url:e,maxImageWidth:"undefined"!==typeof d.maxImageWidth?d.maxImageWidth:c.maxImageWidth,maxImageHeight:"undefined"!==typeof d.maxImageHeight?d.maxImageHeight:c.maxImageHeight},success:function(b){b&&c.success&&"undefined"!==typeof b&&null!==b?c.success(b):c.error&&c.error(b)},error:function(b,a,d){c.error&&c.error(b,a,d)}})},n={load:function(e,d){m(e,d)},render:function(e,d){if(null!==e&&"undefined"!==typeof e&&"undefined"!==typeof e.url&&0!==
e.url.length&&"undefined"!==typeof e.title&&0!==e.title.length){var c=g.extend({},n.defaults,d);return g.telligent.evolution.template.compile(c.template)(e)}},defaults:{endpoint:"",maxImageWidth:90,maxImageHeight:90,template:'<div class="abbreviated-post-header shared-link"></div><div class="abbreviated-post shared-link <% if(imageUrl !== null && imageUrl.length > 0){ %> with-image <% } %>">   <h4 class="post-name"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= title %></a></h4>   <% if(siteName !== null && siteName.length > 0){ %>       <div class="post-application">           <span class="label"></span>           <span class="value"><a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= siteName %></a></span>       </div>   <% } %>   <% if(imageUrl !== null && imageUrl.length > 0){ %>       <div class="post-thumbnail">           <a href="<%: url %>" <% if(url.indexOf(jQuery.telligent.evolution.site.getBaseUrl(true)) < 0) { %>class="external-link" target="_blank"<% } %> rel="nofollow"><%= resizedImageHtml %></a>       </div>   <% } %>   <% if(excerpt !== null && excerpt.length > 0){ %>       <div class="post-summary">           <%= excerpt %>      </div>   <% } %></div><div class="abbreviated-post-footer shared-link"></div>'}};
g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.preview=n;return{}},jQuery,window);u("module.regex",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.regex={encode:function(f){return f?f.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&"):f}};return{}},jQuery,window);u("module.rest",["lib.globalConfiguration"],function(g,f,k,m){function n(a){var b;a:{b=g.authorizationCookieName+
"=";for(var c=document.cookie.split(";"),d=0;d<c.length;d++){for(var h=c[d];" "==h.charAt(0);)h=h.substring(1,h.length);if(0==h.indexOf(b)){b=h.substring(b.length,h.length);break a}}b=null}null!=b&&(a.setRequestHeader("Authorization-Code",b),a.setRequestHeader("Rest-Authorization-Code",b))}function e(a){a&&"~/"==a.substr(0,2)&&(a=g.baseUrl+a.substr(2));g.isRemote&&(g.remoteUrlEncodePattern&&a&&-1<a.lastIndexOf("/~/"))&&(a=a.substr(0,a.lastIndexOf("/~/")+3)+a.substr(a.lastIndexOf("/~/")+3).replace(RegExp(g.remoteUrlEncodePattern,
"gi"),function(a,b,c){return"_"+a.substr(1)}));return a}function d(a,b,c){var d=a,h=b;d&&(b&&"string"!==typeof b&&!1!==c.processData)&&(h={},f.each(b,function(a,b){var c=RegExp("{"+a+"}","gim");d.match(c)?d=d.replace(c,k.encodeURIComponent(b)):h[a]=b}));return{url:d,data:h}}function c(a){var b=null,c=[];try{var d=f.isPlainObject(a)?a:JSON.parse(a);d&&(d.Warnings&&f.isArray(d.Warnings)&&0<d.Warnings.length)&&(0<d.Warnings.length&&(b=d.Warnings[0]),c=d.Warnings)}catch(h){}return{single:b,all:c}}function b(a,
b){var c=b,d=[];d.push(c);try{var h=f.isPlainObject(a)?a:JSON.parse(a);h&&(h.Errors&&f.isArray(h.Errors)&&0<h.Errors.length)&&(d=[],f.each(h.Errors,function(a,b){b&&0<b.length&&d.push(b.replace(s,""))}),0<d.length&&(c=d[0]))}catch(l){}return{single:c,all:d}}function a(a,h){var l=d(a.url,a.data,a);a.url=e(l.url);a.data=l.data;var p=a.beforeSend,v=a.error,s=a.warning,t=a.success,w=f.extend({},{defaultErrorMessage:g.defaultErrorMessage},a);f.extend(a,{type:"GET"===h?h:"POST",beforeSend:function(a){p!==
m&&p(a);n(a);"PUT"!==h&&"DELETE"!==h||a.setRequestHeader("Rest-Method",h)},success:function(a,b,d){var h=c(a);t&&q(t,this,[a,b,d]);if(h&&null!=h.single)if(s!==m)q(s,this,[d,h.single]);else try{f.each(h.all,function(a,b){f.telligent.evolution.notifications.show(b,{type:"warning"})})}catch(l){}},error:function(a,d,h){if(0!==a.readyState&&0!==a.status){d=b(a.responseText,w.defaultErrorMessage);if(v!==m)q(v,this,[a,d.single,h]);else try{f.each(d.all,function(a,b){f.telligent.evolution.notifications.show(b,
{type:"error"})})}catch(l){alert(d.single)}if((h=c(a.responseText))&&null!=h.single)if(s!==m)q(s,this,[a,h.single]);else try{f.each(h.all,function(a,b){f.telligent.evolution.notifications.show(b,{type:"warning"})})}catch(e){}}}});return f.ajax(a)}function l(){var a=++r;w[a]={dfd:f.Deferred(),reqs:[]};setTimeout(function(){delete w[a]},x);return a}function p(a,b){var c=w[a];if(c===m)return f.Deferred(function(b){b.reject('Batch "'+a+'" not found')}).promise();if(0===c.reqs.length)return c.dfd.resolve(),
c.dfd.promise();var h=f.extend({},z,b),l={Sequential:h.sequential};f.each(c.reqs,function(a,b){var c=b.options.url.replace(/\.xml/i,".json"),c=d(c,b.options.data,b.options);"GET"==b.verb?c.url=f.telligent.evolution.url.modify({url:c.url,query:c.data||{}}).split("#")[0]:l["_REQUEST_"+a+"_DATA"]=f.param(c.data||{});l["_REQUEST_"+a+"_URL"]=e(c.url);l["_REQUEST_"+a+"_METHOD"]=b.verb});f.ajax({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/batch.json",type:"POST",data:l,beforeSend:function(a){h.beforeSend&&
h.beforeSend(a);n(a)}}).done(function(b,d){t(c,b.BatchResponses,this,d);c.dfd.resolveWith(this,[b]);delete w[a]}).fail(function(b,d,h){0!==b.readyState&&0!==b.status&&(b.responseJSON&&b.responseJSON.BatchResponses?t(c,b.responseJSON.BatchResponses,b,d):f.each(c.reqs,function(a,c){c.options.error&&q(c.options.error,c.options,[b,d,h]);c.dfd.rejectWith(c.options,[b,d,h])}),c.dfd.rejectWith(this,[b,d,h]),delete w[a])});return c.dfd.promise()}function t(a,d,h,l){f.each(d,function(d,e){var p=a.reqs[d];
if(200===e.StatusCode){var g=c(e.BatchResponse);p.options.success&&q(p.options.success,p.options,[e.BatchResponse,l,h]);p.dfd.resolveWith(p.options,[e.BatchResponse,l,h]);p.options.complete&&q(p.options.complete,p.options,[h,l]);if(g&&null!=g.single)if(p.options.warning!==m)q(p.options.warning,this,[h,g.single]);else try{f.each(g.all,function(a,b){f.telligent.evolution.notifications.show(b,{type:"warning"})})}catch(v){}}else{g=b(e.BatchResponse,p.options.defaultErrorMessage);if(p.options.error)q(p.options.error,
h,[e,g,l]);else try{f.telligent.evolution.notifications.show(g,{type:"error"})}catch(s){alert(g)}p.dfd.rejectWith(h,[e,g,l]);p.options.complete&&q(p.options.complete,p.options,[h,l]);if((g=c(e.BatchResponse))&&null!=g.single)if(p.options.warning!==m)q(p.options.warning,this,[h,g.single]);else try{f.each(g.all,function(a,b){f.telligent.evolution.notifications.show(b,{type:"warning"})})}catch(t){}}})}function q(a,b,c){if(a)if(f.isArray(a))for(var d=0;d<a.length;d++)a[d].apply&&a[d].apply(b,c);else a.apply&&
a.apply(b,c)}function h(b,c){null!==y&&(b.batch=y);b&&(b.url&&0<=b.url.indexOf("/api.ashx/")&&"GET"==c)&&(b=f.extend({},{cache:!1},b));if(b&&b.batch){var d=b,h;h=d.batch;w[h]===m&&(h=l());h=w[h];d={options:f.extend({},{defaultErrorMessage:g.defaultErrorMessage},d),verb:c,dfd:f.Deferred()};h.reqs.push(d);return d.dfd.promise()}return a(b,c)}function v(a,b){if(a){if(null!==y)throw"Batched REST requests cannot be nested.";var c=l();y=c;try{a.apply(this)}finally{y=null}return p(c,b)}}var s=/(?:<|>)/g,
w={},r=0,x=6E4,y=null,z={sequential:!1,beforeSend:null};v.create=l;v.process=p;var A={get:function(a){return h(a,"GET")},post:function(a){return h(a,"POST")},put:function(a){return h(a,"PUT")},del:function(a){return h(a,"DELETE")},writeAuthorizationHeader:n,ensureRemoteUrlEncoding:e,batch:v};f.telligent=f.telligent||{};f.telligent.evolution=f.telligent.evolution||{};f.extend(f.telligent.evolution,A);k.TelligentUtility||(k.TelligentUtility={WriteAuthorizationHeader:function(a){f.telligent.evolution.writeAuthorizationHeader(a)}});
return A},jQuery,window);u("module.scheduledFile",["lib.globalConfiguration","module.messaging"],function(g,f,k,m,n){function e(){f.subscribe("socket.connected",function(){k.telligent.evolution.sockets.scheduledFile.on("complete",function(c){c.resultKey?(b(context),k.telligent.evolution.get({url:g.scheduledFileStatusUrl,data:{resultKey:c.resultKey}}).then(function(b){a(d(c.progressKey),b.largeResult)})):a(d(c.progressKey),c.result)});k.telligent.evolution.sockets.scheduledFile.on("error",function(a){l(d(a.progressKey),
a.message)});k.telligent.evolution.sockets.scheduledFile.on("progress",function(a){p(d(a.progressKey),a.percentComplete||null,a.message||null)})})}function d(a){var b=h[a];b||(b={key:a,messagesReceived:{}},h[a]=b);return b}function c(d){clearTimeout(d.fallbackTimeout);d.fallbackTimeout=setTimeout(function(){k.telligent.evolution.get({url:g.scheduledFileStatusUrl,data:{key:d.key}}).then(function(b){c(d);if(!b)return null;if(b.Log)for(var h=0;h<b.Log.length;h++){var e=b.Log[h];e&&!d.messagesReceived[e]&&
p(d,null,e)}"Completed"==b.State?(b.PercentComplete&&p(d,b.PercentComplete),a(d,b.Result)):"Cancelled"==b.State||"Errored"==b.State?(b.PercentComplete&&p(d,b.PercentComplete),l(d,b.Result)):b.PercentComplete&&p(d,b.PercentComplete)},function(){b(d)})},q)}function b(a){a&&setTimeout(function(){clearTimeout(a.fallbackTimeout);delete h[a.key]},q/2)}function a(a,c){b(a);f.publish("scheduledFile.complete",{progressKey:a.key,percentComplete:1,result:t(c||"")})}function l(a,c){b(a);f.publish("scheduledFile.error",
{progressKey:a.key,message:t(c||"")})}function p(a,b,d){c(a);f.publish("scheduledFile.progress",{progressKey:a.key,percentComplete:b||null,message:d||null});d&&(a.messagesReceived[d]=!0)}function t(a){try{return JSON.parse(a)}catch(b){return a}}var q=5E3,h={};k.telligent=k.telligent||{};k.telligent.evolution=k.telligent.evolution||{};k.telligent.evolution.scheduledFile={monitor:function(a){c(d(a))}};return{init:function(){e()}}},jQuery,window);u("module.scriptRendering",["lib.util","events.rendered"],
function(g,f,k,m,n){function e(b){return(b.attr("src")||a.test(b.attr("type")||""))&&!k.contains(m.document.documentElement,b.get(0))}function d(a,b,c){try{var d=k(b);c.scripts=[];d.filter("script").each(function(){var a=k(this);e(a)&&(c.scripts.push(a),a.remove())});d.find("script").each(function(){var a=k(this);e(a)&&(c.scripts.push(a),a.remove())});return 0<c.scripts.length?d=d.filter(function(){var a=k(this);return!(a.is("script")&&e(a))}):b}catch(l){return b}}function c(a,b){if(b.scripts&&0!==
b.scripts.length){var c=[],d=[],e=[];k.each(b.scripts,function(a,b){b.attr("src")?p[b.attr("src")]?d[a]="":c.push(k.telligent.evolution.get({url:b.attr("src"),type:"GET",dataType:"text",success:function(c){d[a]=c+"";e.push(b.attr("src"))},error:function(a,b,c){}})):d[a]=b.get(0).textContent.replace(l,"")});k.when.apply(k,c).then(function(){k.globalEval(d.join("\n;;;\n"));k.each(e,function(a,b){p[b]=!0});f.decrementLoading(a)})["catch"](function(b){f.decrementLoading(a)})}else f.decrementLoading(a)}
function b(a){return a?(a=k(a).get(0))?k.contains(document,a):!1:!1}var a=/^$|\/(?:java|ecma)script/i,l=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,p={};return{initiate:function(){k("script[src]").each(function(){p[k(this).attr("src")]=!0});k.each(["html","append","prepend"],function(a,l){var h=k.fn[l];k.fn[l]=function(){var a=arguments;if(b(this)||b(a)){var l={scripts:[]};f.incrementLoading(this);a[0]=d(this,a[0],l);a=h.apply(this,a);c(this,l);return a}return h.apply(this,a)}})}}},jQuery,window);
u("module.shortcuts",["lib.shortcutRegistry"],function(g,f,k,m){f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution={});return{init:function(){f.telligent.evolution.shortcuts=f.telligent.evolution.shortcuts||new g}}},jQuery,window);u("module.sockets.connection",function(g,f,k){var m=function(f){m.connectionState=g.signalR.connectionState;var e=g.connection(f.endpoint);return{start:function(d){return e.start(d)},stop:function(){return e.stop()},send:function(d){return e.send(d)},
received:function(d){return e.received(d)},error:function(d){return e.error(d)},stateChanged:function(d){return e.stateChanged(d)},disconnected:function(d){return e.disconnected(d)},reconnected:function(d){return e.reconnected(d)}}};return m},jQuery,window);u("module.sockets.crossTabRequest",["lib.crossWindowBus","lib.backgroundTimer"],function(g,f,k,m,n){var e={},d={timeout:50};return function(c){k.extend({},e,c||{});var b={},a={},l=new g({key:"__ctr",includeLocal:!1,receive:function(c,d,e){"req"==
c?(c=null,b[d.name]&&(c=b[d.name](d.data)),l.send(e.source,"resp",{name:d.name,response:c})):"resp"==c&&(a[d.name]=a[d.name]||[],a[d.name].push({source:e.source,response:d.response}))}});return{handle:function(a,c){b[a]=c},request:function(b,c,e){return k.Deferred(function(h){var g=k.extend({},d,e||{});a=a||{};delete a[b];l.broadcast("req",{name:b,data:c});f.setTimeout(function(){a[b]?h.resolve({responses:a[b]}):h.resolve({responses:[]})},g.timeout)}).promise()}}}},jQuery,window);u("module.sockets.managedConnection",
["module.sockets.connection","lib.crossWindowPresentContentRegistrarSingleton","lib.backgroundTimer","module.messaging"],function(g,f,k,m,n,e,d){function c(a){a.reconnectAttempts++;var b=1E3*(Math.pow(2,a.reconnectAttempts)-1);b>a.maxReconnectDelay&&(b=a.maxReconnectDelay,a.reconnectAttempts--);return Math.floor(Math.random()*(b-1)+1)}function b(a,b){var d=c(a);k.clearTimeout(a.reconnectTimeout);a.reconnectTimeout=k.setTimeout(function(){a.authenticated&&(k.clearTimeout(a.reconnectTimeout),l(a))},
d)}function a(a,b,c){if(a.authenticated){var d=a.crossWindowPresentContentRegistrar.getUniqueVisibleContent(),l;l=[];for(var e=0;e<(d||[]).length;e++)l.push(d[e].ContentId+"|"+d[e].ContentTypeId+"|"+d[e].TypeId),l.sort();l="_present:"+l.join(",");a.connectionState!=g.connectionState.connected||c&&(null==d||0==d.length||a.lastSentPresenceMessage&&l===a.lastSentPresenceMessage)||(b.send(l),a.lastSentPresenceMessage=l)}}function l(a){a.connection.start({callback:function(){a.authenticated=!0}})}function p(c,
d){var f=c.connectionState;c.connectionState=d;switch(c.connectionState){case g.connectionState.connected:k.clearTimeout(c.raiseDisconnectTimeout);if(!c.raisedInitialConnect){if(c.raisedInitialConnect=!0,c.onConnected)c.onConnected()}else if(c.raisedInitialConnect&&c.onReconnected)c.onReconnected();c.reconnectAttempts=0;k.clearInterval(c.presenceInterval);c.presenceInterval=k.setInterval(function(){a(c,c.connection)},c.sendPresenceIntervalTime);n(e).off(q).on("beforeunload"+q,function(){c.unloaded=
!0;c.connection.stop()}).on("online"+q,function(){l(c)}).on("wake"+q,function(){l(c)});break;case g.connectionState.connecting:case g.connectionState.reconnecting:case g.connectionState.disconnected:f==g.connectionState.connected&&!c.unloaded&&c.onDisconnected&&(k.clearTimeout(c.raiseDisconnectTimeout),c.raiseDisconnectTimeout=k.setTimeout(function(){if(c.authenticated)c.onDisconnected(!0)},2E3)),c.connectionState!=g.connectionState.disconnected||c.unloaded||b(c,c.connection)}}var t={endpoint:"",
sendPresenceIntervalTime:2E4,reconnectAttempts:0,disconnectGracePeriod:2E3,maxReconnectDelay:3E5,connectionState:0,raisedInitialConnect:!1,reconnectTimeout:0,presenceInterval:null,onReceived:null,onConnected:null,onDisconnected:null,onReconnected:null},q="._sockets_managedConnection";return function(b){var c=n.extend({},t,b||{});n.ajaxPrefilter(function(a,b,d){0===a.url.indexOf(c.endpoint)&&n.telligent.evolution.writeAuthorizationHeader(d)});c.connection=new g({endpoint:c.endpoint});c.connection.stateChanged(function(a){p(c,
a.newState)});c.connection.received(function(a){if(c.onReceived)c.onReceived(a)});c.connection.error(function(a){c.connection.stop()});m.subscribe("user.logout",function(){c.authenticated=!1;c.onDisconnected&&k.setTimeout(function(){c.onDisconnected(!1)},3E3)});return{start:function(a){a.onConnected&&(c.onConnected=a.onConnected);a.onReceived&&(c.onReceived=a.onReceived);a.onDisconnected&&(c.onDisconnected=a.onDisconnected);a.onReconnected&&(c.onReconnected=a.onReconnected);c.crossWindowPresentContentRegistrar||
(c.crossWindowPresentContentRegistrar=f.get());l(c)},stop:function(){c.connectionState!=g.connectionState.disconnected&&c.connection.stop()},send:function(a){c.connectionState!=g.connectionState.connected&&c.authenticated||c.connection.send(a)},sendPresence:function(){a(c,c.connection,!0)}}}},jQuery,window);u("module.sockets.sharedObjectProxy",["lib.crossWindowBus","module.sockets.sharedObjectProxyState","module.sockets.crossTabRequest","lib.backgroundTimer"],function(g,f,k,m,n,e,d){function c(c){m.setInterval(function(){switch(c.mode){case q.initial:case q.worker:c.beatsWithoutCoordinator++;
c.beatsWithoutCoordinator>c.maxBeatsWithoutCoordinator&&(a(c),c.coordinatorId=null,b(c));break;case q.coordinator:c.crossWindowBus.broadcast(h.coordinating,{});break;case q.volunteer:c.beatsAsVolunteer++,c.beatsAsVolunteer>c.maxBeatsAsVolunteer&&l(c)}},e.__shared_object_proxy_interval?e.__shared_object_proxy_interval:c.heartbeat)}function b(a){null!==a.objectInstance&&(a.destroy(a.objectInstance),a.objectInstance=null)}function a(a){a.mode=q.volunteer;a.beatsAsVolunteer=0;a.coordinatorId=null;b(a);
a.crossWindowBus.broadcast(h.volunteer,{})}function l(a){a.mode=q.coordinator;a.beatsAsVolunteer=0;a.coordinatorId=a.id;a.objectInstance=a.construct();a.crossWindowBus.broadcast(h.coordinating,{});if(a.delayedMessageQueue)for(var b=0;b<a.delayedMessageQueue.length;b++)t(a,a.delayedMessageQueue[b].message,a.delayedMessageQueue[b].data)}function p(a){a.mode=q.worker;a.coordinatorId=null;b(a);a.beatsAsVolunteer=0}function t(a,b,c){a.mode===q.coordinator&&null!==a.objectInstance?a.receive(a.objectInstance,
b,c):null!==a.coordinatorId?a.crossWindowBus.send(a.coordinatorId,h.call,{name:b,data:c}):(a.delayedMessageQueue.push({message:b,data:c}),a.delayedMessageQueue.length>a.delayedMessageQueueMaxLength&&a.delayedMessageQueue.shift())}var q={initial:0,coordinator:1,volunteer:2,worker:3},h={coordinating:"sop:coordinating",working:"sop:working",volunteer:"sop:volunteer",ok:"sop:ok",call:"sop:call",resign:"sop:resign",newarrival:"sop:newarrival"},v={heartbeat:1E3,preexisting:function(a){},construct:function(){},
destroy:function(a){},receive:function(a,b,c){}},s={mode:q.initial,id:0,beatsWithoutCoordinator:0,beatsAsVolunteer:0,coordinatorId:0,objectInstance:null,delayedMessageQueue:[],delayedMessageQueueMaxLength:25,maxBeatsAsVolunteer:2,maxBeatsWithoutCoordinator:2};return function(d){var r=n.extend({},v,d||{},s);r.crossTabRequest=new k;r.crossWindowBus=new g({key:"__sop",includeLocal:!1,receive:function(c,d,l){l=l.source;switch(c){case h.coordinating:r.beatsWithoutCoordinator=0;r.mode===q.worker||r.mode===
q.initial?(r.coordinatorId=l,r.mode===q.initial&&p(r)):(r.mode===q.coordinator&&r.crossWindowBus.broadcast(h.resign,{}),p(r));f.hasMultipleWindows(!0);d&&d.preExisting&&r.preexisting();r.crossWindowBus.send(l,h.working,{});break;case h.working:f.hasMultipleWindows(!0);break;case h.volunteer:r.mode!==q.coordinator&&r.mode!==q.volunteer||r.crossWindowBus.send(l,h.ok,{});break;case h.ok:r.mode===q.volunteer&&p(r);break;case h.call:r.mode===q.coordinator&&null!==r.objectInstance&&r.receive(r.objectInstance,
d.name,d.data);break;case h.resign:if(r.mode===q.worker||r.mode===q.initial)a(r),r.coordinatorId=null,b(r);break;case h.newarrival:r.mode===q.coordinator&&r.crossWindowBus.send(l,h.coordinating,{preExisting:!0})}}});r.id=r.crossWindowBus.id();c(r);n(e).on("unload",function(){r.mode!==q.worker&&r.crossWindowBus.broadcast(h.resign,{})});r.crossWindowBus.broadcast(h.newarrival,{});r.crossTabRequest.handle("CurrentMode",function(){return r.mode});r.crossTabRequest.request("CurrentMode",{},{timeout:100}).then(function(a){for(var b=
!1,c=0;c<a.responses.length;c++)a.responses[c]===q.coordinator&&(b=!0);!b&&(0<a.responses.length&&r.mode===q.initial)&&l(r)});m.setTimeout(function(){r.mode===q.initial&&l(r)},2*r.heartbeat);return{call:function(a,b){t(r,a,b)}}}},jQuery,window);u("module.sockets.sharedObjectProxyState",["lib.backgroundTimer"],function(g,f,k,m){var n=!1,e=null;f={hasMultipleWindows:function(d){d!==m&&(g.clearTimeout(e),n=d,e=g.setTimeout(function(){n=!1},2500));return n}};return k._sharedObjectProxyState=f},jQuery,
window);u("module.sockets","module.sockets.managedConnection module.sockets.sharedObjectProxy lib.crossWindowBus module.notifications lib.backgroundTimer module.presence".split(" "),function(g,f,k,m,n,e,d,c,b){var a={reconnectingResource:"Reconnecting",disconnectResource:"Disconnected",reconnectResource:"Reconnected"},l={},p,t,q=!1,h=function(){d(document).ready(function(){q?d.telligent.evolution.messaging.publish("socket.reconnected",null,{crossWindow:!0}):(q=!0,p.call("sendPresence"),d.telligent.evolution.messaging.publish("socket.connected"))})},
v=function(a){var b=d("body");e.register({node:b.get(0),contents:a})},s=function(a,b,c){(a=l[a+"|"+b])&&d.each(a,function(a,b){try{b(c||null)}catch(d){}})},w=function(){c.parent&&c.parent!=c||(m.show(a.reconnectResource,{id:"__disconnect_notification",duration:5E3}),n.setTimeout(function(){m.hide("__disconnect_notification")},5E3))},r=function(b){d.each(b.sockets,function(a,b){r[b.name]={on:function(a,c){var d=b.fullName+"|"+a;l[d]=l[d]||[];l[d].push(c)},off:function(a){delete l[b.fullName+"|"+a]},
send:function(a,c){if(p){var d=JSON.stringify({_s:b.fullName,_m:a,_d:c||null});p.call("send",d)}}}});r.present=function(){null!==t&&t.broadcast("_shared_socket.sendPresence")};0<b.sockets.length&&(t=new k({key:"__rsm",includeLocal:!0,receive:function(l,e){if("_shared_socket.receive"===l){if(e&&0!=e.length){var f=JSON.parse(e);s(f._s,f._m,f._d)}}else"_shared_socket.socketsReady"===l?(v(b.presentPageContexts),h()):"_shared_socket.socketsDisconnected"===l?(d.telligent.evolution.messaging.publish("socket.disconnected",
null,{crossWindow:!0}),f=e.reconnecting,c.parent&&c.parent!=c||m.show(f?a.reconnectingResource:a.disconnectResource,{id:"__disconnect_notification",type:f?"error":"",duration:6048E5})):"_shared_socket.socketsReconnected"===l?(p.call("sendPresence"),d.telligent.evolution.messaging.publish("socket.reconnected",null,{crossWindow:!0}),w()):"_shared_socket.sendPresence"===l&&p.call("sendPresence")}}),p=new f({heartbeat:1E3,preexisting:function(a){n.setTimeout(function(){v(b.presentPageContexts);h()},250)},
construct:function(){var a=new g({endpoint:b.endpoint});a.start({onConnected:function(){t.broadcast("_shared_socket.socketsReady")},onReceived:function(a){t.broadcast("_shared_socket.receive",a)},onDisconnected:function(a){t.broadcast("_shared_socket.socketsDisconnected",{reconnecting:a})},onReconnected:function(){t.broadcast("_shared_socket.socketsReconnected")}});return a},destroy:function(a){null!==a&&a.stop()},receive:function(a,b,c){null!==a&&("send"===b?a.send(c):"sendPresence"===b&&a.sendPresence())}}))};
r.defaults=a;d.telligent=d.telligent||{};d.telligent.evolution=d.telligent.evolution||{};d.telligent.evolution.sockets=d.telligent.evolution.sockets||r;return{}},jQuery,window);u("module.systemNotifications","lib.util lib.storageProxy module.messaging module.sockets.sharedObjectProxyState lib.globalConfiguration module.rest".split(" "),function(g,f,k,m,n,e,d,c,b){function a(a,b,c){v||(v=new f({id:d.telligent.evolution.user.accessing.id,isSystemAccount:d.telligent.evolution.user.accessing.isSystemAccount}));
var l=v.get(t),e=!1;l&&(l.id==a&&18E5>(new Date).getTime()-l.time)&&(e=!0);!e&&q&&b&&0<b.length&&0<c?(1<c&&(b+=" "+s.andMoreText.replace(/\{0\}/g,c-1)),b='<div class="system-notification-title">'+s.notificationText+'</div><div class="system-notification-content">'+b+'</div><div class="system-notification-review">'+s.reviewText+"</div>",d.telligent.evolution.notifications.show(b,{type:"system-notification",duration:6048E5,id:h,onClick:d.telligent.evolution.systemNotifications.openPanel,onClose:function(){v.set(t,
{id:a,time:(new Date).getTime()})}})):d.telligent.evolution.notifications.hide(h)}function l(){k.subscribe("systemnotification.raised",function(b){a(b.id,b.message,b.count)});k.subscribe("systemnotification.resolved",function(b){a(b.nextid,b.message,b.count)})}function p(){(q=(q=(q=!c.parent||c==c.parent)&&!d("body").hasClass("administration"))&&!(d.telligent.evolution.user.accessing.isSystemAccount||d.telligent.evolution.user.accessing.isTemporary))&&d.telligent.evolution.get({url:d.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/systemnotifications.json",data:{IsResolved:!1,PageSize:1,PageIndex:0},success:function(b){var c=b.TotalCount;0<c&&(b=0<b.SystemNotifications.length?b.SystemNotifications[0]:{},a(b.Id,b.Subject,c))}})}var t="systemnotifications",q=!1,h="__systemnotification",v=null,s={explicitPanelUrl:"",notificationText:"System Notification",reviewText:"Review",andMoreText:" (plus {0} more)"};g={configure:function(a){s=d.extend(s,a)},openPanel:function(){window.location.href=s.explicitPanelUrl}};d.telligent||
(d.telligent={});d.telligent.evolution||(d.telligent.evolution={});d.telligent.evolution.systemNotifications=g;return d.extend({initiate:function(){l();p()}},g)},jQuery,window);u("module.template",["lib.lruCache","lib.storageProxy","module.javaScript","module.html","lib.util"],function(g,f,k,m,n,e,d,c){var b={},a={open:"<%",close:"%>"},l=null,p=function(){var a=new f(e.telligent&&e.telligent.evolution&&e.telligent.evolution.user&&e.telligent.evolution.user.accessing?e.telligent.evolution.user.accessing:
{isSystemAccount:!0,id:0});return new g({load:function(){return a.get("__templates")},persist:function(b){a.set("__templates",b)}})},t=function(a,b){var c={};return function(a,b){var d=b.open+b.close,h=c[d];h||(h=RegExp("("+n.escapeRegEx(b.open)+"|"+n.escapeRegEx(b.close)+")","g"),c[d]=h);for(var d=a.split(h),h=!1,l=0;l<d.length;l++)d[l]==b.open?h=!0:d[l]==b.close?h=!1:h||(d[l]=k.encode(d[l]));return d.join("")}}(),q=function(b,c,d){var h=d.get(b);if(!h){h=e.extend({},a,c||{});c=RegExp(n.escapeRegEx(h.open)+
"=([\\s\\S]+?)"+n.escapeRegEx(h.close),"g");var l=RegExp(n.escapeRegEx(h.open)+":([\\s\\S]+?)"+n.escapeRegEx(h.close),"g"),f=RegExp(n.escapeRegEx(h.open)+"(.*?)"+n.escapeRegEx(h.close),"g"),h="var s=[];with(data){with(e){with(d){s.push('"+t(b,h).replace(c,"');s.push(String($1));s.push('").replace(l,"');s.push(escape(String($1)));s.push('").replace(f,"');$1s.push('")+"');}}}return s.join('');";d.set(b,h)}b=new Function("d","e","data",h);b.compiledSource="function(d, e, data) { "+h+" } ";return b},
h=function(a){return b[a]};e.extend(h,{compile:function(a,c,d,e){e||(l||(l=p()),e=l);var f=b[a];if("undefined"===typeof f){var g=null!==document.getElementById(a)?document.getElementById(a).innerHTML:a,t=q(g,d,e);b[a]=f=function(a){return t.call(this,h.helpers||{},c||{},a||{})};f.source={raw:g,compiled:t.compiledSource}}return f},helpers:{foreach:function(a,b){if(a&&0<a.length&&b)for(var c=0;c<a.length;c++)b(a[c],c)},escape:function(a){return m.encode(a)},template:function(a,d){var h=b[a];if(h===
c||null===h)throw"Subtemplate "+a+" is undefined.";return h(d)},call:function(a,b){return a(b)}},register:function(a,c){b[a]=function(a){return c.call(this,h.helpers||{},a||{})}}});e.telligent=e.telligent||{};e.telligent.evolution=e.telligent.evolution||{};return e.telligent.evolution.template=h},jQuery,window);u("module.themePreview",["module.messaging","module.rest"],function(g,f,k,m,n){function e(b){return k.Deferred(function(c){!0===b!=a.isPreviewing?k.telligent.evolution.post({url:a.callbackUrl,
data:{Enabled:!0===b}}).then(function(){h=!0;d(!0===b);c.resolve(!0===b)})["catch"](function(){c.reject(a.isPreviewing)}):c.resolve(!0===b)}).promise()}function d(b){if(b!=a.isPreviewing){if(b)m.document.cookie=a.cookieName+"=True; path=/";else{var c=new Date;c.setTime(c.getTime()+-864E5);m.document.cookie=a.cookieName+"=; expires="+c.toGMTString()}a.isPreviewing=b;p?t=!0:q||m.location.reload(!0)}}function c(){g.subscribe("administration.panel.loaded",function(){p=!0});g.subscribe("context.shell.closed",
function(){p=!1;h&&(a.isPreviewing&&m.confirm(a.stopPreviewingConfirmation))&&e(!1);t&&!q&&(t=!1,m.location.reload(!0))});g.subscribe(l.enabled,function(){d(!0)});g.subscribe(l.disabled,function(){d(!1)});k(document).on("customizepage",function(){q=!0})}function b(){m.parent!=m&&(q=!0);k.telligent.evolution.sockets.themepreview&&(k.telligent.evolution.sockets.themepreview.on("preview-updated",function(b){m.clearTimeout(v);v=m.setTimeout(function(){g.publish(l.updated,{});a.isPreviewing&&(p?t=!0:q||
m.location.reload(!0))},1E3)}),k.telligent.evolution.sockets.themepreview.on("preview-enabled",function(a){g.publish(l.enabled,{})}),k.telligent.evolution.sockets.themepreview.on("preview-disabled",function(a){g.publish(l.disabled,{})}))}var a={callbackUrl:null,isPreviewing:!1,previewUrl:"",stopPreviewingConfirmation:"",cookieName:"enable_theme_staging"},l={enabled:"themepreview.enabled",disabled:"themepreview.disabled",updated:"themepreview.updated"},p=!1,t=!1,q=!1,h=!1,v=null;f={enabled:function(b){return b===
n?a.isPreviewing:e(b)},configure:function(b){a=k.extend({},a,b)},hasPendingRefresh:function(){return t}};k.telligent||(k.telligent={});k.telligent.evolution||(k.telligent.evolution={});k.telligent.evolution.themePreview=f;return k.extend({initiate:function(){c();b()}},f)},jQuery,window);u("module.tourtips",["module.configuration"],function(g,f,k,m){function n(){function a(b){return f.telligent.evolution.user.accessing.id+":"+b}function b(a){return"tourtip_:"+a}var c=f.telligent.evolution.user.accessing.isSystemAccount?
k.sessionStorage:k.localStorage;return{get:function(d){if(c)return JSON.parse(c.getItem(b(a(d))))},set:function(d,h){c&&c.setItem(b(a(d)),JSON.stringify(h))},remove:function(d){c&&c.removeItem(b(a(d)))}}}function e(){t&&(k.clearTimeout(a),a=k.setTimeout(e,p));var h=[],l=[];f.each(b,function(a,b){var c=q.get(b.key);c&&!c.read?h.push(b):c||l.push(b)});b.length=0;if(0<l.length)if(f.telligent.evolution.user.accessing.isSystemAccount)f.each(l,function(a,b){h.push(b)}),d(h);else{var g={},r=[];f.each(l,
function(a,b){r.push(b.key);g[b.key]=b});t=!0;c.list(r).then(function(a){t=!1;f.each(a.TourTips,function(a,b){q.set(b.Key,{read:b.Read});if(!b.Read){var c=g[b.Key];c&&h.push(c)}});d(h)})}else d(h)}function d(a){q=q||n();var b=q.get(h);b&&0<b&&b>(new Date).getTime()||(a=a.sort(function(a,b){return a.index-b.index}),f.telligent.evolution.messaging.publish("ui.tourtips",{tips:a}))}var c={mark:function(a,b){return(b?f.telligent.evolution.post:f.telligent.evolution.del)({url:f.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/tourtips/{key}.json?IncludeFields=Key,Read",data:{key:a}})},list:function(a){return f.telligent.evolution.get({url:f.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/tourtips.json?IncludeFields=Key,Read",data:{Keys:a.join(",")}})}},b=[],a,l=0,p=1E3,t=!1,q,h="suppressUntil";f.telligent=f.telligent||{};f.telligent.evolution=f.telligent.evolution||{};f.telligent.evolution.tourTips={register:function(c){f.telligent.evolution.user&&f.telligent.evolution.user.accessing&&(q=q||n(),c&&(c.index==
m&&(c.index=l++),b.push(c),k.clearTimeout(a),a=k.setTimeout(e,p)))},mark:function(a,b){q.set(a,{read:b});return f.telligent.evolution.user.accessing.isSystemAccount?f.Deferred(function(a){a.resolve()}).promise():c.mark(a,b)},suppress:function(a){q=q||n();a&&0<a?q.set(h,(new Date).getTime()+a):q.remove(h)}};return{}},jQuery,window);u("module.ui",["lib.util"],function(g,f,k,m){function n(b){b=f(b||document);for(var e in a.components){var g=a.components[e],q=f(".ui-"+e,b);b.hasClass(".ui-"+e)&&q.add(b);
q&&(0<q.length&&"undefined"!==typeof g.setup&&!c[e])&&(g.setup.call(this),c[e]=!0);q&&(0<q.length&&"undefined"!==typeof g.add)&&q.each(function(){try{var b=f(this);b.data(d+"."+e)||(g.add.call(b,b,a.data(b)),b.data(d+"."+e,!0))}catch(c){k.console&&k.console.log&&k.console.log(c)}})}}function e(a){var c;b++;try{c=a()}catch(d){}b--;return c}var d="_telligent_evolution_ui_render_add",c={},b=0,a={components:{},render:n,suppress:e,defer:function(a,b){var c=e(b);n(a);return c},data:function(a){if(!a)return{};
a=f(a);var b=a.data("_telligent_evolution_ui_data");if(null===b||"undefined"===typeof b){var b=a.get(0),c={};if(b.dataset)c=b.dataset;else for(var d=0;d<b.attributes.length;d++){var h=b.attributes[d];if(0===h.name.indexOf("data-")){var e=h.name.substring(5);c[e]=h.value}}c.configuration&&(c=f.extend({},c,{configuration:f.telligent.evolution.url.parseQuery(c.configuration)}));b=c;a.data("_telligent_evolution_ui_data",b)}return b}};f.telligent||(f.telligent={});f.telligent.evolution||(f.telligent.evolution=
{});f.telligent.evolution.ui=a;return f.extend({initiate:function(){f.each(["html","append","prepend"],function(a,c){f.fn[c]=g.wrap(f.fn[c],{after:function(){0==b&&f.telligent.evolution.ui.render(this)}})});f.each(["after","before"],function(a,c){f.fn[c]=g.wrap(f.fn[c],{after:function(){0==b&&f.telligent.evolution.ui.render(this.parent())}})});f.each(["replaceWith"],function(a,c){f.fn[c]=g.wrap(f.fn[c],{filterArguments:function(a){return f(a)[0]?[f(a)]:[a]},after:function(a){0==b&&f.telligent.evolution.ui.render(a)}})})}},
a)},jQuery,window);u("module.url",function(g,f,k){var m=null,n=function(c,b,a,d,e){if(!c)return c;var f=/(?:\.config|\.ascx|\.asax|\.cs|\.vb)$/i.test(c);return c.replace(b,function(b,h,g){if(" "==b)return a;if("."!=b||f||g==c.length-1||"."==c.substr(g+1,1)){h=[];h[h.length]=e;for(g=0;g<b.length;g++){var s=b.charCodeAt(g).toString(16)+"",k=s.length;4==k?(h.push(s.substr(2,2).toUpperCase()),h.push(s.substr(0,2).toUpperCase())):3==k?(h.push(s.substr(1,2).toUpperCase()),h.push("0"),h.push(s.substr(0,
1).toUpperCase())):2==k&&(h.push(s.toUpperCase()),h.push("00"))}h[h.length]=e;return h.join("")}return d})},e=function(c,b,a,d){return c?c.replace(b,function(b,c,e){if(1==b.length){if(b==a)return" ";if(b==d)return"."}else{b=b.substr(1,b.length-2);if(0!=b.length%4)return"";c=[];for(e=0;e<b.length;e+=4)c[c.length]=String.fromCharCode(parseInt(b.substr(e+2,2)+b.substr(e,2),16));return c.join("")}}):c},d={parseQuery:function(c){var b=c.split("?"),a={};c=(1<b.length?b[1]:c).split("#")[0].split("&");g.each(c,
function(b,c){c=c.split("=");2===c.length&&(a[decodeURIComponent(c[0].replace(/\+/gi," "))]=decodeURIComponent(c[1].replace(/\+/gi," ")))});return a},serializeQuery:function(c){c=c||{};var b=[];g.each(c,function(a,c){if(null!=c&&"function"===typeof c.toISOString)c=c.toISOString();else if(null==c||c==k)c="";b[b.length]=encodeURIComponent(a)+"="+encodeURIComponent(c)});return b.join("&")},modify:function(c){c=g.extend({url:f.location.href,query:null,hash:f.location.hash,protocol:f.location.protocol},
c);var b=[c.url.split("?")[0].split("#")[0]],a;"string"===typeof c.query&&(c.query=d.parseQuery(c.query));(a=d.serializeQuery(g.extend(d.parseQuery(c.url),c.query)))&&0<a.length&&(b[b.length]="?"+a);c.hash&&0<c.hash.length&&(b[b.length]=(0!==c.hash.indexOf("#")?"#":"")+c.hash);return b.join("")},hashData:function(c,b){var a=!1,l="";g.isPlainObject(b)?(a=b.overrideCurrent,l=b.prefix||""):a=b;if(l){var e={},t;for(t in c)e[l+t]=c[t];c=e}if("undefined"===typeof c){c={};var a=f.location.href.split("#"),
q="";2<a.length&&(g.each(a,function(a,b){0<a&&(1<a&&(q+="#"),q+=b)}),a=[a[0],q]);2===a.length&&(c=d.parseQuery(a[1]));return c}a||(c=g.extend(d.hashData(),c));f.location.href=f.location.href.split("#")[0]+"#"+d.serializeQuery(c)},encode:function(c){return encodeURIComponent(c)},decode:function(c){return decodeURIComponent(c)},encodePathComponent:function(c){return n(c,/([^A-Za-z0-9 \.]+|\.| )/g,"+","-","_")},decodePathComponent:function(c){return e(c,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|\-|\+)/ig,
"+","-")},encodeFileComponent:function(c){return n(c,/([^A-Za-z0-9 \.]+|\.| )/g,"-",".","_")},decodeFileComponent:function(c){return e(c,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|_|\-)/ig,"-",".")},navigateTo:function(c){var b=g("base");if(0<b.length){m||(m=g("<a></a>").css({position:"absolute",left:"-1000px"}),g("body").append(m));var a=m.attr({href:c})[0];try{f.document.createEvent?a.dispatchEvent(function(a){a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);return a}(document.createEvent("MouseEvents"))):
a.dispatchEvent(new MouseEvent("click",{view:f,bubbles:!0,cancelable:!0}))}catch(d){(b=b.attr("target"))?f.open(c,b):f.document.location=c}}else f.document.location=c}};g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});return g.telligent.evolution.url=d},jQuery,window);u("plugins","plugin.dynamicForm plugin.evolutionBookmark plugin.evolutionComposer plugin.evolutionFeature plugin.evolutionHighlight plugin.evolutionInlineTagEditor plugin.evolutionLike plugin.evolutionModerate plugin.evolutionPager plugin.evolutionResize plugin.evolutionStarRating plugin.evolutionTagTextBox plugin.evolutionTheater plugin.evolutionToggleLink plugin.evolutionTransform plugin.evolutionUserFileTextBox plugin.validation plugin.evolutionTextEditor plugin.evolutionScrollSlider plugin.evolutionMasonry plugin.evolutionTip plugin.evolutionTokenTextBox plugin.evolutionVote plugin.evolutionSqueezeText plugin.evolutionCodeEditor plugin.evolutionThreadReplies plugin.evolutionHtmlEditor plugin.evolutionProgressIndicator".split(" "),
function(){return{}});u("plugin.dynamicForm",function(g,f,k){var m=function(b){return g(b).data("dynamicForm")||{}},n=function(b,a){g(b).data("dynamicForm",a)},e=function(b){null!=b&&"function"===typeof b.toISOString&&(b.toString=b.toISOString);return b},d=function(b){return this.each(function(){n(this,g.extend(!0,{},{legacyStateRegistered:!1,fields:{}},m(this),b,{initialized:!0}))})},c={commitState:function(){var b=m(this);null!=b&&g.each(b.fields,function(a,b){b&&(b.v&&b.sid)&&g("#"+b.sid).val(e(b.v()))})},
registerState:function(b,a){var c=this,d=m(c);d.fields||(d.fields={});var f=d.fields[b];null==f&&(f=d.fields[b]={});f.sid=a;f.onchange||(f.onchange=[]);f.onchange.splice(0,0,function(a){g("#"+f.sid).val(a.val)});if(!d.legacyStateRegistered){var q=g(c).closest("form"),h=q[0].onsubmit;q[0].onsubmit=function(){var a=m(c);null!=a&&g.each(a.fields,function(a,b){b&&(b.v&&b.sid)&&g("#"+b.sid).val(e(b.v()))});return h?h():!0};d.legacyStateRegistered=!0}n(c,d)},register:function(b){var a=m(this);a.fields||
(a.fields={});var c=a.fields[b.id];null==c&&(c=a.fields[b.id]={});b.hasValue&&(c.hasValue=b.hasValue);b.val&&(c.v=b.val);n(this,a)},changed:function(b,a){var c=m(this);c&&(c.fields&&c.fields[b]&&c.fields[b].onchange)&&(a=e(a),g.each(c.fields[b].onchange,function(c,d){d({id:b,val:a})}))},onChange:function(b,a){if(!Array.isArray(b)){var c=[];null!=b&&c.push(b);b=c}var d=m(this);d.fields||(d.fields={});g.each(b,function(b,c){var h=d.fields[c];h||(h=d.fields[c]={});h.onchange||(h.onchange=[]);h.onchange.push(a)});
n(this,d)},dataType:function(b){var a=m(this);return a&&a.fields&&a.fields[b]&&a.fields[b].t?a.fields[b].t:null},val:function(b,a){var c=m(this);return c&&c.fields&&c.fields[b]&&c.fields[b].v?e(c.fields[b].v(a)):null},hasValue:function(b){if(!Array.isArray(b)){var a=[];null!=b&&a.push(b);b=a}var c=0,d=m(this);if(!d.fields)return!1;g.each(b,function(a,b){var h=d.fields[b];h&&(h.hasValue&&h.hasValue())&&c++});return c==b.length},hide:function(b,a){if(!Array.isArray(b)){var c=[];null!=b&&c.push(b);b=
c}var d=m(this);if(!d.fields)return!1;g.each(b,function(b,c){var h=d.fields[c];h&&h.uid&&(h.hiddenBy||(h.hiddenBy=[]),0>h.hiddenBy.indexOf(a)&&h.hiddenBy.push(a),g("#"+h.uid).hide())});n(this,d)},show:function(b,a){if(!Array.isArray(b)){var c=[];null!=b&&c.push(b);b=c}var d=m(this);d.fields&&(g.each(b,function(b,c){var h=d.fields[c];if(h&&h.uid){h.hiddenBy||(h.hiddenBy=[]);var l=h.hiddenBy.indexOf(a);0<=l&&h.hiddenBy.splice(l,1);0==h.hiddenBy.length&&g("#"+h.uid).show()}}),n(this,d))},getValues:function(){var b=
m(this),a={};g.each(b.fields,function(b,c){c&&c.v&&(a[b]=e(c.v()))});return a},getValue:function(b){return c.val.apply(this,[b])},getType:function(b){return c.dataType.apply(this,[b])}};g.fn.dynamicForm=function(b){if(b in c)return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)g.error("Method "+b+" does not exist on jQuery.fn.dynamicForm");else return d.apply(this,arguments)};return{}},jQuery,window);u("plugin.evolutionBookmark",function(g,f,k){var m=function(b){b.toggle=
g("<a></a>").attr({href:"#"});b.element.append(b.toggle);b.toggle.evolutionToggleLink({onHtml:g.telligent.evolution.html.encode(n(b,b.settings.deleteBookmarkText)),offHtml:g.telligent.evolution.html.encode(n(b,b.settings.addBookmarkText)),processingHtml:g.telligent.evolution.html.encode(n(b,b.settings.processingText)),changeState:function(a){d(a,b)},onTitle:n(b,b.settings.deleteBookmarkText),offTitle:n(b,b.settings.addBookmarkText),processingTitle:n(b,b.settings.processingText),onCssClass:b.settings.deleteBookmarkCssClass,
offCssClass:b.settings.addBookmarkCssClass,processingCssClass:b.settings.processingCssClass,val:b.settings.initialState})},n=function(b,a){return a.replace(/\{content_type_name\}/gi,b.settings.contentTypeName)},e=function(b,a){g.telligent.evolution.messaging.publish("ui.bookmark",{contentId:b.settings.contentId,contentTypeId:b.settings.contentTypeId,typeId:b.settings.typeId,bookmarked:a},{crossWindow:!0})},d=function(b,a){if(b)a.settings.onBookmark(a.settings.contentId,a.settings.contentTypeId,a.settings.typeId,
function(){e(a,!0)});else a.settings.onUnbookmark(a.settings.contentId,a.settings.contentTypeId,a.settings.typeId,function(){e(a,!1)})},c=function(b){g.telligent.evolution.messaging.subscribe("ui.bookmark",function(a){a.contentId===b.settings.contentId&&a.contentTypeId===b.settings.contentTypeId&&a.typeId===b.settings.typeId&&b.toggle&&b.toggle.evolutionToggleLink("val",a.bookmarked)})};g.fn.evolutionBookmark=function(b){var a=g.extend({},g.fn.evolutionBookmark.defaults,b||{});return this.each(function(){var b=
{element:g(this),toggle:null,settings:a};m(b);c(b)})};g.fn.evolutionBookmark.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,contentTypeName:"",onBookmark:function(b,a,c,d){},onUnbookmark:function(b,a,c,d){},deleteBookmarkText:"Unbookmark {content_type_name}",addBookmarkText:"Bookmark this {content_type_name}",processingText:"...",addBookmarkCssClass:"internal-link favorite-off",deleteBookmarkCssClass:"internal-link favorite-on",processingCssClass:"internal-link processing"};return{}},
jQuery,window);u("plugin.evolutionCodeEditor",["lib.util"],function(g,f,k,m){function n(a){if(!a)return a;var b=a.split("/");return 2>=b.length?b:"ace.js"!=b.pop()?a:b.join("/")}function e(a){if(!a)return a;a=a.replace(/\/snippets\//gi,"-snippets/");var b=a.split("/");if(2>=b.length)return a;f.each(y,function(a,c){b[b.length-1]=b[b.length-1].replace(a,c)});return b.join("/")}function d(a){return f.ajax({url:a,dataType:"script",cache:!0}).then(function(){ace.config.set("basePath",n(a));var b=ace.config.moduleUrl;
ace.config.moduleUrl=function(a,c){return e(b.apply(this,arguments))}})}function c(a){a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),right:a.wrapper.css("right")};if(!a.expanded){a.wrapper.addClass("maximized");a.expanded=!0;f("body").css({overflow:"hidden"});a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),
position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),right:a.wrapper.css("right")};var b={width:"100%",height:"100%",position:"fixed",zIndex:2E4,left:0,top:0,bottom:0,right:0};a.wrapper.css(b);var c=a.wrapper.get(0);c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
a.originalDimensions={maxLines:a.editor.renderer.$maxLines,minLines:a.editor.renderer.$minLines,desiredHeight:a.editor.renderer.$desiredHeight};delete a.editor.renderer.$maxLines;delete a.editor.renderer.$minLines;delete a.editor.renderer.desiredHeight;a.wrapper.find(".ace_editor, .ace_content").css({width:"100%",height:"100%"});a.editor.resize();a.diffing&&(a.originalDiffContainerStyling={left:a.diffContainer.css("left"),top:a.diffContainer.css("top"),width:a.diffContainer.css("width"),height:a.diffContainer.css("height"),
position:a.diffContainer.css("position")},a.diffContainer.css(b),a=a.differ.getEditors(),delete a.left.renderer.$maxLines,delete a.left.renderer.$minLines,delete a.left.renderer.desiredHeight,delete a.right.renderer.$maxLines,delete a.right.renderer.$minLines,delete a.right.renderer.desiredHeight,a.left.resize(),a.right.resize())}}function c(a){if(!a.expanded){a.wrapper.addClass("maximized");a.expanded=!0;f("body").css({overflow:"hidden"});a.originalStyling={width:a.wrapper.css("width"),height:a.wrapper.css("height"),
position:a.wrapper.css("position"),zIndex:a.wrapper.css("zIndex"),left:a.wrapper.css("left"),top:a.wrapper.css("top"),bottom:a.wrapper.css("bottom"),right:a.wrapper.css("right")};var b={width:"100%",height:"100%",position:"fixed",zIndex:2E4,left:0,top:0,bottom:0,right:0};a.wrapper.css(b);if(a.supportsTrueFullScreen){var c=a.wrapper.get(0);c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&
c.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}a.originalDimensions={maxLines:a.editor.renderer.$maxLines,minLines:a.editor.renderer.$minLines,desiredHeight:a.editor.renderer.$desiredHeight};delete a.editor.renderer.$maxLines;delete a.editor.renderer.$minLines;delete a.editor.renderer.desiredHeight;a.wrapper.find(".ace_editor, .ace_content").css({width:"100%",height:"100%"});a.editor.resize();a.diffing&&(a.originalDiffContainerStyling={left:a.diffContainer.css("left"),top:a.diffContainer.css("top"),
width:a.diffContainer.css("width"),height:a.diffContainer.css("height"),position:a.diffContainer.css("position")},a.diffContainer.css(b),a=a.differ.getEditors(),delete a.left.renderer.$maxLines,delete a.left.renderer.$minLines,delete a.left.renderer.desiredHeight,delete a.right.renderer.$maxLines,delete a.right.renderer.$minLines,delete a.right.renderer.desiredHeight,a.left.resize(),a.right.resize())}}function b(a){if(a.expanded&&(a.originalStyling&&a.originalDimensions)&&(a.supportsTrueFullScreen&&
(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),a.wrapper.removeClass("maximized"),a.expanded=!1,f("body").css({overflow:"auto"}),a.wrapper.css(a.originalStyling),a.editor.renderer.$maxLines=a.originalDimensions.maxLines,a.editor.renderer.$minLines=a.originalDimensions.minlines,a.editor.renderer.desiredHeight=a.originalDimensions.desiredHeight,
a.editor.resize(),a.diffing)){a.diffContainer.css(f.extend(a.originalDiffContainerStyling,{position:"absolute",top:0,left:0,zIndex:7}));var b=a.differ.getEditors();b.left.renderer.$maxLines=a.originalDimensions.maxLines;b.left.renderer.$minLines=a.originalDimensions.minlines;b.left.renderer.desiredHeight=a.originalDimensions.desiredHeight;b.right.renderer.$maxLines=a.originalDimensions.maxLines;b.right.renderer.$minLines=a.originalDimensions.minlines;b.right.renderer.desiredHeight=a.originalDimensions.desiredHeight;
b.left.resize();b.right.resize()}}function a(a){a.expanded=!1;a.fullScreenToggle.on("click",function(d){d.preventDefault();a.expanded?b(a):c(a);return!1})}function l(a,b){clearTimeout(a.setLineNumberTimeout);a.setLineNumberTimeout=setTimeout(function(){a.editor.resize(!0);a.editor.gotoLine(b,0,!0);a.editor.scrollToLine(b,!0,!0,function(){});a.diffing&&!diffSourced&&(a.differ.getEditors().right.resize(!0),a.differ.getEditors().right.gotoLine(b,0,!0),a.differ.getEditors().right.scrollToLine(b,!0,!0,
function(){}))},50)}function p(a){return a?a.replace(/\r\n/g,"\n").replace(/^((?:\s*\n)*)/,"").replace(/((?:\n\s*)*)$/,""):a}function t(a,b,c){c||(a.suppressChangeEvent=!0,k.clearTimeout(a.suppressChangeTimeout),a.suppressChangeTimeout=k.setTimeout(function(){a.suppressChangeEvent=!1},100));a.editor.setValue(p(b),-1);a.isTextArea&&a.sourceElement.val(b);a.diffing&&!c&&a.differ.getEditors().right.setValue(p(b),-1)}function q(a){a.suppressChangeEvent||(a.sourceElement.trigger("evolutionCodeEditorChange"),
a.isTextArea&&a.sourceElement.val(a.editor.getValue()).change())}function h(a){a.completerAdded&&(w=a,ace.config.loadModule("ace/ext/language_tools",function(b){w===a&&(b.setCompleters([b.snippetCompleter,b.textCompleter]),a.completerAdded=!1)}))}function v(a){a.autoComplete&&(w=a,ace.config.loadModule("ace/ext/language_tools",function(b){if(w===a){var c={enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0};if(a.differ){var d=a.differ.getEditors();d&&d.right&&d.right.setOptions(c)}a.editor&&
a.editor.setOptions(c);a.autoComplete&&(b.setCompleters([b.snippetCompleter,b.textCompleter]),b.addCompleter({identifierRegexps:[/[a-zA-Z_0-9#\.\$\-\u00A2-\uFFFF]/],getCompletions:function(b,c,d,h,l){a.autoComplete({editor:b,session:c,pos:d,prefix:h}).then(function(a){l(null,a.results)})},getDocTooltip:function(a){a.doc&&!a.docHTML&&(a.docHTML=a.doc)}}),a.completerAdded=!0)}}))}function s(a){if(A[a])return A[a];var b=a;a=(a||"").toLowerCase();a=a.replace(/[+-]/ig," ");a=a.replace(/ctrl/ig,"control");
a=a.replace(/(opt|alt)/ig,"option");a=a.replace(/shft/ig,"shift");a=a.replace(/(cmd|meta)/ig,"command");a=f.trim(a.split(" ").sort().join(" "));return A[b]=a}var w=null,r=!1,x=!1,y={_:"_5F00_","-":"_2D00_"},z={light:"clouds",dark:"fusion"},A={},B={init:function(c){var e=f.extend({},f.fn.evolutionCodeEditor.defaults,c||{});!1===r&&(r=d(e.editorUrl));e.baseUrl=n(e.editorUrl);return this.each(function(){var c=f(this).data("_code_editor_context"),d=!1;c||(d=!0,c={},f(this).data("_code_editor_context",
c));f.extend(c,e);c.sourceElement=f(this).hide();c.supportsTrueFullScreen=(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled)&&(this.requestFullscreen||this.msRequestFullscreen||this.mozRequestFullScreen||this.webkitRequestFullscreen);var g;if(g=!c.supportsTrueFullScreen)try{g=k.self!==k.top}catch(w){g=!0}g&&(c.enableFullScreen=!1);f(document).on("mozfullscreenchange webkitfullscreenchange fullscreenchange MSFullscreenChange",function(){document.fullscreenElement||
(document.webkitFullscreenElement||document.mozFullScreenElement)||b(c)});r.then(function(){var b=c.theme||"light";z[b]!==m&&(c.theme=z[b]);c.editorOptions={mode:0===(c.mode||"text").indexOf("ace/mode/")?c.mode||"text":"ace/mode/"+(c.mode||"text"),theme:0===(c.theme||"light").indexOf("ace/theme/")?c.theme||"light":"ace/theme/"+(c.theme||"light"),showGutter:c.gutter===m?!0:c.gutter,showPrintMargin:!1,wrap:c.wordWrap};b=0<(c.sourceElement.attr("style")||"").length;c.isTextArea=c.sourceElement.is("textarea");
c.readOnly===m&&(c.readOnly=!c.isTextArea);c.minLines===m||b||(c.editorOptions.minLines=c.minLines);c.maxLines&&!b?(c.editorOptions.maxLines=c.maxLines,c.editorOptions.autoScrollEditorIntoView=!0):(delete c.editorOptions.maxLines,delete c.editorOptions.autoScrollEditorIntoView);c.readOnly?f.extend(c.editorOptions,{readOnly:!0,highlightGutterLine:!1,highlightActiveLine:!1}):f.extend(c.editorOptions,{readOnly:!1,highlightGutterLine:!0,highlightActiveLine:!0});d&&(b=f.grep((c.sourceElement.attr("class")||
"").split(" "),function(a){return 0!==a.indexOf("ui-")}).join(" "),c.wrapper=f("<div></div>").hide().addClass("evolution-code-editor").addClass(b).attr("style",c.sourceElement.attr("style")).insertBefore(c.sourceElement),c.enableFullScreen&&(c.fullScreenToggle=f('<a href="#" class="fullscreen">Fullscreen</a>'),c.fullScreenToggle.appendTo(c.wrapper),a(c)),c.innerElement=f("<div></div>").appendTo(c.wrapper).css({width:"100%",height:"100%"}).show(),c.isTextArea?c.innerElement.text(p(c.sourceElement.val())):
c.innerElement.text(p(c.sourceElement.text())),c.editor=ace.edit(c.innerElement.get(0)),c.wrapper.show(),c.editor.on("change",function(a){q(c)}),c.editor.on("focus",function(a){v(c)}),c.editor.on("blur",function(a){h(c)}),f.each({right:"gotoright",left:"gotoleft",up:"golineup",down:"golinedown"},function(a,b){var d=c.editor.commands.commands[b];c.editor.commands.removeCommand(d);var h=d.exec;c[a]&&(d.exec=function(){c[a].apply(this,c.sourceElement)&&h.apply(this,arguments)});c.editor.commands.addCommand(d)}),
f.each(e.commandOverrides,function(a,b){c.editor.commands.on("exec",function(c){c.command&&(c.command.bindKey&&(s(c.command.bindKey.mac)==s(a)||s(c.command.bindKey.win)==s(a)))&&(b()||c.preventDefault())})}));b=f.grep(c.wrapper.attr("class").split(" "),function(a){return 0!==a.indexOf("theme-")}).join(" ");c.wrapper.attr("class",b);c.wrapper.addClass("theme-"+c.theme);c.editor.setOptions(c.editorOptions);if(d&&!c.editorOptions.maxLines){var g=!c.wrapper.is(":visible"),k;g&&(k=c.wrapper.parentsUntil(":visible").last(),
k.show());b=c.wrapper.height();g&&k.hide();32>b&&(c.editorOptions.minLines=c.minLines||1,c.editorOptions.maxLines=c.maxLines||20,c.editor.setOptions(c.editorOptions))}c.sourceComparison!==m&&null!==c.sourceComparison?(c.sourceComparison=p(c.sourceComparison),c.diffing=!0,!1===x&&(k=e.editorUrl.replace(/ace.js$/,"acediff.js"),b=e.editorUrl.replace(/ace.js$/,"diffmatchpatch.js"),x=f.when.apply(f,[f.ajax({url:k,dataType:"script",cache:!0}),f.ajax({url:b,dataType:"script",cache:!0})])),x.then(function(){if(c.differ)h=
c.differ.getEditors(),h.left.setValue(p(c.sourceComparison),-1),h.right.setOptions(c.editorOptions),h.left.setOptions(c.editorOptions),h.left.setReadOnly(!0),h.right.setReadOnly(c.readOnly);else{c.wrapper.css({position:"relative"});var a="left"+Math.floor(1E8*Math.random()),b="left"+Math.floor(1E8*Math.random()),d="left"+Math.floor(1E8*Math.random());c.diffContainer=f('<div class="acediff-container"><div><div id="'+a+'" class="acediff-left-editor"></div></div><div id="'+b+'" class="acediff-gutter"></div><div><div id="'+
d+'" class="acediff-right-editor"></div></div></div>');c.diffContainer.css({position:"absolute",top:0,left:0,width:c.wrapper.width(),height:c.wrapper.height(),zIndex:6});c.diffContainer.appendTo(c.wrapper);c.differ=new AceDiff({mode:c.editorOptions.mode,theme:c.editorOptions.theme||"light",left:{id:a,content:p(c.sourceComparison),editable:!1,copyLinkEnabled:c.readOnly?!1:!0},right:{id:d,content:p(c.editor.getValue()),copyLinkEnabled:!1,editable:c.readOnly?!1:!0},classes:{gutterID:b}});var h=c.differ.getEditors();
h.right.on("change",function(a){a=h.right.getValue();t(c,a,!0);q(c)})}})):c.diffing?(c.diffing=!1,k=c.differ.getEditors(),b=k.right.getValue(),k.left.destroy(),k.right.destroy(),c.differ.destroy(),c.diffContainer.remove(),c.suppressChangeEvent=!0,c.editor.setValue(p(b),-1),c.suppressChangeEvent=!1,delete c.differ,delete c.diffContainer):c.diffing=!1;c.line&&l(c,c.line);c.sourceElement.trigger("evolutionCodeEditorReady")})})},focus:function(a){var b=f(this).data("_code_editor_context");return b?(a!==
m&&(!0===a?b.editor.focus():b.editor.blur()),b.diffing?b.differ.getEditors().right.isFocused():b.editor.isFocused()):!1},val:function(a){var b=f(this).data("_code_editor_context");return b?a!==m?(t(b,a||""),a):b.editor.getValue():""},scrollTop:function(a){var b=f(this).data("_code_editor_context");return b?a!==m?(b.editor.session.setScrollTop(a),b.diffing&&!diffSourced&&b.differ.getEditors().right.session.setScrollTop(a),a):b&&b.editor&&b.editor.session?b.editor.session.getScrollTop():0:0},wordWrap:function(a){var b=
f(this).data("_code_editor_context");return b?a!==m?(b.editor.setOption("wrap",a),a):b.editor.getOption("wrap"):!1},line:function(a){var b=f(this).data("_code_editor_context");return b?a!==m?(l(b,a||""),a||1):(b.editor.getSelectionRange().start.row||0)+1:1},autoComplete:function(a){var b=f(this).data("_code_editor_context");b&&(b.autoComplete=a,v(b))},fullscreen:function(a){var d=f(this).data("_code_editor_context");if(d)return a!==m?(a?c(d):b(d),a):d.expanded},selectedText:function(){var a=f(this).data("_code_editor_context");
return a?a.editor.getSelectedText():""},__resize:function(){var a=f(this).data("_code_editor_context");a&&(a.diffing?(a.differ.getEditors().right.resize(),a.differ.getEditors().left.resize()):a.editor.resize())}};f.fn.evolutionCodeEditor=function(a){if(B[a])return B[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.evolutionCodeEditor");else return B.init.apply(this,arguments)};f.fn.evolutionCodeEditor.defaults={editorUrl:"",
mode:m,theme:m,minLines:m,maxLines:m,readOnly:m,gutter:m,wordWrap:!1,enableFullScreen:!0,sourceComparison:m,autoComplete:m,commandOverrides:{}};return{}},jQuery,window);u("plugin.evolutionComposer",["events.textinput","module.html"],function(g,f,k,m,n){var e=function(a,b){a=k(a);var c=a.data("__COMPOSER_CONTEXT");!c&&b&&(c=d(a,b),a.data("__COMPOSER_CONTEXT",c));return c},d=function(a,d){var h=k.extend({},k.fn.evolutionComposer.defaults,d||{}),h={input:a,settings:h,plugins:k.map(h.plugins,function(a){return"string"==
typeof a?k.fn.evolutionComposer.plugins[a]:a}),ranges:[],activePlugin:!1};h.pluginContext=c(h);h.input.evolutionHighlight();b(h);return h},c=function(a){return{settings:a.settings,input:a.input,data:function(b,c){return"undefined"!==typeof c?a.input.data(b,c):a.input.data(b)},val:function(b){return"undefined"!==typeof b?a.input.val(b):a.input.val()},release:function(){a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext);a.activePlugin=!1},caretPosition:function(){return h(a.input)},
currentWord:function(b){b=k.extend({allowedWhiteSpaceBeforeCaret:0,allowedWhiteSpaceAfterCaret:0},b||{});var c=b.caretPosition||h(a.input),d="",l=k(a.input).val(),e="",f=0,g=c,p=0;if(c<l.length&&"\n"!==l[c]&&"\t"!==l[c]){e=l.substring(c);f=t(e);0>f&&(f=e.indexOf("\n"));0>f&&(f=e.indexOf("\t"));0>f&&(f=e.length);for(p=0;p<b.allowedWhiteSpaceAfterCaret;p++)if(0<f){var v=l.substring(c+f+1);nextWhiteSpaceIndex=t(v);nextWhiteSpaceIndex=-1===nextWhiteSpaceIndex?v.length:nextWhiteSpaceIndex;if(0<nextWhiteSpaceIndex)f+=
nextWhiteSpaceIndex+1;else break}0<f&&(g=0,d+=e.substring(0,f))}if(0<c&&"\n"!==l[c-1]&&"\t"!==l[c-1]){e=l.substring(0,c);f=q(e);for(p=0;p<b.allowedWhiteSpaceBeforeCaret;p++)if(0<f)if(c=q(l.substring(0,f)),c!==f)f=c;else break;f===e.length&&(f=e.lastIndexOf("\n"));f===e.length&&(f=e.lastIndexOf("\t"));f===e.length&&(f=e.length-1);f<e.length-1&&(g=f+1,d=e.substring(g)+d)}if(b.additionalWhiteSpaceSymbols)for(p=0;p<d.length;p++)if(-1==k.inArray(d[p],b.additionalWhiteSpaceSymbols)){d=d.substring(p);g+=
p;break}return{value:d,start:g,stop:g+d.length}},replace:function(b,c,d){var h=a.input.val();a.input.val(h.substring(0,b)+d+h.substring(c))},clearHighlights:function(b){var c=[];k.each(a.ranges,function(a,d){b&&d.className===b||c.push(d)});a.ranges=c;a.input.evolutionHighlight({ranges:a.ranges})},addHighlight:function(b){a.ranges.push(b)},renderHighlights:function(){a.input.evolutionHighlight({ranges:a.ranges})}}},b=function(b){b.input.on({keypress:function(c){a(b,"onkeypress",c)},keydown:function(c){a(b,
"onkeydown",c)},textinput:function(c){l(b,c);a(b,"oninput",c);p(b,!1)}})},a=function(a,b,c){var d=!0;a.activePlugin&&a.activePlugin[b]&&(d=a.activePlugin[b].call(c.target,a.pluginContext,c));d?a[b]&&((d=a[b].call(c.target,c))||c.preventDefault()):c.preventDefault()},l=function(a,b){a.activePlugin||k.each(a.plugins,function(b,c){if(c.shouldActivate&&!0===c.shouldActivate.call(a.input,a.pluginContext))return a.activePlugin=c,c.onActivate&&c.onActivate.call(a.input,a.pluginContext),!1})},p=function(a,
b){k.each(a.plugins,function(c,d){d.onTransform&&d.onTransform.call(a.input,a.pluginContext,b)})},t=function(a){var b=[];k.each([" ","\t","\n"],function(c,d){var h=a.indexOf(d);0<=h&&b.push(h)});b.sort();return 0<b.length?b[0]:-1},q=function(a){var b=[];k.each([" ","\t","\n"],function(c,d){var h=a.lastIndexOf(d);0<=h&&b.push(h)});b.sort();return 0<b.length?b[b.length-1]:-1},h=function(a){a=a.get(0);if(a.selectionStart)return a.selectionStart;if(document.selection){var b=document.selection.createRange();
if(null===b)return 0;a=a.createTextRange();var c=a.duplicate();a.moveToBookmark(b.getBookmark());c.setEndPoint("EndToStart",a);return c.text.length}return 0},v=function(a){if("undefined"!==typeof k.fn.evolutionResize)a.input.evolutionResize().on("evolutionResize",function(){a.input.evolutionHighlight("resize",a.input.width(),a.input.height())})},s={init:function(a){return this.filter("textarea").each(function(){var b=k(this),c=e(b,a);v(c);c.input.evolutionHighlight("resize",c.input.width(),c.input.height());
if(null!==c){k.each(c.plugins,function(a,d){d.init&&d.init.call(b,c.pluginContext)});c.settings.focus&&setTimeout(function(){b.trigger("focus")},10);var d=k.trim(c.input.val());0<d.length&&s.val.call(c.input,d)}})},val:function(a){if("undefined"!==typeof a){var b=e(this);b&&(b.input.val(f.decode(a)),p(b,!0),b.input.trigger("input"))}else{var b=e(this),c="";b&&(c=b.input.val(),k.each(b.plugins,function(a,d){d.val&&(c=d.val.call(b.input,c,b.pluginContext))}));return c}return this},onkeydown:function(a){var b=
e(this);b&&(b.onkeydown=a);return this},oninput:function(a){var b=e(this);b&&(b.oninput=a);return this},resize:function(a,b){var c=e(this);c&&c.input.evolutionHighlight("resize",a,b);return this},release:function(){var a=e(this);a&&a.activePlugin&&(a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext),a.activePlugin=!1);return this}};k.fn.evolutionComposer=function(a){if(s[a])return s[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)k.error("Method "+
a+" does not exist on jQuery.evolutionComposer");else return s.init.apply(this,arguments)};k.fn.evolutionComposer.defaults={plugins:[],focus:!1};k.fn.evolutionComposer.plugins={};return{}},jQuery,window);u("plugin.evolutionFeature",function(g,f,k){var m=function(e,d){return d.replace(/\{content_type_name\}/gi,e.settings.contentTypeName)},n=function(e){g.telligent.evolution.messaging.subscribe("ui-feature",function(d){d.value?e.toggle.empty().append(g.telligent.evolution.html.encode(m(e,e.settings.editFeatureText))):
e.toggle.empty().append(g.telligent.evolution.html.encode(m(e,e.settings.addFeatureText)))})};g.fn.evolutionFeature=function(e){var d=g.extend({},g.fn.evolutionFeature.defaults,e||{});return this.each(function(){var c={element:g(this),toggle:null,settings:d};c.toggle=g("<a></a>").attr({href:c.settings.panelUrl});c.element.append(c.toggle);c.settings.initialState?c.toggle.append(g.telligent.evolution.html.encode(m(c,c.settings.editFeatureText))):c.toggle.append(g.telligent.evolution.html.encode(m(c,
c.settings.addFeatureText)));n(c)})};g.fn.evolutionFeature.defaults={contentId:"",contentTypeId:"",typeId:"",panelUrl:"",initialState:!1,contentTypeName:"",editFeatureText:"Edit featured",addFeatureText:"Feature"};return{}},jQuery,window);u("plugin.evolutionHighlight",function(g,f,k){var m=function(a,b){var c=a.data("_HIGHLIGHTER_CONTEXT");if("undefined"===typeof c||null===c)c={selection:a.filter("textarea"),settings:g.extend({},g.fn.evolutionHighlight.defaults,b||{})},n(c),a.data("_HIGHLIGHTER_CONTEXT",
c);return c},n=function(a){a.wrapper=g("<div></div>");a.mirror=g("<div></div>");var b={position:"relative",width:a.selection.outerWidth(),height:a.selection.outerHeight()};g.each(["margin-left","margin-right","margin-top","margin-bottom"],function(c,d){b[d]=a.selection.css(d);a.selection.css(d,0)});var c={position:"absolute",top:"0px",left:"0px",zIndex:"0",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent",backgroundColor:a.selection.css("backgroundColor"),
color:"transparent",width:a.selection.width(),height:a.selection.height(),overflow:"hidden",whiteSpace:"normal"};g.each(a.settings.styles,function(b,d){c[d]=a.selection.css(d)});var d={position:"absolute",top:"0px",left:"0px",zIndex:"1",backgroundColor:"transparent",width:a.selection.width(),height:a.selection.height()};a.wrapper.css(b).addClass("highlighter");a.mirror.css(c);a.selection.css(d);a.mirror.css("color",a.mirror.css("background-color"));a.selection.before(a.wrapper);a.wrapper.append(a.selection);
a.wrapper.append(a.mirror)},e=/\s\s/gi,d=/\n/gi,c=function(a){var b={};g.each(a.settings.ranges,function(a,c){b[c.start]=b[c.start]||[];b[c.start].push(g.extend({},c,{index:a}));b[c.stop]=b[c.stop]||[];b[c.stop].push(c)});var c=g.telligent.evolution.html.encode(a.selection.val());newValue=[];for(var f=spanDepth=0;f<c.length;f++)"undefined"!==typeof b[f]&&g.each(b[f],function(a,b){b.start===f?(newValue[newValue.length]='<span class="'+b.className+'" style="white-space:normal;" data-index="'+b.index+
'">',spanDepth++):(newValue[newValue.length]="</span>",spanDepth--)}),newValue[newValue.length]=c.charAt(f);0<spanDepth&&(newValue[newValue.length]="</span>");var c=newValue.join("").replace(d,"<br />").replace(e,"&nbsp; "),q=document.createElement("span");q.innerHTML=c;a.mirror.empty().get(0).appendChild(q);a.selection.off("click").on("click",function(b){g("span",a.mirror).each(function(){var c=g(this),d=c.data("index");if(d!==k){var l=c.offset();l.top<=b.pageY&&(l.top+c.height()>=b.pageY&&l.left<=
b.pageX&&l.left+c.width()>=b.pageX)&&a.selection.trigger("evolutionRangeClick",a.settings.ranges[d])}})})},b={init:function(a){var b=m(this,a);b.settings=g.extend({},g.fn.evolutionHighlight.defaults,a||{});c(b);return this},clear:function(){var a=m(this,null);if(null!==a)return a.mirror.html(""),this},resize:function(a,b){var c=m(this,null);if(null!==c){var d={width:a,height:b};c.mirror.css(d);c.selection.css(d);c.wrapper.css({width:c.selection.outerWidth(),height:c.selection.outerHeight()});return this}},
css:function(a){var b=m(this,null);if(null!==b)return b.wrapper.css(a),this}};g.fn.evolutionHighlight=function(a){if(b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)g.error("Method "+a+" does not exist on jQuery.evolutionHighlight");else return b.init.apply(this,arguments)};g.fn.evolutionHighlight.defaults={ranges:[],styles:"border-top-width border-top-style border-bottom-width border-bottom-style border-right-width border-right-width-value border-right-style border-right-style-value border-left-width border-left-width-value border-left-style border-left-style-value font-family font-size font-size-adjust font-stretch font-style font-variant font-weight padding-bottom padding-left padding-right padding-top letter-spacing line-height text-align text-indent word-spacing".split(" ")};
return{}},jQuery,window);u("plugin.evolutionHtmlEditor",["lib.util","lib.storageProxy","lib.lruCache","module.notifications"],function(g,f,k,m,n,e,d){function c(a){var b=[];b.push(a.contentTypeId||"");b.push(a.submittable?"1":"0");b.push(a._tokens&&0<a._tokens.length?"1":"0");b.push(a._enableLegacyTokens?"1":"0");b.push(a.autoResize?"1":"0");b.push(!0===a.enableFileUpload?"1":!1===a.enableFileUpload?"0":"");return b.join("|")}function b(a){if(!a.contentTypeId)return null;null==y&&((a=n.telligent.evolution.url.parseQuery(e.location.href+
""))&&a._pcurl?y=a._pcurl:(y=e.location.href+"",a=y.indexOf("?"),0<=a&&(y=y.substr(0,a)),a=n.telligent.evolution.site.getBaseUrl(!0),0==y.indexOf(a)&&(y="~/"+y.substr(a.length))));return y}function a(a){return n.Deferred(function(h){var l=c(a),e=x[l];if(e!==d)h.resolve(e);else{var f={ContentTypeId:a.contentTypeId||"",Submittable:a.submittable?"1":"0",HasTokens:a._tokens&&0<a._tokens.length?"1":"0",EnableLegacyTokens:a._enableLegacyTokens?"1":"0",AutoResize:a.autoResize?"1":"0",EnableFileUpload:!0===
a.enableFileUpload?"1":!1===a.enableFileUpload?"0":"",_u:n.telligent.evolution.user.accessing.id},g=b(a);null!=g&&(f._pcurl=g);n.telligent.evolution.get({url:B.scriptBaseUrl+"config.js?_="+B.editorConfigVersionKey,data:f,cache:!0}).then(function(a){a=a.editorConfiguration||{};if(a.protect)for(var b=0;b<a.protect.length;b++)a.protect[b]=RegExp(a.protect[b],"g");e={editorConfiguration:a};x[l]=e;h.resolve(e)})["catch"](function(){h.reject()})}}).promise()}function l(a){var b=new f({id:n.telligent.evolution.user.accessing.id,
isSystemAccount:n.telligent.evolution.user.accessing.isSystemAccount});z=new k({size:5,load:function(){return b.get(r)},persist:function(a){b.set(r,a)}});return n.Deferred(function(a){n.ajax({url:B.scriptBaseUrl+"tinymce.min.js?_="+B.versionKey,dataType:"script",cache:!0}).then(function(){n.ajax({url:B.scriptBaseUrl+"telligent/telligent.tinymce.min.js?_="+B.versionKey,dataType:"script",cache:!0}).then(function(){n.ajax({url:B.scriptBaseUrl+"langs/"+B.language+".js?_="+B.versionKey,dataType:"script",
cache:!0}).then(function(){try{tinymce.EditorManager.baseURL=B.scriptBaseUrl}catch(b){}a.resolve()})["catch"](function(){a.reject()})})["catch"](function(){a.reject()})})["catch"](function(){a.reject()})})}function p(a,b){b&&(e.clearTimeout(a.updateBookmarkHandle),a.updateBookmarkHandle=e.setTimeout(function(){b.selection&&(b._currentBookmark=b.selection.getBookmark(2))},100))}function t(a,b){try{n(document).on("beforecustomizepage",function(){b&&b.remove()})}catch(c){}var d=n(a.elm);b.on("change SetContent NodeChange keyup",
function(){p(a,b);e.clearTimeout(a.changedHandle);a.changedHandle=e.setTimeout(function(){try{var c=b.getContent();c!=a.lastSourceValue&&(a.lastSourceValue=c,d.val(c).trigger("change"),q(a,b,c))}catch(h){}},1E3)});a.onErrorHandler=function(){q(a,b)};m.on("error",a.onErrorHandler);a.lastSourceValue=d.val();a.sourceChangeHandle=e.setInterval(function(){var c=d.val();c!=a.lastSourceValue&&(a.lastSourceValue=c,b.setContent(a.lastSourceValue))},1E3);b.on("Remove",function(){e.clearInterval(a.sourceChangeHandle);
m.off("error",a.onErrorHandler)});b.on("blur",function(){b.save()});b.on("Init",function(c){if(!w){c=n("head link").filter(function(a,b){var c=n(b).prop("href");return c&&0<=c.indexOf("/tinymce/")});var d=n('head style[id="ace_editor.css"]');0<d.length&&c.insertBefore(d);c.filter(":last").after('<link rel="stylesheet" type="text/css" href="'+B.scriptBaseUrl+"telligent/telligent.tinymce.ui.css?_="+B.versionKey+'" />');w=!0}h(a,b);a.initialized=!0;n(a.elm).trigger({type:"evolutionHtmlEditorReady"})});
b.on("keydown",function(b){return a.elm.dispatchEvent(new KeyboardEvent(b.type,{altKey:b.altKey,"char":b["char"],charCode:b.charCode,code:b.code,ctrlKey:b.ctrlKey,isComposing:b.isComposing,key:b.key,keyCode:b.keyCode,keyIdentifier:b.keyIdentifier,keyLocation:b.keyLocation,locale:b.locale,location:b.location,metaKey:b.metaKey,repeat:b.repeat,shiftKey:b.shiftKey,which:b.which}))},!0);b.on("LoadContent",function(){b._oldContentValue=b.getContent();"<p>&nbsp;</p>"==b._oldContentValue&&(b._oldContentValue=
"");try{b.getWin().document.addEventListener("keydown",function(){b.getWin().focus()})}catch(a){}})}function q(a,b,c,h){var l,e;a=a.contextid;if(A){try{for(e=localStorage.length-1;0<e;e--)l=localStorage.key(e),0==l.indexOf("TinyAutoSave")&&localStorage.removeItem(l)}catch(f){}A=!1}try{if(a){if(null===c||c===d)c=b.getContent()||"";if(h||0<c.replace(/\s|&nbsp;|<\/?p[^>]*>|<br[^>]*>/gi,"").length)0<c.length&&131072>c.length?z.set(a,c):z.del(a)}}catch(g){}}function h(a,b){try{var c=a.contextid;if(c){var d=
z.get(c);d&&0==b.getContent().replace(/\s|&nbsp;|<\/?p[^>]*>|<br[^>]*>/gi,"").length&&b.setContent(d)}}catch(h){}}function v(a){return a?(a.getContent()||"").replace(/(?:^\W*<p[^>]*>(?:&nbsp;)?<\/p>|<p[^>]*>(?:&nbsp;)?<\/p>\W*$)/gi,""):""}var s=!1,w=!1,r="evolutionHtmlEditor-UnsavedContent",x={},y=null,z=null,A=!0,B={scriptBaseUrl:"/tinymce/",versionKey:"",contextQueryString:"",mediaMaxWidth:320,mediaMaxHeight:240,defaultMediaWidth:0,defaultMediaHeight:0,directionality:"ltr",language:"en",contentCssUrl:"/tinymce/telligent/telligent.tinymce.content.css",
directUploadContext:"",directUploadUrl:"",autoLinkPattern:null,editorConfigVersionKey:""},C={init:function(b){var c=n.extend({},n.fn.evolutionHtmlEditor.defaults,b||{});!1===s&&(s=l(this.get(0)));var h=e.location+"";try{e.parent&&(e.parent.$&&e.parent.$.fn.glowModal)&&(h=e.parent.location+"")}catch(f){}return this.each(function(){var b=n.extend({},c);b.elm=this;b.initialized=!1;b.elm.id!==d&&0!=b.elm.id.length&&(b.id=b.elm.id,b.contextid=e.location+"#"+b.id,n(b.elm).data("_html_editor_context",b),
s.then(function(){a(b).then(function(a){var c=tinymce.EditorManager.get(b.id);if(c)try{tinymce.EditorManager.remove(c)}catch(d){}c={selector:"#"+b.id,relative_urls:!1,setup:function(a){t(b,a)},evolution_contenttypeid:b.contentTypeId,theme:"modern",skin:"telligent",resize:"true",object_resizing:"table,img,.mceInsertMediaItem",language:B.language,document_base_url:h,images_dataimg_filter:function(){return!1},anchor_bottom:!1,anchor_top:!1,content_css:B.contentCssUrl,directionality:B.directionality,
toc_class:"table-of-contents",evolution_mediaMaxWidth:B.mediaMaxWidth,evolution_mediaMaxHeight:B.mediaMaxHeight,evolution_defaultMediaWidth:B.defaultMediaWidth,evolution_defaultMediaHeight:B.defaultMediaHeight,evolution_customtokens:b._tokens||[0],evolution_contextQueryString:B.contextQueryString,evolution_directUploadContext:B.directUploadContext,evolution_directUploadUrl:B.directUploadUrl,enhancements_placeholder:b.placeholder,submittable_prehtml:b.beforeSubmitHtml,submittable_posthtml:b.afterSubmitHtml,
submit_enabletoggle:b.enableEnterToSubmitToggle,submit_entermessage:b.enterToSubmitPrompt,submit_buttontext:b.submitLabel,submit_onsubmit:function(a){a=v(a);if(b.onSubmit)b.onSubmit(a);n(b.elm).trigger({type:"evolutionHtmlEditorSubmit",html:a})},submit_entertosubmit:b.submittable,autoLinkPattern:B.autoLinkPattern};a.editorConfiguration&&n.extend(c,a.editorConfiguration);a=-1<b.height.indexOf("px")?parseInt(b.height,10):NaN;b.autoResize?(c.autoresize_bottom_margin=1,c.autoresize_overflow_padding=0,
isNaN(a)||(c.autoresize_min_height=a,c.height=a+25,c.min_height=a)):isNaN(a)||(c.height=a,c.min_height=a);tinymce.EditorManager.init(c)})}))})},focus:function(){var a=n(this).data("_html_editor_context");if(a)try{tinyMCE.get(a.id).plugins.enhancements.focusAndView()}catch(b){}return this},val:function(a){if(a===d){var b=n(this).data("_html_editor_context");if(b)try{var c=tinyMCE.get(b.id),h=v(c);q(b,c,"",!0);return h}catch(l){}return""}return this.each(function(){var b=n(this).data("_html_editor_context");
if(b)try{var c=tinyMCE.get(b.id);c.execCommand("mceSetContent",!1,a);q(b,c,null,!0)}catch(d){}})},saveCursorPosition:function(){return this.each(function(){var a=n(this).data("_html_editor_context");if(a)try{p(a,tinyMCE.get(a.id))}catch(b){}})},insert:function(a){return this.each(function(){var b=n(this).data("_html_editor_context");if(b)try{var c=tinyMCE.get(b.id);if(c){if(c&&c._currentBookmark)try{c.selection.moveToBookmark(c._currentBookmark)}catch(d){}c.execCommand("mceInsertContent",!1,a);q(b,
c,null,!0)}}catch(h){}})},moveTo:function(a){return this.each(function(){var b=n(this).data("_html_editor_context");if(b)try{var c=tinyMCE.get(b.id);c&&c.plugins.enhancements.moveTo(a)}catch(d){}})},ready:function(a){var b=n(this),c=b.data("_html_editor_context");return 0<b.length?(a&&(b.on("evolutionHtmlEditorReady",a),c&&c.initialized&&a()),c&&c.initialized):!1},context:function(a){if(a===d){var b=n(this).data("_html_editor_context");if(b)try{return b.contextid}catch(c){}return""}return this.each(function(){var b=
n(this).data("_html_editor_context");if(b)try{var c=a;c&&0!=c.length||(c=e.location+"#"+b.id);if(b.contextid!=c){var d=null;try{d=tinyMCE.get(b.id)}catch(l){d=null}if(d){b.contextid=null;try{d.execCommand("mceSetContent",!1,"")}catch(f){}b.contextid=c;h(b,d)}else b.contextid=c}}catch(g){}})}};n.fn.evolutionHtmlEditor=function(a){if(C[a])return C[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)n.error("Method "+a+" does not exist on jQuery.evolutionHtmlEditor");else return C.init.apply(this,
arguments)};n.fn.evolutionHtmlEditor.defaults={width:"100%",height:"300px",contentTypeId:null,enterToSubmitPrompt:null,submitLabel:null,beforeSubmitHtml:null,afterSubmitHtml:null,autoResize:!1,enableEnterToSubmitToggle:!1,placeholder:null,submittable:!1,enableFileUpload:null,_tokens:{},_enableLegacyTokens:!1};return{configure:function(a){n.extend(B,a)}}},jQuery,window);u("plugin.evolutionInlineTagEditor",function(g,f,k){var m={},n=function(c,b){if(c.internal.isInitialized){for(var a=b.split(/[,;]/g),
d=[],e=0;e<a.length;e++){var f=g.trim(a[e]);f&&(d[d.length]=f)}c.settings.onSave(d,function(){c.settings.currentTags=d})}},e=function(c){return this.each(function(){var b={settings:g.extend({},g.fn.evolutionInlineTagEditor.defaults,c||{}),internal:{state:g(this)}};g(this).data("evolutionTagInlineEditor_context",b);g(this).html()||g(this).text(b.settings.editButtonText);d(b)})},d=function(c){var b=g("<div></div>").addClass(c.settings.editorCssClass).attr("style","display: none;"),a=g('<label for="tag-area"></label>').hide(),
d=g('<textarea id="tag-area"></textarea>').attr("cols","40").attr("rows","2");if(c.settings.allTags&&0<c.settings.allTags.length)var e=g('<input type="button" />').val(c.settings.selectTagsText);var f=g('<input type="button" />').val(c.settings.saveTagsText),q=g('<input type="button" />').val(c.settings.cancelText),h=g('<div style="white-space: nowrap; padding-top: 4px;"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><td align="left"></td><td align="right"></td></tr></tbody></table></div>');
h.find("td").eq(1).append(f);h.find("td").eq(1).append(q);e&&h.find("td").first().append(e);b.append(a);b.append(d);b.append(h);d.evolutionTagTextBox({allTags:c.settings.allTags});b.glowPopUpPanel({cssClass:c.settings.editorCssClass,position:"updown",zIndex:500,hideOnDocumentClick:!1});g(c.internal.state).on("click.evolutionInlineTagEditor",function(a){b.glowPopUpPanel("hide").glowPopUpPanel("show",g(this));d.val(0<c.settings.currentTags.length?c.settings.currentTags.join(", "):"");return!1});f.on("click.evolutionInlineTagEditor",
function(a){n(c,d.attr("value"));b.glowPopUpPanel("hide");return!1});q.on("click.evolutionInlineTagEditor",function(a){b.glowPopUpPanel("hide");return!1});if(e)e.on("click.evolutionInlineTagEditor",function(a){d.evolutionTagTextBox("openTagSelector");return!1});c.internal.state.after(b);c.internal.isInitialized=!0};g.fn.evolutionInlineTagEditor=function(c){if(c in m)return m[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)g.error("Method "+c+" does not exist on jQuery.fn.evolutionInlineTagEditor");
else return e.apply(this,arguments)};g.extend(g.fn.evolutionInlineTagEditor,{defaults:{allTags:[""],currentTags:[""],editorCssClass:"tags-editor",editButtonText:"Edit",selectTagsText:"Select Tags",saveTagsText:"Save",cancelText:"Cancel",onSave:function(c,b){}}});return{}},jQuery,window);u("plugin.evolutionLike",function(g,f,k){var m=!1,n=!1,e=function(a){var c=a.settings.format;a.hasCount&&(c=c.replace(/\{count\}/gi,'<span class="like-count who-likes"></span>'));a.hasToggle&&(c=c.replace(/\{toggle\}/gi,
'<span class="like-toggle"><a href="#" class="internal-link"></a></span>'));a.hasMessage&&(c=c.replace(/\{message\}/gi,'<span class="like-message"></span>'));a.element.html(c);a.hasCount&&(a.countWrapper=a.element.find("span.like-count"),a.countWrapper.html(a.settings.initialCount),a.countWrapper.attr("data-count",a.settings.initialCount));a.hasToggle&&(a.toggleLink=a.element.find("span.like-toggle a"),a.toggleLink.evolutionToggleLink({onHtml:a.settings.unlikeText,offHtml:a.settings.likeText,onTitle:"",
offTitle:"",processingHtml:"...",changeState:function(c){b(c,a)},onCssClass:"internal-link like-on",offCssClass:"internal-link like-off",processingCssClass:"internal-link processing",val:"true"===a.settings.initialState}));a.hasMessage&&(a.messageWrapper=a.element.find("span.like-message"),a.messageWrapper.html(a.settings.initialMessage))},d=function(a,b){var c="";if(0<b.count){var d=0;b.accessingLikes?1===b.count?c=a.settings.whoLikesAccessingText:2===b.count?(c=a.settings.whoLikesAccessingTwoText,
d=-1):2<b.count&&(c=a.settings.whoLikesAccessingMultipleText,d=-1):1===b.count?c=a.settings.whoLikesOtherText:2===b.count?(d=-1,c=a.settings.whoLikesOtherTwoText):2<b.count&&(d=-1,c=a.settings.whoLikesOtherMultipleText);c=c.replace(/\{count\}/gi,b.count+d);c=c.replace(/\{user_profile_url\}/gi,b.latestUserProfileUrl);c=c.replace(/\{user_display_name\}/gi,b.latestUserDisplayName)}return c},c=function(a,b,c){var l=d(a,{count:b.count,accessingLikes:c,latestUserProfileUrl:null!=b.latestLike&&null!=b.latestLike.User?
b.latestLike.User.ProfileUrl:null,latestUserDisplayName:null!=b.latestLike&&null!=b.latestLike.User?b.latestLike.User.DisplayName:null});g.telligent.evolution.messaging.publish("ui.like",{contentId:a.settings.contentId,contentTypeId:a.settings.contentTypeId,typeId:a.settings.typeId,count:b.count,liked:c,message:l},{crossWindow:!0})},b=function(a,b){if(a)b.settings.onLike(b.settings.contentId,b.settings.contentTypeId,b.settings.typeId,function(a){c(b,a,!0)});else b.settings.onUnlike(b.settings.contentId,
b.settings.contentTypeId,b.settings.typeId,function(a){c(b,a,!1)})},a=function(a,b){return g.telligent.evolution.get({url:g.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",data:{ContentId:b.contentId,TypeId:b.typeId},cache:!1}).then(function(a){return null!=a.Like})},l=function(a){n||(n=!0,g.telligent.evolution.messaging.subscribe("like.created",function(b){p(a,b,!0)}),g.telligent.evolution.messaging.subscribe("like.deleted",function(b){p(a,b,!1)}))},p=function(b,c,l){a(b,c).then(function(a){a=
d(b,{count:c.total,accessingLikes:a,latestUserProfileUrl:c.latestUser.profileUrl,latestUserDisplayName:c.latestUser.displayName});g.telligent.evolution.messaging.publish("ui.like",{contentId:c.contentId,contentTypeId:c.contentTypeId,typeId:c.typeId,count:c.total,liked:l,message:a})})},t=function(a){g.telligent.evolution.messaging.subscribe("ui.like",function(b){b.contentId===a.settings.contentId&&(b.contentTypeId===a.settings.contentTypeId&&b.typeId===a.settings.typeId)&&(a.hasToggle&&a.toggleLink.evolutionToggleLink("val",
b.liked),a.hasCount&&(a.countWrapper.html(b.count),a.countWrapper.attr("data-count",b.count)),a.hasMessage&&a.messageWrapper.html(b.message))})};g.fn.evolutionLike=function(a){var b=g.extend({},g.fn.evolutionLike.defaults,a||{});return this.each(function(){var a={element:g(this),settings:b,hasCount:0<=b.format.indexOf("{count}"),hasToggle:0<=b.format.indexOf("{toggle}"),hasMessage:0<=b.format.indexOf("{message}")};e(a);t(a);l(a)})};g.fn.evolutionLike.delegatePopups=function(a){if(!m){m=!0;var b=g.extend({},
g.fn.evolutionLike.defaults,a||{}),c=g.telligent.evolution.template.compile(b.likersTemplate),d=g.telligent.evolution.template.compile(b.likersPopupTemplate),l=function(a,c,d){b.onList(a.contentId,a.contentTypeId,a.typeId,function(a){d(a)},a.pageSize,c)},e=function(a,e){var f=0,p=g(c(a)),q=g(d({likers:p,hasMorePages:a.hasMorePages,showMoreText:b.modalShowMoreText})),t=q.find("ul"),k=q.find(".show-more"),m=b.onOptions(g(e).closest(b.delegatedSelector));t.html(p);k.on("click",function(a){a.preventDefault();
f++;l(m,f,function(a){t.append(c(a));a.hasMorePages?k.show():k.hide();t.scrollTop(t[0].scrollHeight)})});g.glowModal({title:b.modalTitleText,html:q,width:450,height:"100%"})};(function(){g(b.containerSelector).on("click",b.delegatedSelector+" .who-likes",function(a){var c=g(this);a=b.onOptions(g(c).closest(b.delegatedSelector));l(a,0,function(a){e(a,c)})})})()}};g.fn.evolutionLike.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,initialMessage:"",initialCount:0,format:"",onLike:function(a,
b,c,d){},onUnlike:function(a,b,c,d){},likeText:"Like",unlikeText:"Unlike",whoLikesOtherText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> likes this',whoLikesOtherTwoText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> <span class="who-likes">and 1 other</span> like this.',whoLikesOtherMultipleText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> and <span class="who-likes">{count} others</span> like this.',
whoLikesAccessingText:"You like this",whoLikesAccessingTwoText:'You and <span class="who-likes">1 other</span> like this',whoLikesAccessingMultipleText:'You and <span class="who-likes">{count} others</span> like this',modalTitleText:"People who like this",modalShowMoreText:"Show more",onList:function(a,b,c,d){},onOptions:function(a){},containerSelector:"",delegatedSelector:"",delay:500,likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"></div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <% if(liker.avatarHtml) { %>                          <%= liker.avatarHtml %>                      <% } else { %>                          <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                      <% } %>                  </a>              </span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %></a>              </span>          </div>          <div class="full-post-footer"></div>      </li>  <% }); %> ',
likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= likers %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> '};return{}},jQuery,window);u("plugin.evolutionMasonry",["lib.util"],function(g,f,k,m){function n(a){return f(document.createElement("div")).html("&nbsp;").addClass(a.columnClass).css({"float":"left",
minHeight:"1px",overflow:"hidden"})}function e(a){for(var b=0;b<a.columns.length;b++)f(a.columns[b]).empty()}function d(a){for(var b=null,c=null,d=0;d<a.columns.length;d++)if(null===b||null===c)b=a.columns[d],c=a.columns[d].height();else{var l=a.columns[d].height();l<c&&(b=a.columns[d],c=l)}return b}function c(a,b){var c=d(a);b.rendered?b.rendered.appendTo(c):(b.rendered=f(b.original).appendTo(c),l(f(b.rendered).get(0),function(){b.reflowFromHere=!0;a.reflow()}))}function b(a,b){a.rendering=!0;var d;
b?d=b:(d=a.children,e(a));f.each(d,function(b,d){var l=f(d.original).find("img").first();if(0<l.length&&!l.get(0).complete)l.on("load",function(){c(a,d)});else c(a,d)});a.rendering=!1}function a(a,c){c=c||{};a.scrollTop=f(k).scrollTop();if(c.reflow){for(var d=!1,l=[],e=0;e<a.children.length;e++)a.children[e].reflowFromHere&&(delete a.children[e].reflowFromHere,d=!0),d&&(a.children[e].rendered&&a.children[e].rendered.detach(),l.push(a.children[e]));b(a,l)}else{if(c.resize)for(e=0;e<a.children.length;e++)a.children[e].rendered&&
a.children[e].rendered.detach();a.container.empty();a.columns=[];var l=d=0,e=n(a),g=!1;e.height(1200).appendTo(a.container);l=a.container.width();e.height(0).remove();for(var p=50;d<l&&0<p;){p--;var q=n(a);g?e.before(q):q.appendTo(a.container);d+=q.outerWidth(!0);d<=l?a.columns.push(q):q.remove();g||(e.appendTo(a.container),g=!0)}g&&e.remove();b(a,null)}f(k).scrollTop(a.scrollTop)}function l(a,b){if(MutationObserver){var c=f(a);c.data("observed")||(c.data("observed",!0),(new MutationObserver(function(){var a=
c.data("masonryLastHeight"),d=c.height();a&&a==d||(c.data("masonryLastHeight",d),b())})).observe(a,{childList:!0,subtree:!0,attributes:!0}))}}function p(b){return this.each(function(){var c=f.extend({},f.fn.evolutionMasonry.defaults,b||{});c.container=f(this);c.children=c.container.children().detach().toArray().map(function(a){return{original:a}});var d;c.reflow=function(){k.clearTimeout(d);d=k.setTimeout(function(){a(c,{reflow:!0})},50)};a(c);var l;f(window).on("resized",function(b,d){clearTimeout(l);
l=setTimeout(function(){c.rendering||d&&0<Math.abs(d.oldWidth-d.newWidth)&&a(c,{resize:!0})},100)});c.container.data(t,c)})}var t="_evolutionMasonry_context",q={append:function(a){if(a&&0!=a.length){var c=f(a).filter("div");return this.each(function(){var a=f(this).data(t);if(a){var d=[];c.each(function(){var b={original:this};d.push(b);a.children.push(b)});b(a,d)}})}},empty:function(){return this.each(function(){var b=f(this).data(t);b&&(b.container.empty(),b.children=[],a(b))})}};f.fn.evolutionMasonry=
function(a){if(a in q)return q[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)f.error("Method "+a+" does not exist on jQuery.fn.evolutionMasonry");else return p.apply(this,arguments)};f.fn.evolutionMasonry.defaults={columnClass:"masonry-column"};return f.fn.evolutionMasonry},jQuery,window);u("plugin.evolutionModerate",function(g,f,k){var m=g.telligent.evolution,n=function(d){d.settings.onReport(d.settings.contentId,d.settings.contentTypeId,function(c){m.messaging.publish("ui.reportabuse",
{contentId:d.settings.contentId,contentTypeId:d.settings.contentTypeId});showNotification(d,c.Report)})},e=function(d){d.hideTimer&&(clearTimeout(d.hideTimer),d.hideTimer=null)};buildModerationLink=function(d){d.moderationLink=g(m.template.compile(d.settings.moderationLinkTemplate)({linkClassName:d.settings.linkClassName,resources:{moderateLinkText:d.settings.moderateLinkText}})).appendTo(d.element)};buildModerationPopup=function(d){d.popup=g("<div></div>").glowPopUpPanel({cssClass:"content-moderation",
position:"downleft",zIndex:1E3,hideOnDocumentClick:!0});d.popup.on({glowPopUpPanelShown:function(c){d.moderationLink.addClass("open")},glowPopUpPanelHidden:function(c){d.moderationLink.removeClass("open")}})};buildModerationMenuContent=function(d,c){d.settings.onGetAdditionalLinks(function(b){var a=[],a=d.settings.supportsAbuse?d.settings.initialState?b.concat([{href:"#",className:"evolutionModerateFlagged",text:d.settings.reportedLinkText}]):b.concat([{href:"#",className:"evolutionModerateFlag",
text:d.settings.reportLinkText}]):b;b=g(m.template.compile(d.settings.moderationMenuTemplate)({links:a}));b.on("mouseleave",function(a){hideMenu(d)});b.on("mouseenter",function(a){e(d)});b.on("click","a",function(a){var b=g(a.target);b.hasClass("evolutionModerateFlag")?(a.preventDefault(),n(d)):b.hasClass("evolutionModerateFlagged")?a.preventDefault():("#"===b.attr("href")&&a.preventDefault(),d.element.trigger("evolutionModerateLinkClicked",a.target))});c(b)})};showMenu=function(d){d.popup||buildModerationPopup(d);
buildModerationMenuContent(d,function(c){e(d);d.popup.glowPopUpPanel("html",c).glowPopUpPanel("show",d.moderationLink)})};hideMenu=function(d){d.hideTimer||(d.hideTimer=setTimeout(function(){d.popup.glowPopUpPanel("hide");d.hideTimer=null},200))};formatNotificationMessage=function(d,c){return d.settings.reportedNotificationMessageText.replace(/\{NAME\}/gi,c&&c.AuthorUser&&c.AuthorUser.DisplayName?c.AuthorUser.DisplayName:"")};showNotification=function(d,c){var b=m.template.compile(d.settings.notificationTemplate)({resources:{reportedNotificationMessageText:formatNotificationMessage(d,
c),undoLinkText:d.settings.undoLinkText},contextId:d.contextId});m.notifications.show(b,{type:"moderation",duration:d.settings.notificationDuration,cssClass:""})};handleFlagMessages=function(d){m.messaging.subscribe("ui.reportabuse",function(c){d.settings.contentId===c.contentId&&d.settings.contentTypeId===c.contentTypeId&&(d.settings.initialState=!0)})};init=function(d){buildModerationLink(d);d.moderationLink.on({mouseenter:function(c){c.preventDefault();d.popup&&d.popup.glowPopUpPanel("isShown")?
hideMenu(d):showMenu(d);e(d)},mouseleave:function(c){g(c.relatedTarget).is(".content-moderation")||0!==g(c.relatedTarget).closest(".content-moderation").length||hideMenu(d)}});handleFlagMessages(d)};g.fn.evolutionModerate=function(d){var c=g.extend({},g.fn.evolutionModerate.defaults,d||{});return this.each(function(){var b={element:g(this),settings:c};init(b)})};g.fn.evolutionModerate.defaults={contentId:"",contentTypeId:"",initialState:!1,linkClassName:"",onReport:function(d,c,b){},onGetAdditionalLinks:function(d){d([])},
notificationDuration:5E3,moderateLinkText:"moderate",supportsAbuse:!0,reportLinkText:"Report as abusive",reportedLinkText:"Reported as abusive",reportedNotificationMessageText:"{NAME}'s post has been reported. <strong>Thank you for your feedback.</strong>",undoLinkText:"Undo",moderationLinkTemplate:'<a href="#" class="<%: linkClassName %>"><span></span><%= resources.moderateLinkText %></a>',moderationMenuTemplate:'<ul class="navigation-list">   <% foreach(links, function(link){ %>       <li class="navigation-item">           <a href="<%: (link.href || "#") %>" class="<%: (link.className || "") %>"><%= link.text %></a>       </li>   <% }); %></ul>',
notificationTemplate:"<p><%= resources.reportedNotificationMessageText %></p>"};return{}},jQuery,window);u("plugin.evolutionPager",function(g,f,k){var m={},n={},e={},d=function(a){var b=[],c=a.settings,d=function(a){var b={};b[c.pageKey]=a;a={url:c.baseUrl,query:b};c.hash&&0<c.hash.length&&(a[c.hash]=c.hash);return g.telligent.evolution.url.modify(a)};0===c.totalItems||0===c.pageSize?a=0:(a=Math.floor(c.totalItems/c.pageSize),0<c.totalItems%c.pageSize&&(a+=1));if(1<a){c.showFirst&&3<=c.currentPage&&
a>c.numberOfPagesToDisplay&&(b[b.length]={type:"first",selected:!1,page:1,url:d(1)});c.showPrevious&&0<c.currentPage&&(b[b.length]={type:"previous",selected:!1,page:c.currentPage,url:d(c.currentPage)});if(c.showIndividualPages){var l;l=a<c.numberOfPagesToDisplay||0>c.currentPage-Math.floor(c.numberOfPagesToDisplay/2)?0:c.currentPage+Math.floor(c.numberOfPagesToDisplay/2)>=a?a-c.numberOfPagesToDisplay:c.currentPage-Math.floor(c.numberOfPagesToDisplay/2);var e;e=Math.floor(c.numberOfPagesToDisplay/
2);0===c.numberOfPagesToDisplay%2&&(e-=1);for(e=a<c.numberOfPagesToDisplay||c.currentPage+e>=a?a-1:0>c.currentPage-Math.floor(c.numberOfPagesToDisplay/2)?c.numberOfPagesToDisplay-1:c.currentPage+e;l<=e;l++)b[b.length]={type:"page",selected:c.currentPage===l,page:l+1,url:d(l+1)}}c.showNext&&c.currentPage+1<a&&(b[b.length]={type:"next",selected:!1,page:c.currentPage+2,url:d(c.currentPage+2)});c.showLast&&c.currentPage+3<a&&a>c.numberOfPagesToDisplay&&(b[b.length]={type:"last",selected:!1,page:a,url:d(a)})}return b},
c=function(a){var b=a.template({links:a.links});a.selection.html(b)},b=function(a){if(!a.settings.refreshOnAnyHashChange)return null;var b=g.telligent.evolution.url.hashData(),c=null,d;for(d in b)0==d.indexOf(a.settings.pageKey)&&(c=c||{},c[d.substr(a.settings.pageKey.length)]=b[d]);return c},a=function(a){var c=parseInt(g.telligent.evolution.url.hashData()[a.settings.pageKey],10),d=b(a);d&&(c=c||1);isNaN(c)||c===a.settings.currentPage||e[a.settings.pageKey]||(e[a.settings.pageKey]=!0,a.settings.onPage(c,
function(b){a.currentPageIndex=c;q(a,c,0,b,!1)},d||{}))},l=function(a){g(a.selection).on("click","a",function(b){b.preventDefault();b=g(this);var c={};c[a.settings.pageKey]=b.data("page");g.telligent.evolution.url.hashData(c)})},p=function(a){m[a.settings.pageKey]||(m[a.settings.pageKey]=!0,a.currentPageIndex=parseInt(g.telligent.evolution.url.hashData()[a.settings.pageKey],10),isNaN(a.currentPageIndex)&&(a.currentPageIndex=a.settings.currentPage),g(window).on("hashchange",function(c){c=parseInt(g.telligent.evolution.url.hashData()[a.settings.pageKey],
10);if(b(a)||!isNaN(c)&&a.currentPageIndex!=c){a.newPageIndex=c;var d={currentPage:a.currentPageIndex||1,newPage:a.newPageIndex||1,container:a.settings.pagedContentContainer};g.telligent.evolution.messaging.publish(a.settings.pagedContentPagingEvent,d);a.selection.trigger("evolutionPagerPaging",d);a.currentPageIndex=c}}))},t=function(a){n[a.settings.pagedContentPagingEvent]&&(a.currentPageIndex=parseInt(g.telligent.evolution.url.hashData()[a.settings.pageKey],10),g.telligent.evolution.messaging.unsubscribe(n[a.settings.pagedContentPagingEvent]));
n[a.settings.pagedContentPagingEvent]=g.telligent.evolution.messaging.subscribe(a.settings.pagedContentPagingEvent,function(c){e[a.settings.pageKey]||(e[a.settings.pageKey]=!0,a.settings.onPage(c.newPage,function(b){a.currentPageIndex=c.newPage;q(a,c.newPage,c.currentPage,b,!0)},b(a)||{}))})},q=function(a,b,l,f,p){var q=function(){var c={page:b,container:a.settings.pagedContentContainer};g.telligent.evolution.messaging.publish(a.settings.pagedContentPagedEvent,c);a.selection.trigger("evolutionPagerPaged",
c)};!p||"slide"!==a.settings.transition&&"fade"!==a.settings.transition?(g(a.settings.pagedContentContainer).html(f),q(),e[a.settings.pageKey]=!1):(p="fade","slide"===a.settings.transition&&(p=b<l?"slideRight":"slideLeft"),l=g(a.settings.pagedContentContainer),f=g("<div></div>").attr("id",l.attr("id")).html(f).hide().insertAfter(a.settings.pagedContentContainer),l.glowTransition(f,{type:p,duration:a.settings.transitionDuration,complete:function(){g(a.settings.pagedContentContainer).css({width:"",
height:"",overflow:"hidden"});q();e[a.settings.pageKey]=!1}}));a.settings.currentPage=b-1;a.links=d(a);c(a)};g.fn.evolutionPager=function(b){b=g.extend({},g.fn.evolutionPager.defaults,b||{});var e={selection:this,settings:b,template:g.telligent.evolution.template.compile(b.template)};e.links=d(e);c(e);b.onPage&&(b.pagedContentContainer&&0<b.pagedContentContainer.length)&&(t(e),p(e),l(e),a(e));return this};g.fn.evolutionPager.defaults={currentPage:0,pageSize:10,totalItems:0,showPrevious:!1,showNext:!1,
showFirst:!0,showLast:!0,showIndividualPages:!0,numberOfPagesToDisplay:5,pageKey:"pi",hash:"",baseUrl:window.location.href,onPage:function(a,b){},pagedContentContainer:"",pagedContentPagingEvent:"ui.page.paging",pagedContentPagedEvent:"ui.page.paged",transition:null,transitionDuration:250,refreshOnAnyHashChange:!1,template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>     <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>     <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
return{}},jQuery,window);u("plugin.evolutionProgressIndicator",["module.notifications","lib.globalConfiguration"],function(g,f,k,m,n){function e(c){var d=k.extend({},k.fn.evolutionProgressIndicator.defaults,{beforeUnloadMessageTip:f.beforeUnloadMessageTip,beforeUnloadMessageLabel:f.beforeUnloadMessageLabel,pendingTip:f.pendingTip},c||{});q=q||k.telligent.evolution.template.compile(t);return this.each(function(){k(this).append(q(d));d.wrapper=k(this).find(".progress-indicator");d.percentLabel=k(this).find(".progress-percent").first();
d.percentLabelSmaller=k(this).find(".progress-percent-smaller").first();d.log=k(this).find(".progress-log").first();d.graphWrapper=k(this).find(".progress-graph-wrapper").first();d.graph=k(this).find(".progress-graph").first();d.graphLeft=k(this).find(".progress-graph .left").first();d.graphRight=k(this).find(".progress-graph .right").first();d.pending=k(this).find(".progress-pending").first();d.beforeUnloadMessage=k(this).find(".progress-note").first();d.showPending?(d.pending.show(),d.percentLabel.hide(),
d.percentLabelSmaller.hide()):b(d);d.warnBeforeUnload?d.warnBeforeUnload&&(d.beforeUnloadMessage.show(),m.addEventListener("beforeunload",a)):l(d);d.includeLatestMessage&&!d.includeAllMessages&&d.wrapper.addClass("latest-message");d.includePercentComplete||d.graphWrapper.hide();k(this).data(p,d)})}function d(a,b){if(a.includePercentComplete){var c=Math.round(100*b);a.percentLabel.html(c);a.wrapper.addClass(a.progressClass);50<c?(a.graph.css({clip:"rect(auto, auto, auto, auto)"}),a.graphLeft.css({transform:"rotate("+
Math.round(360*b)+"deg)"}),a.graphRight.css({transform:"rotate(180deg)",display:"block"})):(a.graph.css({clip:"rect(0, 1em, 1em, 0.5em)"}),a.graphLeft.css({transform:"rotate("+Math.round(360*b)+"deg)"}),a.graphRight.css({display:"none"}))}}function c(a,b){a.includeAllMessages?a.log.append(k("<li></li>").text(b)):a.includeLatestMessage?a.log.empty().append(k("<li></li>").text(b)):a.log.hide()}function b(a){a.pending.hide();a.percentLabelSmaller.show();a.percentLabel.show()}function a(a){a.stopImmediatePropagation();
a.stopPropagation();a.preventDefault();a.returnValue=""}function l(b){b.beforeUnloadMessage.hide();m.removeEventListener("beforeunload",a)}var p="evolutionProgressIndicator_context",t='\t<div class="progress-indicator">\t\t<div class="progress-graph-wrapper">\t\t\t<span class="progress-label">\t\t\t\t<span class="progress-percent">0</span><span class="progress-percent-smaller">%</span>\t\t\t\t<span class="progress-pending ui-loading ui-tip" data-tip="<%= pendingTip %>" data-width="32" data-height="32"></span>\t\t\t</span>\t\t\t<div class="progress-graph">\t\t\t\t<div class="left half"></div>\t\t\t\t<div class="right half"></div>\t\t\t</div>\t\t\t<div class="progress-shadow"></div>\t\t</div>\t\t<span class="progress-note ui-tip" data-tip="<%= beforeUnloadMessageTip %>"><%= beforeUnloadMessageLabel %></span>\t\t<ul class="progress-log"></ul>\t</div>',
q,h={progress:function(a){var l=this.data(p);if(null!==l)return this.each(function(){b(l);l.finalized||a.percentComplete!==n&&null!==a.percentComplete&&d(l,a.percentComplete);a.message&&0<a.message.length&&c(l,a.message)})},complete:function(a){var c=this.data(p);if(null!==c)return b(c),l(c),c.finalized=!0,this.each(function(){d(c,1);c.wrapper.addClass(c.completeClass)})},error:function(a){var d=this.data(p);if(null!==d)return b(d),l(d),d.finalized=!0,this.each(function(){d.wrapper.addClass(d.errorClass);
d.includeLatestMessage||d.includeAllMessages?c(d,a):k.telligent.evolution.notifications.show(a,{type:"error"})})}};k.fn.evolutionProgressIndicator=function(a){if(a in h)return h[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)k.error("Method "+a+" does not exist on jQuery.fn.evolutionProgressIndicator");else return e.apply(this,arguments)};k.fn.evolutionProgressIndicator.defaults={includePercentComplete:!0,includeLatestMessage:!0,includeAllMessages:!1,progressClass:"progress-indicator-progress",
completeClass:"progress-indicator-complete",errorClass:"progress-indicator-error",warnBeforeUnload:!1,showPending:!1,beforeUnloadMessageTip:null,beforeUnloadMessageLabel:null,pendingTip:null};return{}},jQuery,window);u("plugin.evolutionResize",function(g,f,k){function m(){if(!e){e=!0;var b=g("<textarea>test</textarea>").css({overflow:"hidden",resize:"none",visible:"none"}).appendTo("body");1>=Math.abs(b.prop("scrollHeight")-b.height())&&(n=0);b.remove()}}var n=null,e=!1,d=function(b){b.area.css({height:"auto"}).css({height:b.area.prop("scrollHeight")-
(null===n?b.offset:n)});var a=b.area.outerHeight();a!==b.oldHeight&&(a>=b.maxHeight?b.area.css({overflow:"visible"}):b.area.css({overflow:"hidden"}),b.area.trigger("evolutionResize",{newHeight:a,oldHeight:b.oldHeight}),b.oldHeight=a)},c=function(b){return parseInt(b.replace("px",""),10)};g.fn.evolutionResize=function(){m();return this.filter("textarea").each(function(){var b=g(this).css({resize:"none",overflow:"hidden"}),a={area:b,oldHeight:b.height(),maxHeight:c(b.css("max-height")),offset:b.innerHeight()!==
b.height()?c(b.css("padding-top"))+c(b.css("padding-bottom")):0};b.on("input keydown keyup",function(){d(a)});d(a)})};return{}},jQuery,window);u("plugin.evolutionScrollSlider",["lib.util"],function(g,f,k,m){var n=!1,e=function(c){var b=c.window.height()>=c.document.height(),a=function(){var a=c.document.height(),b=c.window.height(),d=c.window.scrollTop();return(a-d-b)/a};c.window.on("scroll.evolutionScrollSlider",g.requestAnimationFrameThrottle(function(){b=!0}));setInterval(function(){b&&(b=!1,!n&&
1-a()>=c.revealAt?(n=!0,c.document.trigger("evolutionScrollSliderShow")):n&&1-a()<c.revealAt&&(n=!1,c.document.trigger("evolutionScrollSliderHide")))},c.bounceDelay)},d=function(c){var b=f("<div></div>").hide().addClass(c.className).css({width:c.width,minHeight:c.height,maxHeight:0.7*c.window.height(),position:"fixed",bottom:c.offsetBottom,right:"0px"}).appendTo("body"),a=function(){c.load(function(a){a&&(b.html(a),f.fn.evolutionTransform.accelerated()?b.hide().evolutionTransform({left:b.width()+
c.offsetRight,opacity:0},{duration:0}).show().evolutionTransform({left:-1*c.offsetRight,opacity:1},{duration:200}):b.css({right:-b.width()}).show().animate({right:c.offsetRight},{duration:c.animationDuration}))})},d=function(){f.fn.evolutionTransform.accelerated()?b.evolutionTransform({opacity:0},{duration:100,complete:function(){b.hide()}}):b.animate({right:-b.width()},{duration:c.animationDuration,complete:function(){b.hide()}})};c.document.on("evolutionScrollSliderShow.evolutionScrollSlider",function(){a()}).on("evolutionScrollSliderHide.evolutionScrollSlider",
function(){d()})};f.evolutionScrollSlider=function(c){c=f.extend({},f.evolutionScrollSlider.defaults,c||{},{window:f(window),document:f(document)});c.document.off(".evolutionScrollSlider");c.window.off(".evolutionScrollSlider");e(c);d(c)};f.evolutionScrollSlider.hide=function(){f(document).trigger("evolutionScrollSliderHide")};f.evolutionScrollSlider.defaults={load:function(c){c(null)},width:400,height:75,className:"slider-content",animationDuration:250,offsetBottom:25,offsetRight:25,bounceDelay:150,
revealAt:0.8};return{}},jQuery,window);u("plugin.evolutionStarRating",function(g,f,k){var m=[],n=/MSIE 6/i.test(navigator.userAgent)?"gif":"png",e=function(b,a){return 1==a%2?b.settings.imagesPathUrl+"star-right-on."+n:b.settings.imagesPathUrl+"star-left-on."+n},d=function(b,a){return 1==a%2?b.settings.imagesPathUrl+"star-right-off."+n:b.settings.imagesPathUrl+"star-left-off."+n};_cacheImages=function(b){var a,c,f;for(f=0;2>f;f++)c=e(b,f),_isImageCached(c)||(a=new Image,a.src=c,m[m.length]=a),c=d(b,
f),_isImageCached(c)||(a=new Image,a.src=c,m[m.length]=a)};_isImageCached=function(b,a){var c;for(c=0;c<m.length;c++)if(m[c].src==a)return!0;return!1};_getItemTitle=function(b,a,c){return"object"==typeof b.settings.titles?b.settings.titles[a].replace("{0}",c):b.settings.titles?b.settings.titles.replace("{0}",c):c};_getValue=function(b){return"undefined"!==typeof b.internal.value?b.internal.value:b.settings.value};_setValue=function(b,a){b.internal.isInitialized&&!b.settings.isReadOnly&&(b.internal.value=
a,b.settings.allowMultipleSelections||(b.settings.isReadOnly=!0),b.internal.savingValue=!0,b.settings.onRate(a))};_showValue=function(b,a){var c,f=2*b.settings.maxRating;a=2*a-1;var t="img"==b.settings.starElement;for(c=0;c<f;c++)c<=a?t?g(b.internal.state.find("img").get(c)).attr("src",e(b,c)).removeClass().addClass("star-on-"+(0==c%2?"left":"right")):g(b.internal.state.find("span").get(c)).removeClass().addClass("star-on-"+(0==c%2?"left":"right")):t?g(b.internal.state.find("img").get(c)).attr("src",
d(b,c)).removeClass().addClass("star-off-"+(0==c%2?"left":"right")):g(b.internal.state.find("span").get(c)).removeClass().addClass("star-off-"+(0==c%2?"left":"right"))};_mouseOver=function(b,a){b.internal.isInitialized&&!b.settings.isReadOnly&&(b.internal.state.addClass(b.settings.overClass),_showValue(b,a))};_mouseOut=function(b,a){b.internal.isInitialized&&!b.settings.isReadOnly&&(b.internal.state.removeClass(b.settings.overClass),_showValue(b,a))};_init=function(b){return this.each(function(){var a=
{settings:g.extend({},g.fn.evolutionStarRating.defaults,b||{}),internal:{state:g(this)}};a.settings.imagesPathUrl||(a.settings.imagesPathUrl=g.telligent.evolution.site.getBaseUrl()+"utility/images/");_cacheImages(a);g(this).data("evolutionStarRating_context",a);_initialize(a)})};_initialize=function(b){b.internal.state.addClass(b.settings.starClass).css("white-space","nowrap").find("a").off(".evolutionStarRating").end().empty().on("mouseleave",function(){_showValue(b,_getValue(b))});b.settings.isReadOnly&&
b.internal.state.addClass(b.settings.readOnlyClass);var a,c=2*b.settings.maxRating,f="undefined"===typeof b.settings.ratingCount,t="img"==b.settings.starElement;for(a=0;a<c;a++)(function(){var c,l;l=t?g("<img />").css({borderLeftWidth:"0px",borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px"}):g("<span></span>");b.settings.isReadOnly||(c=g('<a href="#" />').css({textDecoration:"none"}).append(l));var k=(a+1)/2;k<=b.settings.value?t?l.attr("src",e(b,a)).addClass("star-on-"+(0==a%2?
"left":"right")):l.addClass("star-on-"+(0==a%2?"left":"right")):t?l.attr("src",d(b,a)).addClass("star-off-"+(0==a%2?"left":"right")):l.addClass("star-off-"+(0==a%2?"left":"right"));if(!b.settings.isReadOnly){if(b.settings.useHalfStars)s=_getItemTitle(b,a,k);else var k=Math.ceil(k),s=_getItemTitle(b,k,k);f&&c.attr("title",s).addClass("ui-tip");t&&l.attr("alt",s);c.data("rating-value",k).on("click.evolutionStarRating",function(a){_setValue(b,c.data("rating-value"));return!1}).on("focus.evolutionStarRating",
function(a){_mouseOver(b,c.data("rating-value"))}).on("mouseover.evolutionStarRating",function(a){_mouseOver(b,c.data("rating-value"))}).on("blur.evolutionStarRating",function(a){_mouseOut(b,c.data("rating-value"))}).on("mouseout.evolutionStarRating",function(a){_mouseOut(b,c.data("rating-value"))})}t&&l.attr("align","absmiddle").attr("border",0);c?b.internal.state.append(c):b.internal.state.append(l)})();_setMessage(b);b.internal.isInitialized=!0};_setMessage=function(b){if(b.settings.ratingMessageFormat&&
!isNaN(parseInt(b.settings.ratingCount))&&!isNaN(parseInt(b.settings.value))){var a=b.settings.ratingMessageFormat.replace(/\{rating\}/gi,Math.round(10*b.settings.value)/10).replace(/\{max_rating\}/gi,b.settings.maxRating).replace(/\{count\}/gi,b.settings.ratingCount);b.internal.state.attr("title",a).attr("aria-label",a)}};var c={val:function(b){var a=this.data("evolutionStarRating_context");return null!==a?"undefined"!==typeof b?(a.internal.value=b,_showValue(a,b),b):_getValue(a):0},readOnly:function(b){var a=
this.data("evolutionStarRating_context");if(null!==a)if("undefined"!==typeof b)(a.settings.isReadOnly=b)?a.internal.state.find("a").css({cursor:"default"}):a.internal.state.find("a").css({cursor:"pointer"});else return a.settings.isReadOnly;return!0},option:function(b,a){if("object"===typeof b)return this.each(function(){var a=g(this).data("evolutionStarRating_context");null!=a&&(a.settings=g.extend({},a.settings,b),_init.apply(g(this),[a.settings]))});if("undefined"!==typeof b&&"undefined"!==typeof a)return this.each(function(){var c=
g(this).data("evolutionStarRating_context");null!=c&&(c.settings[b]=a,_init.apply(g(this),[c.settings]))});if("undefined"!==typeof b){var c=this.data("evolutionStarRating_context");return null!==c?c.settings[b]:null}}};g.fn.evolutionStarRating=function(b){if(b in c)return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)g.error("Method "+b+" does not exist on jQuery.fn.evolutionStarRating");else return _init.apply(this,arguments)};g.extend(g.fn.evolutionStarRating,
{defaults:{value:0,maxRating:5,imagesPathUrl:"",starElement:"img",useHalfStars:!1,starClass:"rating",overClass:"active",readOnlyClass:"readonly",titles:"Terrible Poor Fair Average Good Excellent".split(" "),isReadOnly:!1,allowMultipleSelections:!0,ratingCount:void 0,ratingMessageFormat:"Average rating: {rating} out of {count} ratings.",onRate:function(b){}}});return{}},jQuery,window);u("plugin.evolutionTagTextBox",function(g,f,k){var m={openTagSelector:function(){var b=this.data("evolutionTagTextBox");
if(b){window.__tagEditor={SetSelectedTags:function(a){e(b,a)},GetAllTagsWithEncoding:function(){for(var a=[],c=b.settings.allTags,d=g("<div></div>"),e=0;e<c.length;e++)d.text(c[e]),a[e]=[c[e],d.html()];return a},GetSelectedTags:function(){return d(b)}};var a=g.telligent.evolution.ensureRemoteUrlEncoding(b.settings.selectTagsModalUrl);"~/"==a.substr(0,2)&&(a=g.telligent.evolution.site.getBaseUrl()+a.substr(2));window.Telligent_Modal?window.Telligent_Modal.Open(a,400,350,null):g.glowModal&&g.glowModal(a,
{width:400,height:350})}},val:function(b){if(b===k)return(b=this.data("evolutionTagTextBox"))?d(b).join(","):"";var a=[];0<=b.indexOf(";")&&(b=b.replace(/;/g,","));b=b.split(/,/g);for(var c=0;c<b.length;c++){var f=g.trim(b[c]);f&&a.push(f)}return this.each(function(){var b=g(this).data("evolutionTagTextBox");b&&e(b,a)})}},n=function(b){return this.each(function(){var a={settings:g.extend({},g.fn.evolutionTagTextBox.defaults,b||{}),internal:{state:this,suggestionTimeoutHandle:null,previousTags:[],
previousValue:"",currentTag:"",currentTagPosition:0}},d=g(this);0<=d.val().indexOf(";")&&d.val(d.val().replace(/;/g,","));for(var e=d.val().split(/,/g),f=[],q=0;q<e.length;q++){var h=g.trim(e[q]);h&&f.push(g.telligent.evolution.html.encode(h))}d.data("evolutionTagTextBox",a);d.glowLookUpTextBox({emptyHtml:"",maxValues:100,selectedLookUpsHtml:f,minimumLookUpLength:0,onGetLookUps:function(b,d){window.clearTimeout(a.suggestTimeout);d&&b.glowLookUpTextBox("updateSuggestions",[b.glowLookUpTextBox("createLookUp",
"",'<span class="ui-loading" width="48" height="48"></span>','<span class="ui-loading" width="48" height="48"></span>',!1)]);a.suggestTimeout=window.setTimeout(function(){c(a,d).then(function(a){for(var c=[],e=!1,l=0;l<a.length;l++)a[l].toLowerCase()==d.toLowerCase()?e=!0:c.push(b.glowLookUpTextBox("createLookUp",a[l],g.telligent.evolution.html.encode(a[l]),g.telligent.evolution.html.encode(a[l]),!0));d&&(e?c.unshift(b.glowLookUpTextBox("createLookUp",d,g.telligent.evolution.html.encode(d),g.telligent.evolution.html.encode(d),
!0)):c.unshift(b.glowLookUpTextBox("createLookUp",d,'<em class="new-tag">'+g.telligent.evolution.html.encode(d)+"</em>",'<em class="new-tag">'+g.telligent.evolution.html.encode(d)+"</em>",!0)));b.glowLookUpTextBox("updateSuggestions",c)})},500)}}).on("glowLookUpTextBoxChange",function(){d.trigger("change")})})},e=function(b,a){for(var c=g(b.internal.state);0<c.glowLookUpTextBox("count");)c.glowLookUpTextBox("removeByIndex",0);for(var d=0;d<a.length;d++){var e=c.glowLookUpTextBox("createLookUp",a[d],
g.telligent.evolution.html.encode(a[d]),g.telligent.evolution.html.encode(a[d]),!0);c.glowLookUpTextBox("add",e)}},d=function(b){var a=[];b=g(b.internal.state);for(var c=b.glowLookUpTextBox("count"),d=0;d<c;d++){var e=b.glowLookUpTextBox("getByIndex",d);e&&a.push(e.Value)}return a},c=function(b,a){return g.Deferred(function(c){var e,f,q,h,k=d(b);if(b.settings.applicationId)g.telligent.evolution.get({url:g.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/aggregatetags.json",data:{ApplicationId:b.settings.applicationId,
TagNameFilter:a,PageSize:a?20:100,PageIndex:0,MinimumContentCount:0,TypeId:b.settings.typeId,SortBy:"ContentCount",SortOrder:"Descending"}}).then(function(a){var b=[];for(e=0;e<a.AggregateTags.length;e++){q=!1;h=g.telligent.evolution.html.decode(a.AggregateTags[e].Name);for(f=0;f<k.length&&!q;f++)k[f].toLowerCase()==h.toLowerCase()&&(q=!0);q||b.push(h)}c.resolve(b)})["catch"](function(){c.resolve([])});else{var s=b.settings.allTags,m=[];for(e=0;e<s.length&&(!a||20>=m.length);e++)if(0===s[e].toLowerCase().indexOf(a.toLowerCase())){q=
!1;for(f=0;f<k.length&&!q;f++)k[f].toLowerCase()==s[e].toLowerCase()&&(q=!0);q||m.push(s[e])}c.resolve(m)}}).promise()};g.fn.evolutionTagTextBox=function(b){if(b in m)return m[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)g.error("Method "+b+" does not exist on jQuery.fn.evolutionTagTextBox");else return n.apply(this,arguments)};g.extend(g.fn.evolutionTagTextBox,{defaults:{allTags:[],selectTagsModalUrl:"~/utility/tagselector?TagEditor=__tagEditor",applicationId:null,
typeId:null}});return{}},jQuery,window);u("plugin.evolutionTextEditor",function(g,f,k){var m=function(a){return g(a).data("__EVOLUTIONTEXTEDITOR_CONTEXT")},n=function(a){var b="";a.isReadOnly?b=a.readOnlyView.html():g.telligent.evolution.put({url:g.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/html/fromtext.json",data:{text:a.editor.evolutionComposer("val")},dataType:"json",async:!1,success:function(a){b=a.Html}});return b},e=function(a,b){g.telligent.evolution.put({url:g.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/text/fromhtml.json",data:{html:b},dataType:"json",async:!1,success:function(c){c.TextConversion.IsDataLost?(a.isReadOnly||(a.readOnlyView.css("height",a.editor.height()+"px"),a.readOnlyView.css("width",a.editor.width()+"px"),a.isReadOnly=!0,a.readOnlyView.show(),a.editorWrapper.hide()),a.readOnlyView.html(b),a.editor.val("<!html>"+b)):(a.isReadOnly&&(a.isReadOnly=!1,a.readOnlyView.hide(),a.editorWrapper.show()),a.editor.evolutionComposer("val",c.TextConversion.Text),a.editor.trigger("input"))}})},
d=function(a){var b=function(){var c=a.editorWrapper.offset(),d=a.editorWrapper.height();if(!a.isReadOnly)if(d){var e=g(f),k=e.scrollTop(),e=e.height(),s=Math.max(0,e-g("body").height());k+e<c.top+d?g("body, html").animate({scrollTop:(d>e-s?c.top-s:c.top-(e-d-5))+"px"},200,"swing",function(){a.editor.focus()}):k+s>c.top?g("body, html").animate({scrollTop:c.top-s+"px"},200,"swing",function(){a.editor.focus()}):a.editor.focus()}else f.clearTimeout(a.attemptFocusHandle),a.attemptFocusHandle=f.setTimeout(function(){b()},
50)};b()},c=function(a,b,c){a.editor.evolutionComposer("resize",b,c);isNaN(parseInt(b,10))||a.readOnlyView.css("width",b+"px");isNaN(parseInt(c,10))||a.readOnlyView.css("height",c+"px")},b=function(a){var b=a.width,d=a.height;"%"==a.cssWidth.substr(a.cssWidth.length-1)&&(b=a.editorWrapper.parent().width()*(parseInt(a.cssWidth,10)/100)-parseInt(a.editor.css("padding-left"),10)-parseInt(a.editor.css("padding-right"),10)-(a.editor.outerWidth()-a.editor.innerWidth()),c(a,b,d))},a={init:function(a){return this.each(function(){var b=
g(this),c,d;if(!b.data("__EVOLUTIONTEXTEDITOR_CONTEXT")){var h=b.css("width"),f=b.css("height"),k=b.innerWidth()-parseInt(b.css("padding-left"),10)-parseInt(b.css("padding-right"),10),n=b.innerHeight()-parseInt(b.css("padding-top"),10)-parseInt(b.css("padding-bottom"),10),r=b.val(),x=g('<div class="text-editor-wrapper"></div>');x.insertAfter(b);x.append(b);if(a.onSubmit){var y="cb_"+(new Date).getTime(),z=[];z.push('<div class="text-editor-submit-panel">');z.push(a.beforeSubmitHtml||"");a.enableToggle&&
(z.push('<span class="text-editor-submit-panel-message">'),z.push('<input type="checkbox" id="'+y+'_enable" />'),z.push('<label for="'+y+'_enable">'+(a.submitEnterMessage||"Press enter to send")+"</label>"),z.push("</span>"));z.push('<button type="button" class="text-editor-submit-panel-button" id="'+y+'_submit">');z.push(a.submitButtonText||"Send");z.push("</button>");z.push(a.afterSubmitHtml||"");z.push("</div>");x.append(z.join(""));c=x.find("#"+y+"_enable");d=x.find("#"+y+"_submit")}y=g('<div class="text-editor-read-only" style="overflow: auto; padding: 2px; border: 1px solid; box-sizing: border-box"></div>').hide();
y.on("click",function(){a.readOnlyMessage&&alert(a.readOnlyMessage)});y.insertAfter(x);b.evolutionComposer({plugins:a.plugins,focus:!1}).data("__EVOLUTIONTEXTEDITOR_CONTEXT",{editorWrapper:x,editor:b,readOnlyView:y,isReadOnly:!1,onKeyDowns:[],onChanges:[],cssWidth:h,cssHeight:f,width:k,height:n});b.evolutionComposer("oninput",function(a){var c=m(b);if(c&&c.onChanges&&0<c.onChanges.length)for(var d=0;d<c.onChanges.length;d++)try{c.onChanges[d](a)}catch(e){}return!0});if(a.onSubmit){if(a.enableToggle){b.evolutionComposer("onkeydown",
function(d){if(13!=d.keyCode||!c.is(":checked")||d.shiftKey||d.altKey){var e=m(b);if(e&&e.onKeyDowns&&0<e.onKeyDowns.length)for(var h=0;h<e.onKeyDowns.length;h++)try{e.onKeyDowns[h](d)}catch(f){}return!0}if(a.onSubmit)a.onSubmit();return!1});h=a.enterToSubmit;null!=window.localStorage&&null!==window.localStorage.getItem("tinymce-entertosubmit")&&(h="true"==window.localStorage.getItem("tinymce-entertosubmit"));h?c.prop("checked",!0):c.prop("checked",!1);var A=function(){c.is(":checked")?d.hide():d.show();
null!=window.localStorage&&window.localStorage.setItem("tinymce-entertosubmit",c.is(":checked").toString())};c.on("change",function(){A();return!0});A()}d.on("click",function(b){if(a.onSubmit)a.onSubmit();return!1})}else b.evolutionComposer("onkeydown",function(a){var c=m(b);if(c&&c.onKeyDowns&&0<c.onKeyDowns.length)for(var d=0;d<c.onKeyDowns.length;d++)try{c.onKeyDowns[d](a)}catch(e){}return!0});setTimeout(function(){b.evolutionComposer("resize",k,n)},50);0<g.trim(r).length&&e(m(b),r)}})},val:function(a){if("undefined"!==
typeof a){var b=m(this);if(b)return e(b,a)}else return(b=m(this))?n(b):"";return this},focus:function(){var a=m(this);a&&(b(a),d(a));return this},onKeyDown:function(a){var b=m(this);b&&b.onKeyDowns.push(a);return this},onChange:function(a){var b=m(this);b&&b.onChanges.push(a);return this},resize:function(a,b){var d=m(this);d&&c(d,a,b);return this},appendTo:function(a){var c=m(this);c?(c.editorWrapper.appendTo(a),b(c)):this.appendTo(a);return this}};g.fn.evolutionTextEditor=function(b){if(a[b])return a[b].apply(this,
Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)g.error("Method "+b+" does not exist on jQuery.evolutionTextEditor");else return a.init.apply(this,arguments)};return{}},jQuery,window);u("plugin.evolutionSqueezeText",function(g,f,k){function m(b){return parseFloat(g(b).css("font-size"))}function n(b){return parseFloat(g(b).css("letter-spacing"))}function e(b,a){g(b).css("font-size",a)}function d(b,a){g(b).css("letter-spacing",a)}var c={minSize:9,minSpacing:-0.5,enableSpacing:!0,
resetOnFailure:!1,truncateOnFailure:!0,onFailure:function(){}};g.fn.evolutionSqueezeText=function(b){var a=g.extend({},c,b||{});return this.each(function(){g(this).css({"white-space":"nowrap",overflow:"hidden"});if(!(this.scrollWidth<=this.offsetWidth)){var b=a.enableSpacing?1:2,c=a.minSpacing,f=a.minSize,q=n(this),h=m(this),k=h,s=q,w=q,r=h,x=0,y,z;for(z=0;50>z;z++)if(1===b&&a.enableSpacing){if(this.scrollWidth<=this.offsetWidth){y=q;var A=n(this);y=A+(y-A)/2}else y=c,A=n(this),y+=(A-y)/2;d(this,
y);this.scrollWidth<=this.offsetWidth?c=y:q=y;if(0.01>=Math.abs(y-a.minSpacing)&&2>x)x++,b=2,q=w=s,c=a.minSpacing,d(this,s);else if(0.01>=Math.abs(w-y))break;else w=y}else if(2===b)if(this.scrollWidth<=this.offsetWidth?(y=h,A=m(this),y=A+(y-A)/2):(y=f,A=m(this),y+=(A-y)/2),e(this,y),this.scrollWidth<=this.offsetWidth?f=y:h=y,0.01>=Math.abs(y-a.minSize)&&a.enableSpacing&&2>x)x++,b=1;else if(0.01>=Math.abs(r-y))if(a.enableSpacing&&2>x)x++,b=1;else break;else r=y;this.scrollWidth<=this.offsetWidth||
(a.resetOnFailure&&(e(this,k),d(this,s)),a.truncateOnFailure&&g(this).css("text-overflow","ellipsis"),a.onFailure&&a.onFailure.apply(this))}})};g.fn.evolutionSqueezeText.defaults=c;return{}},jQuery,window);u("plugin.evolutionTheater",["lib.globalConfiguration"],function(g,f,k,m){var n={show:function(e){var d=f.extend({},n.defaults,e||{});e=g.previewClose;var c=f('<div class="theater-mask"></div>').css("opacity","0").appendTo("body"),b=f('<div class="theater-loading"><span class="ui-loading"></span></div>').appendTo(c),
a=f('<div class="theater-container"></div>').css("opacity","0").appendTo(c),l=f('<div class="theater-content-container"></div>').appendTo(a),p=f('<div class="theater-content"></div>').appendTo(l),t=f('<a href="#" class="theater-close">'+e+"</a>").appendTo(c),q=null,h=function(c,e){q=c;c(function(c){e?e(p,c):p.html(c);k.setTimeout(function(){b.hide();d.loaded(p);a.css("opacity","1")},50)})},m=function(){c.css("opacity","0");window.setTimeout(function(){c.remove()},100);t.off("._evolution_theater");
a.off("._evolution_theater");f(document).off("._evolution_theater");f(document).off("._evolution_theater");f("body").css("overflow","")};n.refresh=function(a){h(q,a)};n.hide=function(){m()};(function(){f("body").css({overflow:"hidden"});f(document).off(".evolutionTheater").on("pointerstart._evolution_theater",".theater-mask",function(a){a=this.scrollTop;var b=this.scrollHeight,c=a+this.offsetHeight;0===a?this.scrollTop=1:c===b&&(this.scrollTop=a-1)}).on("pointermove._evolution_theater",{passive:!1},
function(a){for(var b=a.target,c=!1;null!==b;){if(b.classList&&b.classList.contains("theater-mask")){c=!0;break}b=b.parentNode}c||a.preventDefault()})})();t.on("click._evolution_theater",function(a){a.preventDefault();m()});a.on("click._evolution_theater",function(b){b.target===a.get(0)&&m()});f(document).on("keydown._evolution_theater",function(a){27===a.which&&m()});c.css("opacity","1");h(d.content)},hide:function(){},refresh:function(){},defaults:{content:function(){return null},loaded:function(){}}};
f.evolutionTheater=n;return{}},jQuery,window);u("plugin.evolutionThreadReplies.controller",["plugin.evolutionThreadReplies.model","plugin.evolutionThreadReplies.navigator","plugin.evolutionThreadReplies.repliesView","plugin.evolutionThreadReplies.votersPopup","plugin.evolutionThreadReplies.utility"],function(g,f,k,m,n,e,d,c){function b(b){b.model=new g({onListReplies:b.onListReplies,onListVoters:b.onListVoters,onAddReply:b.onAddReply,onEditReply:b.onEditReply,onGetReply:b.onGetReply,onVoteReply:b.onVoteReply,
onFilterChange:b.onFilterChange,onTyping:b.onTyping,onInit:b.onInit,onTypingStarted:function(a){a&&a.authorId==e.telligent.evolution.user.accessing.id||(b.view.indicateTyping({typing:!0,parentId:a.parentId,authorDisplayName:a.authorDisplayName}),b.typingTimeouts=b.typingTimeouts||{},d.clearTimeout(b.typingTimeouts[a.parentId]),delete b.typingTimeouts[a.parentId],b.typingTimeouts[a.parentId]=d.setTimeout(function(){b.view.indicateTyping({typing:!1,parentId:a.parentId,authorDisplayName:a.authorDisplayName})},
1.5*a.delay))},onReplyCreated:function(a,c){var d=a.forceRender;if(!d){if(a.authorId==e.telligent.evolution.user.accessing.id)return;b.view.indicateTyping({typing:!1,parentId:a.parentId});if(b.interacting){b.view.indicateNewReplies({parentId:a.parentId,replyId:a.replyId});return}if(!b.view.isContainerVisible({parentId:a.parentId})||b.interacting){b.view.indicateNewReplies({parentId:a.parentId,replyId:a.replyId});return}}b.model.getReply({replyId:a.replyId}).then(function(c){c=b.view.renderReplies({replies:[c],
highlightNew:!0,permaLinked:a.replyId,includeExplicitLoaders:!0,sortBy:b.sortBy,sortOrder:b.sortOrder,onlyIfVisible:!d}).added;r(b);d?b.view.scrollTo({replyId:a.replyId}):c||b.view.indicateNewReplies({parentId:a.parentId,replyId:a.replyId})})},onReplyUpdated:function(a){v(b,a.replyId)||b.view.isReplyRendered({replyId:a.replyId})&&b.model.getReply({replyId:a.replyId}).then(function(c){!1!==c.isApproved&&b.view.renderReplies({replies:[c],highlightNew:!0,permaLinked:a.replyId,highlightPermaLinked:!0})})},
onVote:function(a){b.view.updateVotes({replyId:a.replyId,yesVotes:a.yesVotes,noVotes:a.noVotes,value:a.value})},onReplyDeleted:function(c){v(b,c.replyId)||a(b,c.replyId,c.deleteChildren)},onAttemptDelete:function(c){h(b,c.replyId);a(b,c.replyId,c.deleteChildren)},onShowReplyForm:function(a){b.view.showReplyForm(a)},onAttemptTyping:n.throttle(function(a){b.model.type({parentId:a.parentId})},1500),onAttemptCreate:function(a){a&&(a.body&&0!=e.trim(a.body).length)&&(b.view.hideReplyForms(),h(b),b.model.addReply({parentId:a.parentId,
body:a.body,data:a.data}).then(function(c){!1!==c.isApproved&&(b.view.renderReplies({replies:[c],sortBy:a.sortBy||b.sortBy,sortOrder:a.sortOrder||b.sortOrder,flattenedSortBy:b.flattenedSortBy,flattenedSortOrder:b.flattenedSortOrder,highlightNew:!0,permaLinked:c.id,includeExplicitLoaders:!0}),b.view.scrollTo({replyId:c.id}))}))},onAttemptUpdate:function(a){a&&(a.body&&0!=e.trim(a.body).length)&&(h(b,a.replyId),b.view.hideReplyForms(),b.model.editReply({replyId:a.replyId,body:a.body,data:a.data}).then(function(a){!1!==
a.isApproved&&b.view.renderReplies({replies:[a],highlightPermaLinked:!0,permaLinked:a.id})}))},shouldHandleLiveMutations:function(){return null==b.filter}})}function a(a,b,c){a.view.isReplyRendered({replyId:b})?c?a.view.removeReply({replyId:b}):a.model.getReply({replyId:b}).then(function(c){a.view.renderReplies({replies:[c],permaLinked:b})}):a.view.indicateRemovedReplies({replyId:b})}function l(a){a.flattenedSortOrder="CreatedDate"==a.sortBy?a.sortOrder:"Ascending";a.navigator=new f({onParseReplyId:a.onParseReplyId,
onGenerateReplyUrl:a.onGenerateReplyUrl,replySortByQueryStringKey:a.replySortByQueryStringKey,replyFilterQueryStringKey:a.replyFilterQueryStringKey,replySortOrderQueryStringKey:a.replySortOrderQueryStringKey,defaultReplyIdQueryStringValue:a.defaultReplyIdQueryStringValue,defaultReplySortByQueryStringValue:a.defaultReplySortByQueryStringValue,defaultReplySortOrderQueryStringValue:a.defaultReplySortOrderQueryStringValue,initialSortBy:a.sortBy,initialSortOrder:a.sortOrder,initialFilter:a.filter,onLoadReply:function(b){return a.model.listReplies({replyId:b.replyId})},
onLoadReplies:function(b){a.view.empty();a.view.showLoading();return a.model.listReplies({sortBy:b.replySortBy,sortOrder:b.replySortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,filter:b.replyFilter})},onRenderReply:function(b,c,d){d.resetFilter&&(a.model.filterChange(d),a.view.empty());a.view.renderReplies({replies:b,permaLinked:c,sortBy:d.sortBy,sortOrder:d.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder});a.view.scrollTo({replyId:c,
highlight:!0})},onRenderReplies:function(b,c){a.model.filterChange(c);a.view.empty();a.view.renderReplies({replies:b,sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,appendOnly:!0})},onAdjustGlobalSort:function(b){a.sortBy=b.sortBy;a.filter=b.filter;a.sortOrder=b.sortOrder;a.flattenedSortOrder="CreatedDate"==b.sortBy?b.sortOrder:"Ascending"}})}function p(a){e(a.container).empty().show();a.view=new k({wrapper:a.wrapper,container:a.container,
loadMoreTemplate:a.loadMoreTemplate,newRepliesTemplate:a.newRepliesTemplate,replyTemplate:a.replyTemplate,typingIndicatorTemplate:a.typingIndicatorTemplate,replyListTemplate:a.replyListTemplate,replyFormTemplate:a.replyFormTemplate,pageSize:a.pageSize,flattenedDepth:a.flattenedDepth,threadUrl:a.threadUrl,loadOnScroll:a.loadOnScroll,delayLoadOnScroll:a.delayLoadOnScroll,highlightClassName:a.highlightClassName,loadMoreSelector:a.loadMoreSelector,containerSelector:a.containerSelector,replySelector:a.replySelector,
permalinkSelector:a.permalinkSelector,loadMorePreviousSelector:a.loadMorePreviousSelector,renderedContentSelector:a.renderedContentSelector,loadMoreNextSelector:a.loadMoreNextSelector,loadMoreLinkSelector:a.loadMoreLinkSelector,newReplySelector:a.newReplySelector,submitReplySelector:a.submitReplySelector,cancelReplySelector:a.cancelReplySelector,onEditorAppendTo:a.onEditorAppendTo,onEditorRemove:a.onEditorRemove,onEditorVal:a.onEditorVal,onEditorFocus:a.onEditorFocus,baseLoadIndicatorsOnSiblings:a.baseLoadIndicatorsOnSiblings,
highlightTimeout:1E3*a.highlightNewReplySeconds,onGetFilter:function(){return a.filter}})}function t(a){a.voterPopup=new m({modalTitleText:a.text.peopleWhoVoted,modalShowMoreText:a.text.more,noVotesText:a.text.noVotes,loadVoters:function(b){return a.model.listVoters(b)}});a.voterPopup.handleVoterPopupRequests({container:a.container})}function q(a){x.subscribe("ui.replies.navigate",function(b){a.navigator.navigate({url:b.url})});x.subscribe("ui.replies.loadpage",function(b){a.model.listReplies({parentId:b.parentId,
startReplyId:b.startReplyId,endReplyId:b.endReplyId,flattenedDepth:a.flattenedDepth-b.currentDepth+1,sortBy:b.sortBy,sortOrder:b.sortOrder,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,filter:b.filter,explicitPageIndex:b.explicitPageIndex}).then(function(c){0==a.view.renderReplies({replies:c.replies,sortBy:b.sortBy,sortOrder:b.sortOrder,offsetElement:b.offsetElement,flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder,loadDirection:b.loadDirection,
explicitContainer:b.explicitContainer,loadInline:b.loadInline}).addedCount&&a.noRepliesMessage&&e.telligent.evolution.notifications.show(a.noRepliesMessage)})});x.subscribe("ui.replies.delete",function(b){if(a.onDeletePrompt)a.onDeletePrompt({replyId:e(b.target).data("id")})});x.subscribe("ui.replies.edit.cancel",function(b){a.view.hideReplyForms()});x.subscribe("ui.replies.edit",function(b){var c=e(b.target).data("id");a.model.getReply({replyId:c}).then(function(b){e.fn.uilinks.hide();a.view.renderEdit({replyId:c,
reply:b})})});x.subscribe("ui.replies.interaction.start",function(){a.interacting=!0});x.subscribe("ui.replies.interaction.stop",function(){a.interacting=!1});x.subscribe("ui.replies.cancel",function(){a.view.hideReplyForms()});x.subscribe("ui.replies.new",function(b){var c=e(b.target).data("replyid");a.model.listReplies({replyId:c,includeSiblings:!0}).then(function(b){a.view.renderReplies({replies:b.replies,permaLinked:c,sortBy:a.sortBy,sortOrder:a.sortOrder,highlightNew:!0,includeExplicitLoaders:!0,
flattenedSortBy:a.flattenedSortBy,flattenedSortOrder:a.flattenedSortOrder});a.view.scrollTo({replyId:c})}).fail(function(){a.view.indicateRemovedReplies({replyId:c})})});x.subscribe("ui.replies.vote.message",function(a){a=e(a.target);e.fn.evolutionTip.hide();a.hasClass("selected")?x.publish("ui.replies.unvote",{replyId:a.data("replyid")}):x.publish("ui.replies.vote",{replyId:a.data("replyid"),value:a.data("value")})});x.subscribe("ui.replies.vote",function(b){a.model.voteReply({replyId:b.replyId,
value:b.value}).then(function(c){a.view.updateVotes({replyId:b.replyId,yesVotes:c.yesVotes,noVotes:c.noVotes,value:c.value})})});x.subscribe("ui.replies.unvote",function(b){a.model.voteReply({replyId:b.replyId}).then(function(c){a.view.updateVotes({replyId:b.replyId,value:null})})})}function h(a,b,c){b=b||"root";a.blockedReplies||(a.blockedReplies={});a.blockedReplies[b]||(a.blockedReplies[b]=d.setTimeout(function(){delete a.blockedReplies[b]},c||2E3))}function v(a,b){return a.blockedReplies&&a.blockedReplies[b||
"root"]}function s(a){var b={sortBy:a.sortBy,sortOrder:a.sortOrder,filter:a.filter,initial:!0};a.replyId&&(b.replyId=a.replyId);a.replyOffsetId&&a.replyOffsetDirection&&("Previous"==a.replyOffsetDirection?b.endReplyId=a.replyOffsetId:b.startReplyId=a.replyOffsetId);return b}function w(a){var b=s(a);b.includeSiblings=!0;return a.model.listReplies(b).then(function(a){return a})}function r(a){a.headerContentRendered||(a.headerContentRendered=!0,a.headerContent&&a.view.appendHeaderContent(a.headerContent))}
var x=e.telligent.evolution.messaging,y={};return function(a){var c=e.extend({},y,a||{});c.replyId&&c.loadOnScroll&&(c.delayLoadOnScroll=!0);b(c);l(c);a=w(c);p(c);t(c);q(c);c.view.showLoading();a.then(function(a){a.replies&&0<a.replies.length&&r(c);c.view.empty();if(c.includeFirstPageOnPermalinks&&c.replyId&&!a.initialPage){var b=s(c);delete b.replyId;c.model.listReplies(b).then(function(b){e.telligent.evolution.ui.defer(e(".content-list.threaded").get(0),function(){c.view.renderReplies({replies:b.replies,
sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:c.flattenedSortBy,flattenedSortOrder:c.flattenedSortOrder,appendOnly:!0});c.view.renderReplies({replies:a.replies,permaLinked:c.replyId,sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:c.flattenedSortBy,flattenedSortOrder:c.flattenedSortOrder,includeExplicitLoaders:!0})});setTimeout(function(){c.preFocus&&c.view.showReplyForm({replyId:c.replyId,focus:!0});c.view.scrollTo({replyId:c.replyId,highlight:!0})},300)})}else c.view.renderReplies({replies:a.replies,
permaLinked:a.initialPage?!1:c.replyId,sortBy:c.sortBy,sortOrder:c.sortOrder,flattenedSortBy:c.flattenedSortBy,flattenedSortOrder:c.flattenedSortOrder,appendOnly:!0}),c.replyId&&setTimeout(function(){c.preFocus&&c.view.showReplyForm({replyId:c.replyId,focus:!0});c.view.scrollTo({replyId:c.replyId,highlight:!0})},300);c.model.filterChange(s(c))});return{}}},jQuery,window);u("plugin.evolutionThreadReplies",["plugin.evolutionThreadReplies.controller"],function(g,f,k,m){var n={replyId:null,sortBy:null,
sortOrder:null,flattenedSortBy:null,flattenedSortOrder:null,replyOffsetId:null,replyOffsetDirection:null,preFocus:!1,headerContent:null,replyIdQueryStringKey:null,replySortByQueryStringKey:null,replyFilterQueryStringKey:null,replySortOrderQueryStringKey:null,threadUrl:"",pageSize:0,loadOnScroll:!1,onListReplies:function(e){},onListVoters:function(e){},onAddReply:function(e){},onEditReply:function(e){},onGetReply:function(e){},onVoteReply:function(e){},onFilterChange:function(e){},onDeletePrompt:function(e){},
onEditorAppendTo:function(e){},onEditorRemove:function(e){},onEditorVal:function(e){},onEditorFocus:function(e){},onInit:function(e){},replyTemplate:null,loadMoreTemplate:null,typingIndicatorTemplate:null,newRepliesTemplate:null,replyListTemplate:null,replyFormTemplate:null,highlightClassName:"new",loadMoreSelector:".load-more",loadMoreLinkSelector:".load-more a",loadMoreNextSelector:".load-more.next",loadMorePreviousSelector:".load-more.previous",containerSelector:"ul.content-list.threaded",replySelector:"li.threaded.content-item",
permalinkSelector:".reply-permalink",newReplySelector:"a.new-reply",submitReplySelector:"a.submit-new-reply",cancelReplySelector:"a.cancel-new-reply",renderedContentSelector:".rendered-content",wrapper:"",container:"",includeFirstPageOnPermalinks:!1,baseLoadIndicatorsOnSiblings:!1,highlightNewReplySeconds:4};f.fn.evolutionThreadedReplies=function(e){var d=f.extend({},n,e||{});return f(this).each(function(){new g(d)})};f.fn.evolutionThreadedReplies.defaults=n;return{}},jQuery,window);u("plugin.evolutionThreadReplies.model",
function(g,f,k){function m(e){if(e.onInit)e.onInit({raiseTypingStart:function(d){if(e.shouldHandleLiveMutations()&&e.onTypingStarted)e.onTypingStarted(d)},raiseReplyCreated:function(d){if(e.shouldHandleLiveMutations()&&e.onReplyCreated)e.onReplyCreated(d)},raiseReplyUpdated:function(d){if(e.onReplyUpdated)e.onReplyUpdated(d)},raiseVote:function(d){if(e.onVote)e.onVote(d)},raiseReplyDeleted:function(d){if(e.onReplyDeleted)e.onReplyDeleted(d)},attemptDelete:function(d){if(e.onAttemptDelete)e.onAttemptDelete(d)},
attemptTyping:function(d){if(e.onAttemptTyping)e.onAttemptTyping(d)},attemptCreate:function(d){if(e.onAttemptCreate)e.onAttemptCreate(d)},attemptUpdate:function(d){if(e.onAttemptUpdate)e.onAttemptUpdate(d)},showReplyForm:function(d){if(e.onShowReplyForm)e.onShowReplyForm(d||{})}})}var n={onListReplies:function(e){},onListVoters:function(e){},onAddReply:function(e){},onEditReply:function(e){},onGetReply:function(e){},getReply:function(e){},onTyping:function(e){},onInit:function(e){},onTypingStarted:function(e){},
onReplyCreated:function(e){},onReplyUpdated:function(e){},onVote:function(e){},onReplyDeleted:function(e){}};return function(e){var d=g.extend({},n,e||{});m(d);return{listReplies:function(c){if(d.onListReplies)return d.onListReplies(c)},listVoters:function(c){if(d.onListVoters)return d.onListVoters(c)},addReply:function(c){if(d.onAddReply)return d.onAddReply(c)},editReply:function(c){if(d.onEditReply)return d.onEditReply(c)},getReply:function(c){if(d.onGetReply)return d.onGetReply(c)},voteReply:function(c){if(d.onVoteReply)return d.onVoteReply(c)},
filterChange:function(c){if(d.onFilterChange)return d.onFilterChange(c)},type:function(c){if(d.onTyping)return d.onTyping(c)}}}},jQuery,window);u("plugin.evolutionThreadReplies.navigator",function(g,f,k){function m(e){var d=g.telligent.evolution.url.parseQuery(f.location.href),c=g.extend({replySortBy:e.defaultReplySortByQueryStringValue,replySortOrder:e.defaultReplySortOrderQueryStringValue,replyFilter:null},{replySortBy:d[e.replySortByQueryStringKey],replyFilter:d[e.replyFilterQueryStringKey],replySortOrder:d[e.replySortOrderQueryStringKey]});
if(e.onParseReplyId){var b=e.onParseReplyId();b!==k&&(null!==b&&!1!==b)&&(c.replyId=b)}var a=c.replyId&&e.currentFilter;e.currentSortBy=c.replySortBy;e.currentSortOrder=c.replySortOrder;e.currentFilter=c.replyFilter;c.replySortBy&&c.replySortOrder&&d[e.replySortByQueryStringKey]&&d[e.replySortOrderQueryStringKey]?(e.onAdjustGlobalSort({sortBy:c.replySortBy,sortOrder:c.replySortOrder,filter:c.replyFilter}),e.onLoadReplies(c).then(function(a){if(a&&a.replies&&e.onRenderReplies)e.onRenderReplies(a.replies,
{sortBy:c.replySortBy,sortOrder:c.replySortOrder,filter:c.replyFilter})})):c.replyId&&(e.onAdjustGlobalSort({sortBy:c.replySortBy,sortOrder:c.replySortOrder,filter:c.replyFilter}),e.onLoadReply(c).then(function(b){if(b&&b.replies&&e.onRenderReply)e.onRenderReply(b.replies,c.replyId,{sortBy:c.replySortBy,sortOrder:c.replySortOrder,filter:c.replyFilter,resetFilter:a})}))}var n={onParseReplyId:function(){},onGenerateReplyUrl:function(){},replySortByQueryStringKey:"",replyFilterQueryStringKey:"",replySortOrderQueryStringKey:"",
defaultReplySortByQueryStringValue:null,defaultReplySortOrderQueryStringValue:null,onLoadReply:function(e){},onLoadReplies:function(e){},onRenderReply:function(e,d){},onRenderReplies:function(e){}};return function(e){var d=g.extend({},n,e||{});g.extend(d,{currentSortBy:e.initialSortBy,currentSortOrder:e.initialSortOrder,currentFilter:e.initialFilter});var c=f.location.pathname;g(f).on("popstate",function(b){f.location.pathname!=c&&m(d);c=f.location.pathname});return{navigate:function(b){if(b.url)history.pushState({},
"",b.url);else{b.replyId&&(delete b.replySortOrder,delete b.replySortBy,delete b.replyFilter);var a={},c=null;b.replyId&&null!==b.newUrl&&b.newUrl!==k?c=d.onGenerateReplyUrl(b.replyId):(b.replySortBy&&(a[d.replySortByQueryStringKey]=b.replySortBy),b.replySortOrder&&(a[d.replySortOrderQueryStringKey]=b.replySortOrder),b.replyFilter&&(a[d.replyFilterQueryStringKey]=b.replyFilter),c=g.telligent.evolution.url.modify({url:f.location.href,query:a}));history.pushState({},"",c)}m(d)}}}},jQuery,window);u("plugin.evolutionThreadReplies.indicatorRegistrarView",
["plugin.evolutionThreadReplies.indicatorView"],function(g,f,k,m){var n={container:null,onGetExistingRenderedReply:function(e){},template:null};return function(e){var d=f.extend({},n,e||{},{indicators:{},offscreenIndicator:null});return{increment:function(c){var b=d.indicators[c.parentId];if(!b){var a=d.onGetExistingRenderedReply(c.parentId);a&&0<a.length&&(b=new g({container:a.find(".new-replies-wrapper").first(),template:d.template}),d.indicators[c.parentId]=b)}b&&b.increment(f.extend(c,{width:d.container.width()}));
b&&b.isVisible()||(d.offscreenIndicatorContainer=d.offscreenIndicatorContainer||f("<div></div>").prependTo(d.container),d.offscreenIndicator||(d.offscreenIndicator=new g({container:d.offscreenIndicatorContainer,offscreen:!0,template:d.template}),d.indicators.offscreen=d.offscreenIndicator),d.offscreenIndicator.increment(f.extend(c,{width:d.container.width()})));f.telligent.evolution.notifications.unread("+1",{isLocal:!0,namespace:"evolutionThreadReplies"})},isIndicating:function(c){return(c=d.indicators[c])?
c.isIndicating():!1},decrement:function(c){f.each(d.indicators,function(b,a){a.decrement(f.extend(c,{width:d.container.width()}))||(a.remove(),delete a[b])});f.telligent.evolution.notifications.unread("-1",{isLocal:!0,namespace:"evolutionThreadReplies"})}}}},jQuery,window);u("plugin.evolutionThreadReplies.indicatorView",["plugin.evolutionThreadReplies.utility"],function(g,f,k,m){var n={container:null,offscreen:!1,parentId:null,template:null};return function(e){var d=f.extend({},n,e||{},{replyStack:[]});
return{increment:function(c){var b=c.replyId.toString();0<d.replyStack.indexOf(b)||(d.replyStack.push(b),d.container.empty(),c=f(d.template({newReplies:d.replyStack.length,replyId:d.replyStack[0],offscreen:d.offscreen,width:c.width||100})),d.container.append(c))},decrement:function(c){var b=d.replyStack.indexOf(c.replyId.toString());0<=b&&d.replyStack.splice(b,1);return 0<d.replyStack.length?(d.container.empty(),c=f(d.template({newReplies:d.replyStack.length,replyId:d.replyStack[0],offscreen:d.offscreen,
width:c.width||100})),d.container.append(c),!0):!1},isIndicating:function(){return d.replyStack&&0<d.replyStack.length},isVisible:function(){return g.isFullyVisible(document,d.container,100)},remove:function(){d.container.empty()}}}},jQuery,window);u("plugin.evolutionThreadReplies.repliesView",["plugin.evolutionThreadReplies.indicatorRegistrarView","plugin.evolutionThreadReplies.utility","lib.util"],function(g,f,k,m,n,e){function d(a){m(document).on("scrollend",function(){if(!a.scrolling&&!a.loadingPage){var b=
a.container.find(a.loadMoreNextSelector+" a").last(),c=!1;b.parents(a.replySelector).each(function(){var b=m(this).next(a.replySelector);b&&0<b.length&&(c=!0)});c||b.trigger("click")}})}function c(a){a.wrapper=m(a.wrapper);a.container=m(a.container);a.headerContainer=m('<div class="reply-header"></div>').appendTo(a.container);r(a);a.replyTemplate=m.telligent.evolution.template(a.replyTemplate);a.loadMoreTemplate=m.telligent.evolution.template(a.loadMoreTemplate);a.typingIndicatorTemplate=m.telligent.evolution.template(a.typingIndicatorTemplate);
a.newRepliesTemplate=m.telligent.evolution.template(a.newRepliesTemplate);a.replyListTemplate=m.telligent.evolution.template(a.replyListTemplate);a.replyFormTemplate=m.telligent.evolution.template(a.replyFormTemplate);a.loadOnScroll&&!a.delayLoadOnScroll&&d(a);a.newRepliesIndicatorRegistrar=new g({container:a.container,onGetExistingRenderedReply:function(b){return a.root?s(a,a.root,b):null},template:a.newRepliesTemplate})}function b(b){b.wrapper.on("click","a.navigable",function(a){a.stopPropagation();
a.preventDefault();a=m(this).attr("href");m.telligent.evolution.messaging.publish("ui.replies.navigate",{url:a});return!1});b.wrapper.on("click",b.loadMoreLinkSelector,function(a){a.preventDefault();b.delayLoadOnScroll&&(b.loadOnScroll&&!b.loadOnScrollInited)&&(b.loadOnScrollInited=!0,d(b));var c=!1;"inline"==m(a.target).data("inline")&&(c=!0);var e=m(this).closest(b.replySelector).data("id"),h=m(this).closest(b.containerSelector),f=m(this).hasClass("previous")?"previous":"next",g=null,q=null;if("previous"==
f)g=m(this).closest(b.loadMoreSelector).next(b.replySelector);else{var g=m(this).closest(b.loadMoreSelector).prev(b.replySelector),p=g.find(".explicitpager");p&&0<p.length&&(q=p.data("explicitpageindex"))}p=l(b,h);b.loadingPage=!0;m.telligent.evolution.messaging.publish("ui.replies.loadpage",{parentId:e,startReplyId:"next"==f&&g&&0<g.length?g.data("id"):null,endReplyId:"previous"==f&&g&&0<g.length?g.data("id"):null,offsetElement:g,currentDepth:p,sortBy:h.data("sortby"),sortOrder:h.data("sortorder"),
filter:h.data("filter"),explicitPageIndex:q,loadDirection:f,explicitContainer:h,loadInline:c});m(a.target).closest("li").addClass("loading");return!1});b.wrapper.on("click",b.newReplySelector,function(a){a.preventDefault();a=m(a.target);0==a.closest(b.replySelector).find(">.newreply .reply-form").length?(B(b,a.closest(b.replySelector).data("id"),!0),a.data("label-cancel")&&a.html(a.data("label-cancel"))):(A(b),a.data("label-reply")&&a.html(a.data("label-reply")));return!1});var c=f.debounce(function(){m.telligent.evolution.messaging.publish("ui.replies.interaction.stop")},
2E3,function(){a(b)}),e=f.debounce(function(){b.container.find("li.content-item."+b.highlightClassName).each(function(){var a=m(this);a.data("_unhighlighting")||(a.data("_unhighlighting",!0),n.setTimeout(function(){a.removeClass(b.highlightClassName)},b.highlightTimeout))})},250);m(n).on("scroll",k.requestAnimationFrameThrottle(function(){c();e()}))}function a(a){m.telligent.evolution.messaging.publish("ui.replies.interaction.start")}function l(a,b){var c=b.data("depth");if(null==c||c==e)c=b.parents(a.containerSelector).length+
1,b.data("depth",c);return c}function p(a,b,c){c.addClass(a.highlightClassName);f.isPartiallyVisible(document,c)&&n.setTimeout(function(){c.removeClass(a.highlightClassName)},a.highlightTimeout)}function t(a,b,c,d){b&&(c&&d)&&(c.addClass("pending"),b[d.direction](c))}function q(a,b){b.find(a.loadMoreSelector+".pending").each(function(){var c=m(this),d=c.find("a").first(),e=c.hasClass("previous")?"Previous":"Next",h=null,h="Previous"==e?c.next(a.replySelector):c.prev(a.replySelector),f=c.closest(a.containerSelector),
g=l(a,f),p=a.threadUrl;1<g&&(p=f.closest(a.replySelector).find(a.permalinkSelector).first().attr("href"));e=m.telligent.evolution.url.modify({url:p,query:{ReplyOffsetId:h&&0<h.length?h.data("id"):null,ReplyOffsetDirection:e,ReplySortBy:b.data("sortby"),ReplySortOrder:b.data("sortorder")}});d.attr("href",e);c.removeClass("pending")})}function h(a,b,c,d,e,g){var q=!1,k=!1,n=null,r=null;e.permaLinked&&(e.includeExplicitLoaders&&0<c.length)&&(k=!0);if(k){var y=a.baseLoadIndicatorsOnSiblings,x;x=null;
x=b.children(a.loadMoreNextSelector+"");null!==x&&0<x.length&&(n=x,a.baseLoadIndicatorsOnSiblings&&(y=!0));y&&(a.baseLoadIndicatorsOnSiblings?(y=c[0].PreviousSiblingCount,x=b.children(a.replySelector).length,y>x&&(y=w(a,b,"previous",{inlineOnly:!0}),y&&0!=y.length&&document.contains(y[0])||(r=w(a,b,"previous",{createOnly:!0}),t(a,b,r,{direction:"append"})))):(y=w(a,b,"previous",{inlineOnly:!0}),y&&0!=y.length&&document.contains(y[0])||(r=w(a,b,"previous",{createOnly:!0}),t(a,b,r,{direction:"append"}))))}for(y=
0;y<c.length;y++){x=c[y];var z=s(a,b,x.id);if(z){e.loadInline&&0<z.next("li.load-more[data-inline]").length&&(q=!0);x.isDeleted&&z.addClass("deleted");z.data("createddate",x.createdDate);z.data("yesvotes",x.yesVotes);z.data("novotes",x.noVotes);z.data("model",x);var A=z.find(".rendered-content").first();A.empty().append(x.body);A.get(0).className="rendered-content "+x.status}else{if(g&&0==d&&0==y||!k&&e.permaLinked&&!e.touchedPermaLink){var C=w(a,b,"previous");a.baseLoadIndicatorsOnSiblings?0<x.PreviousSiblingCount?
t(a,b,C,{direction:"prepend"}):C.remove():t(a,b,C,{direction:"prepend"})}C=l(a,b);x.sortBy=C>a.flattenedDepth+1?e.flattenedSortBy:e.sortBy;x.sortOrder=C>a.flattenedDepth+1?e.flattenedSortOrder:e.sortOrder;a:{var B=a,z=b,M=x,X=e.appendOnly,A=e.onlyIfVisible;M.filter=B.filter;var C=m(B.replyTemplate(M)),U=void 0,U=M,ba=C;ba.data(u+"votes",U.yesVotes-U.noVotes);ba.data(u+"createdDate",U.createdDateTicks||m.telligent.evolution.parseDate(U.createdDate).getTime());if(X)z.append(C),U=D.down;else if(X=z.children(B.replySelector),
B=v(B,X,M,C),B<X.length){if(A&&!f.isBottomVisible(document,m(X.get(B)))){C=!1;break a}z=C.get(0);A=X.get(B);A.parentNode.insertBefore(z,A);U=D.up}else{if(A&&!f.isBottomVisible(document,z)){C=!1;break a}z.append(C);U=D.down}C={renderedReply:C,appendDirection:U}}if(C)C.appendDirection===D.down&&null!==n?n.remove():C.appendDirection===D.up&&null!==r&&r.remove();else return r&&r.remove(),!1;e.addedCount++;z=C.renderedReply;z.data("model",x);e.permaLinked&&!e.touchedPermaLink&&(A=w(a,b,"next"),a.baseLoadIndicatorsOnSiblings?
0<x.NextSiblingCount?(B=z.nextAll(a.replySelector),x.NextSiblingCount>B.length&&t(a,b,A,{direction:"append"})):A.remove():t(a,b,A,{direction:"append"}));x.id==e.permaLinked&&(e.touchedPermaLink=!0);e.highlightNew&&p(a,b,z)}e.highlightPermaLinked&&x.id==e.permaLinked&&p(a,b,z);a.newRepliesIndicatorRegistrar.decrement({replyId:x.id});if(x.children&&0<x.children.length&&(z=z.find(a.containerSelector).first(),!h(a,z,x.children,d+1,e)))return!1}e.loadInline&&(g=w(a,b,"previous",{inlineOnly:!0}),a.baseLoadIndicatorsOnSiblings?
(q=c[0],g.prevAll(a.replySelector).length>=q.PreviousSiblingCount&&g.remove()):(c.length<a.pageSize||q)&&g.remove());q=0===d&&e.loadDirection?"previous"==e.loadDirection?"previous":"down":C&&C.appendDirection==D.up?"previous":"down";if(!e.loadInline||0<d)c.length>=a.pageSize?(c=w(a,b,q),a.baseLoadIndicatorsOnSiblings?"previous"==q?(q=b.children(a.replySelector).first().data("model"))&&0<q.PreviousSiblingCount&&t(a,b,c,{direction:"prepend"}):(q=b.children(a.replySelector).last().data("model"))&&0<
q.NextSiblingCount&&t(a,b,c,{direction:"append"}):"previous"==q?t(a,b,c,{direction:"prepend"}):t(a,b,c,{direction:"append"})):e.permaLinked||w(a,b,q).remove();return!0}function v(a,b,c,d){var e="Ascending"==c.sortOrder?1:-1;return f.determineInsertionIndex(b,d,function(a,b){a=m(a);b=m(b);if("CreatedDate"==c.sortBy)return aDate=a.data(u+"createdDate"),bDate=b.data(u+"createdDate"),aDate<bDate?-1*e:aDate>bDate?1*e:0;aDate=a.data(u+"createdDate");bDate=b.data(u+"createdDate");aVotes=a.data(u+"votes");
bVotes=b.data(u+"votes");return aVotes<bVotes?-1*e:aVotes>bVotes?1*e:aDate<bDate?-1:aDate>bDate?1:0},{equivalentBefore:!1})}function s(a,b,c){return(a=b.find('li.content-item[data-id="'+c+'"]').first())&&a.length?a:null}function w(a,b,c,d){d=m.extend({createOnly:!1,inlineOnly:!1},d||{});var e=null;d&&!d.createOnly&&(e="previous"==c?b.children(a.loadMorePreviousSelector+(d.inlineOnly?"[data-inline]":"")):b.children(a.loadMoreNextSelector+(d.inlineOnly?"[data-inline]":"")));return e&&0<e.length?(d&&
!d.inlineOnly&&e.detach(),e):m(a.loadMoreTemplate({previous:"previous"==c,loadInline:d&&d.createOnly}))}function r(a){a.onEditorRemove();delete a.root;var b=a.container.children(".reply-header").detach();a.container.empty().append(b)}function x(a,b){var c=s(a,a.container,b.replyId);c&&0<c.length&&(clearTimeout(a.currentlyScrollingTiemeout),a.scrolling=!0,b.highlight&&(a.container.find(".permalinked").removeClass("permalinked"),c.addClass("permalinked")),c=c.find(a.renderedContentSelector).first(),
f.scrollToElementIfNotVisible(document,c,130),a.currentlyScrollingTiemeout=setTimeout(function(){a.scrolling=!1},1E3))}function y(a){a.fadeOut(500,function(){a.remove()})}function z(a,b){a.root.find('li.content-item[data-parentid="'+b+'"]').each(function(){var b=m(this);z(a,b.data("id"));var c=b.prev(a.loadMorePreviousSelector);y(c);y(b)})}function A(a){a.onEditorRemove();a.container.find(".reply-form").each(function(){m(this).closest(".threaded.content-item").removeClass("hide-content").removeClass("edit")}).remove();
a=a.wrapper.find(a.newReplySelector);a.data("label-reply")&&a.html(a.data("label-reply"))}function B(b,c){A(b);var d=null;if((d=s(b,b.root,c).find(".newreply").first())&&0!=d.length){var e=d.find(".reply-form").first();0==e.length&&(e=m(b.replyFormTemplate({editingReplyId:null})),d.append(e));b.onEditorAppendTo({container:e.find(".editor").first()});b.onEditorFocus();a(b)}}var C={replyTemplate:null,loadMoreTemplate:null,typingIndicatorTemplate:null,newRepliesTemplate:null,highlightClassName:"new",
wrapper:null,container:null,highlightTimeout:4E3,flattenedDepth:null,loadOnScroll:!1,threadUrl:""},u="_evolutionThreadReplies:",D={up:1,down:2};return function(d){var g=m.extend({},C,d||{});c(g);b(g);return{renderReplies:function(a){return m.telligent.evolution.ui.defer(m(".content-list.threaded").get(0),function(){g.container.find(g.loadMoreSelector).removeClass("loading");var b=g.loadingPage=!1;g.root||(b=!0,g.root=m(g.replyListTemplate({sortBy:0==g.flattenedDepth?a.flattenedSortBy:a.sortBy,sortOrder:0==
g.flattenedSortOrder?a.flattenedSortOrder:a.sortOrder,filter:g.filter===e?g.onGetFilter():g.filter})).appendTo(g.container));var c=a.explicitContainer?a.explicitContainer:g.root;if(!a.explicitContainer&&a.replies&&0<a.replies.length&&a.replies[0].parentId){var d=s(g,g.root,a.replies[0].parentId);d&&(c=d.find(g.containerSelector).first())}d=l(g,c)-1;!a.explicitContainer&&d>g.flattenedDepth&&(c=c.parents(g.containerSelector).first());a.addedCount=0;b=h(g,c,a.replies,0,a,b);q(g,c);return{added:b,addedCount:a.addedCount}})},
empty:function(){return r(g)},scrollTo:function(a){return x(g,a)},indicateTyping:function(a){if(!g.newRepliesIndicatorRegistrar.isIndicating(a.parentId)){var b=s(g,g.root,a.parentId),b=null!==b?b.find(".typing-status-wrapper").first():g.wrapper.find(".typing-status-wrapper").first();a.typing?b.empty().append(g.typingIndicatorTemplate({displayName:a.authorDisplayName})):b.empty()}},indicateNewReplies:function(a){g.root&&s(g,g.root,a.parentId);g.newRepliesIndicatorRegistrar.increment({parentId:a.parentId,
replyId:a.replyId})},indicateRemovedReplies:function(a){g.newRepliesIndicatorRegistrar.decrement({replyId:a.replyId})},updateVotes:function(a){var b=s(g,g.root,a.replyId);b&&0<b.length&&(b=b.find(".votes").first(),!0===a.value?(b.find("a.vote").removeClass("selected"),b.find(".up").first().addClass("selected")):!1===a.value?(b.find("a.vote").removeClass("selected"),b.find(".down").first().addClass("selected")):null===a.value&&b.find("a.vote").removeClass("selected"),a.yesVotes!==e&&a.noVotes!==e&&
(a=a.yesVotes-a.noVotes,b.find(".vote.current").html(0<a?"+"+a:a)))},renderEdit:function(b){var c=s(g,g.root,b.replyId);if(c&&0<c.length){c.addClass("hide-content").addClass("edit");A(g);var c=c.find(".edit-form").first(),d=c.find(".reply-form").first();0==d.length&&(d=m(g.replyFormTemplate({editingReplyId:b.replyId})),c.append(d));g.onEditorAppendTo({container:d.find(".editor").first()});g.onEditorVal({val:b.reply.rawBody,meta:b.reply});g.onEditorFocus();a(g)}},isContainerVisible:function(a){g.root?
(a=s(g,g.root,a.parentId),a&&0!=a.length||(a=g.root),a=f.isPartiallyVisible(document,a)):a=!1;return a},isReplyRendered:function(a){a=g.root?(a=s(g,g.root,a.replyId))&&0<a.length:!1;return a},hideReplyForms:function(){return A(g)},removeReply:function(a){g.onEditorRemove();if(g.root){var b=s(g,g.root,a.replyId);if(0<b.length){var c=b.prev(g.loadMorePreviousSelector);y(c)}y(b);z(g,a.replyId);g.newRepliesIndicatorRegistrar.decrement({replyId:a.replyId});a=void 0}else a=!1;return a},showReplyForm:function(a){return B(g,
a.replyId)},appendHeaderContent:function(a){g.headerContainer.append(a)},showLoading:function(){g.container.append('<span class="ui-loading" data-width="48" data-height="48"></span>')}}}},jQuery,window);u("plugin.evolutionThreadReplies.utility",function(g,f,k){var m={throttle:function(g,e){var d,c;return function(){var b=this,a=(new Date).getTime(),l=arguments;d&&d+(e||50)>a?(f.clearTimeout(c),c=f.setTimeout(function(){d=a;g.apply(b,l)},e||50)):(d=a,g.apply(b,l))}},debounce:function(g,e,d){var c;
return function(){var b=this,a=arguments;d&&!c&&d.apply(b,a);clearTimeout(c);c=null;c=setTimeout(function(){g.apply(b,a);clearTimeout(c);c=null},e||10)}},determineInsertionIndex:function(g,e,d,c){if(null==g||0===g.length||null===e)return 0;var b=0,a=g.length,f,p;f=d(e,g[b]);p=a-1===b?f:d(e,g[a-1]);if(0>f)return b;if(0===f)return c&&c.equivalentBefore?b:b+1;if(0<p)return a;if(0===p)return c&&c.equivalentBefore?a-1:a;for(;b<a;){f=Math.floor((b+a)/2);p=d(g[f],e);if(0===p)return c&&c.equivalentBefore?
f:f+1;0>p?b=f+1:a=f}return b},isPartiallyVisible:function(k,e,d){d=d||0;if(k==document||k instanceof jQuery&&(k.get(0)==document||k.is("body"))){var c=e instanceof jQuery?e.get(0).getBoundingClientRect():e.getBoundingClientRect();return 0<c.top-d&&c.top+d<=(f.innerHeight||document.documentElement.clientHeight)||0<c.bottom-d&&c.bottom+d<=(f.innerHeight||document.documentElement.clientHeight)}k=g(k);c=e.offset().top;e=c+e.height();var b=k.offset().top;k=b+k.height();return c+d>=b&&c-d<=k||e-d<=k&&e+
d>=b},isFullyVisible:function(k,e,d){d=d||0;if(k==document||k instanceof jQuery&&(k.get(0)==document||k.is("body"))){var c=e instanceof jQuery?e.get(0).getBoundingClientRect():e.getBoundingClientRect();return 0<c.top-d&&c.top+d<=(f.innerHeight||document.documentElement.clientHeight)&&0<c.bottom-d&&c.bottom+d<=(f.innerHeight||document.documentElement.clientHeight)}k=g(k);c=e.offset().top;e=c+e.height();var b=k.offset().top;k=b+k.height();return c+d>=b&&e-d<=k},isBottomVisible:function(k,e,d){d=d||
0;if(k==document||k instanceof jQuery&&(k.get(0)==document||k.is("body"))){var c=e instanceof jQuery?e.get(0).getBoundingClientRect():e.getBoundingClientRect();return 0<c.bottom-d&&c.bottom+d<=(f.innerHeight||document.documentElement.clientHeight)}k=g(k);c=k.scrollTop();k=c+k.height();e=e.offset().top+e.height();return e-d<=k&&e+d>=c},isTopVisible:function(k,e,d){d=d||0;if(k==document||k instanceof jQuery&&(k.get(0)==document||k.is("body"))){var c=e instanceof jQuery?e.get(0).getBoundingClientRect():
e.getBoundingClientRect();return 0<c.top-d&&c.top+d<=(f.innerHeight||document.documentElement.clientHeight)}k=g(k);c=k.scrollTop();k=c+k.height();e=e.offset().top;return e+d<=k&&e-d>=c},scrollToElementIfNotVisible:function(f,e,d,c){d=d||0;c=c||100;m.isFullyVisible(f,e,d)||(f=g(f),f.get(0)==document&&(f=g("html, body")),f.stop().animate({scrollTop:e.offset().top-d},c))}};return m},jQuery,window);u("plugin.evolutionThreadReplies.votersPopup",function(g,f,k){var m={votersTemplate:' <% if(voters && voters.length > 0) { %> \t<% foreach(voters, function(voter) { %> \t\t<li class="content-item"> \t\t\t<div class="full-post-header"></div> \t\t\t<div class="full-post"> \t\t\t\t<span class="avatar"> \t\t\t\t\t<a href="<%: voter.profileUrl %>"  class="internal-link view-user-profile"> \t\t\t\t\t\t<% if(voter.avatarHtml) { %> \t\t\t\t\t\t\t<%= voter.avatarHtml %> \t\t\t\t\t\t<% } else { %> \t\t\t\t\t\t\t<img src="<%: voter.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" /> \t\t\t\t\t\t<% } %> \t\t\t\t\t</a> \t\t\t\t</span> \t\t\t\t<span class="user-name"> \t\t\t\t\t<a href="<%: voter.profileUrl %>" class="internal-link view-user-profile"><%= voter.displayName %></a> \t\t\t\t</span> \t\t\t</div> \t\t\t<div class="full-post-footer"></div> \t\t</li> \t<% }); %> <% } else { %> \t<li> \t\t<span class="content"><%= noVotesText %></span> \t</li> <% } %>',
votersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= voters %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> ',noVotesText:"No Votes",delegatedSelector:".votes .current",modalTitleText:"",modalShowMoreText:"More",loadVoters:function(f){}};return function(f){var e=g.extend({},m,f||{}),d=g.extend({},m,f||{}),
c=g.telligent.evolution.template.compile(d.votersTemplate),b=g.telligent.evolution.template.compile(d.votersPopupTemplate),a=function(a,b,c){e.loadVoters({replyId:a.replyid,pageIndex:b}).then(function(a){g.telligent.evolution.batch(function(){g.each(a.Users,function(a,b){g.telligent.evolution.get({url:g.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ui/image.json",data:{url:b.AvatarUrl,maxWidth:32,maxHeight:32,resizeMethod:"ZoomAndCrop"}}).then(function(a){b.userAvatarHtml=a.Html})})}).then(function(){c({voters:g.map(a.Users,
function(a){return{displayName:a.DisplayName,profileUrl:a.ProfileUrl,avatarHtml:a.userAvatarHtml}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})})})},l=function(e,f){var l=0,h=g(c(g.extend(e,{noVotesText:d.noVotesText||m.noVotesText}))),k=g.telligent.evolution.ui.data(g(f)),s=g(b({voters:h,hasMorePages:e.hasMorePages,showMoreText:d.modalShowMoreText})),n=s.find("ul"),r=s.find(".show-more");n.html(h);r.on("click",function(b){b.preventDefault();l++;a(k,l,function(a){n.append(c(a));a.hasMorePages?
r.show():r.hide();n.scrollTop(n[0].scrollHeight)})});g.glowModal({title:d.modalTitleText,html:s,width:450,height:"100%"})};return{handleVoterPopupRequests:function(b){g(b.container).on("click",d.delegatedSelector,function(b){b.preventDefault();var c=g(this);b=g.telligent.evolution.ui.data(g(c));a(b,0,function(a){l(a,c)});return!1})}}}},jQuery,window);u("plugin.evolutionTip",["module.html"],function(g,f,k,m){function n(g,k){e();for(var q=f(g),h=["data-"+k.attribute,"title","alt"],m,s,n=0;n<h.length;n++){m=
h[n];var r=q.attr(m);if(r&&0<f.trim(r).length){s=f("<div>"+(r||"")+"</div>").text();break}}s&&0!=s.length&&(d={attribute:m,content:s,element:q,options:k,ui:f(k.template({content:s})).css({position:"absolute",top:-500,left:-500}).appendTo("body")},"title"!=d.attribute&&"alt"!=d.attribute||d.element.attr(d.attribute,""),s=f(window),m=f(document).scrollTop(),h=q.offset(),targetWidth=q.outerWidth(),targetHeight=q.outerHeight(),windowWidth=s.outerWidth(),windowHeight=s.outerHeight(),tipWidth=d.ui.outerWidth(),
tipHeight=d.ui.outerHeight(!0),k.horizontal?q=k.horizontal:(q=a.center,h.left-tipWidth/2<=b?q=a.left:windowWidth-(h.left+targetWidth+tipWidth/2)<=b&&(q=a.right)),k.vertical?s=k.vertical:(s=l.above,targetHeight+h.top-tipHeight-m<=b&&(s=l.below)),m=q==a.right?h.left+targetWidth-tipWidth:q==a.left?h.left:h.left+targetWidth/2-tipWidth/2,h=s==l.above?h.top-tipHeight:h.top+targetHeight,d.options.shown=!0,d.ui.addClass(s).addClass(q).css({left:m,top:h,"z-index":1E6}),clearInterval(c),c=setInterval(function(){d&&
d.element&&d.element.is(":visible")||e()},200))}function e(){d&&(d.ui.remove(),"title"!=d.attribute&&"alt"!=d.attribute||d.element.attr(d.attribute,g.encode(d.content)),d.options.shown=!1);clearInterval(c)}var d,c,b=30,a={left:"left",center:"center",right:"right"},l={above:"above",below:"below"};f.fn.evolutionTip=function(a){var b=f.extend({},f.fn.evolutionTip.defaults,a||{});b.template=f.telligent.evolution.template.compile(b.template);return this.off("._evolutionTip").on("mouseenter._evolutionTip mouseover._evolutionTip focus._evolutionTip",
function(a){a.originalEvent&&(a.originalEvent._evolutionTipHandled||b.shown||n(this,b),a.originalEvent._evolutionTipHandled=!0)}).on("mouseleave._evolutionTip blur._evolutionTip",function(){b.shown&&e()})};f.fn.evolutionTip.hide=function(){e()};f.fn.evolutionTip.defaults={template:'<div class="tip"><%: content %></div>',attribute:"tip"};return{}},jQuery,window);u("plugin.evolutionToggleLink",function(g,f,k){var m={val:function(d){if(void 0===d){var c=this.data("evolutionToggleLink");return c?c.settings.val:
!1}return this.each(function(){var b=g(this).data("evolutionToggleLink");b&&(b.settings.val=d,b.internal.processing=!1,e(b))})}},n=function(d){return this.each(function(){var c={settings:g.extend({},g.fn.evolutionToggleLink.defaults,d||{}),internal:{state:g(this),processing:!1}};c.internal.state.data("evolutionToggleLink",c).on("click",function(b){!c.internal.processing&&c.settings.changeState&&(c.internal.processing=!0,e(c),c.settings.changeState(!c.settings.val));return!1});e(c)})},e=function(d){d.internal.processing?
d.internal.state.attr("class",d.settings.processingCssClass).attr("title",d.settings.processingTitle).html(d.settings.processingHtml):d.settings.val?d.internal.state.attr("class",d.settings.onCssClass).attr("title",d.settings.onTitle).html(d.settings.onHtml):d.internal.state.attr("class",d.settings.offCssClass).attr("title",d.settings.offTitle).html(d.settings.offHtml)};g.fn.evolutionToggleLink=function(d){if(d in m)return m[d].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof d&&
d)g.error("Method "+d+" does not exist on jQuery.fn.evolutionToggleLink");else return n.apply(this,arguments)};g.extend(g.fn.evolutionToggleLink,{defaults:{onHtml:"",offHtml:"",processingHtml:"",changeState:null,onCssClass:"",offCssClass:"",processingCssClass:"",onTitle:"",offTitle:"",processingTitle:"",val:!1}});return{}},jQuery,window);u("plugin.evolutionTokenTextBox",function(g,f,k){function m(b){var a=b.internal.textbox.val(),c="",d=0;b.internal.tokens.sort(function(a,b){return a.start-b.start});
for(var e=0;e<b.internal.tokens.length;e++){var f=b.internal.tokens[e];f.start>d&&(c+=a.substr(d,f.start-d));c+=f.value;d=f.stop}d<a.length&&(c+=a.substr(d));b.internal.state.val(c);b.internal.lastLength=b.internal.textbox.val().length;b.internal.textbox.evolutionHighlight({ranges:b.internal.tokens})}function n(b){var a=b.internal.textbox.get(0);if(a.selectionStart)return a.selectionStart;if(document.selection){b=document.selection.createRange();if(null===b)return 0;var a=a.createTextRange(),c=a.duplicate();
a.moveToBookmark(b.getBookmark());c.setEndPoint("EndToStart",a);return c.text.length}return 0}function e(b){for(var a=/\$\{token:([0-9a-f]{8,8}-[0-9a-f]{4,4}-[0-9a-f]{4,4}-[0-9a-f]{4,4}-[0-9a-f]{12,12})(?::([^}]*))?\}/gi,c,e=0,f="",g=b.internal.state.val(),h=[],k=0;c=a.exec(g);){var s=c.index;s>e&&(f+=g.substr(e,s-e));e=c[0];s=d[e];!s&&b.settings.previewToken&&(s=b.settings.previewToken(e));s||(s=e);h.push({start:c.index-k,stop:c.index-k+s.length,value:e,text:s,className:b.settings.highlightClassName});
k+=e.length-s.length;f+=s;e=a.lastIndex}e<g.length&&(f+=g.substr(e));b.internal.tokens=h;b.internal.textbox.val(f);m(b)}var d={},c={init:function(b){return g(this).each(function(){b.tokenPlaceholders&&(d=g.extend({},d,b.tokenPlaceholders),delete b.tokenPlaceholders);var a={settings:g.extend({},g.fn.evolutionTokenTextBox.defaults,b),internal:{state:g(this),textbox:g(this).clone().removeAttr("id").removeAttr("name").css("box-sizing","content-box"),lastLength:g(this).val().length,tokens:[]}};a.internal.state.after(a.internal.textbox).hide().data("_evolutionTokenTextBox",
a);a.internal.textbox.on("evolutionRangeClick",function(b,c){f.evolutionInsertEditTokenOptions={dataTypeIds:a.settings.tokenDataTypeIds,token:c.value,save:function(b,e){d[b]=e;var h=a.internal.textbox.val(),h=h.substr(0,c.start)+e+h.substr(c.stop);a.internal.textbox.val(h);var f=c.stop,l=e.length-c.text.length;c.stop=c.start+e.length;c.value=b;c.text=e;g.each(a.internal.tokens,function(){this.start>=f&&(this.start+=l,this.stop+=l)});m(a)},del:function(){var b=a.internal.textbox.val(),b=b.substr(0,
c.start)+b.substr(c.stop),d=c.stop-c.start,e=c.start;a.internal.textbox.val(b);a.internal.tokens=g.grep(a.internal.tokens,function(a){return a.start!=e});g.each(a.internal.tokens,function(){this.start>=e&&(this.start-=d,this.stop-=d)});m(a)}};g.glowModal(a.settings.insertEditTokenUrl,{width:a.settings.insertEditTokenModalWidth,height:a.settings.insertEditTokenModalHeight})});a.internal.textbox.evolutionResize().on("evolutionResize",function(){a.internal.textbox.evolutionHighlight("resize",a.internal.textbox.outerWidth(),
a.internal.textbox.outerHeight())});a.internal.textbox.on("keydown",function(b){var c=n(a),d=!1,e=null;(37>b.which||40<b.which)&&g.each(a.internal.tokens,function(){(this.start<c||this.start==c&&46==b.which)&&(this.stop>c||this.stop==c&&8==b.which)&&(d=!0,e=this)});if(d){if(8==b.which||46==b.which){var h=a.internal.textbox.val(),h=h.substr(0,e.start)+h.substr(e.stop),f=e.stop-e.start,k=e.start;a.internal.textbox.val(h);a.internal.tokens=g.grep(a.internal.tokens,function(a){return a.start!=k});g.each(a.internal.tokens,
function(){this.start>=k&&(this.start-=f,this.stop-=f)});m(a);h=a.internal.textbox.get(0);h.createTextRange?(h=h.createTextRange(),h.move("character",c>k?c-f:c),h.select()):h.selectionStart&&(h.focus(),h.setSelectionRange(c>k?c-f:c,c>k?c-f:c))}b.preventDefault();b.stopPropagation();return!1}});a.internal.textbox.on("keyup",function(){var b=a.internal.textbox.val().length;if(b!=a.internal.lastLength){var c=b-a.internal.lastLength;a.internal.lastLength=b;var d=n(a);g.each(a.internal.tokens,function(){this.start>=
d-1&&(this.start+=c,this.stop+=c)});m(a)}});e(a)})},val:function(b){if(b===k){var a=g(this).data("_evolutionTokenTextBox");return a?a.internal.state.val():""}return g(this).each(function(){var a=g(this).data("_evolutionTokenTextBox");a&&(a.internal.state.val(b),e(a))})},insertToken:function(){return g(this).each(function(){var b=g(this).data("_evolutionTokenTextBox");b&&(f.evolutionInsertEditTokenOptions={dataTypeIds:b.settings.tokenDataTypeIds,token:"",save:function(a,c){d[a]=c;var e=n(b);b.internal.textbox.val(b.internal.textbox.val().substr(0,
e)+c+b.internal.textbox.val().substr(e));g.each(b.internal.tokens,function(){this.start>=e&&(this.start+=c.length,this.stop+=c.length)});b.internal.tokens.push({start:e,stop:e+c.length,value:a,text:c,className:b.settings.highlightClassName});m(b)},del:function(){}},g.glowModal(b.settings.insertEditTokenUrl,{width:b.settings.insertEditTokenModalWidth,height:b.settings.insertEditTokenModalHeight}))})},tokenDataTypeIds:function(b){if(b===k){var a=g(this).data("_evolutionTokenTextBox");return a?a.settings.tokenDataTypeIds:
[]}return g(this).each(function(){var a=g(this).data("_evolutionTokenTextBox");a&&(a.settings.tokenDataTypeIds=b||[])})}};g.fn.evolutionTokenTextBox=function(b){if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)g.error("Method "+b+" does not exist on jQuery.evolutionHighlight");else return c.init.apply(this,arguments)};g.fn.evolutionTokenTextBox.defaults={highlightClassName:"token-highlight",insertEditTokenUrl:"",previewToken:function(b){return b},insertEditTokenModalWidth:400,
insertEditTokenModalHeight:500,tokenDataTypeIds:[],tokenPlaceholders:null};return{}},jQuery,window);u("plugin.evolutionTransform",function(g,f,k){function m(){var a=(document.body||document.documentElement).style,b="Moz webkit Webkit Khtml O ms".split(" ");if("string"==typeof a.transition)return!0;for(var c=0;c<b.length;c++)if("string"==typeof a[b[c]+"Transition"])return!0;return!1}function n(w,r){if(!this||0==this.length)return this;var x=w||{};r=r||{};var y=[],z,A,B=null,C=null,u=null,D=null;w=
[];null===v&&(v=m());this.each(function(){if(3!==this.nodeType){var m=g(this),I=!1,O=null,L=function(){f.clearTimeout(O);I||(I=!0,m.css({transition:"all 0s"}).off(".evolutionTransform"),r.complete&&r.complete())};m.off(".evolutionTransform").on("transitionend.evolutionTransform webkitTransitionEnd.evolutionTransform oTransitionEnd.evolutionTransform MSTransitionEnd.evolutionTransform",function(){L()});if(!v)return x.x&&(x.left=x.x),x.y&&(x.y=x.y),m.css(x);for(var H in n.defaults)r[H]||(r[H]=n.defaults[H]);
for(var E in x)H=x[E],E===e||E===c?(z=H,delete x[E]):E===d||E===b?(A=H,delete x[E]):E===a?(B=H,delete x[E]):E===l?(C=H,delete x[E]):E===p?(u=H,delete x[E]):E===t?(D=H,delete x[E]):(E==q?0===H?x[E]=1E-5:1===H&&(x[E]=0.99999):"number"===typeof H&&0==H%1&&(x[E]=H+"px"),y[y.length]=E);if(z!=k||A!=k)w[w.length]="translate3d("+(z||0)+"px, "+(A||0)+"px, 0px)";B!=k&&(w[w.length]="rotateZ("+B+"deg)");C!=k&&(w[w.length]="rotateX("+C+"deg)");u!=k&&(w[w.length]="rotateY("+u+"deg)");D!=k&&(w[w.length]="scale("+
D+")");0<w.length&&(H=s+"transform",mergedTransforms=w.join(" "),y[y.length]=H,x[H]=mergedTransforms,x.transform=mergedTransforms);H=g.fn.evolutionTransform.animationEnabled?r.duration/1E3+"s "+r.easing:"";transition=y.join(" "+H+", ")+" "+H;g.noop(this.offsetHeight);if(u||C)h=h||g("body").get(0),h.style[s+"perspective"]=r.perspective,h.style.perspective=r.perspective;this.style[s+"transition"]=transition;this.style.transition=transition;for(E in x)this.style[E]=x[E];O=f.setTimeout(function(){L()},
r.duration+100)}});return this}var e="x",d="y",c="left",b="top",a="rotate",l="rotateX",p="rotateY",t="scale",q="opacity",h,v=null,s=function(){if(!("getComputedStyle"in window))return"";var a=window.getComputedStyle(document.documentElement,"");return"-"+(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1]+"-"}();n.defaults={duration:0,easing:"linear",perspective:250,complete:null};g.fn.evolutionTransform=n;g.fn.evolutionTransform.animationEnabled=!0;g.fn.evolutionTransform.accelerated=
function(){null===v&&(v=m());return v};return{}},jQuery,window);u("plugin.evolutionUserFileTextBox",function(g,f,k){var m={},n=1,e=function(d){return this.each(function(){var c={settings:g.extend({},g.fn.evolutionUserFileTextBox.defaults,d||{}),internal:{state:this,preview:null,select:null,remove:null}};g.telligent.evolution.post({url:c.settings.endpoint,data:{m:"c"},success:function(b){c.internal.contextid=b.uploadContextId;c.internal.uploadurl=b.uploadUrl;b=g("<div></div>").attr("class",c.settings.cssClass);
c.internal.preview=g("<div></div>").attr("class",c.settings.previewCssClass);b.append(c.internal.preview);c.internal.select=g('<a href="#" class="upload"></a>').attr("id","userfiletextbox_"+(new Date).getTime()+"_"+n++).html(c.settings.selectText).glowUpload({fileFilter:null,uploadUrl:c.internal.uploadurl,renderMode:"link"}).on("glowUploadBegun",function(a){c.uploading=!0;c.internal.select.html("0%")}).on("glowUploadComplete",function(a,b){c.internal.select.html(c.settings.selectText);b&&0<b.name.length&&
g.telligent.evolution.post({url:c.settings.endpoint,data:{m:"f",ContextId:c.internal.contextid,FileName:b.name},success:function(a){c.internal.state.value=a.url;c.uploading=!1;c.internal.preview.html(a.previewHtml).slideDown(100);c.internal.remove.show()}})}).on("glowUploadFileProgress",function(a,b){c.internal.select.html(b.percent+"%")});b.append(c.internal.select);c.internal.remove=g('<a href="#" class="remove" style="margin-left: 1em;"></a>').html(c.settings.removeText).on("click",function(){c.internal.preview.html("").slideUp(100);
c.internal.state.value="";c.internal.remove.hide();return!1}).hide();b.append(c.internal.remove);var a=g(c.internal.state).val();a?(c.internal.remove.show(),g.telligent.evolution.post({url:c.settings.endpoint,data:{m:"p",Url:a},success:function(a){c.internal.preview.html(a.previewHtml).slideDown(100)}})):c.internal.preview.html("").hide();g(c.internal.state).data("evolutionUserFileTextBox",c).before(b).hide()}})})};g.fn.evolutionUserFileTextBox=function(d){if(d in m)return m[d].apply(this,Array.prototype.slice.call(arguments,
1));if("object"!==typeof d&&d)g.error("Method "+d+" does not exist on jQuery.fn.evolutionUserFileTextBox");else return e.apply(this,arguments)};g.extend(g.fn.evolutionUserFileTextBox,{defaults:{removeText:"",selectText:"",noFileText:"",initialPreviewHtml:"",cssClass:"user-file-url",previewCssClass:"user-file-url-preview",endpoint:""}});return{}},jQuery,window);u("plugin.validation",function(g,f,k){g.telligent||(g.telligent={});g.telligent.evolution||(g.telligent.evolution={});g.telligent.evolution.validation=
{registerExtensions:function(a){g.validator&&(g.validator.addMethod("passwordvalid",function(b,c){return this.optional(c)||b.match(a.passwordRegex)},a.passwordInvalidMessage),g.validator.addMethod("email",function(b,c){return this.optional(c)||b.match(RegExp(a.emailRegex))},a.emailInvalidMessage),g.validator.addMethod("url",function(b,c){return this.optional(c)||b.match(a.urlRegex)?!0:("http://"+b).match(a.urlRegex)?(g(c).val("http://"+b),!0):!1},a.urlInvalidMessage),g.validator.addMethod("emails",
function(b,c){for(var d=b.split(/[;,]/),e=!0,f=RegExp(a.emailRegex),g=0;g<d.length;g++)jQuery.trim(d[g]).match(f)||(e=!1);return this.optional(c)||e},a.emailsInvalidMessage),g.validator.addMethod("username",function(b,c){return this.optional(c)||b.match(a.usernameRegex)},a.usernameInvalidMessage),g.validator.addMethod("usernameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=
this.settings.messages[b.name].usernameexists;this.settings.messages[b.name].usernameexists=d.message;c="string"==typeof c&&{url:c}||c;var e=g.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsUsernameAvailable";c.url&&(e=c.url);if(d.old!==a){d.old=a;var f=this;this.startRequest(b);c=JSON.stringify({username:a||"",elementName:b.name});g.telligent.evolution.post({url:e,dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){b=f.findByName(c.d.ElementName)[0];
f.settings.messages[b.name].usernameexists=d.originalMessage;var e=!0===c.d.IsValid;if(e){var g=f.formSubmitted;f.prepareElement(b);f.formSubmitted=g;f.successList.push(b);f.showErrors()}else g={},c=c.d.ErrorMessage||f.defaultMessage(b,"usernameexists"),g[b.name]=d.message="function"===typeof c?c(a):c,f.showErrors(g);d.valid=e;f.stopRequest(b,e)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),g.validator.addMethod("emailexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";
var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].emailexists;this.settings.messages[b.name].emailexists=d.message;c="string"==typeof c&&{url:c}||c;var e=g.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsEmailAvailable";c.url&&(e=c.url);if(d.old!==a){d.old=a;var f=this;this.startRequest(b);c=JSON.stringify({email:a||"",elementName:b.name});g.telligent.evolution.post({url:e,
dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){b=f.findByName(c.d.ElementName)[0];f.settings.messages[b.name].emailexists=d.originalMessage;var e=!0===c.d.IsValid;if(e){var g=f.formSubmitted;f.prepareElement(b);f.formSubmitted=g;f.successList.push(b);f.showErrors()}else g={},c=f.customMessage(b.name,"emailexists")||c.d.ErrorMessage||f.defaultMessage(b,"emailexists"),g[b.name]=d.message="function"===typeof c?c(a):c,f.showErrors(g);d.valid=e;f.stopRequest(b,
e)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),g.validator.addMethod("groupnameexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(g.trim(a));if(0==d.length)return!0;var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].groupnameexists;this.settings.messages[b.name].groupnameexists=e.message;c=c.getParentId();d=JSON.stringify({groupName:d||
"",parentGroupId:c||"",elementName:b.name});if(e.old!==d){e.old=d;var f=this;this.startRequest(b);c=g.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsGroupNameAvailable";g.telligent.evolution.post({url:c,dataType:"json",contentType:"application/json; charset=utf-8",data:d,success:function(c){b=f.findByName(c.d.ElementName)[0];f.settings.messages[b.name].groupnameexists=e.originalMessage;var d=!0===c.d.IsValid;if(d){var g=f.formSubmitted;f.prepareElement(b);f.formSubmitted=
g;f.successList.push(b);f.showErrors()}else g={},c=c.d.ErrorMessage||f.defaultMessage(b,"groupnameexists"),g[b.name]=e.message="function"===typeof c?c(a):c,f.showErrors(g);e.valid=d;f.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":e.valid},void 0),g.validator.addMethod("wikipageexists",function(a,b,c){if(this.optional(b))return"dependency-mismatch";var d=encodeURIComponent(g.trim(a));if(0==d.length)return!0;var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]=
{});e.originalMessage=this.settings.messages[b.name].wikipageexists;this.settings.messages[b.name].wikipageexists=e.message;c=JSON.stringify({pageName:d||"",wikiId:c.wikiId||"",pageId:c.pageId||"",parentPageId:c.parentPageId()||"",elementName:b.name});if(e.old!==c){e.old=c;var f=this;this.startRequest(b);d=g.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsWikiPageNameAvailable";g.telligent.evolution.post({url:d,dataType:"json",contentType:"application/json; charset=utf-8",
data:c,success:function(c){b=f.findByName(c.d.ElementName)[0];f.settings.messages[b.name].wikipageexists=e.originalMessage;var d=!0===c.d.IsValid;if(d){var g=f.formSubmitted;f.prepareElement(b);f.formSubmitted=g;f.successList.push(b);f.showErrors()}else g={},c=c.d.ErrorMessage||f.defaultMessage(b,"wikipageexists"),g[b.name]=e.message="function"===typeof c?c(a):c,f.showErrors(g);e.valid=d;f.stopRequest(b,d)}});return"pending"}return this.pending[b.name]?"pending":e.valid},void 0),g.validator.addMethod("mailinglistnameexists",
function(a,b,c){if(""==g.trim(a))return this.optional(b);var d=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});d.originalMessage=this.settings.messages[b.name].mailinglistnameexists;this.settings.messages[b.name].mailinglistnameexists=d.message;c="string"==typeof c&&{url:c}||c;var e=g.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsMailingListNameAvailable";c.url&&(e=c.url);var f;c.id&&(f=c.id);if(d.old!==a){d.old=a;var l=this;
this.startRequest(b);c=JSON.stringify({mailingListName:a||"",existingMailingListId:f||"",elementName:b.name});g.telligent.evolution.post({url:e,dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){b=l.findByName(c.d.ElementName)[0];l.settings.messages[b.name].mailinglistnameexists=d.originalMessage;var e=!0===c.d.IsValid;if(e){var f=l.formSubmitted;l.prepareElement(b);l.formSubmitted=f;l.successList.push(b);l.showErrors()}else f={},c=c.d.ErrorMessage||l.defaultMessage(b,
"mailinglistnameexists"),f[b.name]=d.message="function"===typeof c?c(a):c,l.showErrors(f);d.valid=e;l.stopRequest(b,e)}});return"pending"}return this.pending[b.name]?"pending":d.valid},void 0),g.validator.addMethod("pattern",function(a,b,c){return this.optional(b)||null!=a.match(c||/.*/)},void 0))}};var m={addField:function(a,c,d,f){var l=this.data("evolutionValidation");if(l&&"undefined"!==typeof l){var p=g(a);e(p,this,!0);l.internal.fields[l.internal.fields.length]={selector:a,messageSelector:d,
isValid:!0,context:f,initialized:!1};p.data("_evolutionValidation",l).data("_evolutionValidationFieldIndex",l.internal.fields.length-1).data("_evolutionValidationOldValue","$$$$$NULL$$$$$").rules("add",c);try{p.on("input",function(){if(l.internal.hasAttemptedSubmit){window.clearTimeout(l.internal.keyPressValidationHandle);var a=this;l.internal.keyPressValidationHandle=window.setTimeout(function(){b(l,g(a))},499)}})}catch(k){}p.on("blur",function(){b(l,g(this))})}return this},addCustomValidation:function(a,
b,c,d,e){var f=this.data("evolutionValidation");if(f&&"undefined"!==typeof f){var g=f.internal.customValidations.length;f.internal.customValidations[g]={id:a,validationFunction:b,message:c,messageSelector:d,isValid:!0,context:e,initialized:!1};return function(){return l(f,g)}}},isValid:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var d=0;d<a.internal.fields.length;d++)a.internal.fields[d].initialized||b(a,g(a.internal.fields[d].selector),!0);for(d=0;d<a.internal.customValidations.length;d++)a.internal.customValidations[d].initialized||
l(a,d);return c(a)},validate:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var c=0;c<a.internal.fields.length;c++)b(a,g(a.internal.fields[c].selector),!0);for(c=0;c<a.internal.customValidations.length;c++)l(a,c);(c=this.closest("form").data("_evolutionValidation"))&&c.showErrors();return m.isValid.apply(g(a.internal.state),[])},validateField:function(a){try{var c=this.data("evolutionValidation"),d=b(c,g(a),!0),e=this.closest("form").data("_evolutionValidation");e&&e.showErrors();
return d}catch(f){}},validateCustom:function(a){var b=this.data("evolutionValidation");if(!b)return this;for(var c=0;c<b.internal.customValidations.length;c++)if(b.internal.customValidations[c].id==a)return l(b,c);return!0},reset:function(){var a=this.data("evolutionValidation");if(!a)return this;for(var b=0;b<a.internal.customValidations.length;b++)g(a.internal.customValidations[b].messageSelector).hide(),a.internal.customValidations[b].isValid=!0,a.internal.customValidations[b].initialized=!1;for(b=
0;b<a.internal.fields.length;b++)g(a.internal.fields[b].messageSelector).hide(),a.internal.fields[b].errorMessage=null,a.internal.fields[b].isValid=!0,a.internal.fields[b].initialized=!1,g(a.internal.fields[b].selector).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");a.internal.submitButtonClicked=!1;a.internal.hasAttemptedSubmit=!1;window.clearTimeout(a.internal.initialValidationHandle);a.internal.initialValidationHandle=window.setTimeout(function(){d(a)},249)}},n=function(a){return this.each(function(){var b=
{settings:g.extend({},g.fn.evolutionValidation.defaults,a||{}),internal:{state:this,submitButtonClicked:!1,hasAttemptedSubmit:!1,fields:[],customValidations:[],initialValidationHandle:null}};g(this).data("evolutionValidation",b);if(!g.fn.validate)throw"Validation API is not available";e(this,this);g(this).on("click",function(a){return p(b,a)});this._isValid=function(){return p(b,{})};window.clearTimeout(b.internal.initialValidationHandle);b.internal.initialValidationHandle=window.setTimeout(function(){d(b)},
499)})},e=function(a,b,d){a=g(a).closest("form");if(0<a.length){var e=null;null==a.data("_evolutionValidation")&&(d=a.validate({errorPlacement:function(a,b){var c=g(b).data("_evolutionValidation");if(c){var d=parseInt(g(b).data("_evolutionValidationFieldIndex"),10);0>d||d>=c.internal.fields.length||(c.internal.hasAttemptedSubmit?g(c.internal.fields[d].messageSelector).html(a).show():c.internal.fields[d].errorMessage=a)}},highlight:function(a,b,d){if(b=g(a).data("_evolutionValidation"))if(d=c(b),a=
g(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=b.internal.fields.length)&&(b.internal.fields[a].isValid=!1,b.internal.fields[a].initialized=!0,b.internal.hasAttemptedSubmit&&(g(b.internal.fields[a].messageSelector).show(),(b.internal.submitButtonClicked||d)&&b.settings.onValidated)))b.settings.onValidated(!1,b.internal.submitButtonClicked,b.internal.fields[a].context)},unhighlight:function(a,b,d){if(b=g(a).data("_evolutionValidation"))if(a=g(a).data("_evolutionValidationFieldIndex"),!(0>a||
a>=b.internal.fields.length)&&(b.internal.fields[a].isValid=!0,b.internal.fields[a].initialized=!0,b.internal.hasAttemptedSubmit&&(g(b.internal.fields[a].messageSelector).hide(),c(b)&&b.settings.onValidated)))b.settings.onValidated(!0,b.internal.submitButtonClicked,b.internal.fields[a].context)},onsubmit:!1,onkeyup:!1,onfocusout:!1}),a.data("_evolutionValidation",d),a.on("submit",function(){if(null==e||10<(new Date).getTime()-e)return e=(new Date).getTime(),g(b).trigger("click"),!1}))}else if(!0===
d)throw"Validated inputs must exist within form elements.";},d=function(b){window.clearTimeout(b.internal.initialValidationHandle);try{var c=!1;if(!0===b.settings.validateOnLoad)c=!0;else if(!1!==b.settings.validateOnLoad)for(var e=0;e<b.internal.fields.length;e++){var f=g(b.internal.fields[e].selector),l=f.attr("type");if("checkbox"!=l&&"radio"!=l&&"select"!=l&&"submit"!=l&&"button"!=l&&"reset"!=l&&""!=a(b,f)){c=!0;break}}if(c){b.internal.hasAttemptedSubmit=!0;var p=m.validate.apply(g(b.internal.state));
t(b);if(b.settings.onValidated)b.settings.onValidated(p,!1,null)}else if(!b.internal.hasAttemptedSubmit&&b.settings.onValidated)b.settings.onValidated(!0,!1,null)}catch(k){b.internal.initialValidationHandle=window.setTimeout(function(){d(b)},499)}},c=function(a){for(var b=0;b<a.internal.fields.length;b++)if(!a.internal.fields[b].isValid)return!1;for(b=0;b<a.internal.customValidations.length;b++)if(!a.internal.customValidations[b].isValid)return!1;return!0},b=function(b,c,d){var e=a(b,c);if(e!=c.data("_evolutionValidationOldValue")||
!0===d)return c.data("_evolutionValidationOldValue",e),d=c.valid(),c=c.data("_evolutionValidationFieldIndex"),0<=c&&c<b.internal.fields.length&&((b.internal.fields[c].isValid=d)?g(b.internal.fields[c].messageSelector).hide():g(b.internal.fields[c].messageSelector).show()),d;c=c.data("_evolutionValidationFieldIndex");return 0>c||c>=b.internal.fields.length?!1:b.internal.fields[c].isValid},a=function(a,b){return"checkbox"==b.attr("type")||"radio"==b.attr("type")?b.get(0).checked?b.val():"":b.val()},
l=function(a,b){if(0>b||b>=a.internal.customValidations.length)return!0;var d=a.internal.customValidations[b].validationFunction();a.internal.customValidations[b].initialized=!0;if(!0===d){a.internal.customValidations[b].isValid=!0;g(a.internal.customValidations[b].messageSelector).hide();if(c(a)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!0,a.internal.submitButtonClicked,a.internal.customValidations[b].context);return!0}d=c(a);a.internal.customValidations[b].isValid=
!1;a.internal.hasAttemptedSubmit&&g(a.internal.customValidations[b].messageSelector).html(a.internal.customValidations[b].message).show();if((a.internal.submitButtonClicked||d)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!1,a.internal.submitButtonClicked,a.internal.customValidations[b].context);return!1},p=function(a,b){var c=!a.internal.hasAttemptedSubmit;a.internal.hasAttemptedSubmit=!0;a.internal.submitButtonClicked=!0;m.validate.apply(g(a.internal.state),[]);
var d=m.isValid.apply(g(a.internal.state),[]);c&&!d&&t(a);c=!0;d&&a.settings.onSuccessfulClick&&(c=a.settings.onSuccessfulClick(b));a.internal.submitButtonClicked=!1;!d&&b&&(b.cancelBubble=!0,b.returnValue=!1);return d&&!1!==c},t=function(a){for(var b=0;b<a.internal.fields.length;b++)a.internal.fields[b].isValid||null==a.internal.fields[b].errorMessage||(g(a.internal.fields[b].messageSelector).html(a.internal.fields[b].errorMessage).show(),a.internal.fields[b].errorMessage=null);for(b=0;b<a.internal.customValidations.length;b++)a.internal.customValidations[b].isValid||
g(a.internal.customValidations[b].messageSelector).html(a.internal.customValidations[b].message).show()};g.fn.evolutionValidation=function(a){if(a in m)return m[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)g.error("Method "+a+" does not exist on jQuery.fn.evolutionValidation");else return n.apply(this,arguments)};g.extend(g.fn.evolutionValidation,{defaults:{validateOnLoad:null,onValidated:null,onSuccessfulClick:null}});f.Telligent_Validation=function(a,b){this._jq=
g(a);b.onValidatedFunction&&(b.onValidated=b.onValidatedFunction);b.onSuccessfulClickFunction&&(b.onSuccessfulClick=b.onSuccessfulClickFunction);this._jq.evolutionValidation(b)};Telligent_Validation.prototype.AddField=function(a,b,c,d){this._jq.evolutionValidation("addField",a,b,c,d)};Telligent_Validation.prototype.AddCustomValidation=function(a,b,c,d,e){return this._jq.evolutionValidation("addCustomValidation",a,b,c,d,e)};Telligent_Validation.prototype.IsValid=function(){return this._jq.evolutionValidation("isValid")};
Telligent_Validation.prototype.Validate=function(){return this._jq.evolutionValidation("validate")};Telligent_Validation.prototype.ValidateField=function(a){return this._jq.evolutionValidation("validateField",a)};Telligent_Validation.prototype.ValidateCustom=function(a){return this._jq.evolutionValidation("validateCustom",a)};return{}},jQuery,window);u("plugin.evolutionVote",function(g,f,k){var m=function(a,b,c){if(a.internal.isInitialized&&!a.settings.isReadOnly)if(a.internal.userVote=c,a.settings.allowMultipleSelections||
(a.settings.isReadOnly=!0),a.internal.savingValue=!0,null===b||0==c)a.settings.onDeleteVote();else a.settings.onVote(b,c)},n=function(a){var b=parseInt(a);return isNaN(b)?!0===a||"true"==a?1:!1===a||"false"==a?-1:0:b},e=function(a){return this.each(function(){a&&a.userVote!=k&&(a.userVote=n(a.userVote));var b={settings:g.extend({},g.fn.evolutionUpDownVoting.defaults,a||{}),internal:{state:g(this)}};g(this).data("evolutionUpDownVoting_context",b);b.internal.state.addClass(b.settings.voteClass).css("white-space",
"nowrap").find("a").off(".evolutionUpDownVoting").empty().end();b.internal.state.empty();"true"==b.settings.userVote?b.settings.userVote=!0:"false"==b.settings.userVote&&(b.settings.userVote=!1);b.settings.isReadOnly&&b.internal.state.addClass(b.settings.readOnlyClass);d(b,!0);var c="",e="neutral";0<b.settings.score?(e="positive",c="+"):0>b.settings.score&&(e="negative");b.internal.state.append('<div class="score-summary"><div class="vote-score '+e+'">'+c+b.settings.score+"</div></div>");d(b,!1)})},
d=function(a,b){(function(){if(!a.settings.isUserRegistered||!a.settings.isUserGroupMember||!1!=b||a.settings.canUserDownVote)if(!a.settings.isUserRegistered||!a.settings.isUserGroupMember||!0!=b||a.settings.canUserUpVote){var d,e="",e=c(a,b);d=!a.settings.isUserRegistered||!0==b&&a.settings.canUserUpVote||!1==b&&a.settings.canUserDownVote?g('<a href="#" >'+e+"</a>").css({textDecoration:"none"}).attr("title",e).addClass("votingenabled ui-tip"):g('<a disabled="disabled">'+e+"</a>").addClass(a.settings.readOnlyClass).attr("title",
e).addClass("votingdisabled ui-tip");d.addClass("vote");1==b?d.addClass("upvote"):d.addClass("downvote");if(!a.settings.isReadOnly)if(!a.settings.isUserRegistered)d.attr("href",a.settings.loginUrl);else if(!0==b&&a.settings.canUserUpVote||!1==b&&a.settings.canUserDownVote)if(a.settings.userVote&&0<a.settings.userVote==b)0<a.settings.userVote==b&&(d.data("rating-value",b).addClass("selected").on("click.evolutionUpDownVoting",function(c){a.settings.allowMultipleVotes?(c=a.settings.userVote+(b?1:-1),
m(a,d.data("rating-value"),c)):m(a,null,0);return!1}),1<Math.abs(a.settings.userVote)?(e=Math.abs(a.settings.userVote),9<e&&(e="9+"),d.addClass("multiple").append('<span class="multiple-value">'+e+"</span>")):d.removeClass("multiple"));else d.data("rating-value",b).on("click.evolutionUpDownVoting",function(c){c=b?1:-1;a.settings.allowMultipleVotes&&(c+=a.settings.userVote);m(a,d.data("rating-value"),c);return!1});a.internal.state.append(d)}})();a.internal.isInitialized=!0},c=function(a,b){if(a.settings.isReadOnly)return a.settings.readOnlyMessage;
if((!b||a.settings.canUserUpVote)&&(b||a.settings.canUserDownVote)||a.settings.isUserRegistered){if(b&&!a.settings.canUserUpVote||!b&&!a.settings.canUserDownVote)return a.settings.isUserGroupMember?a.settings.noPermissionMessage:a.settings.notGroupMemberMessage;if(0<a.settings.userVote&&b||0>a.settings.userVote&&!b)return a.settings.allowMultipleVotes?b?a.settings.voteUpAgainMessage:a.settings.voteDownAgainMessage:a.settings.deleteMessage;if(b&&0==a.settings.userVote)return a.settings.voteUpMessage;
if(b&&0>a.settings.userVote)return a.settings.allowMultipleVotes?a.settings.removeDownVoteMessage:a.settings.switchToUpVoteMessage;if(!b&&0==a.settings.userVote)return a.settings.voteDownMessage;if(!b&&0<a.settings.userVote)return a.settings.allowMultipleVotes?a.settings.removeUpVoteMessage:a.settings.switchToDownVoteMessage}else return a.settings.loginMessage;return""},b={val:function(a){var b=this.data("evolutionUpDownVoting_context");if(null!==b){if("undefined"!==typeof a)return b.internal.yesVotes=
a;a="undefined"!==typeof b.internal.yesVotes?b.internal.yesVotes:b.settings.yesVotes;return a}return 0},readOnly:function(a){var b=this.data("evolutionUpDownVoting_context");if(null!==b)if("undefined"!==typeof a)(b.settings.isReadOnly=a)?b.internal.state.find("a").css({cursor:"default"}):b.internal.state.find("a").css({cursor:"pointer"});else return b.settings.isReadOnly;return!0},option:function(a,b){if("object"===typeof a)return this.each(function(){var b=g(this).data("evolutionUpDownVoting_context");
null!=b&&(a.userVote&&(a.userVote=n(a.userVote)),b.settings=g.extend({},b.settings,a),e.apply(g(this),[b.settings]))});if("undefined"!==typeof a&&"undefined"!==typeof b)return this.each(function(){var c=g(this).data("evolutionUpDownVoting_context");null!=c&&("userVote"==a&&(b=n(b)),c.settings[a]=b,e.apply(g(this),[c.settings]))});if("undefined"!==typeof a){var c=this.data("evolutionUpDownVoting_context");return null!==c?c.settings[a]:null}}};g.fn.evolutionUpDownVoting=function(a){if(a in b)return b[a].apply(this,
Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)g.error("Method "+a+" does not exist on jQuery.fn.evolutionUpDownVoting");else return e.apply(this,arguments)};g.extend(g.fn.evolutionUpDownVoting,{defaults:{yesVotes:0,noVotes:0,voteCount:0,score:0,userVote:0,voteClass:"updownvote",overClass:"active",readOnlyClass:"readonly",isReadOnly:!1,allowMultipleSelections:!0,allowMultipleVotes:!1,canUserUpVote:!1,canUserDownVote:!1,isUserRegistered:!0,loginUrl:"",isUserGroupMember:!1,voteDownMessage:"Vote against this idea",
voteUpMessage:"Vote for this idea",voteDownAgainMessage:"Vote against this idea again",voteUpAgainMessage:"Vote for this idea again",loginMessage:"Sign in to vote on ideas",noPermissionMessage:"You do not have permission to vote for this idea",notGroupMemberMessage:"Join this group to vote on this idea",deleteMessage:"Remove your vote for this idea",removeDownVoteMessage:"Remove a vote against this idea",removeUpVoteMessage:"Remove a vote for this idea",readOnlyMessage:"Voting has been disabled",
switchToDownVoteMessage:"Vote against this idea instead of for it",switchToUpVoteMessage:"Vote for this idea instead of against it",onVote:function(a){},onDeleteVote:function(a){}}});return{}},jQuery,window);!function(g,f){function k(e,d){for(var c,b=[],a=0;a<e.length;++a){var f;if(!(f=n[e[a]]))a:{f=g;for(var p=e[a].split(/[.\/]/),k=0;k<p.length;++k){if(!f[p[k]]){f=void 0;break a}f=f[p[k]]}}if(c=f,!c)throw"module definition dependecy not found: "+e[a];b.push(c)}d.apply(null,b)}function m(e,d,c){if("string"!=
typeof e)throw"invalid module definition, module id must be defined and be a string";if(d===f)throw"invalid module definition, dependencies must be specified";if(c===f)throw"invalid module definition, definition function must be specified";k(d,function(){n[e]=c.apply(null,arguments)})}var n={};m("moxie/core/utils/Basic",[],function(){var e=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},d=function(a){return c(arguments,
function(f,g){0<g&&c(f,function(c,f){void 0!==c&&(e(a[f])===e(c)&&~b(e(c),["array","object"])?d(a[f],c):a[f]=c)})}),a},c=function(a,b){var c,d;if(a)if("number"===e(a.length))for(d=0,c=a.length;c>d&&!1!==b(a[d],d);d++);else if("object"===e(a))for(c in a)if(a.hasOwnProperty(c)&&!1===b(a[c],c))break},b=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c}return-1};return{guid:function(){var a=0;return function(b){var c=
(new Date).getTime().toString(32),d;for(d=0;5>d;d++)c+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+c+(a++).toString(32)}}(),typeOf:e,extend:d,each:c,isEmptyObj:function(a){var b;if(!a||"object"!==e(a))return!0;for(b in a)return!1;return!0},inSeries:function(a,b){function c(f){"function"===e(a[f])&&a[f](function(a){++f<d&&!a?c(f):b(a)})}var d=a.length;"function"!==e(b)&&(b=function(){});a&&a.length||b();c(0)},inParallel:function(a,b){var d=0,e=a.length,f=Array(e);c(a,function(a,c){a(function(a){if(a)return b(a);
var g=[].slice.call(arguments);g.shift();f[c]=g;d++;d===e&&(f.unshift(null),b.apply(this,f))})})},inArray:b,arrayDiff:function(a,c){var d=[];"array"!==e(a)&&(a=[a]);"array"!==e(c)&&(c=[c]);for(var f in a)-1===b(a[f],c)&&d.push(a[f]);return d.length?d:!1},arrayIntersect:function(a,d){var e=[];return c(a,function(a){-1!==b(a,d)&&e.push(a)}),e.length?e:null},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):
a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},sprintf:function(a){var b=[].slice.call(arguments,1);return a.replace(/%[a-z]/g,function(){var a=b.shift();return"undefined"!==e(a)?a:""})},parseSizeStr:function(a){if("string"!=typeof a)return a;var b={t:1099511627776,g:1073741824,m:1048576,k:1024},c;return a=/^([0-9\.]+)([tmgk]?)$/.exec(a.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),c=a[2],a=+a[1],b.hasOwnProperty(c)&&(a*=b[c]),Math.floor(a)}}});m("moxie/core/utils/Env",["moxie/core/utils/Basic"],
function(e){var d=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,c=0,d,e,f,g,h,k=arguments;c<k.length;c+=2){h=k[c];var p=k[c+1];if("undefined"===typeof b)for(f in b={},p)d=p[f],"object"===typeof d?b[d[0]]=a:b[d]=a;for(d=e=0;d<h.length;d++)if(g=h[d].exec(this.getUA())){for(f=0;f<p.length;f++)h=g[++e],d=p[f],"object"===typeof d&&0<d.length?2==d.length?"function"==typeof d[1]?b[d[0]]=d[1].call(this,
h):b[d[0]]=d[1]:3==d.length?"function"!==typeof d[1]||d[1].exec&&d[1].test?b[d[0]]=h?h.replace(d[1],d[2]):a:b[d[0]]=h?d[1].call(this,h,d[2]):a:4==d.length&&(b[d[0]]=h?d[3].call(this,h.replace(d[1],d[2])):a):b[d]=h?h:a;break}if(g)break}return b},d=function(c,d){for(var e in d)if("object"===typeof d[e]&&0<d[e].length)for(var f=0;f<d[e].length;f++){if(b.has(d[e][f],c))return"?"===e?a:e}else if(b.has(d[e],c))return"?"===e?a:e;return c},e={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1",
"NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},f=[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],
["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],
"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",d,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412",
"2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,
/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],g=[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],k=[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],
["name",["version",d,e]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",d,e]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name",
"Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?
window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,f)};this.getEngine=function(){return c.apply(this,g)};this.getOS=function(){return c.apply(this,k)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){return b=a,this};this.setUA(b)}}(),c=function(){var b={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||
!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==e.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;if(b.open("get","/"),"responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(c){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){b.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),
!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==a.browser||9<=a.version)},use_data_uri_of:function(a){return b.use_data_uri&&33E3>a||b.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(a){var c=[].slice.call(arguments);
return c.shift(),"function"===e.typeOf(b[a])?b[a].apply(this,c):!!b[a]}}(),b=(new d).getResult(),a={can:c,uaParser:d,browser:b.browser.name,version:b.browser.version,os:b.os.name,osVersion:b.os.version,verComp:function(a,b,c){var d=0,e=0,f=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},d=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]};a=d(a);b=d(b);e=Math.max(a.length,b.length);for(d=0;e>d;d++)if(a[d]!=
b[d]){if(a[d]=a[d]?isNaN(a[d])?g[a[d]]||-7:parseInt(a[d],10):0,b[d]=b[d]?isNaN(b[d])?g[b[d]]||-7:parseInt(b[d],10):0,a[d]<b[d]){f=-1;break}if(a[d]>b[d]){f=1;break}}if(!c)return f;switch(c){case ">":case "gt":return 0<f;case ">=":case "ge":return 0<=f;case "<=":case "le":return 0>=f;case "==":case "=":case "eq":return 0===f;case "<>":case "!=":case "ne":return 0!==f;case "":case "<":case "lt":return 0>f;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};
return a.OS=a.os,a});m("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var d={};return{addI18n:function(c){return e.extend(d,c)},translate:function(c){return d[c]||c},_:function(c){return this.translate(c)},sprintf:function(c){var b=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var a=b.shift();return"undefined"!==e.typeOf(a)?a:""})}}});m("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,d){var c={mimes:{},extensions:{},addMimeType:function(b){b=
b.split(/,/);var a,c,d;for(a=0;a<b.length;a+=2){d=b[a+1].split(/ /);for(c=0;c<d.length;c++)this.mimes[d[c]]=b[a];this.extensions[b[a]]=d}},extList2mimes:function(b,a){var c,d,f,g,h=[];for(d=0;d<b.length;d++)for(c=b[d].extensions.split(/\s*,\s*/),f=0;f<c.length;f++){if("*"===c[f])return[];if(g=this.mimes[c[f]],g&&-1===e.inArray(g,h)&&h.push(g),a&&/^\w+$/.test(c[f]))h.push("."+c[f]);else if(!g)return[]}return h},mimes2exts:function(b){var a=this,c=[];return e.each(b,function(b){if("*"===b)return c=
[],!1;var d=b.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?e.each(a.extensions,function(b,e){RegExp("^"+d[1]+"/").test(e)&&[].push.apply(c,a.extensions[e])}):a.extensions[b]&&[].push.apply(c,a.extensions[b]))}),c},mimes2extList:function(b){var a=[],c=[];return"string"===e.typeOf(b)&&(b=e.trim(b).split(/\s*,\s*/)),c=this.mimes2exts(b),a.push({title:d.translate("Files"),extensions:c.length?c.join(","):"*"}),a.mimes=b,a},getFileExtension:function(b){return(b=b&&b.match(/\.([^.]+)$/))?b[1].toLowerCase():
""},getFileMime:function(b){return this.mimes[this.getFileExtension(b)]||""}};return c.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
c});m("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var d=function(c,b){return c.className?RegExp("(^|\\s+)"+b+"(\\s+|$)").test(c.className):!1};return{get:function(c){return"string"!=typeof c?c:document.getElementById(c)},hasClass:d,addClass:function(c,b){d(c,b)||(c.className=c.className?c.className.replace(/\s+$/,"")+" "+b:b)},removeClass:function(c,b){c.className&&(c.className=c.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)"),function(a,b,c){return" "===b&&" "===c?" ":""}))},getStyle:function(c,
b){return c.currentStyle?c.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(c,null)[b]:void 0},getPos:function(c,b){function a(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===k.compatMode?k.documentElement:k.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var d=0,f=0,g,k=document,h;if(b=b||k.body,c&&c.getBoundingClientRect&&"IE"===e.browser&&(!k.documentMode||8>k.documentMode))return g=a(c),h=a(b),{x:g.x-h.x,y:g.y-h.y};for(g=c;g&&g!=b&&g.nodeType;)d+=
g.offsetLeft||0,f+=g.offsetTop||0,g=g.offsetParent;for(g=c.parentNode;g&&g!=b&&g.nodeType;)d-=g.scrollLeft||0,f-=g.scrollTop||0,g=g.parentNode;return{x:d,y:f}},getSize:function(c){return{w:c.offsetWidth||c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});m("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function d(c,b){for(var a in c)if(c[a]===b)return a;return null}return{RuntimeError:function(){function c(a){this.code=a;this.name=d(b,a);this.message=this.name+": RuntimeError "+this.code}
var b={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(c,b),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function c(b){this.code=b;this.name="OperationNotAllowedException"}return e.extend(c,{NOT_ALLOWED_ERR:1}),c.prototype=Error.prototype,c}(),ImageError:function(){function c(a){this.code=a;this.name=d(b,a);this.message=this.name+": ImageError "+this.code}var b={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return e.extend(c,b),c.prototype=Error.prototype,
c}(),FileException:function(){function c(a){this.code=a;this.name=d(b,a);this.message=this.name+": FileException "+this.code}var b={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(c,b),c.prototype=Error.prototype,c}(),DOMException:function(){function c(a){this.code=a;this.name=d(b,a);this.message=this.name+": DOMException "+this.code}var b={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,
WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(c,b),c.prototype=Error.prototype,c}(),EventException:function(){function c(b){this.code=
b;this.name="EventException"}return e.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0}),c.prototype=Error.prototype,c}()}});m("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,d,c){function b(){var a={};c.extend(this,{uid:null,init:function(){this.uid||(this.uid=c.guid("uid_"))},addEventListener:function(b,d,e,f){var g=this,k;return this.hasOwnProperty("uid")||(this.uid=c.guid("uid_")),b=c.trim(b),/\s/.test(b)?void c.each(b.split(/\s+/),function(a){g.addEventListener(a,
d,e,f)}):(b=b.toLowerCase(),e=parseInt(e,10)||0,k=a[this.uid]&&a[this.uid][b]||[],k.push({fn:d,priority:e,scope:f||this}),a[this.uid]||(a[this.uid]={}),void(a[this.uid][b]=k))},hasEventListener:function(b){return(b=b?a[this.uid]&&a[this.uid][b]:a[this.uid])?b:!1},removeEventListener:function(b,d){b=b.toLowerCase();var e=a[this.uid]&&a[this.uid][b],f;if(e){if(d)for(f=e.length-1;0<=f;f--){if(e[f].fn===d){e.splice(f,1);break}}else e=[];e.length||(delete a[this.uid][b],c.isEmptyObj(a[this.uid])&&delete a[this.uid])}},
removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var e,f,g,h={},k=!0;if("string"!==c.typeOf(b)){if(f=b,"string"!==c.typeOf(f.type))throw new d.EventException(d.EventException.UNSPECIFIED_EVENT_TYPE_ERR);b=f.type;void 0!==f.total&&void 0!==f.loaded&&(h.total=f.total,h.loaded=f.loaded);h.async=f.async||!1}if(-1!==b.indexOf("::")?!function(a){e=a[0];b=a[1]}(b.split("::")):e=this.uid,b=b.toLowerCase(),f=a[e]&&a[e][b]){f.sort(function(a,b){return b.priority-
a.priority});g=[].slice.call(arguments);g.shift();h.type=b;g.unshift(h);var m=[];c.each(f,function(a){g[0].target=a.scope;m.push(h.async?function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,g))},1)}:function(b){b(!1===a.fn.apply(a.scope,g))})});m.length&&c.inSeries(m,function(a){k=!a})}return k},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},
trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(a){var b=this;this.bind(a.join(" "),function(a){var b="on"+a.type.toLowerCase();"function"===c.typeOf(this[b])&&this[b].apply(this,arguments)});c.each(a,function(a){a="on"+a.toLowerCase(a);"undefined"===c.typeOf(b[a])&&(b[a]=null)})}})}return b.instance=new b,b});m("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,d,c,b){function a(b,
e,f,l,k){var m=this,n,x=d.guid(e+"_");k=k||"browser";b=b||{};g[x]=this;f=d.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,
use_http_method:!0},f);b.preferred_caps&&(k=a.getMode(l,b.preferred_caps,k));n=function(){var a={};return{exec:function(b,c,d,e){return n[c]&&(a[b]||(a[b]={context:this,instance:new n[c]}),a[b].instance[d])?a[b].instance[d].apply(this,e):void 0},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;d.each(a,function(a,c){"function"===d.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();d.extend(this,{initialized:!1,uid:x,type:e,mode:a.getMode(l,
b.required_caps,k),shimid:x+"_container",clients:0,options:b,can:function(b,c,e){e=e||f;if("string"===d.typeOf(b)&&"undefined"===d.typeOf(c)&&(b=a.parseCaps(b)),"object"===d.typeOf(b)){for(var g in b)if(!this.can(g,b[g],e))return!1;return!0}return"function"===d.typeOf(e[b])?e[b].call(this,c):c===e[b]},getShimContainer:function(){var a,b=c.get(this.shimid);return b||(a=this.options.container?c.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+
this.type,d.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b)),b},getShim:function(){return n},shimExec:function(a,b){var c=[].slice.call(arguments,2);return m.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return m[a]&&m[a][b]?m[a][b].apply(this,c):m.shimExec.apply(this,arguments)},destroy:function(){if(m){var a=c.get(this.shimid);a&&a.parentNode.removeChild(a);n&&n.removeAllInstances();
this.unbindAll();delete g[this.uid];x=m=n=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var f={},g={};return a.order="html5,flash,silverlight,html4",a.getRuntime=function(a){return g[a]?g[a]:!1},a.addConstructor=function(a,c){c.prototype=b.instance;f[a]=c},a.getConstructor=function(a){return f[a]||null},a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null},a.parseCaps=
function(a){var b={};return"string"!==d.typeOf(a)?a||{}:(d.each(a.split(","),function(a){b[a]=!0}),b)},a.can=function(b,c){var d,e=a.getConstructor(b),f;return e?(d=new e({required_caps:c}),f=d.mode,d.destroy(),!!f):!1},a.thatCan=function(b,c){var d=(c||a.order).split(/\s*,\s*/),e;for(e in d)if(a.can(d[e],b))return d[e];return null},a.getMode=function(a,b,c){var e=null;if("undefined"===d.typeOf(c)&&(c="browser"),b&&!d.isEmptyObj(a)){if(d.each(b,function(b,c){if(a.hasOwnProperty(c)){var f=a[c](b);
if("string"==typeof f&&(f=[f]),e){if(!(e=d.arrayIntersect(e,f)))return e=!1}else e=f}}),e)return-1!==d.inArray(c,e)?c:e[0];if(!1===e)return!1}return c},a.capTrue=function(){return!0},a.capFalse=function(){return!1},a.capTest=function(a){return function(){return!!a}},a});m("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,d,c,b){return function(){var a;c.extend(this,{connectRuntime:function(e){function f(c){var k,
q;return c.length?(k=c.shift().toLowerCase(),(q=b.getConstructor(k))?(a=new q(e),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;g.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();f(c)}),a.mode?void a.init():void a.trigger("Error")):void f(c)):(g.trigger("RuntimeError",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR)),void(a=null))}var g=this,k;if("string"===c.typeOf(e)?k=e:"string"===c.typeOf(e.ruid)&&(k=e.ruid),k){if(a=b.getRuntime(k))return a.clients++,
a;throw new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR);}f((e.runtime_order||b.order).split(/\s*,\s*/))},disconnectRuntime:function(){a&&0>=--a.clients&&a.destroy();a=null},getRuntime:function(){return a&&a.uid?a:a=null},exec:function(){return a?a.exec.apply(this,arguments):null}})}});m("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Env moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
function(e,d,c,b,a,f,g,k,q){function h(d){var f=this,h;if(-1!==e.inArray(e.typeOf(d),["string","node"])&&(d={browse_button:d}),h=b.get(d.browse_button),!h)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);h={accept:[{title:g.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:h.parentNode||document.body};d=e.extend({},h,d);"string"==typeof d.required_caps&&(d.required_caps=k.parseCaps(d.required_caps));"string"==typeof d.accept&&(d.accept=c.mimes2extList(d.accept));
(h=b.get(d.container))||(h=document.body);"static"===b.getStyle(h,"position")&&(h.style.position="relative");h=h=null;q.call(f);e.extend(f,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){f.bind("RuntimeInit",function(a,c){f.ruid=c.uid;f.shimid=c.shimid;f.bind("Ready",function(){f.trigger("Refresh")},999);f.bind("Refresh",function(){var a,f,g,h;g=b.get(d.browse_button);h=b.get(c.shimid);g&&(a=b.getPos(g,b.get(d.container)),f=b.getSize(g),h&&e.extend(h.style,{top:a.y+"px",left:a.x+
"px",width:f.w+"px",height:f.h+"px"}))});c.exec.call(f,"FileInput","init",d)});f.connectRuntime(e.extend({},d,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===e.typeOf(a)?!0:a)},refresh:function(){f.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===e.typeOf(this.files)&&e.each(this.files,function(a){a.destroy()});this.files=
null;this.unbindAll()}});this.handleEventProps(m)}var m="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");return h.prototype=f.instance,h});m("moxie/core/utils/Encode",[],function(){var e=function(c){return unescape(encodeURIComponent(c))},d=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:e,utf8_decode:d,atob:function(c,b){if("function"==typeof window.atob)return b?d(window.atob(c)):window.atob(c);var a,e,f,g,k,h=0,m=0,n="",w=[];if(!c)return c;c+="";do a=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(h++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(h++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(h++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(h++)),f=a<<18|e<<12|g<<6|k,a=f>>16&255,e=f>>8&255,f&=255,64==g?w[m++]=String.fromCharCode(a):64==k?w[m++]=String.fromCharCode(a,e):w[m++]=
String.fromCharCode(a,e,f);while(h<c.length);return n=w.join(""),b?d(n):n},btoa:function(c,b){if(b&&(c=e(c)),"function"==typeof window.btoa)return window.btoa(c);var a,d,f,g,k=0,h=0,m="",m=[];if(!c)return c;do a=c.charCodeAt(k++),d=c.charCodeAt(k++),f=c.charCodeAt(k++),g=a<<16|d<<8|f,a=g>>18&63,d=g>>12&63,f=g>>6&63,g&=63,m[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);while(k<c.length);m=m.join("");k=c.length%3;return(k?m.slice(0,k-3):m)+"===".slice(k||3)}}});m("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(e,d,c){function b(f,g){function k(c,d,f){var g,l=a[this.uid];return"string"===e.typeOf(l)&&l.length?(g=new b(null,{type:f,size:d-c}),g.detach(l.substr(c,g.size)),g):null}c.call(this);f&&this.connectRuntime(f);g?"string"===
e.typeOf(g)&&(g={data:g}):g={};e.extend(this,{uid:g.uid||e.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(a,b,c){return this.isDetached()?k.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return a[this.uid]?a[this.uid]:null},detach:function(b){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),b=b||"","data:"==b.substr(0,5)){var c=b.indexOf(";base64,");this.type=
b.substring(5,c);b=d.atob(b.substring(c+8))}this.size=b.length;a[this.uid]=b},isDetached:function(){return!this.ruid&&"string"===e.typeOf(a[this.uid])},destroy:function(){this.detach();delete a[this.uid]}});g.data?this.detach(g.data):a[this.uid]=g}var a={};return b});m("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(e,d,c){function b(a,b){b||(b={});c.apply(this,arguments);this.type||(this.type=d.getFileMime(b.name));var f;b.name?(f=b.name.replace(/\\/g,
"/"),f=f.substr(f.lastIndexOf("/")+1)):this.type&&(f=this.type.split("/")[0],f=e.guid((""!==f?f:"file")+"_"),d.extensions[this.type]&&(f+="."+d.extensions[this.type][0]));e.extend(this,{name:f||e.guid("file_"),relativePath:"",lastModifiedDate:b.lastModifiedDate||(new Date).toLocaleString()})}return b.prototype=c.prototype,b});m("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/core/utils/Env moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
function(e,d,c,b,a,f,g,k,m){function h(a){var c=this,f;"string"==typeof a&&(a={drop_zone:a});f={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};a="object"==typeof a?b.extend({},f,a):f;a.container=d.get(a.drop_zone)||document.body;"static"===d.getStyle(a.container,"position")&&(a.container.style.position="relative");"string"==typeof a.accept&&(a.accept=m.mimes2extList(a.accept));g.call(c);b.extend(c,{uid:b.guid("uid_"),ruid:null,files:null,init:function(){c.bind("RuntimeInit",
function(b,d){c.ruid=d.uid;d.exec.call(c,"FileDrop","init",a);c.dispatchEvent("ready")});c.connectRuntime(a)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null;this.unbindAll()}});this.handleEventProps(n)}var n=["ready","dragenter","dragleave","drop","error"];return h.prototype=k.instance,h});m("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/runtime/RuntimeClient".split(" "),
function(e,d,c,b,a,f){function g(){function b(e,f){if(this.trigger("loadstart"),this.readyState===g.LOADING)return this.trigger("error",new c.DOMException(c.DOMException.INVALID_STATE_ERR)),void this.trigger("loadend");if(!(f instanceof a))return this.trigger("error",new c.DOMException(c.DOMException.NOT_FOUND_ERR)),void this.trigger("loadend");if(this.result=null,this.readyState=g.LOADING,f.isDetached()){var l=f.getSource();switch(e){case "readAsText":case "readAsBinaryString":this.result=l;break;
case "readAsDataURL":this.result="data:"+f.type+";base64,"+d.btoa(l)}this.readyState=g.DONE;this.trigger("load");this.trigger("loadend")}else this.connectRuntime(f.ruid),this.exec("FileReader","read",e,f)}f.call(this);e.extend(this,{uid:e.guid("uid_"),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(a){b.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){b.call(this,"readAsDataURL",a)},readAsText:function(a){b.call(this,"readAsText",a)},abort:function(){this.result=
null;-1===e.inArray(this.readyState,[g.EMPTY,g.DONE])&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(k);this.bind("Error",function(a,b){this.readyState=g.DONE;this.error=b},999);this.bind("Load",function(a){this.readyState=g.DONE},999)}var k="loadstart progress load abort error loadend".split(" ");
return g.EMPTY=0,g.LOADING=1,g.DONE=2,g.prototype=b.instance,g});m("moxie/core/utils/Url",[],function(){var e=function(d,c){for(var b="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),a=b.length,f={http:80,https:443},g={},k=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(d||"");a--;)k[a]&&(g[b[a]]=k[a]);g.scheme||(c&&"string"!=
typeof c||(c=e(c||document.location.href)),g.scheme=c.scheme,g.host=c.host,g.port=c.port,b="",/^[^\/]/.test(g.path)&&(b=c.path,b=/\/[^\/]*\.[^\/]*$/.test(b)?b.replace(/\/[^\/]+$/,"/"):b.replace(/\/?$/,"/")),g.path=b+(g.path||""));return g.port||(g.port=f[g.scheme]||80),g.port=parseInt(g.port,10),g.path||(g.path="/"),delete g.source,g};return{parseUrl:e,resolveUrl:function(d){d="object"==typeof d?d:e(d);return d.scheme+"://"+d.host+(d.port!=={http:80,https:443}[d.scheme]?":"+d.port:"")+d.path+(d.query?
d.query:"")},hasSameOrigin:function(d){function c(b){return[b.scheme,b.host,b.port].join("/")}return"string"==typeof d&&(d=e(d)),c(e())===c(d)}}});m("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,d,c){function b(){this.uid=e.guid("uid_");d.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return b.prototype=c.instance,b});m("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient",
"moxie/core/utils/Encode"],function(e,d,c){return function(){function b(a,b){if(!b.isDetached()){var d=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b);return this.disconnectRuntime(),d}d=b.getSource();switch(a){case "readAsBinaryString":return d;case "readAsDataURL":return"data:"+b.type+";base64,"+c.btoa(d);case "readAsText":for(var e="",f=0,g=d.length;g>f;f++)e+=String.fromCharCode(d[f]);return e}}d.call(this);e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(a){return b.call(this,
"readAsBinaryString",a)},readAsDataURL:function(a){return b.call(this,"readAsDataURL",a)},readAsText:function(a){return b.call(this,"readAsText",a)}})}});m("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,d,c){return function(){var b,a=[];d.extend(this,{append:function(e,f){var g=this,k=d.typeOf(f);f instanceof c?b={name:e,value:f}:"array"===k?(e+="[]",d.each(f,function(a){g.append(e,a)})):"object"===k?d.each(f,function(a,b){g.append(e+"["+b+"]",
a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(f)?g.append(e,"false"):a.push({name:e,value:f.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return b&&b.value||null},getBlobName:function(){return b&&b.name||null},each:function(c){d.each(a,function(a){c(a.value,a.name)});b&&c(b.value,b.name)},destroy:function(){b=null;a=[]}})}});m("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
function(e,d,c,b,a,f,g,k,m,h,n,s){function w(){this.uid=e.guid("uid_")}function r(){function c(a,b){return C.hasOwnProperty(a)?1===arguments.length?n.can("define_property")?C[a]:q[a]:void(n.can("define_property")?C[a]=b:q[a]=b):void 0}function m(a){function b(){N&&(N.destroy(),N=null);k.dispatchEvent("loadend");k=null}function d(f){N.bind("LoadStart",function(a){c("readyState",r.LOADING);k.dispatchEvent("readystatechange");k.dispatchEvent(a);V&&k.upload.dispatchEvent(a)});N.bind("Progress",function(a){c("readyState")!==
r.LOADING&&(c("readyState",r.LOADING),k.dispatchEvent("readystatechange"));k.dispatchEvent(a)});N.bind("UploadProgress",function(a){V&&k.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});N.bind("Load",function(a){c("readyState",r.DONE);c("status",Number(f.exec.call(N,"XMLHttpRequest","getStatus")||0));c("statusText",x[c("status")]||"");c("response",f.exec.call(N,"XMLHttpRequest","getResponse",c("responseType")));~e.inArray(c("responseType"),["text",""])?c("responseText",
c("response")):"document"===c("responseType")&&c("responseXML",c("response"));T=f.exec.call(N,"XMLHttpRequest","getAllResponseHeaders");k.dispatchEvent("readystatechange");0<c("status")?(V&&k.upload.dispatchEvent(a),k.dispatchEvent(a)):(W=!0,k.dispatchEvent("error"));b()});N.bind("Abort",function(a){k.dispatchEvent(a);b()});N.bind("Error",function(a){W=!0;c("readyState",r.DONE);k.dispatchEvent("readystatechange");Y=!0;k.dispatchEvent(a);b()});f.exec.call(N,"XMLHttpRequest","send",{url:D,method:G,
async:u,user:O,password:L,headers:I,mimeType:E,encoding:H,responseType:k.responseType,withCredentials:k.withCredentials,options:P},a)}var k=this;(new Date).getTime();N=new g;"string"==typeof P.required_caps&&(P.required_caps=f.parseCaps(P.required_caps));P.required_caps=e.extend({},P.required_caps,{return_response_type:k.responseType});a instanceof h&&(P.required_caps.send_multipart=!0);e.isEmptyObj(I)||(P.required_caps.send_custom_headers=!0);R||(P.required_caps.do_cors=!0);P.ruid?d(N.connectRuntime(P)):
(N.bind("RuntimeInit",function(a,b){d(b)}),N.bind("RuntimeError",function(a,b){k.dispatchEvent("RuntimeError",b)}),N.connectRuntime(P))}var q=this,C={timeout:0,readyState:r.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},u=!0,D,G,I={},O,L,H=null,E=null,F=!1,J=!1,V=!1,Y=!1,W=!1,R=!1,P={},N,T="",Q;e.extend(this,C,{uid:e.guid("uid_"),upload:new w,open:function(f,g,h,l,k){var m;if(!f||!g)throw new d.DOMException(d.DOMException.SYNTAX_ERR);
if(/[\u0100-\uffff]/.test(f)||b.utf8_encode(f)!==f)throw new d.DOMException(d.DOMException.SYNTAX_ERR);if(~e.inArray(f.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(G=f.toUpperCase()),~e.inArray(G,["CONNECT","TRACE","TRACK"]))throw new d.DOMException(d.DOMException.SECURITY_ERR);if(g=b.utf8_encode(g),m=a.parseUrl(g),R=a.hasSameOrigin(m),D=a.resolveUrl(g),(l||k)&&!R)throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);if(O=l||m.user,L=k||m.pass,u=h||!0,!1===
u&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);F=!u;J=!1;I={};c("responseText","");c("responseXML",null);c("response",null);c("status",0);c("statusText","");c("readyState",r.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(a,f){if(c("readyState")!==r.OPENED||J)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(a)||b.utf8_encode(a)!==a)throw new d.DOMException(d.DOMException.SYNTAX_ERR);
return a=e.trim(a).toLowerCase(),~e.inArray(a,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(a)?!1:(I[a]?I[a]+=", "+f:I[a]=f,!0)},getAllResponseHeaders:function(){return T||""},getResponseHeader:function(a){return a=a.toLowerCase(),W||~e.inArray(a,["set-cookie",
"set-cookie2"])?null:T&&""!==T&&(Q||(Q={},e.each(T.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=e.trim(a[0]),Q[a[0].toLowerCase()]={header:a[0],value:e.trim(a[1])})})),Q.hasOwnProperty(a))?Q[a].header+": "+Q[a].value:null},overrideMimeType:function(a){var b;if(~e.inArray(c("readyState"),[r.LOADING,r.DONE]))throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(a=e.trim(a.toLowerCase()),/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=b[1]),!s.mimes[a])throw new d.DOMException(d.DOMException.SYNTAX_ERR);
},send:function(a,c){if(P="string"===e.typeOf(c)?{ruid:c}:c?c:{},this.readyState!==r.OPENED||J)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(a instanceof k)P.ruid=a.ruid,E=a.type||"application/octet-stream";else if(a instanceof h){if(a.hasBlob()){var f=a.getBlob();P.ruid=f.ruid;E=f.type||"application/octet-stream"}}else"string"==typeof a&&(H="UTF-8",E="text/plain;charset=UTF-8",a=b.utf8_encode(a));this.withCredentials||(this.withCredentials=P.required_caps&&P.required_caps.send_browser_cookies&&
!R);V=!F&&this.upload.hasEventListener();W=!1;Y=!a;F||(J=!0);m.call(this,a)},abort:function(){if(W=!0,F=!1,~e.inArray(c("readyState"),[r.UNSENT,r.OPENED,r.DONE]))c("readyState",r.UNSENT);else{if(c("readyState",r.DONE),J=!1,!N)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);N.getRuntime().exec.call(N,"XMLHttpRequest","abort",Y);Y=!0}},destroy:function(){N&&("function"===e.typeOf(N.destroy)&&N.destroy(),N=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}});this.handleEventProps(y.concat(["readystatechange"]));
this.upload.handleEventProps(y)}var x={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",
405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",
504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};w.prototype=c.instance;var y="loadstart progress abort error load timeout loadend".split(" ");return r.UNSENT=0,r.OPENED=1,r.HEADERS_RECEIVED=2,r.LOADING=3,r.DONE=4,r.prototype=c.instance,r});m("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,d,c,b){function a(){function b(c,
d){var g=this;k=d;g.bind("TransportingProgress",function(b){n=b.loaded;m>n&&-1===e.inArray(g.state,[a.IDLE,a.DONE])&&f.call(g)},999);g.bind("TransportingComplete",function(){n=m;g.state=a.DONE;h=null;g.result=k.exec.call(g,"Transporter","getAsBlob",c||"")},999);g.state=a.BUSY;g.trigger("TransportingStarted");f.call(g)}function f(){var a;a=m-n;w>a&&(w=a);a=d.btoa(h.substr(n,w));k.exec.call(this,"Transporter","receive",a,m)}var g,k,h,m,n,w;c.call(this);e.extend(this,{uid:e.guid("uid_"),state:a.IDLE,
result:null,transport:function(a,c,d){var f=this;d=e.extend({chunk_size:204798},d);(g=d.chunk_size%3)&&(d.chunk_size+=3-g);w=d.chunk_size;m=n=0;h=this.result=null;if(h=a,m=a.length,"string"===e.typeOf(d)||d.ruid)b.call(f,c,this.connectRuntime(d));else{var k=function(a,d){f.unbind("RuntimeInit",k);b.call(f,c,d)};this.bind("RuntimeInit",k);this.connectRuntime(d)}},abort:function(){this.state=a.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));m=n=0;h=this.result=
null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();m=n=0;h=this.result=null}})}return a.IDLE=0,a.BUSY=1,a.DONE=2,a.prototype=b.instance,a});m("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),function(e,
d,c,b,a,f,g,k,m,h,n,s,w){function r(){function b(a){var d=e.typeOf(a);try{if(a instanceof r){if(!a.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);h.apply(this,arguments)}else if(a instanceof n){if(!~e.inArray(a.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);A.apply(this,arguments)}else if(-1!==e.inArray(d,["blob","file"]))b.call(this,new s(null,a),arguments[1]);else if("string"===d)"data:"===a.substr(0,5)?b.call(this,new n(null,{data:a}),arguments[1]):
u.apply(this,arguments);else{if("node"!==d||"img"!==a.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);b.call(this,a.src,arguments[1])}}catch(f){this.trigger("error",f.code)}}function h(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===e.typeOf(b)?!0:b)}function A(a,b){function c(b){d.ruid=b.uid;b.exec.call(d,"Image","loadFromBlob",a)}var d=this;d.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
function(a,b){c(b)}),b&&"string"==typeof b.required_caps&&(b.required_caps=f.parseCaps(b.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function u(b,c){var d=this,e;e=new a;e.open("get",b);e.responseType="blob";e.onprogress=function(a){d.trigger(a)};e.onload=function(){A.call(d,e.response,!0)};e.onerror=function(a){d.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",
b)});e.send(null,c)}g.call(this);e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){b.apply(this,arguments)},downsize:function(a,b,d,f){var g={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:!1};a="object"==typeof a?e.extend(g,a):e.extend(g,{width:a,height:b,crop:d,preserveHeaders:f});try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
if(this.width>r.MAX_RESIZE_WIDTH||this.height>r.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);this.exec("Image","downsize",a.width,a.height,a.crop,a.preserveHeaders)}catch(h){this.trigger("error",h.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!m.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
return this.exec("Image","getAsBlob",a||"image/jpeg",b||90)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",a||"image/jpeg",b||90)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return w.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function f(b,d){var l=this;if(m.can("create_canvas")){var p=l.getAsCanvas();if(p)return a.appendChild(p),p=null,l.destroy(),void g.trigger("embedded")}p=
l.getAsDataURL(b,d);if(!p)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(m.can("use_data_uri_of",p.length))a.innerHTML='<img src="'+p+'" width="'+l.width+'" height="'+l.height+'" />',l.destroy(),g.trigger("embedded");else{var n=new k;n.bind("TransportingComplete",function(){h=g.connectRuntime(this.result.ruid);g.bind("Embedded",function(){e.extend(h.getShimContainer().style,{top:"0px",left:"0px",width:l.width+"px",height:l.height+"px"});h=null},999);h.exec.call(g,"ImageView","display",this.result.uid,
width,height);l.destroy()});n.transport(w.atob(p.substring(p.indexOf("base64,")+7)),b,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a})}}var g=this,h;b=e.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},b||{});try{if(!(a=d.get(a)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);this.width>r.MAX_RESIZE_WIDTH||this.height>r.MAX_RESIZE_HEIGHT;var l=
new r;return l.bind("Resize",function(){f.call(this,b.type,b.quality)}),l.bind("Load",function(){l.downsize(b)}),this.meta.thumb&&this.meta.thumb.width>=b.width&&this.meta.thumb.height>=b.height?l.load(this.meta.thumb.data):l.clone(this,!1),l}catch(p){this.trigger("error",p.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}});this.handleEventProps(x);this.bind("Load Resize",function(){var a=void 0,a=this.exec("Image",
"getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999)}var x=["progress","load","error","resize","embedded"];return r.MAX_RESIZE_WIDTH=8192,r.MAX_RESIZE_HEIGHT=8192,r.prototype=h.instance,r});m("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,d,c,b){var a={};return c.addConstructor("html5",function(d,f,g){var k=this,h=c.capTest,
m=c.capTrue;g=e.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!a.Image},display_media:h(b.can("create_canvas")||b.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==b.browser||b.verComp(b.version,9,">"))}()),filter_by_extension:h("Chrome"===
b.browser&&b.verComp(b.version,28,">=")||"IE"===b.browser&&b.verComp(b.version,10,">=")||"Safari"===b.browser&&b.verComp(b.version,7,">=")),return_response_headers:m,return_response_type:function(a){return"json"===a&&window.JSON?!0:b.can("return_response_type",a)},return_status_code:m,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&b.can("create_canvas")},select_file:function(){return b.can("use_fileinput")&&window.File},
select_folder:function(){return k.can("select_file")&&"Chrome"===b.browser&&b.verComp(b.version,21,">=")},select_multiple:function(){return!(!k.can("select_file")||"Safari"===b.browser&&"Windows"===b.os||"iOS"===b.os&&b.verComp(b.osVersion,"7.0.0",">")&&b.verComp(b.osVersion,"8.0.0","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&
(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:function(){return k.can("select_file")&&("Firefox"===b.browser&&b.verComp(b.version,4,">=")||"Opera"===b.browser&&b.verComp(b.version,12,">=")||"IE"===b.browser&&b.verComp(b.version,10,">=")||!!~e.inArray(b.browser,["Chrome",
"Safari"]))},upload_filesize:m},g);c.call(this,d,f||"html5",g);e.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});e.extend(this.getShim(),a)}),a});m("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){function d(){this.returnValue=!1}function c(){this.cancelBubble=!0}var b={},a="moxie_"+e.guid(),f=function(c,d,f){var g;if(d=d.toLowerCase(),c[a]&&b[c[a]]&&b[c[a]][d]){g=b[c[a]][d];for(var l=g.length-1;0<=l&&(g[l].orig!==
f&&g[l].key!==f||(c.removeEventListener?c.removeEventListener(d,g[l].func,!1):c.detachEvent&&c.detachEvent("on"+d,g[l].func),g[l].orig=null,g[l].func=null,g.splice(l,1),void 0===f));l--);if(g.length||delete b[c[a]][d],e.isEmptyObj(b[c[a]])){delete b[c[a]];try{delete c[a]}catch(k){c[a]=void 0}}}};return{addEvent:function(f,g,l,h){var k;g=g.toLowerCase();f.addEventListener?(k=l,f.addEventListener(g,k,!1)):f.attachEvent&&(k=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=
d;a.stopPropagation=c;l(a)},f.attachEvent("on"+g,k));f[a]||(f[a]=e.guid());b.hasOwnProperty(f[a])||(b[f[a]]={});f=b[f[a]];f.hasOwnProperty(g)||(f[g]=[]);f[g].push({func:k,orig:l,key:h})},removeEvent:f,removeAllEvents:function(c,d){c&&c[a]&&e.each(b[c[a]],function(a,b){f(c,b,d)})}}});m("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,
d,c,b,a,f,g){return e.FileInput=function(){var e;c.extend(this,{init:function(k){var h=this,m=h.getRuntime(),n,w,r;e=k;k=e.accept.mimes||f.extList2mimes(e.accept,m.can("filter_by_extension"));n=m.getShimContainer();n.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&m.can("select_multiple")?"multiple":"")+(e.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />";k=b.get(m.uid);c.extend(k.style,{position:"absolute",
top:0,left:0,width:"100%",height:"100%"});w=b.get(e.browse_button);m.can("summon_file_dialog")&&("static"===b.getStyle(w,"position")&&(w.style.position="relative"),r=parseInt(b.getStyle(w,"z-index"),10)||1,w.style.zIndex=r,n.style.zIndex=r-1,a.addEvent(w,"click",function(a){var c=b.get(m.uid);c&&!c.disabled&&c.click();a.preventDefault()},h.uid));r=m.can("summon_file_dialog")?w:n;a.addEvent(r,"mouseover",function(){h.trigger("mouseenter")},h.uid);a.addEvent(r,"mouseout",function(){h.trigger("mouseleave")},
h.uid);a.addEvent(r,"mousedown",function(){h.trigger("mousedown")},h.uid);a.addEvent(b.get(e.container),"mouseup",function(){h.trigger("mouseup")},h.uid);k.onchange=function y(a){(h.files=[],c.each(this.files,function(a){var b="";return e.directory&&"."==a.name?!0:(a.webkitRelativePath&&(b="/"+a.webkitRelativePath.replace(/^\//,"")),a=new d(m.uid,a),a.relativePath=b,void h.files.push(a))}),"IE"!==g.browser&&"IEMobile"!==g.browser)?this.value="":(a=this.cloneNode(!0),this.parentNode.replaceChild(a,
this),a.onchange=y);h.files.length&&h.trigger("change")};h.trigger({type:"ready",async:!0});n=null},disable:function(a){var c=this.getRuntime(),d;(d=b.get(c.uid))&&(d.disabled=!!a)},destroy:function(){var c=this.getRuntime(),d=c.getShim(),c=c.getShimContainer();a.removeAllEvents(c,this.uid);a.removeAllEvents(e&&b.get(e.container),this.uid);a.removeAllEvents(e&&b.get(e.browse_button),this.uid);c&&(c.innerHTML="");d.removeInstance(this.uid);e=null}})}});m("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime",
"moxie/file/Blob"],function(e,d){return e.Blob=function(){function c(b,a,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(b,a,c):null;try{return b.slice(),b.slice(a,c)}catch(e){return b.slice(a,c-a)}}this.slice=function(){return new d(this.getRuntime().uid,c.apply(this,arguments))}}});m("moxie/runtime/html5/file/FileDrop","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime".split(" "),
function(e,d,c,b,a,f){return e.FileDrop=function(){function e(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=c.toArray(a.dataTransfer.types||[]);return-1!==c.inArray("Files",a)||-1!==c.inArray("public.file-url",a)||-1!==c.inArray("application/x-moz-file",a)}function g(a,b){var e;x.length?(e=f.getFileExtension(a.name),e=!e||-1!==c.inArray(e,x)):e=!0;e&&(e=new d(u,a),e.relativePath=b||"",r.push(e))}function k(a){for(var b=[],d=0;d<a.length;d++)[].push.apply(b,a[d].extensions.split(/\s*,\s*/));
return-1===c.inArray("*",b)?b:[]}function h(a,b){var d=[];c.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?g(a.getAsFile(),b.fullPath):d.push(b))});d.length?m(d,b):b()}function m(a,b){var d=[];c.each(a,function(a){d.push(function(b){n(a,b)})});c.inSeries(d,function(){b()})}function n(a,b){a.isFile?a.file(function(c){g(c,a.fullPath);b()},function(){b()}):a.isDirectory?w(a,b):b()}function w(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],
e=a.createReader();c(function(){m(d,b)})}var r=[],x=[],y,u;c.extend(this,{init:function(b){var d=this;y=b;u=d.ruid;x=k(y.accept);b=y.container;a.addEvent(b,"dragover",function(a){e(a)&&(a.preventDefault(),a.dataTransfer.dropEffect="copy")},d.uid);a.addEvent(b,"drop",function(a){e(a)&&(a.preventDefault(),r=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?h(a.dataTransfer.items,function(){d.files=r;d.trigger("drop")}):(c.each(a.dataTransfer.files,function(a){g(a)}),d.files=r,d.trigger("drop")))},
d.uid);a.addEvent(b,"dragenter",function(a){d.trigger("dragenter")},d.uid);a.addEvent(b,"dragleave",function(a){d.trigger("dragleave")},d.uid)},destroy:function(){a.removeAllEvents(y&&b.get(y.container),this.uid);u=r=x=y=null}})}});m("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,d,c){return e.FileReader=function(){var b,a=!1;c.extend(this,{read:function(e,f){var g=this;g.result="";b=new window.FileReader;b.addEventListener("progress",
function(a){g.trigger(a)});b.addEventListener("load",function(c){g.result=a?d.atob(b.result.substring(b.result.indexOf("base64,")+7)):b.result;g.trigger(c)});b.addEventListener("error",function(a){g.trigger(a,b.error)});b.addEventListener("loadend",function(a){b=null;g.trigger(a)});"function"===c.typeOf(b[e])?(a=!1,b[e](f.getSource())):"readAsBinaryString"===e&&(a=!0,b.readAsDataURL(f.getSource()))},abort:function(){b&&b.abort()},destroy:function(){b=null}})}});m("moxie/runtime/html5/xhr/XMLHttpRequest",
"moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(e,d,c,b,a,f,g,k,m){return e.XMLHttpRequest=function(){function e(a,b){var c=this,d,g;d=b.getBlob().getSource();g=new window.FileReader;g.onload=function(){b.append(b.getBlobName(),new f(null,{type:d.type,data:g.result}));w.send.call(c,a,b)};g.readAsBinaryString(d)}function n(){var a;if(!window.XMLHttpRequest||
"IE"===m.browser&&m.verComp(m.version,8,"<"))a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}else a=new window.XMLHttpRequest;return a}function s(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new k.RuntimeError(k.RuntimeError.NOT_SUPPORTED_ERR);return r.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,d){c+=a instanceof
f?"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n":"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),c+="--"+b+"--\r\n"}var w=this,r,x;d.extend(this,{send:function(a,c){var k=this,t="Mozilla"===m.browser&&m.verComp(m.version,4,">=")&&m.verComp(m.version,7,"<"),w="Android Browser"===m.browser,
u=!1;if(x=a.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),r=n(),r.open(a.method,a.url,a.async,a.user,a.password),c instanceof f)c.isDetached()&&(u=!0),c=c.getSource();else if(c instanceof g){if(c.hasBlob())if(c.getBlob().isDetached())c=s.call(k,c),u=!0;else if((t||w)&&"blob"===d.typeOf(c.getBlob().getSource())&&window.FileReader)return void e.call(k,a,c);if(c instanceof g){var D=new window.FormData;c.each(function(a,b){a instanceof f?D.append(b,a.getSource()):D.append(b,a)});c=D}}r.upload?
(a.withCredentials&&(r.withCredentials=!0),r.addEventListener("load",function(a){k.trigger(a)}),r.addEventListener("error",function(a){k.trigger(a)}),r.addEventListener("progress",function(a){k.trigger(a)}),r.upload.addEventListener("progress",function(a){k.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):r.onreadystatechange=function(){switch(r.readyState){case 3:var c,d;try{b.hasSameOrigin(a.url)&&(c=r.getResponseHeader("Content-Length")||0),r.responseText&&(d=r.responseText.length)}catch(e){c=
d=0}k.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:d});break;case 4:r.onreadystatechange=function(){},k.trigger(0===r.status?"error":"load")}};d.isEmptyObj(a.headers)||d.each(a.headers,function(a,b){r.setRequestHeader(b,a)});""!==a.responseType&&"responseType"in r&&("json"!==a.responseType||m.can("return_response_type","json")?r.responseType=a.responseType:r.responseType="text");u?r.sendAsBinary?r.sendAsBinary(c):!function(){for(var a=new Uint8Array(c.length),b=0;b<c.length;b++)a[b]=
255&c.charCodeAt(b);r.send(a.buffer)}():r.send(c);k.trigger("loadstart")},getStatus:function(){try{if(r)return r.status}catch(a){}return 0},getResponse:function(b){var d=this.getRuntime();try{switch(b){case "blob":var e=new a(d.uid,r.response),f=r.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(x=g[2])}return e.name=x,e.type||(e.type=c.getFileMime(x)),e;case "json":return m.can("return_response_type","json")?r.response:200===r.status&&window.JSON?JSON.parse(r.responseText):
null;case "document":var h=r.responseXML,l=r.responseText;return"IE"===m.browser&&l&&h&&!h.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(r.getResponseHeader("Content-Type"))&&(h=new window.ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.validateOnParse=!1,h.loadXML(l)),h&&("IE"===m.browser&&0!==h.parseError||!h.documentElement||"parsererror"===h.documentElement.tagName)?null:h;default:return""!==r.responseText?r.responseText:null}}catch(k){return null}},getAllResponseHeaders:function(){try{return r.getAllResponseHeaders()}catch(a){}return""},
abort:function(){r&&r.abort()},destroy:function(){w=x=null}})}});m("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(e){function d(a){a instanceof ArrayBuffer?c.apply(this,arguments):b.apply(this,arguments)}function c(a){var b=new DataView(a);e.extend(this,{readByteAt:function(a){return b.getUint8(a)},writeByteAt:function(a,c){b.setUint8(a,c)},SEGMENT:function(c,d,e){switch(arguments.length){case 2:return a.slice(c,c+d);case 1:return a.slice(c);case 3:if(null===e&&(e=new ArrayBuffer),
e instanceof ArrayBuffer){var f=new Uint8Array(this.length()-d+e.byteLength);0<c&&f.set(new Uint8Array(a.slice(0,c)),0);f.set(new Uint8Array(e),c);f.set(new Uint8Array(a.slice(c+d)),c+e.byteLength);this.clear();a=f.buffer;b=new DataView(a);break}default:return a}},length:function(){return a?a.byteLength:0},clear:function(){b=a=null}})}function b(a){function b(c,d,e){e=3===arguments.length?e:a.length-d-1;a=a.substr(0,d)+c+a.substr(e+d)}e.extend(this,{readByteAt:function(b){return a.charCodeAt(b)},
writeByteAt:function(a,c){b(String.fromCharCode(c),a,1)},SEGMENT:function(c,d,e){switch(arguments.length){case 1:return a.substr(c);case 2:return a.substr(c,d);case 3:b(null!==e?e:"",c,d);break;default:return a}},length:function(){return a?a.length:0},clear:function(){a=null}})}return e.extend(d.prototype,{littleEndian:!1,read:function(a,b){var c,d,e;if(a+b>this.length())throw Error("You are trying to read outside the source boundaries.");d=this.littleEndian?0:-8*(b-1);for(c=e=0;b>e;e++)c|=this.readByteAt(a+
e)<<Math.abs(d+8*e);return c},write:function(a,b,c){var d,e;if(a>this.length())throw Error("You are trying to write outside the source boundaries.");d=this.littleEndian?0:-8*(c-1);for(e=0;c>e;e++)this.writeByteAt(a+e,b>>Math.abs(d+8*e)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){a=this.read(a,4);return 2147483647<a?a-4294967296:a},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,
b){return this.asArray("CHAR",a,b).join("")},asArray:function(a,b,c){for(var d=[],e=0;c>e;e++)d[e]=this[a](b+e);return d}}),d});m("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,d){return function b(a){var f=[],g,k,m,h=0;if(g=new e(a),65496!==g.SHORT(0))throw g.clear(),new d.ImageError(d.ImageError.WRONG_FORMAT);for(k=2;k<=g.length();)if(m=g.SHORT(k),65488<=m&&65495>=m)k+=2;else{if(65498===m||65497===m)break;h=g.SHORT(k+2)+2;65505<=
m&&65519>=m&&f.push({hex:m,name:"APP"+(15&m),start:k,length:h,segment:g.SEGMENT(k,h)});k+=h}return g.clear(),{headers:f,restore:function(a){var b,d,g;g=new e(a);k=65504==g.SHORT(2)?4+g.SHORT(4):2;d=0;for(b=f.length;b>d;d++)g.SEGMENT(k,0,f[d].segment),k+=f[d].length;return a=g.SEGMENT(),g.clear(),a},strip:function(a){var d,f,g;d=new b(a);f=d.headers;d.purge();d=new e(a);for(g=f.length;g--;)d.SEGMENT(f[g].start,f[g].length,"");return a=d.SEGMENT(),d.clear(),a},get:function(a){for(var b=[],d=0,e=f.length;e>
d;d++)f[d].name===a.toUpperCase()&&b.push(f[d].segment);return b},set:function(a,b){var d=[],e,g,h;"string"==typeof b?d.push(b):d=b;e=g=0;for(h=f.length;h>e&&(f[e].name===a.toUpperCase()&&(f[e].segment=d[g],f[e].length=d[g].length,g++),!(g>=d.length));e++);},purge:function(){this.headers=f=[]}}}});m("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(e,d,c){function b(a){function g(a,b){var d,k,l,m,p,s,t,v,u=[],
I={},O={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},L={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};d=this.SHORT(a);for(k=0;d>k;k++)if(u=[],t=a+2+12*k,l=b[this.SHORT(t)],l!==f){if(m=O[this.SHORT(t+=2)],p=this.LONG(t+=2),s=L[m],!s)throw new c.ImageError(c.ImageError.INVALID_META_ERR);if(t+=4,4<s*p&&(t=this.LONG(t)+h.tiffHeader),t+s*p>=this.length())throw new c.ImageError(c.ImageError.INVALID_META_ERR);"ASCII"!==m?(u=this.asArray(m,
t,p),v=1==p?u[0]:u,n.hasOwnProperty(l)&&"object"!=typeof v?I[l]=n[l][v]:I[l]=v):I[l]=e.trim(this.STRING(t,p).replace(/\0$/,""))}return I}var k,m,n,h,v,s;if(d.call(this,a),m={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",
37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},n={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",
3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",
1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",
69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",
95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",
W:"West longitude"}},h={tiffHeader:10},v=h.tiffHeader,k={clear:this.clear},e.extend(this,{read:function(){try{return b.prototype.read.apply(this,arguments)}catch(a){throw new c.ImageError(c.ImageError.INVALID_META_ERR);}},write:function(){try{return b.prototype.write.apply(this,arguments)}catch(a){throw new c.ImageError(c.ImageError.INVALID_META_ERR);}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(a){return this.LONG(a)/this.LONG(a+4)},SRATIONAL:function(a){return this.SLONG(a)/
this.SLONG(a+4)},ASCII:function(a){return this.CHAR(a)},TIFF:function(){return s||null},EXIF:function(){var a=null;if(h.exifIFD){try{a=g.call(this,h.exifIFD,m.exif)}catch(b){return null}if(a.ExifVersion&&"array"===e.typeOf(a.ExifVersion)){for(var c=0,d="";c<a.ExifVersion.length;c++)d+=String.fromCharCode(a.ExifVersion[c]);a.ExifVersion=d}}return a},GPS:function(){var a=null;if(h.gpsIFD){try{a=g.call(this,h.gpsIFD,m.gps)}catch(b){return null}a.GPSVersionID&&"array"===e.typeOf(a.GPSVersionID)&&(a.GPSVersionID=
a.GPSVersionID.join("."))}return a},thumb:function(){if(h.IFD1)try{var a=g.call(this,h.IFD1,m.thumb);if("JPEGInterchangeFormat"in a)return this.SEGMENT(h.tiffHeader+a.JPEGInterchangeFormat,a.JPEGInterchangeFormatLength)}catch(b){}return null},setExif:function(a,b){var c;if("PixelXDimension"!==a&&"PixelYDimension"!==a)c=!1;else a:{c=a;var d,e,f,g=0;if("string"==typeof c)for(e in d=m.exif,d)if(d[e]===c){c=e;break}d=h.exifIFD;e=this.SHORT(d);for(var k=0;e>k;k++)if(f=d+12*k+2,this.SHORT(f)==c){g=f+8;
break}if(g){try{this.write(g,b,4)}catch(l){c=!1;break a}c=!0}else c=!1}return c},clear:function(){k.clear();a=m=n=s=h=k=null}}),65505!==this.SHORT(0)||"EXIF\x00"!==this.STRING(4,5).toUpperCase())throw new c.ImageError(c.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(v),42!==this.SHORT(v+=2))throw new c.ImageError(c.ImageError.INVALID_META_ERR);h.IFD0=h.tiffHeader+this.LONG(v+=2);s=g.call(this,h.IFD0,m.tiff);"ExifIFDPointer"in s&&(h.exifIFD=h.tiffHeader+s.ExifIFDPointer,delete s.ExifIFDPointer);
"GPSInfoIFDPointer"in s&&(h.gpsIFD=h.tiffHeader+s.GPSInfoIFDPointer,delete s.GPSInfoIFDPointer);e.isEmptyObj(s)&&(s=null);(v=this.LONG(h.IFD0+12*this.SHORT(h.IFD0)+2))&&(h.IFD1=h.tiffHeader+v)}return b.prototype=d.prototype,b});m("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(e,d,c,b,a){return function(f){function g(a){var b=0,c,d;for(a||
(a=m);b<=a.length();){if(c=a.SHORT(b+=2),65472<=c&&65475>=c)return b+=5,{height:a.SHORT(b),width:a.SHORT(b+2)};d=a.SHORT(b+=2);b+=d-2}return null}function k(){var a=n.thumb(),c,d;return a&&(c=new b(a),d=g(c),c.clear(),d)?(d.data=a,d):null}var m,h,n,s;if(m=new b(f),65496!==m.SHORT(0))throw new d.ImageError(d.ImageError.WRONG_FORMAT);h=new c(f);try{n=new a(h.get("app1")[0])}catch(w){}s=g.call(this);e.extend(this,{type:"image/jpeg",size:m.length(),width:s&&s.width||0,height:s&&s.height||0,setExif:function(a,
b){return n?("object"===e.typeOf(a)?e.each(a,function(a,b){n.setExif(b,a)}):n.setExif(a,b),void h.set("app1",n.SEGMENT())):!1},writeHeaders:function(){return h.restore(arguments.length?arguments[0]:f)},stripHeaders:function(a){return h.strip(a)},purge:function(){n&&h&&m&&(n.clear(),h.purge(),m.clear(),s=h=n=m=null)}});n&&(this.meta={tiff:n.TIFF(),exif:n.EXIF(),gps:n.GPS(),thumb:k()})}});m("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],
function(e,d,c){return function(b){function a(){f&&(f.clear(),b=g=f=null)}var f,g;f=new c(b);(function(){for(var a=0,b=0,c=[35152,20039,3338,6666],b=0;b<c.length;b++,a+=2)if(c[b]!=f.SHORT(a))throw new e.ImageError(e.ImageError.WRONG_FORMAT);})();g=function(){var a,b,c=8,d,e,g,k;return a=(d=f.LONG(c),e=f.STRING(c+=4,4),g=c+=4,k=f.LONG(c+d),{length:d,type:e,start:g,CRC:k}),"IHDR"==a.type?(b=a.start,{width:f.LONG(b),height:f.LONG(b+4)}):null}.call(this);d.extend(this,{type:"image/png",size:f.length(),
width:g.width,height:g.height,purge:function(){a.call(this)}});a.call(this)}});m("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,d,c,b){return function(a){var f=[c,b],g;g=function(){for(var b=0;b<f.length;b++)try{return new f[b](a)}catch(c){}throw new d.ImageError(d.ImageError.WRONG_FORMAT);}();e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},
stripHeaders:function(a){return a},purge:function(){a=null}});e.extend(this,g);this.purge=function(){g.purge();g=null}}});m("moxie/runtime/html5/image/MegaPixel",[],function(){function e(d){var c=d.naturalWidth;if(1048576<c*d.naturalHeight){var b=document.createElement("canvas");b.width=b.height=1;b=b.getContext("2d");return b.drawImage(d,-c+1,0),0===b.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:e,renderTo:function(d,c,b){var a=d.naturalWidth,f=d.naturalHeight,g=b.width,k=b.height,
m=b.x||0;b=b.y||0;c=c.getContext("2d");e(d)&&(a/=2,f/=2);var h=document.createElement("canvas");h.width=h.height=1024;var n=h.getContext("2d"),s;s=f;var w=document.createElement("canvas");w.width=1;w.height=s;w=w.getContext("2d");w.drawImage(d,0,0);for(var w=w.getImageData(0,0,1,s).data,r=0,u=s,y=s;y>r;)0===w[4*(y-1)+3]?u=y:r=y,y=u+r>>1;s=y/s;s=0===s?1:s;for(w=0;f>w;){r=w+1024>f?f-w:1024;for(u=0;a>u;){y=u+1024>a?a-u:1024;n.clearRect(0,0,1024,1024);n.drawImage(d,-u,-w);var z=u*g/a+m<<0,A=Math.ceil(y*
g/a),B=w*k/f/s+b<<0,C=Math.ceil(r*k/f/s);c.drawImage(h,0,0,y,r,z,B,A,C);u+=1024}w+=1024}}}});m("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(e,d,c,b,a,f,g,k,m,h){return e.Image=function(){function e(){if(!C&&!A)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);
return C||A}function n(a){return b.atob(a.substring(a.indexOf("base64,")+7))}function w(a){var d=this;A=new Image;A.onerror=function(){y.call(this);d.trigger("error",c.ImageError.WRONG_FORMAT)};A.onload=function(){d.trigger("load")};A.src="data:"==a.substr(0,5)?a:"data:"+(D.type||"")+";base64,"+b.btoa(a)}function r(a,b){var d=this,e;return window.FileReader?(e=new FileReader,e.onload=function(){b(this.result)},e.onerror=function(){d.trigger("error",c.ImageError.WRONG_FORMAT)},e.readAsDataURL(a),void 0):
b(a.getAsDataURL())}function u(a,b,c,f){var g,l=0,m=0,n,p;if(I=f,p=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==d.inArray(p,[5,6,7,8]))n=a,a=b,b=n;n=e();c?(a=Math.min(a,n.width),b=Math.min(b,n.height),g=Math.max(a/n.width,b/n.height)):g=Math.min(a/n.width,b/n.height);if(1<g&&!c&&f)m=void this.trigger("Resize");else{C||(C=document.createElement("canvas"));f=Math.round(n.width*g);g=Math.round(n.height*g);c?(C.width=a,C.height=b,f>a&&(l=Math.round((f-a)/2)),g>b&&(m=Math.round((g-b)/
2))):(C.width=f,C.height=g);if(!I){a=C.width;b=C.height;switch(p){case 5:case 6:case 7:case 8:C.width=b;C.height=a;break;default:C.width=a,C.height=b}c=C.getContext("2d");switch(p){case 2:c.translate(a,0);c.scale(-1,1);break;case 3:c.translate(a,b);c.rotate(Math.PI);break;case 4:c.translate(0,b);c.scale(1,-1);break;case 5:c.rotate(0.5*Math.PI);c.scale(1,-1);break;case 6:c.rotate(0.5*Math.PI);c.translate(0,-b);break;case 7:c.rotate(0.5*Math.PI);c.translate(a,-b);c.scale(-1,1);break;case 8:c.rotate(-0.5*
Math.PI),c.translate(-a,0)}}p=C;l=-l;m=-m;"iOS"===h.OS?k.renderTo(n,p,{width:f,height:g,x:l,y:m}):p.getContext("2d").drawImage(n,l,m,f,g);m=(this.width=C.width,this.height=C.height,G=!0,void this.trigger("Resize"))}return m}function y(){B&&(B.purge(),B=null);K=A=C=D=null;G=!1}var z=this,A,B,C,K,D,G=!1,I=!0;d.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return D=
a,a.isDetached()?(K=a.getSource(),void w.call(this,K)):void r.call(this,a.getSource(),function(a){e&&(K=n(a));w.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta;D=new f(null,{name:a.name,size:a.size,type:a.type});w.call(this,b?K=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b=this.getRuntime(),c;return!B&&K&&b.can("access_image_binary")&&(B=new g(K)),c={width:e().width||0,height:e().height||0,type:D.type||m.getFileMime(D.name),size:K&&K.length||D.size||0,name:D.name||"",
meta:B&&B.meta||this.meta||{}},!c.meta||!c.meta.thumb||c.meta.thumb.data instanceof a||(c.meta.thumb.data=new a(null,{type:"image/jpeg",data:c.meta.thumb.data})),c},downsize:function(){u.apply(this,arguments)},getAsCanvas:function(){return C&&(C.id=this.uid+"_canvas"),C},getAsBlob:function(a,b){return a!==this.type&&u.call(this,this.width,this.height,!1),new f(null,{name:D.name||"",type:a,data:z.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!G)return A.src;if("image/jpeg"!==
a)return C.toDataURL("image/png");try{return C.toDataURL("image/jpeg",c/100)}catch(d){return C.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!G)return K||(K=n(z.getAsDataURL(a,b))),K;if("image/jpeg"!==a)K=n(z.getAsDataURL(a,b));else{var c;b||(b=90);try{c=C.toDataURL("image/jpeg",b/100)}catch(d){c=C.toDataURL("image/jpeg")}K=n(c);B&&(K=B.stripHeaders(K),I&&(B.meta&&B.meta.exif&&B.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),K=B.writeHeaders(K)),B.purge(),B=null)}return G=
!1,K},destroy:function(){z=null;y.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});m("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,d,c,b,a){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+
"."+a[1])}function g(a){var b=c.get(a);b&&"OBJECT"==b.nodeName&&("IE"===d.browser?(b.style.display="none",function s(){if(4==b.readyState){var d=c.get(a);if(d){for(var e in d)"function"==typeof d[e]&&(d[e]=null);d.parentNode.removeChild(d)}}else setTimeout(s,10)}()):b.parentNode.removeChild(b))}var k={};return a.addConstructor("flash",function(m){var h=this,n;m=e.extend({swf_url:d.swf_url},m);a.call(this,m,"flash",{access_binary:function(a){return a&&"browser"===h.mode},access_image_binary:function(a){return a&&
"browser"===h.mode},display_media:a.capTrue,do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===h.mode},resize_image:a.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!e.arrayDiff(a,["","text","document"])||"browser"===h.mode},return_status_code:function(a){return"browser"===h.mode||!e.arrayDiff(a,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:function(a){return a&&"browser"===h.mode},
send_browser_cookies:function(a){return a&&"browser"===h.mode},send_custom_headers:function(a){return a&&"browser"===h.mode},send_multipart:a.capTrue,slice_blob:function(a){return a&&"browser"===h.mode},stream_upload:function(a){return a&&"browser"===h.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=e.parseSizeStr(a)||"client"===h.mode},use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?
"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return e.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return e.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?
"client":"browser"},upload_filesize:function(a){return 2097152<=e.parseSizeStr(a)?"client":"browser"}},"client");10>f()&&(this.mode=!1);e.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return h.getShim().exec(this.uid,a,b,c)},init:function(){var a,c,f;f=this.getShimContainer();e.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});a='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+
m.swf_url+'" ';"IE"===d.browser&&(a+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');a+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+m.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+d.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===d.browser?(c=document.createElement("div"),f.appendChild(c),c.outerHTML=a,c=f=null):f.innerHTML=a;n=setTimeout(function(){h&&
!h.initialized&&h.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){g(h.uid);a.call(h);clearTimeout(n);m=n=a=h=null}}(this.destroy)},k)}),k});m("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(e,d,c){return e.FileInput={init:function(b){var a=this,e=this.getRuntime();this.bind("Change",function(){var b=e.shimExec.call(a,"FileInput","getFiles");a.files=[];c.each(b,function(b){a.files.push(new d(e.uid,
b))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{name:b.name,accept:b.accept,multiple:b.multiple});this.trigger("ready")}}});m("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,d){return e.Blob={slice:function(c,b,a,e){var f=this.getRuntime();return 0>b?b=Math.max(c.size+b,0):0<b&&(b=Math.min(b,c.size)),0>a?a=Math.max(c.size+a,0):0<a&&(a=Math.min(a,c.size)),c=f.shimExec.call(this,"Blob","slice",b,a,e||""),c&&(c=new d(f.uid,c)),c}}});m("moxie/runtime/flash/file/FileReader",
["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,d){function c(b,a){switch(a){case "readAsText":return d.atob(b,"utf8");case "readAsBinaryString":return d.atob(b);case "readAsDataURL":return b}return null}return e.FileReader={read:function(b,a){var d=this;return d.result="","readAsDataURL"===b&&(d.result="data:"+(a.type||"")+";base64,"),d.bind("Progress",function(a,e){e&&(d.result+=c(e,b))},999),d.getRuntime().shimExec.call(this,"FileReader","readAsBase64",a.uid)}}});m("moxie/runtime/flash/file/FileReaderSync",
["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,d){function c(b,a){switch(a){case "readAsText":return d.atob(b,"utf8");case "readAsBinaryString":return d.atob(b);case "readAsDataURL":return b}return null}return e.FileReaderSync={read:function(b,a){var d;return(d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",a.uid))?("readAsDataURL"===b&&(d="data:"+(a.type||"")+";base64,"+d),c(d,b,a.type)):null}}});m("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(e,d,c,b,a,f,g){return e.XMLHttpRequest={send:function(a,b){function e(){a.transport=r.mode;r.shimExec.call(n,"XMLHttpRequest","send",a,b)}function k(a,c){r.shimExec.call(n,"XMLHttpRequest","appendBlob",a,c.uid);b=null;e()}function m(a,b){var c=new g;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:r.uid})}var n=this,r=n.getRuntime();if(d.isEmptyObj(a.headers)||d.each(a.headers,function(a,b){r.shimExec.call(n,"XMLHttpRequest","setRequestHeader",
b,a.toString())}),b instanceof f){var u;if(b.each(function(a,b){a instanceof c?u=b:r.shimExec.call(n,"XMLHttpRequest","append",b,a)}),b.hasBlob()){var y=b.getBlob();y.isDetached()?m(y,function(a){y.destroy();k(u,a)}):k(u,y)}else b=null,e()}else b instanceof c?b.isDetached()?m(b,function(a){b.destroy();b=a.uid;e()}):(b=b.uid,e()):e()},getResponse:function(c){var e,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new b(g.uid,f),"blob"===c)return f;try{if(e=
new a,~d.inArray(c,["","text"]))return e.readAsText(f);if("json"===c&&window.JSON)return JSON.parse(e.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});m("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,d){return e.Transporter={getAsBlob:function(c){var b=this.getRuntime();return(c=b.shimExec.call(this,
"Transporter","getAsBlob",c))?new d(b.uid,c):null}}});m("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,d,c,b,a){return e.Image={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid);d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var f=new c;f.bind("TransportingComplete",function(){b(f.result.getSource())});f.transport(a.getSource(),
a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getInfo:function(){var a=this.getRuntime(),c=a.shimExec.call(this,"Image","getInfo");return!c.meta||!c.meta.thumb||c.meta.thumb.data instanceof b||(c.meta.thumb.data=new b(a.uid,c.meta.thumb.data)),c},getAsBlob:function(a,c){var d=this.getRuntime(),e=d.shimExec.call(this,"Image","getAsBlob",a,c);return e?new b(d.uid,e):null},getAsDataURL:function(){var b=
this.getRuntime().Image.getAsBlob.apply(this,arguments),c;return b?(c=new a,c.readAsDataURL(b)):null}}});m("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,d,c,b,a){function f(a){var b=!1,c=null,d,e,g,k,l,m=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(n){var p=navigator.plugins["Silverlight Plug-In"];if(p){d=p.description;"1.0.30226.2"===
d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(g=a.split(".");4<g.length;)g.pop();do k=parseInt(g[m],10),l=parseInt(e[m],10),m++;while(m<g.length&&k===l);l>=k&&!isNaN(k)&&(b=!0)}}}catch(u){b=!1}return b}var g={};return a.addConstructor("silverlight",function(k){var m=this,h;k=e.extend({xap_url:d.xap_url},k);a.call(this,k,"silverlight",{access_binary:a.capTrue,access_image_binary:a.capTrue,display_media:a.capTrue,do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:a.capTrue,
resize_image:a.capTrue,return_response_headers:function(a){return a&&"client"===m.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===m.mode||!e.arrayDiff(a,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:a.capTrue,send_browser_cookies:function(a){return a&&"browser"===m.mode},send_custom_headers:function(a){return a&&"client"===m.mode},send_multipart:a.capTrue,slice_blob:a.capTrue,stream_upload:!0,
summon_file_dialog:!1,upload_filesize:a.capTrue,use_http_method:function(a){return"client"===m.mode||!e.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return e.arrayDiff(a,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return e.arrayDiff(a,["GET","POST"])?"client":["client",
"browser"]}});f("2.0.31005.0")&&"Opera"!==d.browser||(this.mode=!1);e.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return m.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+k.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+
this.uid+",target="+d.global_event_dispatcher+'"/></object>';h=setTimeout(function(){m&&!m.initialized&&m.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR))},"Windows"!==d.OS?1E4:5E3)},destroy:function(a){return function(){a.call(m);clearTimeout(h);k=h=a=m=null}}(this.destroy)},g)}),g});m("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(e,d,c){return e.FileInput={init:function(b){var a=this,e=this.getRuntime();
this.bind("Change",function(){var b=e.shimExec.call(a,"FileInput","getFiles");a.files=[];c.each(b,function(b){a.files.push(new d(e.uid,b))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",function(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(b.accept),b.name,b.multiple);this.trigger("ready")}}});m("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],
function(e,d,c){return e.Blob=d.extend({},c)});m("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,d,c){return e.FileDrop={init:function(){var b=this.getRuntime(),a;return a=b.getShimContainer(),c.addEvent(a,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},this.uid),c.addEvent(a,"dragenter",function(a){a.preventDefault();d.get(b.uid).dragEnter(a)&&a.stopPropagation()},
this.uid),c.addEvent(a,"drop",function(a){a.preventDefault();d.get(b.uid).dragDrop(a)&&a.stopPropagation()},this.uid),b.shimExec.call(this,"FileDrop","init")}}});m("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,d,c){return e.FileReader=d.extend({},c)});m("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],
function(e,d,c){return e.FileReaderSync=d.extend({},c)});m("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(e,d,c){return e.XMLHttpRequest=d.extend({},c)});m("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,d,c){return e.Transporter=d.extend({},c)});m("moxie/runtime/silverlight/image/Image",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(e,d,c,b){return e.Image=d.extend({},b,{getInfo:function(){var a=this.getRuntime(),b=["tiff","exif","gps","thumb"],e={meta:{}},f=a.shimExec.call(this,"Image","getInfo");return f.meta&&(d.each(b,function(a){var b=f.meta[a],c,d,g,k;if(b&&b.keys)for(e.meta[a]={},d=0,g=b.keys.length;g>d;d++)c=b.keys[d],(k=b[c])&&(/^(\d|[1-9]\d+)$/.test(k)?k=parseInt(k,10):/^\d*\.\d+$/.test(k)&&(k=
parseFloat(k)),e.meta[a][c]=k)}),!e.meta||!e.meta.thumb||e.meta.thumb.data instanceof c||(e.meta.thumb.data=new c(a.uid,e.meta.thumb.data))),e.width=parseInt(f.width,10),e.height=parseInt(f.height,10),e.size=parseInt(f.size,10),e.type=f.type,e.name=f.name,e}})});m("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,d,c,b){var a={};return c.addConstructor("html4",function(d){var f=this,g=c.capTest,k=c.capTrue;c.call(this,
d,"html4",{access_binary:g(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:g(a.Image&&(b.can("create_canvas")||b.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:g("Chrome"===b.browser&&b.verComp(b.version,28,">=")||"IE"===b.browser&&b.verComp(b.version,10,">=")||"Safari"===b.browser&&b.verComp(b.version,7,">=")),resize_image:function(){return a.Image&&f.can("access_binary")&&b.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,
return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~e.inArray(a,["text","document",""])},return_status_code:function(a){return!e.arrayDiff(a,[200,404])},select_file:function(){return b.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return f.can("select_file")},summon_file_dialog:function(){return f.can("select_file")&&("Firefox"===b.browser&&b.verComp(b.version,4,">=")||"Opera"===b.browser&&
b.verComp(b.version,12,">=")||"IE"===b.browser&&b.verComp(b.version,10,">=")||!!~e.inArray(b.browser,["Chrome","Safari"]))},upload_filesize:k,use_http_method:function(a){return!e.arrayDiff(a,["GET","POST"])}});e.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(f);a=f=null}}(this.destroy)});e.extend(this.getShim(),a)}),a});m("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(e,d,c,b,a,f,g){return e.FileInput=function(){function e(){var f=this,l=f.getRuntime(),n,u,y,z,A,B;B=c.guid("uid_");n=l.getShimContainer();k&&(y=b.get(k+"_form"),y&&c.extend(y.style,{top:"100%"}));z=document.createElement("form");z.setAttribute("id",B+"_form");z.setAttribute("method","post");z.setAttribute("enctype","multipart/form-data");z.setAttribute("encoding","multipart/form-data");c.extend(z.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});A=document.createElement("input");
A.setAttribute("id",B);A.setAttribute("type","file");A.setAttribute("name",m.name||"Filedata");A.setAttribute("accept",h.join(","));c.extend(A.style,{fontSize:"999px",opacity:0});z.appendChild(A);n.appendChild(z);c.extend(A.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===g.browser&&g.verComp(g.version,10,"<")&&c.extend(A.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});A.onchange=function(){var a;if(this.value){if(this.files){if(a=this.files[0],0===
a.size)return void z.parentNode.removeChild(z)}else a={name:this.value};a=new d(l.uid,a);this.onchange=function(){};e.call(f);f.files=[a];A.setAttribute("id",a.uid);z.setAttribute("id",a.uid+"_form");f.trigger("change");A=z=null}};l.can("summon_file_dialog")&&(u=b.get(m.browse_button),a.removeEvent(u,"click",f.uid),a.addEvent(u,"click",function(a){A&&!A.disabled&&A.click();a.preventDefault()},f.uid));k=B;n=y=u=null}var k,h=[],m;c.extend(this,{init:function(c){var d=this,g=d.getRuntime(),k;m=c;h=c.accept.mimes||
f.extList2mimes(c.accept,g.can("filter_by_extension"));k=g.getShimContainer();(function(){var e,f;e=b.get(c.browse_button);g.can("summon_file_dialog")&&("static"===b.getStyle(e,"position")&&(e.style.position="relative"),f=parseInt(b.getStyle(e,"z-index"),10)||1,e.style.zIndex=f,k.style.zIndex=f-1);e=g.can("summon_file_dialog")?e:k;a.addEvent(e,"mouseover",function(){d.trigger("mouseenter")},d.uid);a.addEvent(e,"mouseout",function(){d.trigger("mouseleave")},d.uid);a.addEvent(e,"mousedown",function(){d.trigger("mousedown")},
d.uid);a.addEvent(b.get(c.container),"mouseup",function(){d.trigger("mouseup")},d.uid);e=null})();e.call(this);k=null;d.trigger({type:"ready",async:!0})},disable:function(a){var c;(c=b.get(k))&&(c.disabled=!!a)},destroy:function(){var c=this.getRuntime(),d=c.getShim(),c=c.getShimContainer();a.removeAllEvents(c,this.uid);a.removeAllEvents(m&&b.get(m.container),this.uid);a.removeAllEvents(m&&b.get(m.browse_button),this.uid);c&&(c.innerHTML="");d.removeInstance(this.uid);k=h=m=null}})}});m("moxie/runtime/html4/file/FileReader",
["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,d){return e.FileReader=d});m("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(e,d,c,b,a,f,g,k){return e.XMLHttpRequest=function(){function e(a){var b=this,d,g,h,k=!1;if(n){if(d=n.id.replace(/_iframe$/,""),g=c.get(d+"_form")){d=g.getElementsByTagName("input");
for(h=d.length;h--;)switch(d[h].getAttribute("type")){case "hidden":d[h].parentNode.removeChild(d[h]);break;case "file":k=!0}d=[];k||g.parentNode.removeChild(g);g=null}setTimeout(function(){f.removeEvent(n,"load",b.uid);n.parentNode&&n.parentNode.removeChild(n);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);n=null;a()},1)}}var h,m,n;d.extend(this,{send:function(u,r){var x=this,y=x.getRuntime(),z,A,B,C;if(h=m=null,r instanceof k&&r.hasBlob()){if(C=r.getBlob(),
z=C.uid,B=c.get(z),A=c.get(z+"_form"),!A)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);}else z=d.guid("uid_"),A=document.createElement("form"),A.setAttribute("id",z+"_form"),A.setAttribute("method",u.method),A.setAttribute("enctype","multipart/form-data"),A.setAttribute("encoding","multipart/form-data"),y.getShimContainer().appendChild(A);A.setAttribute("target",z+"_iframe");r instanceof k&&r.each(function(a,b){if(a instanceof g)B&&B.setAttribute("name",b);else{var c=document.createElement("input");
d.extend(c,{type:"hidden",name:b,value:a});B?A.insertBefore(c,B):A.appendChild(c)}});A.setAttribute("action",u.url);(function(){var a=y.getShimContainer()||document.body,c=document.createElement("div");c.innerHTML='<iframe id="'+z+'_iframe" name="'+z+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';n=c.firstChild;a.appendChild(n);f.addEvent(n,"load",function(){var a;try{a=n.contentWindow.document||n.contentDocument||window.frames[n.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(a.title)?
h=a.title.replace(/^(\d+).*$/,"$1"):(h=200,m=d.trim(a.body.innerHTML),x.trigger({type:"progress",loaded:m.length,total:m.length}),C&&x.trigger({type:"uploadprogress",loaded:C.size||1025,total:C.size||1025}))}catch(c){if(!b.hasSameOrigin(u.url))return void e.call(x,function(){x.trigger("error")});h=404}e.call(x,function(){x.trigger("load")})},x.uid)})();A.submit();x.trigger("loadstart")},getStatus:function(){return h},getResponse:function(a){if("json"===a&&"string"===d.typeOf(m)&&window.JSON)try{return JSON.parse(m.replace(/^\s*<pre[^>]*>/,
"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return m},abort:function(){var a=this;n&&n.contentWindow&&(n.contentWindow.stop?n.contentWindow.stop():n.contentWindow.document.execCommand?n.contentWindow.document.execCommand("Stop"):n.src="about:blank");e.call(this,function(){a.dispatchEvent("abort")})}})}});m("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,d){return e.Image=d});(function(e){for(var d=0;d<e.length;d++){for(var c=g,
b=e[d],a=b.split(/[.\/]/),k=0;k<a.length-1;++k)c[a[k]]===f&&(c[a[k]]={}),c=c[a[k]];c[a[a.length-1]]=n[b]}})("moxie/core/utils/Basic moxie/core/utils/Env moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/FileInput moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/file/FileDrop moxie/file/FileReader moxie/core/utils/Url moxie/runtime/RuntimeTarget moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(g){var f={},k=g.moxie.core.utils.Basic.inArray;return function n(e){var d,c;for(d in e)c=typeof e[d],"object"!==c||~k(d,["Exceptions","Env","Mime"])?"function"===c&&(f[d]=e[d]):n(e[d])}(g.moxie),f.Env=g.moxie.core.utils.Env,f.Mime=g.moxie.core.utils.Mime,f.Exceptions=g.moxie.core.Exceptions,g.mOxie=f,g.o||(g.o=f),f})(this);(function(g,f,k){function m(c){function b(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",
multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[a]?e[d[a]]=b:c||(e[a]=b)}var a=c.required_features,e={};if("string"==typeof a)d.each(a.split(/\s*,\s*/),function(a){b(a,!0)});else if("object"==typeof a)d.each(a,function(a,c){b(c,a)});else if(!0===a){0<c.chunk_size&&(e.slice_blob=!0);if(c.resize.enabled||!c.multipart)e.send_binary_string=
!0;d.each(c,function(a,c){b(c,!!a,!0)})}return e}var n=g.setTimeout,e={},d={VERSION:"2.1.8",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:f.mimes,ua:f.ua,typeOf:f.typeOf,extend:f.extend,guid:f.guid,get:function(c){var b=[],a;"array"!==f.typeOf(c)&&(c=[c]);
for(var d=c.length;d--;)(a=f.get(c[d]))&&b.push(a);return b.length?b:null},each:f.each,getPos:f.getPos,getSize:f.getSize,xmlEncode:function(c){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},a=/[<>&\"\']/g;return c?(""+c).replace(a,function(a){return b[a]?"&"+b[a]+";":a}):c},toArray:f.toArray,inArray:f.inArray,addI18n:f.addI18n,translate:f.translate,isEmptyObj:f.isEmptyObj,hasClass:f.hasClass,addClass:f.addClass,removeClass:f.removeClass,getStyle:f.getStyle,addEvent:f.addEvent,removeEvent:f.removeEvent,
removeAllEvents:f.removeAllEvents,cleanName:function(c){var b,a;a=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<a.length;b+=2)c=c.replace(a[b],a[b+1]);return c=c.replace(/\s+/g,"_"),c=c.replace(/[^a-z0-9_\-\.]+/gi,""),c},buildUrl:function(c,b){var a="";return d.each(b,function(b,c){a+=(a?"&":"")+
encodeURIComponent(c)+"="+encodeURIComponent(b)}),a&&(c+=(0<c.indexOf("?")?"&":"?")+a),c},formatSize:function(c){function b(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(c===k||/\D/.test(c))return d.translate("N/A");var a=Math.pow(1024,4);return c>a?b(c/a,1)+" "+d.translate("tb"):c>(a/=1024)?b(c/a,1)+" "+d.translate("gb"):c>(a/=1024)?b(c/a,1)+" "+d.translate("mb"):1024<c?Math.round(c/1024)+" "+d.translate("kb"):c+" "+d.translate("b")},parseSize:f.parseSizeStr,predictRuntime:function(c,
b){var a,e;return a=new d.Uploader(c),e=f.Runtime.thatCan(a.getOption().required_features,b||c.runtimes),a.destroy(),e},addFileFilter:function(c,b){e[c]=b}};d.addFileFilter("mime_types",function(c,b,a){c.length&&!c.regexp.test(b.name)?(this.trigger("Error",{code:d.FILE_EXTENSION_ERROR,message:d.translate("File extension error."),file:b}),a(!1)):a(!0)});d.addFileFilter("max_file_size",function(c,b,a){c=d.parseSize(c);void 0!==b.size&&c&&b.size>c?(this.trigger("Error",{code:d.FILE_SIZE_ERROR,message:d.translate("File size error."),
file:b}),a(!1)):a(!0)});d.addFileFilter("prevent_duplicates",function(c,b,a){if(c)for(c=this.files.length;c--;)if(b.name===this.files[c].name&&b.size===this.files[c].size){this.trigger("Error",{code:d.FILE_DUPLICATE_ERROR,message:d.translate("Duplicate file error."),file:b});a(!1);return}a(!0)});d.Uploader=function(c){function b(){var a,b=0,c;if(this.state==d.STARTED){for(c=0;c<G.length;c++)a||G[c].status!=d.QUEUED?b++:(a=G[c],this.trigger("BeforeUpload",a)&&(a.status=d.UPLOADING,this.trigger("UploadFile",
a)));b==G.length&&(this.state!==d.STOPPED&&(this.state=d.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",G))}}function a(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;g()}function g(){var a,b;E.reset();for(a=0;a<G.length;a++)b=G[a],b.size!==k?(E.size+=b.origSize,E.loaded+=b.loaded*b.origSize/b.size):E.size=k,b.status==d.DONE?E.uploaded++:b.status==d.FAILED?E.failed++:E.queued++;E.size===k?E.percent=0<G.length?Math.ceil(100*(E.uploaded/G.length)):0:(E.bytesPerSec=Math.ceil(E.loaded/
((+new Date-H||1)/1E3)),E.percent=0<E.size?Math.ceil(100*(E.loaded/E.size)):0)}function p(){var a=O[0]||L[0];return a?a.getRuntime().uid:!1}function t(a,b){if(a.ruid){var c=f.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function q(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");a.refresh()});this.bind("CancelUpload",z);this.bind("BeforeUpload",w);this.bind("UploadFile",r);this.bind("UploadProgress",x);this.bind("StateChanged",y);this.bind("QueueChanged",g);this.bind("Error",
B);this.bind("FileUploaded",A);this.bind("Destroy",C)}function h(a,b){var c=this,e=0,g=[],h={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:I,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};d.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(h[b]=a[b])});a.browse_button&&d.each(a.browse_button,function(b){g.push(function(g){var k=new f.FileInput(d.extend({},h,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:b}));
k.onready=function(){var a=f.Runtime.getInfo(this.ruid);f.extend(c.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});e++;O.push(this);g()};k.onchange=function(){c.addFile(this.files)};k.bind("mouseenter mouseleave mousedown mouseup",function(c){F||(a.browse_button_hover&&("mouseenter"===c.type?f.addClass(b,a.browse_button_hover):"mouseleave"===c.type&&f.removeClass(b,a.browse_button_hover)),a.browse_button_active&&("mousedown"===c.type?
f.addClass(b,a.browse_button_active):"mouseup"===c.type&&f.removeClass(b,a.browse_button_active)))});k.bind("mousedown",function(){c.trigger("Browse")});k.bind("error runtimeerror",function(){k=null;g()});k.init()})});a.drop_element&&d.each(a.drop_element,function(a){g.push(function(b){var g=new f.FileDrop(d.extend({},h,{drop_zone:a}));g.onready=function(){var a=f.Runtime.getInfo(this.ruid);c.features.dragdrop=a.can("drag_and_drop");e++;L.push(this);b()};g.ondrop=function(){c.addFile(this.files)};
g.bind("error runtimeerror",function(){g=null;b()});g.init()})});f.inSeries(g,function(){"function"==typeof b&&b(e)})}function u(a,b,c){var d=new f.Image;try{d.onload=function(){if(b.width>this.width&&b.height>this.height&&b.quality===k&&b.preserve_headers&&!b.crop)return this.destroy(),c(a);d.downsize(b.width,b.height,b.crop,b.preserve_headers)},d.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},d.onerror=function(){c(a)},d.load(a)}catch(e){c(a)}}function s(a,b,c){function e(a,
b,c){var f=D[a];switch(a){case "max_file_size":"max_file_size"===a&&(D.max_file_size=D.filters.max_file_size=b);break;case "chunk_size":if(b=d.parseSize(b))D[a]=b,D.send_file_name=!0;break;case "multipart":(D[a]=b)||(D.send_file_name=!0);break;case "unique_names":(D[a]=b)&&(D.send_file_name=!0);break;case "filters":"array"===d.typeOf(b)&&(b={mime_types:b});c?d.extend(D.filters,b):D.filters=b;b.mime_types&&(D.filters.mime_types.regexp=function(a){var b=[];return d.each(a,function(a){d.each(a.extensions.split(/,/),
function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),RegExp("("+b.join("|")+")$","i")}(D.filters.mime_types));break;case "resize":c?d.extend(D.resize,b,{enabled:!0}):D.resize=b;break;case "prevent_duplicates":D.prevent_duplicates=D.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=d.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":D[a]=
b;c||(k=!0);break;default:D[a]=b}c||g.trigger("OptionChanged",a,b,f)}var g=this,k=!1;"object"==typeof a?d.each(a,function(a,b){e(b,a,c)}):e(a,b,c);c?(D.required_features=m(d.extend({},D)),I=m(d.extend({},D,{required_features:!0}))):k&&(g.trigger("Destroy"),h.call(g,D,function(a){a?(g.runtime=f.Runtime.getInfo(p()).type,g.trigger("Init",{runtime:g.runtime}),g.trigger("PostInit")):g.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})}))}function w(a,b){if(a.settings.unique_names){var c=
b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function r(a,b){function c(){0<k--?n(e,1E3):(b.loaded=m,a.trigger("Error",{code:d.HTTP_ERROR,message:d.translate("HTTP Error."),file:b,response:J.responseText,status:J.status,responseHeaders:J.getAllResponseHeaders()}))}function e(){var q,r,s={},t;b.status===d.UPLOADING&&a.state!==d.STOPPED&&(a.settings.send_file_name&&(s.name=b.target_name||b.name),h&&l.chunks&&p.size>h?(t=Math.min(h,p.size-m),q=p.slice(m,m+t)):(t=p.size,q=
p),h&&l.chunks&&(a.settings.send_chunk_number?(s.chunk=Math.ceil(m/h),s.chunks=Math.ceil(p.size/h)):(s.offset=m,s.total=p.size)),J=new f.XMLHttpRequest,J.upload&&(J.upload.onprogress=function(c){b.loaded=Math.min(b.size,m+c.loaded);a.trigger("UploadProgress",b)}),J.onload=function(){400<=J.status?c():(k=a.settings.max_retries,t<p.size?(q.destroy(),m+=t,b.loaded=Math.min(m,p.size),a.trigger("ChunkUploaded",b,{offset:b.loaded,total:p.size,response:J.responseText,status:J.status,responseHeaders:J.getAllResponseHeaders()}),
"Android Browser"===f.Env.browser&&a.trigger("UploadProgress",b)):b.loaded=b.size,q=r=null,!m||m>=p.size?(b.size!=b.origSize&&(p.destroy(),p=null),a.trigger("UploadProgress",b),b.status=d.DONE,a.trigger("FileUploaded",b,{response:J.responseText,status:J.status,responseHeaders:J.getAllResponseHeaders()})):n(e,1))},J.onerror=function(){c()},J.onloadend=function(){this.destroy();J=null},a.settings.multipart&&l.multipart?(J.open("post",g,!0),d.each(a.settings.headers,function(a,b){J.setRequestHeader(b,
a)}),r=new f.FormData,d.each(d.extend(s,a.settings.multipart_params),function(a,b){r.append(b,a)}),r.append(a.settings.file_data_name,q),J.send(r,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(g=d.buildUrl(a.settings.url,d.extend(s,a.settings.multipart_params)),J.open("post",g,!0),J.setRequestHeader("Content-Type","application/octet-stream"),d.each(a.settings.headers,function(a,
b){J.setRequestHeader(b,a)}),J.send(q,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var g=a.settings.url,h=a.settings.chunk_size,k=a.settings.max_retries,l=a.features,m=0,p;b.loaded&&(m=b.loaded=h?h*Math.floor(b.loaded/h):0);p=b.getSource();a.settings.resize.enabled&&t(p,"send_binary_string")&&~f.inArray(p.type,["image/jpeg","image/png"])?u.call(this,p,a.settings.resize,function(a){p=
a;b.size=a.size;e()}):e()}function x(b,c){a(c)}function y(a){if(a.state==d.STARTED)H=+new Date;else if(a.state==d.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==d.UPLOADING&&(a.files[b].status=d.QUEUED,g())}function z(){J&&J.abort()}function A(a){g();n(function(){b.call(a)},1)}function B(c,e){e.code===d.INIT_ERROR?c.destroy():e.code===d.HTTP_ERROR&&(e.file.status=d.FAILED,a(e.file),c.state==d.STARTED&&(c.trigger("CancelUpload"),n(function(){b.call(c)},1)))}function C(a){a.stop();d.each(G,
function(a){a.destroy()});G=[];O.length&&(d.each(O,function(a){a.destroy()}),O=[]);L.length&&(d.each(L,function(a){a.destroy()}),L=[]);I={};F=!1;H=J=null;E.reset()}var K=d.guid(),D,G=[],I={},O=[],L=[],H,E,F=!1,J;D={runtimes:f.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,
send_chunk_number:!0};s.call(this,c,null,!0);E=new d.QueueProgress;d.extend(this,{id:K,uid:K,state:d.STOPPED,features:{},runtime:null,files:G,settings:D,total:E,init:function(){var a=this;"function"==typeof D.preinit?D.preinit(a):d.each(D.preinit,function(b,c){a.bind(c,b)});q.call(this);D.browse_button&&D.url?h.call(this,D,function(b){"function"==typeof D.init?D.init(a):d.each(D.init,function(b,c){a.bind(c,b)});b?(a.runtime=f.Runtime.getInfo(p()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):
a.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})}):this.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})},setOption:function(a,b){s.call(this,a,b,!this.runtime)},getOption:function(a){return a?D[a]:D},refresh:function(){O.length&&d.each(O,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=d.STARTED&&(this.state=d.STARTED,this.trigger("StateChanged"),b.call(this))},stop:function(){this.state!=d.STOPPED&&(this.state=
d.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){F=a!==k?a:!0;O.length&&d.each(O,function(a){a.disable(F)});this.trigger("DisableBrowse",F)},getFile:function(a){var b;for(b=G.length-1;0<=b;b--)if(G[b].id===a)return G[b]},addFile:function(a,b){function c(a,b){var d=[];f.each(h.settings.filters,function(b,c){e[c]&&d.push(function(d){e[c].call(h,b,a,function(a){d(!a)})})});f.inSeries(d,b)}function g(a){var e=f.typeOf(a);if(a instanceof f.File){if(!a.ruid&&
!a.isDetached()){if(!m)return!1;a.ruid=m;a.connectRuntime(m)}g(new d.File(a))}else a instanceof f.Blob?(g(a.getSource()),a.destroy()):a instanceof d.File?(b&&(a.name=b),k.push(function(b){c(a,function(c){c||(G.push(a),l.push(a),h.trigger("FileFiltered",a));n(b,1)})})):-1!==f.inArray(e,["file","blob"])?g(new f.File(null,a)):"node"===e&&"filelist"===f.typeOf(a.files)?f.each(a.files,g):"array"===e&&(b=null,f.each(a,g))}var h=this,k=[],l=[],m;m=p();g(a);k.length&&f.inSeries(k,function(){l.length&&h.trigger("FilesAdded",
l)})},removeFile:function(a){a="string"==typeof a?a:a.id;for(var b=G.length-1;0<=b;b--)if(G[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var c=G.splice(a===k?0:a,b===k?G.length:b),e=!1;return this.state==d.STARTED&&(d.each(c,function(a){if(a.status===d.UPLOADING)return e=!0,!1}),e&&this.stop()),this.trigger("FilesRemoved",c),d.each(c,function(a){a.destroy()}),e&&this.start(),c},dispatchEvent:function(a){var b,c;a=a.toLowerCase();if(b=this.hasEventListener(a)){b.sort(function(a,b){return b.priority-
a.priority});c=[].slice.call(arguments);c.shift();c.unshift(this);for(var d=0;d<b.length;d++)if(!1===b[d].fn.apply(b[d].scope,c))return!1}return!0},bind:function(a,b,c,e){d.Uploader.prototype.bind.call(this,a,b,e,c)},destroy:function(){this.trigger("Destroy");D=E=null;this.unbindAll()}})};d.Uploader.prototype=f.EventTarget.instance;d.File=function(){var c={};return function(b){d.extend(this,{id:d.guid(),name:b.name||b.fileName,type:b.type||"",size:b.size||b.fileSize,origSize:b.size||b.fileSize,loaded:0,
percent:0,status:d.QUEUED,lastModifiedDate:b.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==f.inArray(f.typeOf(a),["blob","file"])?a:null},getSource:function(){return c[this.id]?c[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete c[this.id])}});c[this.id]=b}}();d.QueueProgress=function(){var c=this;c.size=0;c.loaded=0;c.uploaded=0;c.failed=0;c.queued=0;c.percent=0;c.bytesPerSec=0;c.reset=function(){c.size=
c.loaded=c.uploaded=c.failed=c.queued=c.percent=c.bytesPerSec=0}};g.plupload=d})(window,mOxie);$.telligent=$.telligent||{};$.telligent.evolution=$.telligent.evolution||{};ca("components composers events lib modules plugins lib.messageLinks lib.sheetProvider lib.sheet lib.actionSheet lib.touchEventAdapter lib.reflow lib.storageShim lib.imagePreview lib.legacyFormFilter lib.jsSupport lib.devicePixelRatio module.ui module.scriptRendering module.themePreview module.notifications module.systemNotifications lib.jQueryShim lib.keyboardActive module.shortcuts module.scheduledFile".split(" "),
function(g,f,k,m,n,e,d,c,b,a,l,p,t,q,h,u,s,w,r,x,y,z,A,B,C,K,D,G){D(function(){A.shim();s.setCookie();u.setCookie();t.shim();l.adapt()&&D("body").addClass("touch");C.init();K.init();w.initiate();r.initiate();x.initiate();y.initiate();z.initiate();p.monitor();c.sheet=new b({parent:D("body"),enablePan:!0,maxHeightPerent:0.8,cssClass:"sheet",backgroundColor:"#333",backgroundOpacity:0.75,animationDuration:250,onOpening:function(){D.telligent.evolution.messaging.publish("sheet.opening")},onClosing:function(){D.telligent.evolution.messaging.publish("sheet.closing")},
onOpened:function(){D.telligent.evolution.messaging.publish("sheet.opened")},onClosed:function(){D.telligent.evolution.messaging.publish("sheet.closed")}});c.actionSheet=new a({sheet:c.sheet});(new d({parent:"body"})).handle("click");h.init();D.telligent.evolution.ui.render();q.register();B.init()})},jQuery,window)})();
