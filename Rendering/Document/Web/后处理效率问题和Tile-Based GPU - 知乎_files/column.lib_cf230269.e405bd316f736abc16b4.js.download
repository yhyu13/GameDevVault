(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{1734:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return Nn}));var r,o,c,a=n(1409),i=n.n(a),s=n(132),u=n.n(s),l=n(39),d=n.n(l),b=n(30),p=n.n(b),f=n(33),h=n.n(f),m=n(72),O=n.n(m),g=n(48),j=n.n(g),x=n(21),v=n.n(x),y=n(0),C=n(1),k=n.n(C),T=n(123),w=n(1291),A=n(894),B=n(76),I=n(5),S=n(9),z=n(87),E=n.n(z),L=n(1471),D=n(1530),R=n(1735),M=n(57),G=n.n(M),P=n(40),F=n(1755),N=n(1813),K=n(911),_=n(1373),H=n(1819),U=n(356),W=n(26),V=n(799),Z=n.n(V),q=n(257),J=n.n(q),X=n(44),Y=n.n(X),$=n(252),Q=n.n($),ee=n(18),te=n(160),ne=n(43),re=n(1214),oe=n(1219),ce=n(284),ae=n(445),ie=n(1323),se=n(705),ue=n(1316),le=n(896),de=n(1814),be=n(1737),pe=n(1216),fe=n(1815),he=n(1217),me=n(1738),Oe=n(1816),ge=n(1303),je=n(1817),xe=n(1818),ve=n(1820),ye=n(1821),Ce=n(897),ke=n(3),Te=n(536),we=n(94),Ae=n(513),Be=n(62),Ie=n(179),Se=n(77),ze=n(1736),Ee=n(230),Le=n(1220),De=["children"],Re=["showConfirm"],Me=["sortType"],Ge=["liked","disabled","onClick"];function Pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ne(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,c=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw c}}}}function Fe(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var r=t.length;return Ne(t,void 0!==n&&n<r?n:r)}return e(t,n)}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ke(e,t){var n=Object(C.useRef)(),r=Object(C.useRef)(),o=Object(C.useState)({}),c=Fe(v.a,o,2)[1],a=Object(T.a)((function(e){e!==r.current&&(r.current="function"==typeof e?e(r.current):e,c({}))}));return function(e,t){return!e||!t||e.length!==t.length||e.some((function(e,n){return e!==t[n]}))}(n.current,t)&&(n.current=t,r.current=e()),[r.current,a]}var _e=function(e){var t=e.isOpen,n=e.title,r=e.content,o=e.onOK,c=e.onCancel;return Object(y.b)(F.a,{title:n,closeButton:" ",maskClosable:!1,hotKeyClosable:!1,children:t&&Object(y.c)(y.a,{children:[Boolean(r)&&Object(y.b)(I.Text,{textAlign:"center",mb:"-15px",children:r}),Object(y.c)(N.a,{direction:"horizontal",children:[Object(y.b)(K.a,{onClick:c,children:"取消"}),Object(y.b)(K.a,{preset:"primary",color:"blue",onClick:o,children:"确定"})]})]})})},He="https://www.zhihu.com/api/v4/comment_v5",Ue=function(e){var t,n;return(null===(n=null===(t=e.payload)||void 0===t?void 0:t.error)||void 0===n?void 0:n.message)||e.statusMessage||e.message},We=new W.b.Entity("comments"),Ve=new W.b.Array(We);We.define({childComments:Ve});var Ze,qe,Je=function(e){return Object(W.a)(e,Ve)},Xe=function(e){return{elementLocation:{block:{blockText:e}}}},Ye={root:"root_comment",sub:"child_comment",collapsed:"collapse_comments",reviewing:"reviewing_comments",anchor:"anchor_comment"},$e=function(e){var t=e.resourceId,n=e.resourceType,r=e.onError,o=e.children,c=Object(U.b)(),a=Object(L.d)().cache,i=Object(C.useMemo)((function(){return function(e,t){return function(n){return function(r,o,c){return Array.isArray(r)?n([e,t].concat(Fe(j.a,r)),o,c):n(r,o,c)}}}(n,t)}),[n,t]),s=Object(T.a)((function(e,r,o,c,i){var s,u,l=Object(L.c)([n,t,e,r,o]),d="".concat(l).concat(JSON.stringify(c||""),","),b=Pe(a.keys(),!0);try{for(b.s();!(u=b.n()).done;){var p=u.value;p.startsWith(l)&&p!==d&&function(){var e=(null===(s=a.get(p))||void 0===s?void 0:s.entities)||{};i.data=i.data.filter((function(t){return!e[t.id]}))}()}}catch(e){b.e(e)}finally{b.f()}})),u=Object(T.a)(function(){var e=O()(h.a.mark((function e(t,n,o,a,i,u){var l,d,b,p,f;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l="sub"!==o&&"anchor"!==o||!i?"".concat(t,"s/").concat(n):"comment/".concat(i),e.next=4,c("".concat(He,"/").concat(l,"/").concat(Ye[o]),{query:{order_by:a,limit:20,offset:u}});case 4:return d=e.sent,s(o,a,i,u,d),b=Je(d.data),p=b.result,f=b.entities,d.data=p||[],d.entities=f.comments||{},e.abrupt("return",d);case 12:throw e.prev=12,e.t0=e.catch(0),null==r||r("commentFetchError",Ue(e.t0)),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n,r,o,c,a){return e.apply(this,arguments)}}());return Object(y.b)(L.a,{value:{use:[i],fetcher:u,revalidateOnFocus:!1,errorRetryCount:3},children:o})},Qe=Object(C.createContext)({}),et=function(e){var t=e.children,n=p()(e,De),r=n.resourceType,o=n.resourceId,c=n.onError,a=Object(B.b)().ZhihuHybrid,i=function(){var e=Object(C.useState)({isOpen:!1,title:""}),t=Fe(v.a,e,2),n=t[0],r=n.isOpen,o=n.title,c=n.content,a=t[1],i=Object(B.b)().ZhihuHybrid,s=Object(C.useRef)(),u=Object(T.a)((function(e,t){return i?Object(P.a)("ui/showAlert").dispatch({title:e,content:t,affirm:"确定",dismiss:"取消"}).then((function(e){return"AFFIRM"===e.result})):(a({isOpen:!0,title:e,content:t}),new Promise((function(e){s.current=e})))}));return{isOpen:r,title:o,content:c,onOK:Object(T.a)((function(){var e;a({isOpen:!1,title:""}),null===(e=s.current)||void 0===e||e.call(s,!0),s.current=void 0})),onCancel:Object(T.a)((function(){var e;a({isOpen:!1,title:""}),null===(e=s.current)||void 0===e||e.call(s,!1),s.current=void 0})),showConfirm:u}}(),s=i.showConfirm,u=p()(i,Re),l=Object(C.useMemo)((function(){var e=n.onMessage,t=n.onError;return a&&(e=e||function(e){Object(P.a)("ui/showToast").dispatch({text:e})},t=t||function(e,t){Object(P.a)("ui/showToast").dispatch({text:t||e,icon:"fail"})}),Object.assign(Object.assign({showConfirm:s},n),{},{onMessage:e,onError:t})}),Object.values(n));return r&&o?Object(y.c)(Qe.Provider,{value:l,children:[Object(y.b)($e,{resourceType:r,resourceId:o,onError:c,children:t}),a||Object(y.b)(_e,Object.assign({},u))]}):null},tt=function(){return Object(C.useContext)(Qe)},nt=k.a.createContext({push:G.a,pop:G.a,changeLayerData:G.a,layers:[]}),rt=k.a.createContext({}),ot=function(e){var t=e.children,n=tt(),r=n.shown,o=n.displayType,c=n.anchorCommentId,a=n.onClose,i=Ke((function(){if(!r)return[];var e=[{index:0,sortType:"score",commentType:"root",displayType:o}];return c&&e.push({index:1,sortType:"score",commentType:"anchor",displayType:"modal",fetchCommentId:c}),e}),[r,o,c]),s=Fe(v.a,i,2),u=s[0],l=s[1],d=Object(T.a)((function(e){var t=e.sortType,n=p()(e,Me);l((function(e){return[].concat(Fe(j.a,e),[Object.assign({index:e.length,sortType:t||"score",displayType:"modal"},n)])}))})),b=Object(T.a)((function(e){1===u.length?null==a||a():l("number"==typeof e?function(t){return t.slice(0,e+1)}:function(e){return e.slice(0,e.length-1)})})),f=Object(T.a)((function(e,t){l(Object(R.b)((function(n){n[t]=Object.assign(Object.assign({},n[t]),e)})))})),h={layers:u,push:d,pop:b,changeLayerData:f};return Object(y.b)(nt.Provider,{value:h,children:t})},ct=function(){return Object(C.useContext)(nt)},at=Object(C.memo)((function(e){var t=e.data,n=e.children,r=ct(),o=r.changeLayerData,c=Object(T.a)((function(e){o(e,t.index)})),a=Object(T.a)((function(){return t.index===r.layers.length-1}));return t&&n?Object(y.b)(rt.Provider,{value:Object.assign(Object.assign({},t),{},{changeLayerData:c,isTopLayer:a,router:r}),children:n}):null})),it=function(){return Object(C.useContext)(rt)},st=function(e,t){var n=it(),r=n.displayType,o=n.commentType,c=n.sortType,a=n.fetchCommentId;return Object(L.b)([o,c,a,e],Object.assign({revalidateIfStale:Boolean("list"===r||(null==t?void 0:t.isInfinitePage))},t))},ut=function(e,t){var n=e.data,r=e.customFetchKey,o=t.changePageData,c=t.sharedData;return o((function(e){var t;e.entities[n.id]=n,e.data.unshift(n.id),e.counts.totalCounts+=1,null===(t=c.onMessage)||void 0===t||t.call(c,"评论发布成功！")}),void 0,r)},lt=function(e,t){var n=t.pageOffset,r=t.layer,o=t.changePageData,c=r.commentType,a=r.sortType;""!==n&&o(e,void 0,[c,a,void 0,""])},dt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.data,o=t.replyCommentId,c=t.customFetchKey,e.next=3,n.changePageData((function(e){e.entities[r.id]=r;var t=e.entities[o].replyRootCommentId,c=e.entities[t];e.counts.totalCounts+=1,t===o?(c.childComments.unshift(r.id),c.childCommentCount+=1):"root"===n.layer.commentType?c.childComments.splice(c.childComments.indexOf(o)+1,0,r.id):e.data.splice(e.data.indexOf(o)+1,0,r.id)}),void 0,c);case 3:null===(i=(a=n.sharedData).onMessage)||void 0===i||i.call(a,"评论发布成功！"),lt((function(e){e.counts.totalCounts+=1}),n);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),bt=function(e){var t=e.layer;(0,e.changePageData)(void 0,void 0,["root",t.router.layers[0].sortType,void 0,""],!0)},pt=function(e,t){var n=e.id,r=e.type,o=t.changePageData,c=t.fetcher,a=t.sharedData;return o(function(){var e=O()(h.a.mark((function e(t){var o,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.entities[n]["".concat(r,"d")],e.next=3,c("".concat(He,"/comment/").concat(n,"/reaction/").concat(r),{method:i?"PUT":"DELETE"});case 3:"dislike"===r&&(null===(o=a.onMessage)||void 0===o||o.call(a,i?"已踩评论":"已取消踩"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t=e.entities[n];if("like"===r)t.liked=!t.liked,t.disliked&&(t.disliked=!t.liked),t.likeCount+=t.liked?1:-1;else{t.disliked=!t.disliked;var o=t.liked;t.liked&&(t.liked=!t.disliked),o!==t.liked&&(t.likeCount+=t.liked?1:-1)}}))},ft=function(e,t){return pt({id:e,type:"like"},t)},ht=function(e,t){return pt({id:e.id,type:"dislike"},t)},mt=function(){var e=O()(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=Number(Y.a.get("zhihu::comment_replace_top_count"))||0)>=3)){e.next=3;break}return e.abrupt("return",!0);case 3:return Y.a.set("zhihu::comment_replace_top_count",n+1),e.next=6,t("确定替换已置顶的评论？","当前已有置顶评论，你只能置顶一条评论");case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ot=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.commentData,o=t.alreadyToppedId,c=n.changePageData,a=n.fetcher,i=n.layer,e.abrupt("return",c(function(){var e=O()(h.a.mark((function e(t){var n,c,i,s,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=7;break}return n=t.entities[o],e.next=4,a("".concat(He,"/comment/").concat(o));case 4:(c=e.sent).childComments=n.childComments,t.entities[o]=c;case 7:i=Je([r]),s=i.result,u=i.entities,l=t.data.findIndex((function(e){return t.entities[e].top})),t.data.splice(l+1,0,s[0]),t.entities=Object.assign(Object.assign({},t.entities),u.comments);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),void 0,["root",i.sortType,void 0,""]));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),gt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i,s,u,l,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.changePageData,c=n.getCache,a=n.sharedData,i=n.fetcher,s=n.layer,e.next=3,o(function(){var e=O()(h.a.mark((function e(n){var r,o,b,p;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.entities[t],o=r.isAuthorTop){e.next=12;break}if(b=c(["root",s.sortType,void 0,""]),l=null==b?void 0:b.data.find((function(e){return b.entities[e].isAuthorTop})),e.t0=l,!e.t0){e.next=10;break}return e.next=9,mt(a.showConfirm);case 9:e.t0=!e.sent;case 10:if(!e.t0){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,i("".concat(He,"/comment/").concat(t,"/operation/top"),{method:o?"DELETE":"PUT"});case 14:p=e.sent,o?(p.childComments=r.childComments,n.entities[t]=p):(r.childComments.forEach((function(e){delete n.entities[e]})),delete n.entities[t],n.data=n.data.filter((function(e){return t!==e})),u=p),d=o?"已取消置顶":"已置顶";case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:u&&Ot({commentData:u,alreadyToppedId:l},n),d&&(null===(r=a.onMessage)||void 0===r||r.call(a,d));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),jt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,o=n.fetcher,c=n.changePageData,a=n.sharedData,e.next=4,a.showConfirm("你确定要删除这条评论吗？");case 4:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,c(function(){var e=O()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("".concat(He,"/comment/").concat(r),{method:"DELETE"});case 2:t.entities[r].isDelete=!0;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xt=function(e,t){var n=e.id,r=t.fetcher;return(0,t.changePageData)(function(){var e=O()(h.a.mark((function e(t){var o,c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.entities[n],c=o.hot,e.next=4,r("".concat(He,"/comment/").concat(n,"/operation/hot"),{method:c?"DELETE":"PUT"});case 4:(a=e.sent).childComments=o.childComments,t.entities[n]=a;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},vt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,o=n.changePageData,c=n.fetcher,e.next=4,o(function(){var e=O()(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.entities[r].collapsed,e.next=3,c("".concat(He,"/comment/").concat(r,"/operation/collapse"),{method:n?"DELETE":"PUT"});case 3:n?(delete t.entities[r],t.data=t.data.filter((function(e){return e!==r})),t.counts.totalCounts-=1):t.entities[r].collapsed=!0;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:lt((function(e){e.counts.totalCounts-=1}),n),bt(n);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),yt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.changePageData,o=n.fetcher,e.next=3,o("".concat(He,"/comment/").concat(t,"/child_comment"));case 3:return c=e.sent,a=Je(c.data),i=a.entities.comments,s=a.result,e.abrupt("return",r((function(e){var n=e.entities[t];e.entities=Object.assign(Object.assign({},e.entities),i),n.childComments=J()(n.childComments,s)})));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ct=function(e,t){t.sharedData.onReport(e)},kt=function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.sharedData,o=n.fetcher,e.next=3,r.showConfirm("确定屏蔽该用户吗？","屏蔽后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你、邀请你回答问题，但仍然可以查看你的公开信息。");case 3:if(!e.sent){e.next=9;break}return i=t.author.urlToken,e.next=7,o("https://www.zhihu.com/api/v4/members/".concat(encodeURIComponent(i),"/actions/block"),{method:"POST"});case 7:null===(c=r.onMessage)||void 0===c||c.call(r,"屏蔽成功"),null===(a=r.onUserBlocked)||void 0===a||a.call(r,t.author);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Tt=function(e,t){var n,r=t.sharedData,o=document.createElement("span");o.innerHTML=e.content,Z()(o.innerText),null===(n=r.onMessage)||void 0===n||n.call(r,"已复制到剪贴板")},wt={addComment:ut,replyComment:dt,toggleLike:ft,toggleDislike:ht,toggleAuthorTop:gt,toggleHot:xt,toggleCollapse:vt,deleteComment:jt,reviewComment:function(){var e=O()(h.a.mark((function e(t,n){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.changePageData,o=n.fetcher,e.next=3,r(function(){var e=O()(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("".concat(He,"/comment/").concat(t,"/operation/approve"),{method:"PUT"});case 2:delete n.entities[t],n.data=n.data.filter((function(e){return e!==t})),n.counts.totalCounts-=1;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:lt((function(e){e.counts.totalCounts-=1}),n),bt(n);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),expandChildComments:yt,report:Ct,block:kt,copy:Tt},At=function(){var e=O()(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n("".concat(He,"/comment/").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Bt={changeComment:function(){var e=O()(h.a.mark((function e(t,n){var r,o,c,a,i,s,u,l,b,p,f,m,O,g;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.type,o=t.data,c=n.layer,a=n.changePageData,i=n.fetcher,e.t0=r,e.next="addComment"===e.t0?5:"replyComment"===e.t0?10:"changeComment"===e.t0?18:26;break;case 5:return e.next=7,At(o.commentId,i);case 7:return s=e.sent,ut({data:s,customFetchKey:[c.commentType,c.sortType,void 0,""]},n),e.abrupt("return");case 10:if(u=o.commentId,l=o.replyCommentId,!Ze||Ze.id!==l){e.next=17;break}return b=Ze.key,e.next=15,At(u,i);case 15:p=e.sent,dt({replyCommentId:l,data:p,customFetchKey:b},n);case 17:return e.abrupt("return");case 18:if(qe){e.next=20;break}return e.abrupt("return");case 20:return m=(f=qe).id,O=f.key,e.next=23,At(m,i);case 23:return g=e.sent,a((function(e){var t=e.entities[m];g.childComments=t.childComments,g.childCommentCount=t.childCommentCount,e.entities=Object.assign(Object.assign({},e.entities),{},d()({},m,g))}),void 0,O),e.abrupt("return");case 26:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),clearWaiting:function(){Ze=void 0,qe=void 0},replyComment:function(e,t){var n=e.replyCommentId,r=e.pageOffset,o=t.getCache,c=t.sharedData,a=t.layer,i=c.resourceType,s=c.resourceId,u=[a.commentType,a.sortType,a.fetchCommentId,r];Ze={key:u,id:n};var l=o(u),d=null==l?void 0:l.entities[n];if(d){var b=new URLSearchParams(Object(ee.decamelizeKeys)({replyCommentId:n,replyAuthorName:d.author.name})).toString().replace(/\+/g,"%20");Object(P.a)("base/openURL").dispatch({url:"".concat("zhihu://comment/editor","/").concat(i,"/").concat(s,"?").concat(b)})}},toggleLike:ft,toggleDislike:ht,toggleAuthorTop:gt,toggleHot:xt,toggleCollapse:vt,deleteComment:jt,expandChildComments:yt,showCommentList:function(e,t){var n=e.commentType,r=e.rootCommentId,o=e.pageOffset,c=t.sharedData,a=t.layer,i=c.resourceType,s=c.resourceId;if(r){var u=a.sortType,l=a.fetchCommentId;qe={key:[a.commentType,u,l,o],id:r}}var d=new URLSearchParams(Object(ee.decamelizeKeys)(Q()({listType:n,isChild:Boolean(r),rootCommentId:r},Boolean)));Object(P.a)("base/openURL").dispatch({url:"".concat("https://www.zhihu.com/comment/list","/").concat(i,"/").concat(s,"?").concat(d.toString())})},report:Ct,block:kt,copy:Tt},It=function(){},St={addComment:It,replyComment:It,toggleLike:It,toggleDislike:It,toggleAuthorTop:It,toggleHot:It,toggleCollapse:It,deleteComment:It,reviewComment:It,expandChildComments:It,report:It,block:kt,copy:Tt},zt=function(){var e=Object(U.b)(),t=tt().onError;return Object(T.a)(O()(h.a.mark((function n(){var r,o=arguments;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.apply(void 0,o);case 3:return n.abrupt("return",n.sent);case 6:throw n.prev=6,n.t0=n.catch(0),r=n.t0,null==t||t("commentActionError",Ue(r),r),n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,6]])}))))},Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(B.b)(),n=t.ZhihuHybrid,r=t.Mobile,o=Object(L.d)(),c=o.mutate,a=o.cache,i=zt(),s=it(),u=tt(),l=u.resourceType,d=u.resourceId,b=s.commentType,p=s.sortType,f=s.fetchCommentId,h=Object(T.a)((function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return c(r?[l,d].concat(Fe(j.a,r)):[l,d,b,p,f,e],t&&Object(R.a)(t),{optimisticData:n&&Object(R.a)(n),revalidate:o,populateCache:!n,rollbackOnError:!0})})),m=Object(T.a)((function(t){return a.get(Object(L.c)(t?[l,d].concat(Fe(j.a,t)):[l,d,b,p,f,e]))}));return Object(T.a)((function(t,o){var a={changePageData:h,layer:s,fetcher:i,mutate:c,getCache:m,pageOffset:e,sharedData:u};return"string"==typeof t?(r?n?Bt:St:wt)[t](o,a):t(a)}))},Lt={1:"评论区已关闭",2:"评论内容由作者筛选后展示",3:"因作者设置，评论区已关闭"},Dt=function(e){var t=e.noComments,n=e.type,r=void 0===n?0:n,o=Object(B.b)().Mobile,c=it(),a=c.displayType,i=c.commentType,s="list"===a?{height:o?"168px":"400px"}:{height:"100%"};if(t){var u="root"===i||"sub"===i;return Object(y.b)(te.a.EI1,{image:"noWorks",content:u?"还没有评论，发表第一个评论吧":"无内容",preset:o?"compact":"normal",css:s})}return Object(y.b)(te.a.EI1,{image:"contentError",content:Lt[r],preset:o?"compact":"normal",css:s})},Rt=Object(C.createContext)(G.a),Mt=function(e){var t=e.pageOffset,n=e.isResourceAuthor,r=e.children,o=Object(B.b)().ZhihuHybrid,c=Object(C.useState)(!1),a=Fe(v.a,c,2),i=a[0],s=a[1],u=Object(C.useState)(),l=Fe(v.a,u,2),d=l[0],b=l[1],p=Object(C.useState)([]),f=Fe(v.a,p,2),m=f[0],g=f[1],j=Object(C.useRef)(),x=it().displayType,k=tt().authorInfo,w=Et(t),A=Object(T.a)((function(e,t,n,r){var o;null===(o=j.current)||void 0===o||o.trackEvent({eventType:"Click",action:"report"===t?"Report":void 0,elementLocation:{type:"Text",content:{type:"Comment",id:r},text:e,block:{blockText:n}}})})),z=Object(T.a)(function(){var e=O()(h.a.mark((function e(t,n){var r,c,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.id,a="modal"===x?"comment_popup":"comment_list",null===(r=j.current)||void 0===r||r.trackEvent({eventType:"Click",action:"Expand",elementLocation:{type:"Button",content:{type:"Comment",id:c},text:m.map((function(e){return Fe(v.a,e,1)[0]})).join(" "),block:{blockText:a}}}),!o){e.next=10;break}return e.next=6,Object(P.a)("ui/showActionSheet").dispatch({items:t.map((function(e){var t=Fe(v.a,e,2),n=t[0];return{id:t[1],text:n,data:{text:n}}}))});case 6:(i=e.sent).id&&(A(i.data.text,i.id,a,c),w(i.id,n)),e.next=12;break;case 10:g(t.map((function(e){var t=Fe(v.a,e,2),r=t[0],o=t[1];return[r,function(){s(!1),A(r,o,a,c),w(o,n)}]}))),s(!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),E=Object(T.a)((function(e,t){if(i)s(!1);else{b(e);var r=t.author,o=t.isAuthor,c=t.disliked,a=t.hot,u=t.collapsed,l=t.canDislike,d=t.canHot,p=t.canCollapse,f=t.canDelete,h=r.id===(null==k?void 0:k.id)&&o,m=[!h&&["屏蔽","block"],!h&&["举报","report"],!h&&l&&[c?"取消踩":"踩评论","toggleDislike"],n&&d&&[a?"取消推荐":"推荐为热门","toggleHot"],n&&p&&[u?"取消折叠":"折叠评论","toggleCollapse"],(n||h)&&f&&["删除评论","deleteComment"],["复制","copy"]].filter(Boolean);z(m,t)}})),L=Object(T.a)((function(){s(!1)}));return Object(y.c)(y.a,{children:[Object(y.b)(Rt.Provider,{value:E,children:r}),Object(y.b)(S.e,{ref:j}),o||Object(y.b)(_.a,{globalClose:!0,placement:"bottom",target:d,isOpen:i,onClose:L,children:Object(y.b)(I.Box,{py:"5px",children:m.map((function(e){var t=Fe(v.a,e,2),n=t[0],r=t[1];return Object(y.b)(I.Flex,{onClick:r,alignItems:"center",justifyContent:"center",width:"95px",height:"40px",fontSize:"14px",color:"GBL05A",sx:{cursor:"pointer",":hover":{background:"GBK10A"}},children:n},n)}))})})]})},Gt=Object(C.createContext)({}),Pt=function(e){var t=e.data,n=e.children;return Object(y.b)(Gt.Provider,{value:t,children:n})},Ft={score:"默认",ts:"时间"},Nt={root:function(e){return e.totalCounts?"".concat(e.totalCounts," 条评论"):"暂无评论"},sub:function(){return"评论回复"},collapsed:function(e){return e.totalCounts?"".concat(e.totalCounts," 条已折叠评论"):"暂无评论"},reviewing:function(e){return e.totalCounts?"".concat(e.totalCounts," 条待筛选评论"):"暂无评论"},anchor:function(){return"返回评论"}},Kt=function(e){var t=e.title,n=e.children,r=Object(B.b)().Mobile;return Object(y.c)(I.Flex,{flex:"0 0 auto",px:r?0:"20px",height:r?"31px":"50px",alignItems:"center",justifyContent:"space-between",sx:r?null:Object(re.a)({borderBottom:"1px solid",borderBottomColor:"GBK09A"}),children:[Object(y.b)(I.Text,{fontSize:"15px",color:"GBK03A",fontWeight:"bold",children:t}),n]})},_t=Object(C.memo)((function(e){var t=e.title,n=e.counts,r=e.onChangeSortType,o=tt(),c=o.targetLink,a=o.hideSort,i=it(),s=i.commentType,u=i.index,l=i.sortType,d=i.changeLayerData,b=i.router,p="modal"===tt().displayType?u>0:u>1,f=t||Object(y.c)(I.Text,{onClick:p?b.pop.bind(void 0,void 0):void 0,css:{cursor:p?"pointer":"default"},children:[p&&Object(y.b)(ie.b,{center:!0,size:24}),Nt[s](n||{})]});return Object(y.c)(Kt,{title:f,children:[0===u&&Object(y.b)(I.Flex,{flex:"1 1 auto",children:c}),Boolean(!a&&n&&"root"===s)&&Object(y.b)(I.Flex,{fontSize:"12px",lineHeight:"24px",fontWeight:"bold",bg:"GBK10A",sx:{border:"2px solid",borderColor:"GBK10A",borderRadius:"3px"},children:["score","ts"].map((function(e){return Object(y.b)(S.a,{as:I.Box,zaType:"Button",zaText:!0,view:Xe("sort"),width:"50px",height:"24px",bg:e===l?"GBK99A":"transparent",sx:{color:l===e?"GBK02A":"GBK05A",borderRadius:"2px",textAlign:"center",cursor:"pointer"},onClick:function(){null==r||r(e),d({sortType:e,prevLayerOffset:void 0})},children:Ft[e]},e)}))})]})})),Ht=function(e){var t=e.id,n=e.urlToken,r=e.children,o=Object(B.b)().Mobile,c=tt().userHoverCard;return o||!c?r:Object(y.b)(c,{id:t,urlToken:n,toggler:k.a.cloneElement(r,{key:t})})},Ut=Object(C.memo)((function(e){var t=e.user,n=t.avatarUrl,r=t.isOrg,o=t.id,c=t.name,a="0"===o||""===o,i=Object(B.b)().Mobile,s=Object(y.b)(Te.b,{url:a?Te.a:n,alt:c,size:i?30:24,round:i,css:Object.assign(Object.assign({},Object(oe.a)()),{},{flex:"0 0 auto"}),loading:"lazy"});return a?s:Object(y.b)(I.Box,{flex:"0 0 auto",children:Object(y.b)(Ht,{id:o,children:Object(y.b)(we.b,{href:"https://www.zhihu.com/".concat(r?"org":"people","/").concat(o),target:"_blank",zaType:"Button",zaText:"头像",css:{height:i?"30px":"24px",width:i?"30px":"24px",display:"block"},children:s})})})})),Wt=Object(C.createContext)([]),Vt=function(e){var t=e.children,n=Object(C.useState)([]),r=Fe(v.a,n,2),o=r[0],c=r[1];return Object(C.useEffect)((function(){Object(Ae.c)().then((function(e){c(e)}))}),[]),Object(y.b)(Wt.Provider,{value:o,children:t})},Zt=function(){return Object(C.useContext)(Wt)},qt=function(e){var t=e.className,n=e.height,r=e.width,o=e.url,c=e.onClick,a=Object(C.useMemo)((function(){return function(e,t){var n=parseInt(t,10)||120,r=parseInt(e,10)||120,o=Math.max(120,Math.min(202,r)),c=Math.max(120,Math.min(202,n)),a=Math.min(Math.max(r/n,.5),2);return{width:a>1?o:c*a,height:a>1?o/a:c,ratio:a}}(r,n)}),[r,n]),i=a.width,s=a.height,u=a.ratio,l=Object(C.useMemo)((function(){return o.endsWith("gif")?[o,o]:[Object(Be.imgUrl)(o,"xld"),Object(Be.imgUrl)(o,"")]}),[o]),d=Fe(v.a,l,2),b=d[0],p=d[1],f=Object(T.a)((function(e){null==c||c(e,p)}));return Object(y.b)(I.Box,{width:i,height:s,sx:{backgroundColor:"GBK10B",position:"relative",borderRadius:"8px"},className:t,children:Object(y.b)("img",{alt:"",src:b,"data-rawwidth":r||i,"data-rawheight":n||i,"data-original":p,css:{width:"100%",height:"100%",borderRadius:"8px",objectFit:"cover",cursor:"zoom-in",objectPosition:u<1?"center top":"unset"},loading:"lazy",onClick:f})})},Jt=function(e){var t=e["data-height"],n=e["data-width"],r=e.className,o=e.href,c=Object(B.b)().ZhihuHybrid,a=tt().onShowImage,i=Object(T.a)((function(e,t){c&&!a?Object(P.a)("base/openImage").dispatch({images:[t]}):null==a||a(t,e.currentTarget)}));return Object(y.b)(qt,{height:t,width:n,url:o,css:{marginTop:"12px"},className:r,onClick:i})},Xt=function(e){var t=e.href,n=e["data-hash"],r=e.children;return Object(y.b)(Ht,{id:n,children:Object(y.b)(we.b,{href:t,target:"_blank",className:"member_mention",children:r})})},Yt=function(e,t){return Object(Ae.a)(e,{convertEmoticon:!0,emoticonList:t,traverseCallback:function(e,t){if(e.nodeType===Node.ELEMENT_NODE){var n=e.classList,r=e.textContent;if(n.contains("member_mention"))return t(Xt);if(n.contains("comment_img")||n.contains("comment_sticker"))return t(Jt);if(null==r?void 0:r.match("http"))return t("A"===e.tagName?we.b:void 0)}return t()}})},$t=function(e){var t=e.data,n=e.commentType,r=Zt(),o=t.content,c=t.isDelete,a=t.collapsed,i=Object(C.useMemo)((function(){if("collapsed"!==n){if(c)return[!0,"该条评论已删除"];if(a)return[!0,"该条评论被折叠"]}else if("collapsed"===n&&c)return[!0,"该条评论已删除"];return[!1,Yt(o,r)]}),[n,c,a,o,r]),s=Fe(v.a,i,2),u=s[0],l=s[1];return Object(y.b)(I.Text,{className:"CommentContent",mt:"4px",fontSize:"15px",lineHeight:"21px",sx:{color:u?"GBL05A":"GBK03A",overflowWrap:"break-word",p:{margin:0},".sticker":{width:"20px",height:"20px",marginBottom:"-4px"},".member_mention":{color:"GBL07A"},"a.internal,a.external":{textDecoration:"none",color:"GBK03A",borderBottom:"1px solid",borderColor:"GBK03A",":hover":{color:"GBL07A",borderBottom:"1px solid",borderColor:"GBL07A"},".invisible":{display:"none"},".ellipsis::after":{content:'"..."'}}},children:l})},Qt=Object(C.memo)((function(e){var t=e.text;return Object(Ae.d)(t)})),en=function(e){var t=e.data,n=e.responseLink,r=e.richText,o=e.className,c=Object(ce.a)(),a=c.colors,i=a.GBK06A,s=a.GBK08A,u=a.GBL01A,l=c.isDarkMode,d=t.text,b=t.color,p=t.nightColor,f=t.hasBorder,h=t.borderColor,m=t.borderNightColor,O=t.targetLink,g=n&&O,j=g?we.b:"span";return Object(y.c)(j,{css:Object.assign(Object.assign(Object.assign({},f&&Object.assign(Object.assign({},Object(re.a)({border:"1px solid ".concat((l?m:h)||s),borderRadius:"4px"})),{},{padding:"0 4px"})),{},{color:(l?p:b)||i},g&&{textDecoration:"none"}),{},{height:"16px",fontSize:"12px",lineHeight:"16px",boxSizing:"border-box","& a":{color:u,textDecoration:"none"}}),className:o,href:g?O:"",children:[r?Object(y.b)(Qt,{text:d}):d,Boolean(O)&&Object(y.b)(se.b,{css:{fill:b,marginRight:"-2px"},center:!0,size:12})]})},tn=function(e){var t=e.data,n=Object(B.b)().Mobile,r=Object(ce.a)().isDarkMode,o=tt().onNeedVip;if(!t)return null;var c=t.vipIcon,a=(c=void 0===c?{}:c).url,i=c.nightModeUrl,s=t.isVip;return a&&s?Object(y.b)(I.Image,{src:r?i:a,size:n?14:16,css:{cursor:"pointer",marginLeft:"4px"},onClick:function(){o("vip_badge")}}):null},nn=function(e){var t=e.user,n=Object(B.b)().Mobile,r=t.id,o=t.name,c=t.isOrg,a=function(e){return{fontSize:n?"14px":"15px",fontWeight:"bold",textDecoration:"none",color:e.colors.GBK03A}};return"0"===r||""===r?Object(y.b)("span",{css:a,children:o}):Object(y.b)(Ht,{id:r,children:Object(y.b)(we.b,{href:"https://www.zhihu.com/".concat(c?"org":"people","/").concat(r),target:"_blank",css:a,children:o})})},rn=function(e){var t=e.user,n=e.authorTag,r=e.isReplyTo,o=t.badge,c=t.badgeV2,a=t.vipInfo,i=Object(B.b)().Mobile;return Object(y.c)(I.Flex,{alignItems:"center",height:"16px",children:[Object(y.b)(nn,{user:t}),Boolean(r)||Object(y.c)(y.a,{children:[null==n?void 0:n.map((function(e){return Object(y.b)(en,{data:e,css:{marginLeft:"4px",fontSize:i?"10px":"12px"}},e.text)})),Object(y.b)(Ie.c,{size:i?16:18,badge:null!=c?c:o,css:{marginLeft:"4px"}}),Object(y.b)(tn,{data:a})]})]})},on=function(e){var t=e.onClick,n=tt().authorInfo;return(null==n?void 0:n.id)?Object(y.b)(ue.d,{size:16,css:{margin:"2px",cursor:"pointer"},onClick:t}):null},cn=function(e){var t=e.id,n=e.author,r=e.childComments,o=e.childCommentCount,c=e.pageOffset,a=e.onAction,i=Object(ce.a)().colors.GBL05A,s=Object(B.b)().Mobile,u=o>(null==r?void 0:r.length),l=o<=5,d=Object(T.a)((function(){l?a("expandChildComments",t):s?a("showCommentList",{rootCommentId:t,pageOffset:c}):a((function(e){e.layer.router.push({commentType:"sub",sortType:"ts",fetchCommentId:t,rootCommentAuthor:n,prevLayerOffset:c})}))}));return u?Object(y.c)(S.a,{as:K.a,shouldTrackShow:!0,zaType:"Block",zaAction:"Expand",view:Xe("show_reply"),preset:"secondary",color:"grey",onClick:d,css:s?function(e){return{margin:"10px 0 10px 54px",padding:"0 10px 0 16px",fontSize:"12px",borderRadius:"14px",height:"28px",lineHeight:"28px",background:e.colors.GBK10A,color:e.colors.GBK03A,svg:{marginBottom:"1px"}}}:{margin:"10px 0 10px 54px",padding:"0 6px 0 12px",height:"32px",color:i,fontWeight:500,svg:{marginBottom:"1px"}},children:[l?"展开其他 ".concat(o-r.length," 条回复"):"查看全部 ".concat(o," 条回复"),Object(y.b)(le.b,{center:!0,size:s?20:24})]}):null},an=function(e){var t=e.data,n=t.author,r=t.authorTag,o=t.replyToAuthor,c=t.replyAuthorTag;return Object(y.c)(I.Flex,{alignItems:"center",flex:"0 0 auto",children:[Object(y.b)(rn,{user:n,authorTag:r}),o&&Object(y.b)(de.a,{size:12,css:{margin:"0 4px"}}),o&&Object(y.b)(rn,{user:o,isReplyTo:!0,authorTag:c})]})},sn=function(e){var t=e.isReply,n=e.isSticky,r=e.autoFocus,o=e.replyCommentId,c=e.localCache,a=e.disabled,i=e.placeholder,s=e.maxLine,u=e.onSubmit,l=e.className,d=Object(C.useRef)(),b=tt(),p=b.authorInfo,f=b.resourceType,h=b.resourceId,m=b.onNeedLogin,O=b.onNeedVip,g=b.onError,j=Zt(),x=t?void 0:n?"悬浮":"常驻",v=t?"reply_comment":"direct_comment",k=Object(T.a)((function(e){var t;null===(t=d.current)||void 0===t||t.trackEvent({eventType:"Click",action:"Comment",elementLocation:{type:"Button",text:x,block:{blockText:v}}}),u(e)}));return Object(y.c)(y.a,{children:[Object(y.b)(S.e,{ref:d}),Object(y.b)(S.f,{zaType:"Block",zaText:x,view:Xe(v),children:Object(y.b)(ze.a,{className:l,authorInfo:p,resourceType:f,resourceId:h,isReply:t,disabled:a,autoFocus:r,placeholder:i,localCache:c,replyCommentId:o,maxLine:s,emoticonList:j,onSubmit:k,onNeedLogin:m,onNeedPurchaseVip:O,onError:g})})]})},un=Object(Ee.a)(K.a),ln=function(e){var t=e.liked,n=e.disabled,r=e.onClick,o=p()(e,Ge),c=Object(ce.a)().colors.GBK06A,a=Object(B.b)().Mobile,i=Object(Le.a)(),s=Object(w.a)(function(){var e=O()(h.a.mark((function e(o){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return");case 2:if(null==r||r(o),!a||t){e.next=9;break}return Object(P.a)("iOS/hapticFeedback").dispatch(),e.next=7,i.start({scale:1.3,transition:{type:"tween",duration:.2,ease:[0,0,.58,1]}});case 7:return e.next=9,i.start({scale:1,transition:{type:"tween",duration:.3,ease:[.42,0,.2,1.8]}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),300,{leading:!0,trailing:!1});return Object(y.b)(un,Object.assign(Object.assign({},o),{},{initial:{scale:1},animate:i,css:Object.assign(Object.assign({},a&&{color:t?void 0:c,fontSize:"12px",svg:{fontSize:"16px"}}),n&&{cursor:"default",opacity:"0.5"}),onClick:s}))},dn=function(e){var t=Object(B.b)().Mobile,n=Object(w.a)(e.onClick||G.a,300,{leading:!0,trailing:!1});return Object(y.b)(K.a,Object.assign(Object.assign({},e),{},{onClick:n},t?{label:"",css:function(e){return{svg:{fontSize:"16px"},color:e.colors.GBK06A}}}:null))},bn=function(e){var t,n=e.data,r=e.subIntro,o=e.commentType,c=e.pageOffset,a=e.onAction,i=n.id,s=n.createdTime,u=n.commentTag,l=n.canReply,d=n.canLike,b=n.isAuthorTop,p=n.canAuthorTop,f=n.liked,h=n.likeCount,m=n.reviewing,O=n.collapsed,g=n.author,j=Object(B.b)().Mobile,x=tt().authorInfo,k=!r&&!m&&!O&&l,w=g.id!==(null==x?void 0:x.id)&&d,A=!m&&!O&&p,z=Object(C.useState)(!1),E=Fe(v.a,z,2),L=E[0],D=E[1],R=Object(T.a)((function(){j?a("replyComment",{replyCommentId:i,pageOffset:c}):D(!L)})),M=Object(T.a)((function(e){D(!1),a("replyComment",{replyCommentId:i,data:e,pageOffset:c})})),G=Object(T.a)((function(){a("toggleLike",i)})),P=Object(T.a)((function(){a("reviewComment",i)})),F=Object(T.a)((function(){a("toggleAuthorTop",i)}));return t=!m||"root"!==o&&"sub"!==o?Object(y.c)(I.Flex,{alignItems:"center",flex:"0 0 auto",css:{".Button":{marginLeft:"16px"}},children:[k&&Object(y.b)(S.a,{as:dn,zaType:"Card",zaAction:"Comment",preset:"plain",icon:j?be.b:pe.b,label:"回复",onClick:R}),m&&Object(y.b)(S.a,{as:dn,zaType:"Button",zaText:!0,preset:"plain",icon:fe.a,label:"公开此评论",onClick:P}),!m&&!O&&Object(y.b)(S.a,{as:ln,zaType:"Card",zaAction:f?"UnUpvote":"Upvote",preset:"plain",disabled:!w,icon:!j||f?he.b:me.b,label:h?String(h):"赞",color:f?"blue":"grey",liked:f,onClick:G}),A&&Object(y.b)(S.a,{as:dn,shouldTrackShow:!0,zaType:"Button",zaText:!0,preset:"plain",icon:j?b?Oe.a:ge.c:b?je.a:xe.a,label:b?"取消置顶":"置顶",onClick:F})]}):null,Object(y.c)(y.a,{children:[Object(y.c)(I.Flex,{alignItems:"center",justifyContent:"space-between",mt:"4px",children:[Object(y.c)(I.Flex,{alignItems:"center",flex:"0 0 auto",fontSize:j?"12px":"14px",color:"GBK06A",children:[Object(y.b)(I.Text,{mr:"4px",children:Object(Se.toSmartString)(s)}),u.map((function(e){return Object(y.c)(C.Fragment,{children:[Object(y.b)("span",{children:" · "}),Object(y.b)(en,{data:e,css:{fontSize:j?"12px":"14px",margin:"0 4px"}})]},e.type)}))]}),t]}),L&&Object(y.b)(sn,{isReply:!0,autoFocus:!0,localCache:!0,placeholder:"回复 ".concat(g.name),replyCommentId:i,onSubmit:M,css:{marginTop:"8px"}})]})},pn=function(e){var t=e.enable,n=e.clickDelay,r=void 0===n?300:n,o=e.longPressDelay,c=void 0===o?800:o,a=e.onPress,i=e.onLongPress,s=e.children,u=Object(C.useRef)(0),l=Object(C.useRef)();var d=Object(w.a)(a,r,{leading:!0,trailing:!1}),b=Object(T.a)((function(e){for(var t=e.target;t!==e.currentTarget;){if(["A","SVG","BUTTON","IMG"].includes(t.tagName.toUpperCase()))return!1;t=t.parentElement}return!0})),p=Object(T.a)((function(){clearTimeout(l.current),l.current=void 0,u.current=0})),f=Object(T.a)((function(e){u.current=Date.now(),l.current=setTimeout((function(){i(e),p()}),c)})),h=Object(T.a)((function(e){l.current&&(Date.now()-u.current<r&&b(e)&&d(e),p())}));return t?Object(y.b)(I.Box,{css:{userSelect:"none"},onTouchStart:f,onTouchEnd:h,onTouchMove:p,children:s}):Object(y.b)(y.a,{children:s})},fn=Object(ke.h)(r||(r=u()(["\n  0%, 100% {background-color: rgba(255,255,255,1);}\n  50% {background-color: rgba(0,102,255,.08);}\n"]))),hn=Object(ke.h)(o||(o=u()(["\n  0%, 100% {background-color: rgba(0,0,0,1);}\n  50% {background-color: rgba(85, 142, 255,.08);}\n"]))),mn=Object(C.memo)(Object(C.forwardRef)((function(e,t){var n=e.className,r=e.data,o=e.commentType,c=e.sub,a=e.subIntro,i=e.blink,s=e.pageOffset,u=e.onAction,l=r.id,d=r.author,b=r.isDelete,p=r.childComments,f=r.childCommentCount,h=Object(B.b)().Mobile,m=Object(C.useContext)(Rt),O=Object(w.a)((function(e){m(e.currentTarget,r)}),300,{leading:!0,trailing:!1}),g=Object(T.a)((function(){u("replyComment",{replyCommentId:l,pageOffset:s})}));return Object(y.c)("div",{ref:t,children:[Object(y.b)(S.b,{content:{type:"Comment",id:l},children:Object(y.b)(pn,{enable:h&&!b,onPress:g,onLongPress:O,children:Object(y.c)(S.f,{as:I.Flex,zaType:"Card",extra:{configMap:{commentLevel:c?"2":"1"}},css:function(e){return{animation:i?"".concat(e.isDarkMode?hn:fn," 1s linear forwards"):void 0,padding:h?"10px 0 6px ".concat(c?"40px":0):"10px 20px 14px ".concat(c?"54px":"20px")}},className:n,children:[Object(y.b)(Ut,{user:d}),Object(y.c)(I.Box,{ml:"10px",flex:"1 1 auto",children:[Object(y.c)(I.Flex,{justifyContent:"space-between",color:"GBK06A",children:[Object(y.b)(an,{data:r}),Object(y.b)(on,{onClick:O})]}),Object(y.b)($t,{data:r,commentType:o}),Object(y.b)(bn,{data:r,subIntro:a,commentType:o,pageOffset:s,onAction:u})]})]})})}),Boolean(a)||(null==p?void 0:p.map((function(e){return Object(y.b)(On,{id:e,sub:!0,commentType:o,pageOffset:s,onAction:u},e)}))),Boolean(a)||Object(y.b)(cn,{id:l,author:d,childComments:p,childCommentCount:f,pageOffset:s,onAction:u})]})}))),On=Object(C.forwardRef)((function(e,t){var n,r=(n=e.id,Object(C.useContext)(Gt)[n]);return Object(y.b)(mn,Object.assign(Object.assign({ref:t},e),{},{data:r}))})),gn=function(e){var t=e.pageOffset,n=e.rootCommentId,r=st(t).data,o=Et(t);return r&&n?Object(y.c)(Pt,{data:r.entities,children:[Object(y.b)(On,{id:n,commentType:"sub",pageOffset:t,subIntro:!0,css:function(e){return{padding:"20px",background:e.colors.GBK99A,borderBottom:"20px solid ".concat(e.colorMod(e.colors.GBL05A).alpha(.1))}},onAction:o}),Object(y.b)(Kt,{title:"".concat(Object(ne.cnNiceNumber)(r.entities[n].childCommentCount),"条回复")})]}):null},jn=function(e){var t=e.isResourceAuthor,n=it(),r=n.prevLayerOffset,o=void 0===r?"":r,c=n.fetchCommentId,a=n.router.layers,i=n.displayType,s=Object(C.useState)((function(){return Object.assign(Object.assign({},a[0]),{},{displayType:i})})),u=Fe(v.a,s,1)[0];return Object(y.b)(at,{data:u,children:Object(y.b)(Mt,{pageOffset:o,isResourceAuthor:t,children:Object(y.b)(gn,{pageOffset:o,rootCommentId:c})})})},xn=Object(C.memo)((function(e){var t=e.containerRef,n=e.className,r=e.commentType,o=e.scrollAndBlink,c=e.list,a=e.entities,i=e.paging,s=e.counts,u=e.pageOffset,l=e.isInfinite,d=e.onNextPage,b=e.onAction,p=Object(C.useRef)(null),f=Object(C.useRef)(null),h=Object(C.useRef)(null),m=Object(B.b)(),O=m.ZhihuHybrid,g=m.Mobile,j=Object(C.useMemo)((function(){return o?"last"===o?c.length-1:c.findIndex((function(e){return e===o})):-1}),[c,o]);return Object(A.a)((function(){-1!==j&&t.current&&p.current&&f.current&&t.current.scrollTo({top:p.current.offsetTop+f.current.offsetTop-10})})),Object(C.useEffect)((function(){if(l&&!i.isEnd&&h.current){var e=new IntersectionObserver((function(e){if(e[0].isIntersecting&&i.next){var t=new URL(i.next).searchParams.get("offset");null==d||d(t)}}),{root:O?void 0:t.current,rootMargin:"0px 0px 200px 0px"});return e.observe(h.current),function(){e.disconnect()}}}),[l,i,d,O,t]),Object(y.c)(I.Box,{ref:p,className:n,children:[Object(y.b)(Pt,{data:a,children:c.map((function(e,t){var n=t===j;return Object(y.b)(On,{ref:n?f:void 0,id:e,commentType:r,pageOffset:u,blink:n,onAction:b},e)}))}),g&&i.isEnd&&0===(null==s?void 0:s.collapsedCounts)&&Object(y.b)(I.Box,{mt:"20px",color:"GBK06A",fontSize:"13px",textAlign:"center",children:"没有更多评论了"}),Object(y.b)("div",{ref:h})]})})),vn=Object(ke.h)(c||(c=u()(["\n0% {transform: translateX(-56%);}\n100% {transform: translateX(56%);}\n"]))),yn=function(e){var t=e.className,n=Object(ce.a)().colors,r=n.GBK10A,o=n.GBK09A,c=n.GBK99A;return Object(y.c)("div",{className:t,css:{position:"relative",overflow:"hidden",background:r,color:c},children:[Object(y.b)("div",{css:{position:"absolute",width:"200%",height:"100%",background:"linear-gradient(to right, ".concat(r," 0%, ").concat(o," 20%, ").concat(r," 40%, ").concat(r," 100%)"),animation:"".concat(vn," 1s linear 1ms infinite forwards")}}),Object(y.b)("svg",{width:"656",height:"44",viewBox:"0 0 656 44",css:{position:"relative",minWidth:"100%",verticalAlign:"top",boxSizing:"border-box"},children:Object(y.b)("path",{d:"M0 0h656v44H0V0zm0 0h480v12H0V0zm0 32h238v12H0V32z",fill:"currentColor",fillRule:"evenodd"})})]})},Cn=function(e){var t=e.isInfinite,n=e.fullHeight;return t?Object(y.b)("div",{css:{boxSizing:"border-box",padding:"10px 20px 14px 20px",height:n?"calc(100vh - 24px * 2 - 50px - 62px - 20px)":void 0},children:Object(y.b)(yn,{})}):Object(y.b)(I.Flex,{justifyContent:"center",alignItems:"center",height:"96px",children:Object(y.b)(H.a,{})})},kn=function(e){var t=e.containerRef,n=e.commentType,r=e.scrollAndBlink,o=e.fullHeightLoading,c=e.pageOffset,a=e.isResourceAuthor,i=e.isInfinite,s=e.onNextPage,u=st(c,{isInfinitePage:i}),l=u.data,d=u.isValidating,b=Et(c);if(d&&!l)return Object(y.b)(Cn,{isInfinite:i,fullHeight:o});var p=l||{},f=p.data,h=p.entities,m=p.paging,O=p.counts;return f&&f.length>0&&h&&m&&O?Object(y.b)(Mt,{pageOffset:c,isResourceAuthor:a,children:Object(y.b)(xn,{containerRef:t,commentType:n,scrollAndBlink:r,list:f,entities:h,paging:m,counts:O,pageOffset:c,isInfinite:i,onNextPage:s,onAction:b})}):null},Tn=function(e){var t=e.paging,n=Object(C.useMemo)((function(){return t?[t.isEnd,new URL(t.next).searchParams.get("offset")||void 0]:[!0]}),[t]),r=Fe(v.a,n,2),o=r[0],c=r[1],a=it(),i=a.sortType,s=a.router,u=Object(T.a)((function(){!o&&c&&s.push({commentType:"root",sortType:i,prevLayerOffset:c})}));return o?null:Object(y.c)(S.a,{as:I.Flex,zaType:"Button",zaAction:"Expand",shouldTrackShow:!0,zaText:"查看全部评论",css:function(e){return Object.assign({alignItems:"center",justifyContent:"center",color:e.colors.GBL05A,fontSize:"15px",padding:"20px 0",margin:"0 20px",cursor:"pointer"},Object(re.a)({borderTop:"1px solid ".concat(e.colors.GBK10A)}))},onClick:u,children:[Object(y.b)(I.Text,{children:"点击查看全部评论"}),Object(y.b)(le.b,{size:24})]})},wn=Object(C.memo)((function(e){var t=e.type,n=e.counts,r=e.isResourceAuthor,o=e.onAction,c=Object(B.b)().Mobile,a=ct().push,i=Object(T.a)((function(){r&&(c?o("showCommentList",{commentType:"review"}):a({commentType:"reviewing"}))})),s=Object(T.a)((function(){c?o("showCommentList",{commentType:"collapsed"}):a({commentType:"collapsed"})}));if(!n)return null;if("reviewing"===t){var u=r&&n.reviewingCounts>0;return Object(y.c)(S.a,{as:I.Flex,shouldTrackShow:!0,zaType:"Button",zaAction:"Expand",zaText:!0,css:function(e){return{flex:"0 0 auto",alignItems:"center",margin:c?"20px 0 0":"20px 20px 0",padding:"0 10px",height:"36px",fontSize:"14px",color:r?e.colors.GBL01A:e.colors.GBL05A,borderRadius:"3px",backgroundColor:e.colorMod(r?e.colors.GBL01A:e.colors.GBL05A).alpha(.1),cursor:u?"pointer":"default"}},onClick:u?i:G.a,children:[Object(y.b)(ve.a,{text:!0,size:16}),Object(y.b)(I.Text,{ml:"8px",flex:"1 1 auto",children:r?"".concat(n.reviewingCounts," 条新评论待筛选"):"评论内容由作者筛选后展示"}),u&&Object(y.b)(le.b,{size:24})]})}return"collapsed"===t&&n.collapsedCounts>0?Object(y.c)(I.Flex,{alignItems:"center",justifyContent:"center",color:"GBL05A",fontSize:"15px",p:c?"0 0 10px 0":"20px 0",mx:"20px",sx:Object.assign(Object.assign({},c?void 0:Object(re.a)({borderTop:"1px solid",borderTopColor:"GBK10A"})),{},{cursor:"pointer"}),onClick:s,children:[Object(y.b)(I.Text,{children:"查看被折叠评论"}),Object(y.b)(ye.a,{size:16,css:{marginLeft:"4px"},onClick:function(e){e.stopPropagation(),window.open("https://www.zhihu.com/question/52029856/answer/128623557")}})]}):null})),An=function(e){return{flex:"0 0 auto",padding:"10px 20px",boxShadow:"0px -1px 3px ".concat(e.colorMod(e.colors.GBK02B).alpha(.12))}},Bn=function(){var e=tt(),t=e.hideFoldButton,n=e.onClose;return t||!n?null:Object(y.b)(Ee.a.div,{variants:{initial:{opacity:0,transitionEnd:{display:"none"}},sticky:{opacity:1,display:"block"},unSticky:{opacity:0,transitionEnd:{display:"none"}}},css:{position:"absolute",top:"-52px",right:"20px"},children:Object(y.c)(K.a,{preset:"secondary",color:"grey",onClick:n,css:function(e){return{margin:"10px 0 10px 54px",padding:"0 6px 0 12px",height:"32px",color:e.colors.GBL05A,backgroundColor:e.colors.GBK10A,fontWeight:500,":hover":{backgroundColor:e.colors.GBK10A},svg:{marginBottom:"1px"}}},children:["收起评论",Object(y.b)(Ce.b,{center:!0,size:24})]})})},In=function(e){var t=e.disabled,n=e.autoFocus,r=e.placeholder,o=e.onSubmit,c=e.children,a=tt().hideBottomEditorShadow,i=Object(C.useRef)(null),s=Object(C.useRef)(null),u=Object(C.useRef)(null),l=Object(C.useState)(!1),d=Fe(v.a,l,2),b=d[0],p=d[1],f=Object(Le.a)(),m=Object(ce.a)().colors,g=m.GBK99A,j=m.GBK02B;return Object(C.useEffect)((function(){if(i.current){var e=i.current.offsetHeight;p(e>1.5*window.innerHeight)}}),[c]),Object(C.useEffect)((function(){if(b&&i.current&&s.current&&u.current){var e=function(){var e=O()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.set(t?"unSticky":"sticky"),e.next=3,f.start(t?"sticky":"unSticky");case 3:t||f.set("initial");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=new IntersectionObserver((function(t){var n=Fe(v.a,t,2),r=n[0],o=n[1];2===t.length||!1===(null==o?void 0:o.isIntersecting)?f.start("initial"):r.target===u.current?f.start(r.isIntersecting?"initial":"sticky"):r.target===s.current&&e(r.isIntersecting)}));return t.observe(s.current),t.observe(u.current),function(){return t.disconnect()}}}),[f,b]),Object(y.c)("div",{css:{position:"relative"},ref:i,children:[Object(y.b)(S.b,{content:{type:"Comment"},children:Object(y.b)(sn,{disabled:t,autoFocus:n,placeholder:r,localCache:!0,css:{marginBottom:"10px"},onSubmit:o})}),c,b&&Object(y.b)("div",{ref:s,css:{position:"absolute",top:"100vh",bottom:0}}),t||b&&Object(y.c)(Ee.a.div,{initial:"initial",animate:f,variants:{initial:{position:"relative",boxShadow:"0 0"},sticky:{position:"sticky",y:0,boxShadow:a?"0 0":"0px -1px 3px ".concat(Object(ae.a)(j).alpha(.12))},unSticky:{position:"sticky",y:"100%",boxShadow:"0 0"}},css:{zIndex:1,margin:"0 -20px",padding:"10px 20px",bottom:0,background:g},children:[Object(y.b)(Bn,{}),Object(y.b)(S.b,{content:{type:"Comment"},children:Object(y.b)(sn,{isSticky:!0,autoFocus:!1,placeholder:r,maxLine:6,onSubmit:o})})]}),b&&Object(y.b)("div",{ref:u})]})},Sn=function(e){var t=e.hide,n=e.disabled,r=e.autoFocus,o=e.placeholder,c=e.onAction,a=e.children,i=it(),s=i.displayType,u=i.fetchCommentId,l=i.rootCommentAuthor,d=l?"回复 ".concat(l.name):o,b=Object(T.a)((function(e){c("addComment",{data:e})}));return t?Object(y.b)(y.a,{children:a}):"list"===s?Object(y.b)(In,{disabled:n,autoFocus:r,placeholder:d,onSubmit:b,children:a}):Object(y.c)(y.a,{children:[a,Object(y.b)(S.b,{content:{type:"Comment"},children:Object(y.b)(sn,{disabled:n,autoFocus:r,placeholder:d,maxLine:6,localCache:!0,replyCommentId:u,css:An,onSubmit:b})})]})},zn=function(e){var t=e.className,n=e.hideEditor,r=e.disableEditor,o=e.autoFocusEditor,c=e.editorPlaceholder,a=e.onAction,i=e.children,s=it(),u=s.displayType,l=s.commentType,d="root"!==l&&"sub"!==l||n;return Object(B.b)().Mobile?Object(y.b)(S.b,{block:"comment_list",children:Object(y.b)(I.Box,{className:t,children:Object(y.b)(I.Flex,{flexDirection:"column",alignItems:"stretch",sx:{position:"relative"},children:i})})}):"list"===u?Object(y.b)(S.b,{block:"comment_list",children:Object(y.b)(I.Box,{className:t,children:Object(y.b)(Sn,{hide:d,disabled:r,autoFocus:o,placeholder:c,onAction:a,children:Object(y.b)(I.Flex,{flexDirection:"column",alignItems:"stretch",sx:{position:"relative",border:"1px solid",borderColor:"GBK09A",borderRadius:"4px"},children:i})})})}):Object(y.b)(S.b,{block:"comment_popup",children:Object(y.b)(I.Flex,{flexDirection:"column",alignItems:"stretch",height:"100%",css:{position:"relative"},className:t,children:Object(y.b)(Sn,{hide:d,disabled:r,autoFocus:o,placeholder:c,onAction:a,children:i})})})},En={avatarUrl:"https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_s.jpeg",id:"0",urlToken:"",name:""},Ln=["1","0.7","0.4"],Dn=["[谢邀]","[赞同]"],Rn=function(e){var t=e.commentStatus,n=e.onInputShowTips,r=tt(),o=r.resourceId,c=r.resourceType,a=Object(ce.a)().colors,i=a.GBK10A,s=a.GBK06A,u=Zt(),l=Object(C.useState)([]),d=Fe(v.a,l,2),b=d[0],p=d[1],f=Object(C.useState)(En),h=Fe(v.a,f,2),m=h[0],O=h[1],g=t.type,j=t.text,x=t.induceText,k=4===g,w=5===g,A=k||w,B=A&&j;Object(C.useEffect)((function(){u.length>0&&Object(P.a)("base/getFrequentlyUsedEmoticon").dispatch({count:3}).then((function(e){var t=null==e?void 0:e.data;return t&&0!==t.length||(t=Dn),p(t.map((function(e){return function(e,t){return t.find((function(t){return t.placeholder===e}))}(e,u)})))}))}),[u]),Object(C.useEffect)((function(){Object(P.a)("account/me").dispatch().then((function(e){if(null==e?void 0:e.url_token){var t=e.avatar_url,n=void 0===t?"":t,r=e.url_token,o=e.id,c=e.name;O({avatarUrl:n,id:o,name:void 0===c?"":c,urlToken:r})}}))}),[]);var S=Object(T.a)((function(e){A&&e.preventDefault(),k&&Object(P.a)("ui/showToast").dispatch({text:j}),w&&(null==n||n(x||"评论区功能升级中，暂时无法发送评论，可以使用「赞同并推荐」功能参与互动"))}));return Object(y.c)(I.Flex,{css:{width:"100%",alignItems:"center"},children:[Object(y.b)(Ut,{user:m}),Object(y.c)(we.b,{as:I.Flex,css:{flex:1,marginLeft:"10px",height:"36px",color:s,backgroundColor:i,borderRadius:"18px",padding:"0 4px 0 16px",fontSize:"14px",justifyContent:"space-between",alignItems:"center"},href:"zhihu://comment/list/".concat(c,"/").concat(o,"?open_editor=true"),onClick:S,children:[Object(y.b)(I.Text,{css:{lineHeight:"normal"},children:B||"写下你的评论..."}),b.length>0&&Object(y.b)(I.Flex,{css:{height:"34px",alignItems:"center",marginRight:"4px"},children:b.filter(Boolean).map((function(e,t){var n=e.static_image_url,r=e.title;return Object(y.b)("img",{alt:"icon",src:n,css:{width:"20px",height:"20px",marginRight:"4px",opacity:Ln[t]}},r)}))})]})]})},Mn=function(e){var t,n,r,o,c,a,i=e.className,s=Object(C.useRef)(null),u=tt(),l=u.onInputShowTips,d=u.hideEditor,b=Object(B.b)(),p=b.Mobile,f=b.ZhihuHybrid,h=it(),m=h.index,O=h.displayType,g=h.commentType,x=h.sortType,k=h.prevLayerOffset,w=h.fetchCommentId,A="modal"===O,z="list"===O,L="root"===g,R="sub"===g,M="anchor"===g,G=function(){var e=it().commentType,t=Object(C.useMemo)((function(){return[["sub","anchor"].includes(e)?"root":e,"score",void 0,""]}),[e]),n=Object(D.a)(t),r=n.data,o=n.error,c=null==r?void 0:r.data;return t?o&&!c?{error:Ue(o)}:c?E()(r,"entities"):{error:"请求数据失败"}:{}}(),F=Et();c=F,a=0===m&&f,Object(C.useEffect)((function(){if(a){var e=Object(P.a)("comment/onMessage").listen((function(e){var t=e.type,n=e.data;c("changeComment",{type:t,data:n})})),t=Object(P.a)("base/viewDidAppear").listen((function(){c("clearWaiting")}));return function(){e(),t()}}}),[a,c]);var N=Boolean(A&&L&&k),K=M?w:void 0,_=Ke((function(){return[N&&k||""]}),[N,k,x]),H=Fe(v.a,_,2),U=H[0],W=H[1],V=Object(T.a)((function(e){U.find((function(t){return t===e}))||W((function(t){return[].concat(Fe(j.a,t),[e])}))})),Z=Object(T.a)((function(){var e;A&&(null===(e=s.current)||void 0===e||e.scrollTo({top:0}))})),q=(null===(t=G.commentStatus)||void 0===t?void 0:t.type)||0;if(1===q||3===q)return Object(y.c)(zn,{className:i,hideEditor:!0,onAction:F,children:[p&&Object(y.b)(_t,{title:"评论"}),Object(y.b)(Dt,{type:q})]});var J=null===(n=G.commentStatus)||void 0===n?void 0:n.induceText,X=Boolean(G.error||J),Y=L&&2===q,$=!d&&p&&G.commentStatus&&Object(y.b)(I.Box,{mt:16,children:Object(y.b)(Rn,{commentStatus:G.commentStatus,onInputShowTips:l})});return 0===(null===(r=G.counts)||void 0===r?void 0:r.totalCounts)&&0===(null===(o=G.data)||void 0===o?void 0:o.length)?Object(y.c)(zn,{className:i,disableEditor:X,autoFocusEditor:!X,editorPlaceholder:J,onAction:F,hideEditor:d,children:[p&&Object(y.b)(_t,{title:"评论"}),$,Y&&Object(y.b)(wn,{type:"reviewing",counts:G.counts,isResourceAuthor:G.isContentAuthor,onAction:F}),Object(y.b)(Dt,{noComments:!0})]}):Object(y.c)(zn,{className:i,disableEditor:X,editorPlaceholder:J,onAction:F,hideEditor:d,children:[(Boolean(p&&G.counts)||!p)&&Object(y.b)(_t,{counts:G.counts,onChangeSortType:Z}),$,Object(y.c)(S.f,{zaType:"Block",ref:s,css:{flex:"1 1 auto",overflowY:A?"scroll":void 0,position:"relative"},children:[R&&Object(y.b)(jn,{isResourceAuthor:G.isContentAuthor}),Y&&Object(y.b)(wn,{type:"reviewing",counts:G.counts,isResourceAuthor:G.isContentAuthor,onAction:F}),Object(y.c)(I.Box,{py:"10px",css:{minHeight:"100%"},children:[Boolean(N)&&Object(y.b)(kn,{containerRef:s,commentType:g,pageOffset:"",isResourceAuthor:G.isContentAuthor,scrollAndBlink:"last"}),U.map((function(e,t){return Object(y.b)(kn,{commentType:g,containerRef:s,fullHeightLoading:0===t&&N,scrollAndBlink:K,pageOffset:e,isResourceAuthor:G.isContentAuthor,isInfinite:p||A&&!M,onNextPage:V},e)}))]}),L&&Object(y.b)(wn,{type:"collapsed",counts:G.counts,isResourceAuthor:G.isContentAuthor,onAction:F})]}),!p&&z&&U.length>0&&Object(y.b)(Tn,{paging:G.paging})]})},Gn=function(e){var t=e.onClose,n=e.onExit,r=e.children,o=ct().pop,c=Object(T.a)((function(){t&&t(),o(0)}));return Object(y.b)(F.a,{size:"fullPage",css:{".Modal-content":{padding:0,marginTop:0,position:"relative"}},maskClosable:!1,onClose:c,onExitComplete:n,children:r})},Pn=function(e,t){return t<e-1?{display:"none"}:{}},Fn=function(e){var t=e.onExit,n=ct().layers,r=tt(),o=r.className,c=r.displayType,a=r.onClose;if(Object(C.useEffect)((function(){"list"===c&&0===n.length&&t()}),[c,n.length,t]),"list"===c){var s=Fe(i.a,n),u=s[0],l=s.slice(1);return u?Object(y.c)(y.a,{children:[Object(y.b)(at,{data:u,children:Object(y.b)(Mn,{className:o})}),Object(y.b)(Gn,{children:l.length>0?l.map((function(e,t){return Object(y.b)(at,{data:e,children:Object(y.b)(Mn,{css:Pn(l.length,t)})},e.index)})):null})]}):null}return Object(y.b)(Gn,{onClose:a,onExit:t,children:n.length>0?n.map((function(e,t){return Object(y.b)(at,{data:e,children:Object(y.b)(Mn,{css:Pn(n.length,t)})},e.index)})):null})},Nn=function(e){var t=e.shown,n=Object(C.useState)(t),r=Fe(v.a,n,2),o=r[0],c=r[1],a=Object(T.a)((function(){c(!1)}));return Object(C.useEffect)((function(){t&&c(!0)}),[t]),o?Object(y.b)(et,Object.assign(Object.assign({},e),{},{children:Object(y.b)(Vt,{children:Object(y.b)(ot,{children:Object(y.b)(Fn,{onExit:a})})})})):null}}).call(this,n(247))}}]);
//# sourceMappingURL=column.lib_cf230269.e405bd316f736abc16b4.js.map