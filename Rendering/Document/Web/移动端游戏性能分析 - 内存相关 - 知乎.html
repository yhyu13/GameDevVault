<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/481796640 -->
<html lang="zh" data-hairline="true" data-theme="light" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>移动端游戏性能分析 - 内存相关 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="图形处理器（GPU）,计算机图形学,Unity（游戏引擎）"><meta data-rh="true" name="description" content="本文主要总结和介绍移动端游戏性能相关问题的分析，本篇为内存专题。 GPU is very IO limited! IO is very often the throughput bottleneck, so its important to be smart about IO. --- By someone 1 Introduct…"><meta data-rh="true" property="og:title" content="移动端游戏性能分析 - 内存相关"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/481796640"><meta data-rh="true" property="og:description" content="本文主要总结和介绍移动端游戏性能相关问题的分析，本篇为内存专题。 GPU is very IO limited! IO is very often the throughput bottleneck, so its important to be smart about IO. --- By someone 1 Introduct…"><meta data-rh="true" property="og:image" content="https://pic1.zhimg.com/v2-9127f55344df6af258900557d2d2538b_720w.jpg?source=172ae18b"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.bbce8f18.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.cbade8f9.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.8f6c52aa.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><style data-emotion-css="1m4merm">.u-safeAreaInset-top{height:constant(safe-area-inset-top) !important;height:env(safe-area-inset-top) !important;}.u-safeAreaInset-bottom{height:constant(safe-area-inset-bottom) !important;height:env(safe-area-inset-bottom) !important;}</style><link href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.app.216a26f4.9984cbe9a79e1fa699d5.css" crossorigin="" rel="stylesheet"><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"4582-0108e965\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;4582-0108e965&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/init.js.download"></script><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="1yuhvjn">.css-1yuhvjn{margin-top:16px;}</style><style data-emotion-css="3jt6os">.css-3jt6os .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-3jt6os .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-3jt6os .FileLinkCard-info{margin-left:12px;}.css-3jt6os .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-3jt6os .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-3jt6os .FileLinkCard-source{white-space:pre;}</style><style data-emotion-css="1wr1m8">.css-1wr1m8 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-1wr1m8 .LinkCard.new,.css-1wr1m8 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1wr1m8 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-1wr1m8 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1wr1m8 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1wr1m8 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-1wr1m8 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1wr1m8 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1wr1m8 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-1wr1m8 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1wr1m8 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1wr1m8 .LinkCard.old,.css-1wr1m8 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="hypxot">.css-hypxot .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-hypxot .LinkCard.old,.css-hypxot .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-hypxot .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-hypxot .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-hypxot .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-hypxot .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-hypxot .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-hypxot .LinkCard.new,.css-hypxot .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-hypxot .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-hypxot .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-hypxot .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-hypxot .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-hypxot .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-hypxot .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-hypxot .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-hypxot .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-hypxot .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-hypxot .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-hypxot .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-hypxot .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-hypxot .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-hypxot .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-hypxot .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-hypxot .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-hypxot .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-hypxot .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-hypxot .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-hypxot .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-hypxot .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-hypxot .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-hypxot .FileLinkCard-info{margin-left:12px;}.css-hypxot .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-hypxot .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-hypxot .FileLinkCard-source{white-space:pre;}</style><style data-emotion-css="yvdm7v animation-1sh55c5">.css-yvdm7v{word-break:break-word;line-height:1.6;}.css-yvdm7v a.UserLink-link{color:#175199;}.css-yvdm7v a.UserLink-link:hover{border-bottom:1px solid #175199;}.css-yvdm7v lazy[data-lazy-status]{background-color:#F6F6F6;}.css-yvdm7v lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1sh55c5 0.5s ease-in;animation:animation-1sh55c5 0.5s ease-in;}.css-yvdm7v > [data-first-child]{margin-top:0;}.css-yvdm7v > :last-child{margin-bottom:0;}.css-yvdm7v h1,.css-yvdm7v h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-yvdm7v h3,.css-yvdm7v h4,.css-yvdm7v h5,.css-yvdm7v h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-yvdm7v u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #444444;}.css-yvdm7v b{font-weight:600;}.css-yvdm7v sup{font-size:0.8em;}.css-yvdm7v sup[data-draft-type='reference']{color:#175199;}.css-yvdm7v a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-yvdm7v a:focus{box-shadow:0 0 0 2px #FFFFFF,0 0 0 4px rgba(5,109,232,0.3);}.css-yvdm7v a.ztext-link,.css-yvdm7v a.internal,.css-yvdm7v a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #808080;}.css-yvdm7v a.ztext-link:hover,.css-yvdm7v a.internal:hover,.css-yvdm7v a.external:hover{color:#175199;border-bottom:1px solid #175199;}.css-yvdm7v a.ztext-link > .ellipsis::after,.css-yvdm7v a.internal > .ellipsis::after,.css-yvdm7v a.external > .ellipsis::after{content:'...';}.css-yvdm7v a.ztext-link > .invisible,.css-yvdm7v a.internal > .invisible,.css-yvdm7v a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-yvdm7v a.ztext-link u,.css-yvdm7v a.internal u,.css-yvdm7v a.external u{border:none;}.css-yvdm7v a.member_mention{color:#175199;}.css-yvdm7v a.member_mention:hover{border-bottom:1px solid #175199;}.css-yvdm7v p{margin:1.4em 0;}.css-yvdm7v p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-yvdm7v p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-yvdm7v hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #D3D3D3;}.css-yvdm7v img[eeimg]{max-width:100%;vertical-align:middle;}.css-yvdm7v img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-yvdm7v img[eeimg="2"]{margin:1.4em auto;display:block;}.css-yvdm7v blockquote{margin:1.4em 0;padding-left:1em;color:#646464;border-left:3px solid #D3D3D3;}.css-yvdm7v ol,.css-yvdm7v ul{margin:1.4em 0;padding:0;width:100%;}.css-yvdm7v ol ol,.css-yvdm7v ul ol,.css-yvdm7v ol ul,.css-yvdm7v ul ul{margin:0;}.css-yvdm7v ol li::before,.css-yvdm7v ul li::before{width:1em;}.css-yvdm7v ol > ol,.css-yvdm7v ul > ol,.css-yvdm7v ol > ul,.css-yvdm7v ul > ul{display:table-row;}.css-yvdm7v ol > ol::before,.css-yvdm7v ul > ol::before,.css-yvdm7v ol > ul::before,.css-yvdm7v ul > ul::before{display:table-cell;content:'';}.css-yvdm7v ul{display:table;}.css-yvdm7v ul>li{display:table-row;list-style:none;}.css-yvdm7v ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-yvdm7v ol{display:table;counter-reset:ol;}.css-yvdm7v ol > li{display:table-row;list-style:none;}.css-yvdm7v ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-yvdm7v ol ol{counter-reset:ol2;}.css-yvdm7v ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-yvdm7v ol ol ol{counter-reset:ol3;}.css-yvdm7v ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-yvdm7v ol ol ol ol{counter-reset:ol4;}.css-yvdm7v ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-yvdm7v figure{margin:1.4em 0;}.css-yvdm7v figure .content_image,.css-yvdm7v figure .origin_image{margin:0 auto;}.css-yvdm7v figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#999999;}.css-yvdm7v figure + figure{margin-top:calc(1.4em * 1.6);}.css-yvdm7v figure[data-size='small'],.css-yvdm7v figure:not([data-size]) > [data-size='small']{clear:both;}.css-yvdm7v figure[data-size='left'],.css-yvdm7v figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-yvdm7v figure[data-size='right'],.css-yvdm7v figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-yvdm7v figure[data-size='collapse']{margin-bottom:0;}.css-yvdm7v figure[data-size='collapse'] + figure{margin-top:0;}.css-yvdm7v .content_image,.css-yvdm7v .origin_image{display:block;max-width:100%;margin:1.4em auto;}.css-yvdm7v .content_image[data-size='small'],.css-yvdm7v .origin_image[data-size='small']{max-width:40%;}.css-yvdm7v .content_image.zh-lightbox-thumb,.css-yvdm7v .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-yvdm7v code{margin:0 2px;padding:3px 4px;border-radius:3px;font-size:0.9em;background-color:#F6F6F6;}.css-yvdm7v pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#F6F6F6;border-radius:4px;}.css-yvdm7v pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-yvdm7v li pre{white-space:pre-wrap;}.css-yvdm7v table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-yvdm7v table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-yvdm7v table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#F6F6F6;}.css-yvdm7v table[data-draft-type='table'] td,.css-yvdm7v table[data-draft-type='table'] th{border:1px solid #D3D3D3;line-height:24px;height:24px;padding:3px 12px;}.css-yvdm7v table[data-draft-type='table'] th{background:#EBEBEB;color:#121212;font-weight:500;}.css-yvdm7v .video-box,.css-yvdm7v .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #EBEBEB;border-radius:4px;}.css-yvdm7v .highlight{margin:1em 0;}.css-yvdm7v .highlight pre{margin:0;}.css-yvdm7v .highlight .hll{background-color:#FDFDFD;}.css-yvdm7v .highlight .c{font-style:italic;color:#999999;}.css-yvdm7v .highlight .err{color:#F1403C;}.css-yvdm7v .highlight .k{font-weight:600;}.css-yvdm7v .highlight .o{font-weight:600;}.css-yvdm7v .highlight .cm{font-style:italic;color:#999999;}.css-yvdm7v .highlight .cp{font-weight:600;color:#999999;}.css-yvdm7v .highlight .c1{font-style:italic;color:#999999;}.css-yvdm7v .highlight .cs{font-style:italic;font-weight:600;color:#999999;}.css-yvdm7v .highlight .gd{color:#FF3366;}.css-yvdm7v .highlight .ge{font-style:italic;}.css-yvdm7v .highlight .gr{color:#F1403C;}.css-yvdm7v .highlight .gh{color:#999999;}.css-yvdm7v .highlight .gi{color:#12b370;}.css-yvdm7v .highlight .go{color:#808080;}.css-yvdm7v .highlight .gp{color:#646464;}.css-yvdm7v .highlight .gs{font-weight:600;}.css-yvdm7v .highlight .gu{color:#999999;}.css-yvdm7v .highlight .gt{color:#F1403C;}.css-yvdm7v .highlight .kc{font-weight:600;}.css-yvdm7v .highlight .kd{font-weight:600;}.css-yvdm7v .highlight .kn{font-weight:600;}.css-yvdm7v .highlight .kp{font-weight:600;}.css-yvdm7v .highlight .kr{font-weight:600;}.css-yvdm7v .highlight .kt{font-weight:600;color:#175199;}.css-yvdm7v .highlight .m{color:#056DE8;}.css-yvdm7v .highlight .s{color:#F1403C;}.css-yvdm7v .highlight .na{color:#056DE8;}.css-yvdm7v .highlight .nb{color:#056DE8;}.css-yvdm7v .highlight .nc{font-weight:600;color:#175199;}.css-yvdm7v .highlight .no{color:#056DE8;}.css-yvdm7v .highlight .ni{color:#5555DD;}.css-yvdm7v .highlight .ne{font-weight:600;color:#F1403C;}.css-yvdm7v .highlight .nf{font-weight:600;color:#F1403C;}.css-yvdm7v .highlight .nn{color:#646464;}.css-yvdm7v .highlight .nt{color:#175199;}.css-yvdm7v .highlight .nv{color:#056DE8;}.css-yvdm7v .highlight .ow{font-weight:600;}.css-yvdm7v .highlight .w{color:#BFBFBF;}.css-yvdm7v .highlight .mf{color:#056DE8;}.css-yvdm7v .highlight .mh{color:#056DE8;}.css-yvdm7v .highlight .mi{color:#056DE8;}.css-yvdm7v .highlight .mo{color:#056DE8;}.css-yvdm7v .highlight .sb{color:#F1403C;}.css-yvdm7v .highlight .sc{color:#F1403C;}.css-yvdm7v .highlight .sd{color:#F1403C;}.css-yvdm7v .highlight .s2{color:#F1403C;}.css-yvdm7v .highlight .se{color:#F1403C;}.css-yvdm7v .highlight .sh{color:#F1403C;}.css-yvdm7v .highlight .si{color:#F1403C;}.css-yvdm7v .highlight .sx{color:#F1403C;}.css-yvdm7v .highlight .sr{color:#A5542F;}.css-yvdm7v .highlight .s1{color:#F1403C;}.css-yvdm7v .highlight .ss{color:#F1403C;}.css-yvdm7v .highlight .bp{color:#999999;}.css-yvdm7v .highlight .vc{color:#056DE8;}.css-yvdm7v .highlight .vg{color:#056DE8;}.css-yvdm7v .highlight .vi{color:#056DE8;}.css-yvdm7v .highlight .il{color:#056DE8;}.css-yvdm7v .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-yvdm7v .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(18,18,18,0.5);border-radius:6px;}.css-yvdm7v .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(18,18,18,0.6);}.css-yvdm7v .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yvdm7v .LinkCard.old,.css-yvdm7v .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yvdm7v .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-yvdm7v .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yvdm7v .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yvdm7v .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-yvdm7v .LinkCard.new,.css-yvdm7v .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yvdm7v .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yvdm7v .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-yvdm7v .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yvdm7v .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yvdm7v .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yvdm7v .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yvdm7v .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yvdm7v .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yvdm7v .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yvdm7v .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-yvdm7v .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yvdm7v .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yvdm7v .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yvdm7v .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-yvdm7v .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-yvdm7v .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yvdm7v .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yvdm7v .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-yvdm7v .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yvdm7v .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yvdm7v .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yvdm7v .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yvdm7v .FileLinkCard-info{margin-left:12px;}.css-yvdm7v .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yvdm7v .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yvdm7v .FileLinkCard-source{white-space:pre;}@-webkit-keyframes animation-1sh55c5{from{opacity:0;}to{opacity:1;}}@keyframes animation-1sh55c5{from{opacity:0;}to{opacity:1;}}</style><style data-emotion-css="u1frr4">.css-u1frr4{width:724px;}.css-u1frr4 .Modal-content{margin:22px 0 5px;}.css-u1frr4 .Creator-QuestionShared-title{padding-right:65px;}</style><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.zswsdid.8a757e7f9aca174311cb.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.shared_da7c8ae9ba4d3befc7c2f1c0b3e151cc8ee375ec.af12ecf8f2d548afdf54.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.user-hover-card.216a26f4.2325354b564ca3c742a9.css" crossorigin="anonymous"><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.user-hover-card.71fc423e9dc0dd03156b.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.Labels.216a26f4.7d19d2afdc588e36471f.css" crossorigin="anonymous"><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.Labels.a730f78c61b869939ce0.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.GoodsRecommendGoodsCardList.216a26f4.fa4bea774ed719d42a42.css" crossorigin="anonymous"><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.GoodsRecommendGoodsCardList.ab2afb8cb93040927be1.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.report_modals.bed2ca0468847d780826.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.modals.216a26f4.4cc94e5a02bc6d62ae13.css" crossorigin="anonymous"><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.modals.a1ce0d73eb75e5779eea.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_cf230269.1f03be8440230089d5eb.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.comments-v3.94b98e3ddfcd5d8fbe3c.js.download" crossorigin="anonymous"></script><style data-emotion="css"></style><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.81.e7fba72373a0d6bae521.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_9974496f.5b97ef76824871658209.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.shared_03103dc5b8182a3433c5ef33bacb88093fd08a38.06cbe3c48b6f221e0ffd.js.download" crossorigin="anonymous"></script><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.shared_889419e066c38251e2dcbb9a7c42dbfc379cadeb.d310b40a3fff5126c470.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.EditableV2.216a26f4.56bfcd6fcf02391f767f.css" crossorigin="anonymous"><script charset="utf-8" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.EditableV2.9f0e35d0c4103cc5b4ea.js.download" crossorigin="anonymous"></script></head><body class="WhiteBg-body PostIndex-body" data-rh="class"><div id="root"><div class="App"><div class="LoadingBar"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;ao-ta-kang-007&quot;}" data-zop="{&quot;authorName&quot;:&quot;Josh LEE&quot;,&quot;itemId&quot;:481796640,&quot;title&quot;:&quot;移动端游戏性能分析 - 内存相关&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;481796640&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader is-fixed css-1l12z7y" style="width: 1581.33px; top: 0px; left: 0px;"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#056DE8" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover1-content" type="button" class="Button ColumnPageHeader-MenuToggler Button--plain"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots" class="Zi Zi--Dots" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="PencilPaper24" data-old-api="EditSurround" class="Zi Zi--EditSurround" fill="currentColor"><path d="M3.55 5.97a2.415 2.415 0 012.415-2.416h7.56a.75.75 0 010 1.5h-7.56a.915.915 0 00-.915.915v12.072c0 .505.41.915.915.915h12.074c.506 0 .915-.41.915-.915v-7.557a.75.75 0 011.5 0v7.557a2.415 2.415 0 01-2.415 2.415H5.965A2.415 2.415 0 013.55 18.04V5.969z" fill-rule="evenodd" clip-rule="evenodd"></path><path d="M20.239 3.77a.75.75 0 010 1.06l-8.206 8.206a.75.75 0 01-1.06-1.06l8.205-8.206a.75.75 0 011.06 0z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover7-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover7-content" type="button" class="Button AppHeader-profileEntry Button--plain"><img class="Avatar AppHeader-profileAvatar" width="30" height="30" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-ef69d369588e9764f9252225e6dc29ce_is.jpg" srcset="https://pic1.zhimg.com/v2-ef69d369588e9764f9252225e6dc29ce_im.jpg?source=32738c0c 2x" alt="点击打开奥塔康007的主页"></button></div><div class="Popover AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover8-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover8-content"></div></div></div></div><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div></div><img class="TitleImage" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-9127f55344df6af258900557d2d2538b_1440w.jpg" alt="移动端游戏性能分析 - 内存相关"><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">移动端游戏性能分析 - 内存相关</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="Josh LEE"><meta itemprop="image" content="https://pic4.zhimg.com/v2-70621b79f1611bdacea0282c1e445798_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/josh-lee-12"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover9-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover9-content"><a href="https://www.zhihu.com/people/josh-lee-12" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar Avatar--round AuthorInfo-avatar" width="38" height="38" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-70621b79f1611bdacea0282c1e445798_xs.jpg" srcset="https://pic4.zhimg.com/v2-70621b79f1611bdacea0282c1e445798_l.jpg?source=172ae18b 2x" alt="Josh LEE"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover10-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover10-content"><a href="https://www.zhihu.com/people/josh-lee-12" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">Josh LEE</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">Make a better world!</div></div></div></div></div></div><button type="button" class="Button FollowButton Button--primary Button--blue"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="PlusFill24" data-old-api="Plus" class="Zi Zi--Plus FollowButton-icon" fill="currentColor"><path d="M13.25 3.25a1.25 1.25 0 10-2.5 0v7.5h-7.5a1.25 1.25 0 100 2.5h7.5v7.5a1.25 1.25 0 102.5 0v-7.5h7.5a1.25 1.25 0 000-2.5h-7.5v-7.5z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>关注他</button></div><div class="LabelContainer-wrapper"></div><div role="button" tabindex="0"><span class="Voters"><button type="button" class="Button Button--plain">28 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="css-1yuhvjn"><div class="RichText ztext Post-RichText css-yvdm7v" options="[object Object]"><p data-first-child="" data-pid="DhTployj">本文主要总结和介绍移动端游戏性能相关问题的分析，本篇为内存专题。</p><p data-pid="tcJBuFj7">GPU is very IO limited! IO is very often the throughput bottleneck, so its important to be smart about IO.    --- By  someone</p><h2>1 Introduction</h2><p data-pid="pj1NVW8g">随着移动端游戏渲染画质提高，海量几何顶点、纹理数据、超高分辨率等都挑战着移动端GPU内存带宽。在PC端，独立显卡都有一块GPU专属的DRAM(显存)，它具有非常高的带宽设计，但在移动端，受限于功耗，所以在移动端一般都与CPU共用SOC中互联的DRAM，但这也有问题，就是SOC总线访问DRAM的带宽往往也不能满足实际游戏应用的需要，因此为了解决这个问题，移动端一般采用Tile Based Rendering（TBR）:</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-43e7df0b1358a2b495123248f96c7604_b.jpg" data-rawwidth="843" data-rawheight="484" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="843" data-original="https://pic1.zhimg.com/v2-43e7df0b1358a2b495123248f96c7604_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-43e7df0b1358a2b495123248f96c7604_1440w.jpg" data-rawwidth="843" data-rawheight="484" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="843" data-original="https://pic1.zhimg.com/v2-43e7df0b1358a2b495123248f96c7604_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-43e7df0b1358a2b495123248f96c7604_b.jpg" data-lazy-status="ok"></figure><p data-pid="QNCq5ZaN">TBR架构下，GPU内部L1 level设计了一块Tile Memory，高带宽低延迟，Renderpass渲染时，将屏幕按tile划分为多个区域，逐tile渲染写入到tile memory上，并且整个renderpass最后只需要向外部DRAM写出一次，而IMR渲染在每个draw call的fragment都要写到DRAM中，相比于IMR，大量节省了Framebuffer读写的开销。当然，TBR架构只是移动端GPU设计的总体架构，关于内存的优化，还有非常多的微架构设计在里面，例如CRC、frame buffer compression、sparse texture、load tile(frame_buffer_fetch)、Transaction elimination等等移动端GPU特性。</p><p data-pid="MEzgHXAn">GPU存储体系的设计哲学是更大的内存带宽，而不是更低的访问延迟。该设计原则不同于CPU依赖多级Cache来降低内存访问延迟的策略，GPU则是通过大量的并行线程来规避或者叫隐藏内存访问的延迟，具体来说就是GPU在等待某个内存数据到来的时候，会运行成百上千个其他与该数据无关的线程，来处理另外的数据请求，这就是GPU存储体系内存访问的特点：高带宽，高延迟。</p><p data-pid="NcLyi1TO">GPU设计中，一般会采用多个EU（execute unit）组成一个cluster core，又由多个cluster core组成最终的GPU，每个Core部分会有Registers、L1 cache、shared memory等资源，多个Core之间会通过L2 cache连接和外面DRAM交互。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-9f38a7dc0e17d72543d35610435bedb1_b.jpg" data-rawwidth="674" data-rawheight="339" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="674" data-original="https://pic2.zhimg.com/v2-9f38a7dc0e17d72543d35610435bedb1_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-9f38a7dc0e17d72543d35610435bedb1_1440w.jpg" data-rawwidth="674" data-rawheight="339" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="674" data-original="https://pic2.zhimg.com/v2-9f38a7dc0e17d72543d35610435bedb1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-9f38a7dc0e17d72543d35610435bedb1_b.jpg" data-lazy-status="ok"></figure><ul><li data-pid="AvmniA-i">Register</li></ul><p data-pid="a13bR1by">- 由编译器管理，访问速度最快</p><ul><li data-pid="RJfNY5fY">Shared memory/ L1 cache</li></ul><p data-pid="HBn0Wo1J">-低延迟，高带宽，如shared memory可由用户编程使用，例如compute中一般对于同一个workgroup可以共享使用</p><ul><li data-pid="U3DGqb6G">Read-only Cache</li></ul><p data-pid="Cd_4mKv6">-一般用于texture、uniform等的缓存，由硬件管理</p><ul><li data-pid="P4ldmh88">L2 cache</li></ul><p data-pid="2Gt0zYSh">-一般所以对Global memory的访问，都要经过L2 cache，较大，如mali G710，L2 cache大小是512~2048KB</p><ul><li data-pid="Os-2UKQw">Global Memory</li></ul><p data-pid="ObkYoZgi">-由SoC总线互联，总线上的IP都可以访问，目前移动端一般几GB到几十GB不等，但访问延迟较大，约几百cycle</p><h2>2 内存相关Performance Counter分析</h2><p data-pid="q8bhff9_">内存Performance Counter的分析，一般自上而下，比如先分析GPU与外部DRAM交互的带宽是否成为瓶颈，如果是，那么进一步解刨GPU内部进一步分析，如Shader Core、TU、EU等。</p><h3>External memory bandwidth</h3><p data-pid="tLmbWdPF">下面相关counter描述GPU与SOC DRAM交互的读写带宽，DRAM的读写对功耗指标来说非常敏感，一般来说，1GB/s的带宽会产生80mW到100mW的功耗，假设某游戏的功耗预算是650mW，并且以60FPS的帧率来运行，那么这个游戏每帧只能有100MB左右的DRAM读写，因此，某些游戏来说，GPU内存带宽的优化非常重要。</p><p data-pid="FBViYH9J">主要有三类counter，一是反应读写数据吞吐量的read/write bytes counter，二是反应读写stall rate的counter，三是反应read/write latency的counter。 其中stall rate和latency能反应出memory读写是否是一个瓶颈。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1c5bf6f3d53cf6d9e3e197b89c887b78_b.jpg" data-rawwidth="601" data-rawheight="448" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="601" data-original="https://pic1.zhimg.com/v2-1c5bf6f3d53cf6d9e3e197b89c887b78_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-1c5bf6f3d53cf6d9e3e197b89c887b78_1440w.jpg" data-rawwidth="601" data-rawheight="448" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="601" data-original="https://pic1.zhimg.com/v2-1c5bf6f3d53cf6d9e3e197b89c887b78_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-1c5bf6f3d53cf6d9e3e197b89c887b78_b.jpg" data-lazy-status="ok"></figure><ul><li data-pid="diZt0iHH">External read/write bytes</li></ul><p data-pid="w06h_mKX">读写带宽的计算：</p><div class="highlight"><pre><code class="language-text">$MaliExternalBusBeatsReadBeat * ($MaliConstantsBusWidthBits / 8)
$MaliExternalBusBeatsWriteBeat * ($MaliConstantsBusWidthBits / 8)</code></pre></div><ul><li data-pid="A9Z-QWT_">External read/write stall</li></ul><p data-pid="f25DrSSH">stall counter表示GPU的读写请求已经ready，但Memroy system当前不能接受这个请求，如果stall率过高，就需要考虑是不读写请求已经超出了当前memory system的最大能力，此时需要考虑优化并减少带宽。</p><p data-pid="HxwP0Xie">以read stall rate为例，通过下面公式计算：</p><div class="highlight"><pre><code class="language-cpp"><span class="n">max</span><span class="p">(</span><span class="n">min</span><span class="p">((</span><span class="err">$</span><span class="n">MaliExternalBusStallsReadStallCycles</span> <span class="o">/</span> <span class="p">(</span><span class="err">$</span><span class="n">MaliConstantsL2SliceCount</span> <span class="o">*</span> <span class="err">$</span><span class="n">MaliGPUCyclesGPUActive</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div><ul><li data-pid="3VGZyObi">External read/write latency</li></ul><p data-pid="Rwnb6Fw3">latency counter表示一个读写请求发送完成后，经过多少个cycle后被gpu看到。过高的latency，也需要考虑是不是所请求的数据超出了当前memory system的最大能力，，此时需要考虑优化并减少带宽。Mali GPU根据laytency的范围，有多组相关的counter:</p><div class="highlight"><pre><code class="language-cpp"><span class="err">$</span><span class="n">MaliExternalBusReadLatency0127Cycles</span>  <span class="c1">//0-127cycles
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliExternalBusReadLatency128191Cycles</span>  <span class="c1">//128-191cycles
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliExternalBusReadLatency192255Cycles</span>  <span class="c1">//192-255cycles
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliExternalBusReadLatency256319Cycles</span>  <span class="c1">//256-319cycles
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliExternalBusReadLatency320383Cycles</span>  <span class="c1">//320-383cycles
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliExternalBusBeatsReadBeat</span> <span class="o">-</span> <span class="n">SUM</span><span class="p">(</span><span class="n">Above</span> <span class="n">All</span><span class="p">)</span>  <span class="c1">//384+cycles
</span></code></pre></div><h3>Shader Core Memory Traffic</h3><p data-pid="UWSz54Jl">前面讲到的external memory bandwidth可以总体算出Memory的吞吐及判断Memory是否是瓶颈，但不能判断memory bound在具体什么地方，因此需要从Shader Core相关Counter进一步分析，从这系列counter，可以区分出带宽的来源。</p><p data-pid="CxalsQ33">对于读取来讲，源头主要有三个：</p><ol><li data-pid="7_EvUycD">Fragment Front-end（处理fragment shader执行前的一些事情，如polygon list reader、triangle setup、rast等）</li><li data-pid="01MKYonr">Load/Store Unit（一般处理shader 执行时的一些读写请求，在mali valhall架构中，除texture和frame buffer write back外，读写都走Load/Store Unit）</li><li data-pid="Jhy9PlsQ">Texture Unit（纹理的采样）</li></ol><p data-pid="iRpP4SIz">对于写出来讲，源头有两个：</p><ol><li data-pid="OmDNwCoP">Load/Store Unit</li><li data-pid="7Y-ROvTB">Tile Buffer Write Back Unit（一个tile渲染结束后，需要 write back到外部DRAM上）</li></ol><p data-pid="DLfi1Ghf">下面介绍具体counter:</p><ul><li data-pid="5LBNWtYb">Read From L2 cache</li></ul><div class="highlight"><pre><code class="language-cpp"><span class="err">$</span><span class="n">MaliCoreL2ReadsFragmentL2ReadBeats</span> <span class="o">*</span> <span class="mi">16</span>  <span class="c1">//fragment front-end从L2上共读取了多少Bytes
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliCoreL2ReadsLoadStoreL2ReadBeats</span> <span class="o">*</span> <span class="mi">16</span>  <span class="c1">//Load/Store unit从L2上共读取了多少Bytes
</span><span class="c1"></span><span class="err">$</span><span class="n">MaliCoreL2ReadsTextureL2ReadBeats</span> <span class="o">*</span> <span class="mi">16</span>
  <span class="c1">//Texture unit从L2上共读取了多少Bytes
</span></code></pre></div><ul><li data-pid="wRY5Wqwn">Read From external memory</li></ul><div class="highlight"><pre><code class="language-text">$MaliCoreExternalReadsFragmentExternalReadBeats * 16
$MaliCoreExternalReadsLoadStoreExternalReadBeats * 16
$MaliCoreExternalReadsTextureExternalReadBeats * 16</code></pre></div><ul><li data-pid="3QGFBUkP">Write Access</li></ul><div class="highlight"><pre><code class="language-text">($MaliCoreWritesLoadStoreWritebackWriteBeats +  $MaliCoreWritesLoadStoreOtherWriteBeats) * 16  //从Load/Store写出到L2的内存
$MaliCoreWritesTileBufferWriteBeats * 16  //Tile buffer写出到L2的内存</code></pre></div><h3>Shader Core Load/Store Unit</h3><p data-pid="E91jl88T">更近一步，如果知道了Shader Core带宽具体来源后，可具体进一步根据Load/Store Unit或Texture Unit的相关counter进一步分析。</p><p data-pid="iIQu_wGB">在mali valhall架构中，除texture和frame buffer write back外，读写都走Load/Store Unit。由于Load/Store单元设计时，每次读写是按Load/Store unit的接口宽度来进行读写的，因此更希望应用按接口宽度对数据读写，而不希望partial read/write，因此这里counter可区分有多少请求full read/write，又有多少是partial read/write，另外还能区别出atomic access 的cycles</p><div class="highlight"><pre><code class="language-text">$MaliCoreLoadStoreCyclesFullReadCycles   //full read的cycles
$MaliCoreLoadStoreCyclesPartialReadCycles  //partial read的cycles
$MaliCoreLoadStoreCyclesFullWriteCycles  //full write的cycles
$MaliCoreLoadStoreCyclesPartialWriteCycles   //partial write的cycles

$MaliCoreLoadStoreCyclesAtomicAccessCycles  //atomic cycles</code></pre></div><p data-pid="kj7HIiJE">对于partial read/write较高的情况下，Load/Store单元处理效率较差，为了提升效率，可以做如下优化：</p><ol><li data-pid="Mgt3rDZ0">尽量使用vector data loads</li><li data-pid="J7Ygmxg-">避免 strided data访问的padding</li><li data-pid="WjXxp6yg">对于compute shader，尽量让同一个warp内线程访问相临的内存地址</li></ol><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-484775dd04abf4c0ecdce96a66fe0bdc_b.jpg" data-rawwidth="1091" data-rawheight="179" data-size="normal" class="origin_image zh-lightbox-thumb" width="1091" data-original="https://pic1.zhimg.com/v2-484775dd04abf4c0ecdce96a66fe0bdc_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-484775dd04abf4c0ecdce96a66fe0bdc_1440w.jpg" data-rawwidth="1091" data-rawheight="179" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="1091" data-original="https://pic1.zhimg.com/v2-484775dd04abf4c0ecdce96a66fe0bdc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-484775dd04abf4c0ecdce96a66fe0bdc_b.jpg" data-lazy-status="ok"><figcaption>场景：Warp requests 32 aligned, consecutive 4-byte words   该场景下的Bus utilization: 100%</figcaption></figure><p data-pid="hHWpamZS">对于atomic ，是一个多cycles的操作，也是比较昂贵的操作，在性能比较关键的shader，应该尽可能减少atomic的使用。</p><p data-pid="Vz8Vr91J">另外，还有两个指标需要关注，那就是：</p><ul><li data-pid="YoFpXit2">Load/Store bytes read/write from L2 per access cycle</li></ul><div class="highlight"><pre><code class="language-text">($MaliCoreL2ReadsLoadStoreL2ReadBeats * 16) /  ($MaliCoreLoadStoreCyclesFullReadCycles +  $MaliCoreLoadStoreCyclesPartialReadCycles) </code></pre></div><p data-pid="UqcdJMiU">表示每个cycle从L2 memory平均读取的bytes，这个指标反应L1 cache miss率，如果这个值较高，那相应的L1 miss率应该也较高，因考虑数据formats及访问的pattern是否合理</p><ul><li data-pid="wCOgRk7C">Load/Store bytes read from external memory per access cycle</li></ul><div class="highlight"><pre><code class="language-text">($MaliCoreExternalReadsLoadStoreExternalReadBeats  * 16) / ($MaliCoreLoadStoreCyclesFullReadCycles +  $MaliCoreLoadStoreCyclesPartialReadCycles) </code></pre></div><p data-pid="FjhoSFpy">表示每个cycle从external memory平均读取的bytes，这个指标反应L2 cache miss率，如果这个值较高，那相应的L2 miss率应该也较高，因考虑数据formats及访问的pattern是否合理</p><h3>Shader Core Texture Unit</h3><ul><li data-pid="C9kJ90Ow">Texture bytes read from L2 per texture cycle</li></ul><div class="highlight"><pre><code class="language-text">($MaliCoreL2ReadsTextureL2ReadBeats * 16) / $MaliCoreTextureCyclesTexturingActive</code></pre></div><p data-pid="KMDjzMbs">表示每个cycle从L2中平均读取的bytes，反应L1 miss率</p><ul><li data-pid="czVtd9sr">Texture bytes read from external memory per texture cycle</li></ul><div class="highlight"><pre><code class="language-text">($MaliCoreExternalReadsTextureExternalReadBeats * 16) /  $MaliCoreTextureCyclesTexturingActive</code></pre></div><p data-pid="Q43DG4X2">表示每个cycle从外部DRAM中平均读取的bytes，反应L2 miss率</p><p data-pid="Za3alRfT">对texure的一些优化及推荐配置：</p><ol><li data-pid="lh7SwrHR">对离线生成的texture尽可能使能mipmaps</li><li data-pid="xEJF995A">对离线生成的texture尽可能使用ASTC或ETC进行压缩</li><li data-pid="0dQbXH7R">对运行时渲染或生成的texture，尽量使narrower format（如32bit format）</li><li data-pid="t2UFdWg8">尽可能避免使用imageLoad/Store，因为可能会使framebuffer不能进行压缩</li><li data-pid="wO7ivwkI">减少negative LOD bias</li><li data-pid="ILrYoc7y">对于各向异性filtering，减少MAX_ANISOTROPY level的使用</li></ol><h2>3 其它内存优化分析视角</h2><p data-pid="qikekHlq">除了从GPU Performance Counter视角外，还有其它一些视角可以辅助分析内存相关问题</p><h3>shader分析</h3><p data-pid="-SDghZQ_">通过Mali的离线编译器，可以对shader生成一个静态分析报告:</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-07b980600a1c22fce4b851b0225593b2_b.jpg" data-rawwidth="737" data-rawheight="205" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="737" data-original="https://pic3.zhimg.com/v2-07b980600a1c22fce4b851b0225593b2_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-07b980600a1c22fce4b851b0225593b2_1440w.jpg" data-rawwidth="737" data-rawheight="205" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="737" data-original="https://pic3.zhimg.com/v2-07b980600a1c22fce4b851b0225593b2_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-07b980600a1c22fce4b851b0225593b2_b.jpg" data-lazy-status="ok"></figure><p data-pid="bPuQrXVM">图中FMA代表算复杂运算，CVT代表简单操作，SFU表示特殊函数，LS代表Load/Store指令，T表示纹理采样。后面的Bound也清晰的指出这段代码的瓶颈是LS，因此需要对shader中内存Load/Store相关操作尽可能优化。</p><p data-pid="z4Bu1D7W">另外，这里需要特别注意的是，registers在GPU内存体系中属于金字塔尖最金贵的内存资源，每个EU的resigsters file大小一般几KB到几十KB，如果shader中寄存器使用过多，那么单个EU可以并发的warp数将受到限制，从而影响性能，因此应该尽可能减少寄存器的使用（使用低精度变量、减小变量的生存的scope），也要避免写一些超大的inline shader（shader功能要单一，不要将多个不同功能的shader内联到一起通过uniform控制分析来使用）。</p><h3>游戏行为分析</h3><p data-pid="x8LpBtg_">可以通过RenderDoc抓关键帧分析游戏renderpass之间依赖关系，整理出Frame Graph关系图，如在Apple Xcode中，可以轻松抓取出Frame Graph:</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-996e9f9126ea312562ed7c85be4444fd_b.jpg" data-rawwidth="1000" data-rawheight="854" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb" width="1000" data-original="https://pic2.zhimg.com/v2-996e9f9126ea312562ed7c85be4444fd_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-996e9f9126ea312562ed7c85be4444fd_1440w.jpg" data-rawwidth="1000" data-rawheight="854" data-size="normal" data-caption="" class="origin_image zh-lightbox-thumb lazy" width="1000" data-original="https://pic2.zhimg.com/v2-996e9f9126ea312562ed7c85be4444fd_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-996e9f9126ea312562ed7c85be4444fd_b.jpg" data-lazy-status="ok"></figure><p data-pid="6zZltgZN">Frame Graph可以看到游戏renderpass 之间读写关系，这样可以提前分析识别出一些pass是否合理，是否可以优化掉一些pass的内存读取</p><h2>4 游戏优化建议</h2><ul><li data-pid="45TUQ942">OpenGL ES : 在一个frame中，对于同一个FBO，尽可绑定一次后完成所有的渲染操作，因为重复绑定渲染的话，在TBR架构中会造成额外的ReadBack（将外面DRAM上的Frame buffer数据读回到Tile buffer上）和WriteBack，从而增加读带宽</li><li data-pid="nVVd1TOb">OpenGL ES: 在FBO绑定后，在开始渲染操作之前调用glClear() ，可以节少一次ReadBack，如果没有Clear，那需要读回tile，从而能增量渲染</li><li data-pid="KqTdcY_A">OpenGL ES: 如果有可能，在FBO的渲染结束后，调用glInvalidateFramebuffer() or glDiscardFramebufferExt() ，可节少tile buffer向external DRAM的WriteBack</li></ul><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-71bc8cb4a6e90f7c985c9962a843a850_b.jpg" data-rawwidth="820" data-rawheight="471" data-size="normal" class="origin_image zh-lightbox-thumb" width="820" data-original="https://pic1.zhimg.com/v2-71bc8cb4a6e90f7c985c9962a843a850_r.jpg"/></noscript><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-71bc8cb4a6e90f7c985c9962a843a850_1440w.jpg" data-rawwidth="820" data-rawheight="471" data-size="normal" class="origin_image zh-lightbox-thumb lazy" width="820" data-original="https://pic1.zhimg.com/v2-71bc8cb4a6e90f7c985c9962a843a850_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-71bc8cb4a6e90f7c985c9962a843a850_b.jpg" data-lazy-status="ok"><figcaption>重复绑定FBO渲染，Tile Memory与DRAM之间增加一次读/写</figcaption></figure><ul><li data-pid="pKmUiUtj">OpenGL ES: 对于延迟渲染管线，使用EXT_shader_pixel_local_storage，可节省Gbuffer的读写带宽</li></ul><h2>参考文献</h2><p data-pid="60of7vOf">【1】<a href="https://link.zhihu.com/?target=https%3A//developer.arm.com/documentation/102730/0100/%3Flang%3Den%23md456-mali-g77-performance-counter-reference__content-behavior" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">Documentation - Arm Developer</a></p><p data-pid="ibikAMq4">【2】<a href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Mali_%28GPU%29%23Mali-V77" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">https://</span><span class="visible">en.wikipedia.org/wiki/M</span><span class="invisible">ali_(GPU)#Mali-V77</span><span class="ellipsis"></span></a></p><p data-pid="jWRvlm7p">【3】<a href="https://link.zhihu.com/?target=https%3A//developer.arm.com/solutions/graphics-and-gaming/developer-guides/learn-the-basics/tile-based-rendering/single-page" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">Graphics and Gaming Development | Tile-Based Rendering – Arm Developer</a></p><p data-pid="C74tNBVs">【4】<a href="https://link.zhihu.com/?target=https%3A//developer.arm.com/documentation/101863/7-4/Using-Mali-Offline-Compiler/Performance-analysis" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">Documentation - Arm Developer</a></p></div></div></div><div role="button" tabindex="0" class="ContentItem-time">编辑于 2022-03-18 08:21</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19570894&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19570894" target="_blank"><div class="Popover"><div id="Popover2-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover2-content">图形处理器（GPU）</div></div></a></span></div><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19613730&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19613730" target="_blank"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover3-content">计算机图形学</div></div></a></span></div><div class="Tag Topic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19568806&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19568806" target="_blank"><div class="Popover"><div id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover4-content">Unity（游戏引擎）</div></div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-bottom" style=""><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;481796640&quot;}}}"><span><button aria-label="赞同 28 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" data-new-api="AgreeFill24" data-old-api="TriangleUp" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>赞同 28</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" data-new-api="OpposeFill24" data-old-api="TriangleDown" class="Zi Zi--TriangleDown" fill="currentColor"><path d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="Comment" class="Zi Zi--Comment Button-zi" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>1 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover5-content"><img class="ShareMenu-fakeQRCode" src="https://www.zhihu.com/qrcode?url=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F481796640%23showWechatShareTip" alt="微信二维码"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="PaperplaneFill24" data-old-api="Share" class="Zi Zi--Share Button-zi" fill="currentColor"><path d="M19.47 1.914a.8.8 0 011.204.778l-1.872 16.386a.9.9 0 01-1.204.743l-4.615-1.692a.7.7 0 00-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 01.179-.504l5.808-7.148a.595.595 0 00-.897-.781l-5.93 6.354a1.1 1.1 0 01-1.258.252L2.57 13.46a.8.8 0 01-.08-1.415l16.98-10.13z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="HeartFill24" data-old-api="Heart" class="Zi Zi--Heart Button-zi" fill="currentColor"><path d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 01-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 01-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="StarFill24" data-old-api="Star" class="Zi Zi--Star Button-zi" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 00.165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 00-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 00-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 00-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 00.164-.12l2.378-4.122z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="TrayFullFill24" data-old-api="Deliver" class="Zi Zi--Deliver Button-zi" fill="currentColor"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 01.75-.75h6.857a.75.75 0 010 1.5H8.571a.75.75 0 01-.75-.75zm1.144-4a.75.75 0 01.75-.75h4.571a.75.75 0 010 1.5H9.715a.75.75 0 01-.75-.75z"></path><path d="M7.527 3.15a2.35 2.35 0 00-2.309 1.91L3.165 15.84a.85.85 0 00-.015.16v2.5a2.35 2.35 0 002.35 2.35h13a2.35 2.35 0 002.35-2.35V16a.848.848 0 00-.015-.16L18.78 5.06a2.35 2.35 0 00-2.308-1.91H7.527zm0 1.7a.65.65 0 00-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 00-.64-.528H7.528z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover6-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover6-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots" class="Zi Zi--Dots Button-zi" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></span></button></div></div></div></div></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-1oi6kgx" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-ef69d369588e9764f9252225e6dc29ce_l.jpg" srcset="https://pic1.zhimg.com/v2-ef69d369588e9764f9252225e6dc29ce_l.jpg?source=32738c0c 2x"><div class="css-x0pxoz"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-ip4bff Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-f01gk" style="white-space: pre-wrap;">评论千万条，友善第一条</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-f01gk" class="notranslate public-DraftEditor-content" contenteditable="true" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word;" role="textbox"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="f01gk" data-offset-key="fgtr2-0-0"><div data-offset-key="fgtr2-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="fgtr2-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-z07uxh"><div class="css-we6n55"><div class="css-vpssrj"><div class="css-1k10w8f">1 条评论</div></div><div class="css-59erns"></div><div class="css-1hnxfhy"><div class="css-gjiv4z">默认</div><div class="css-1v9si9f">时间</div></div></div><div class="css-840pn3"><div class="css-1frn93x"><div class="css-vurnku"><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="Popover"><div id="Popover13-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover13-content"><a href="https://www.zhihu.com/people/bdc3ccc1530a5a55accf990f36745179" target="_blank" class="css-1d3mfcn"><img class="Avatar css-1qchsfe" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-9991a3c7bb4e0f90aeb78e533d8f75ec_l.jpg" srcset="https://pic1.zhimg.com/v2-9991a3c7bb4e0f90aeb78e533d8f75ec_l.jpg?source=06d4cd63 2x" alt="飞云焕日" loading="lazy"></a></div></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-dza3t2"><div class="css-1tww9qq"><div class="Popover"><div id="Popover14-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover14-content"><a href="https://www.zhihu.com/people/bdc3ccc1530a5a55accf990f36745179" target="_blank" class="css-o7lu8j">飞云焕日</a></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" data-new-api="Dots24" data-old-api="Dots24" class="ZDI ZDI--Dots24 css-1jofpfq" fill="currentColor"><path d="M5.34 12a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0zm8.325 0a1.665 1.665 0 11-3.33 0 1.665 1.665 0 013.33 0z"></path></svg></div><div class="CommentContent css-1ygdre8"><p>“逐tile渲染写入到tile memory上，并且整个renderpass最后只需要向外部DRAM写出一次”</p><p><br></p><p>Tile Memory一般都不大吧，要是Tile Memory不足也是串行写出？</p></div><div class="css-dbby2p"><div class="css-82fsyv"><div class="css-12cl38p">08-02</div></div><div class="css-18opwoy"><button type="button" class="Button  css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ChatBubbleFill24" data-old-api="ChatBubbleFill24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path d="M12 2.75a9.25 9.25 0 104.737 17.197l2.643.817a1 1 0 001.25-1.25l-.8-2.588A9.25 9.25 0 0012 2.75z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" data-new-api="ThumbFill24" data-old-api="ThumbFill24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 012.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 01-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 012.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 003.19-2.191c.115-.296.173-.611.173-.928v-.553z"></path></svg></span>赞</button></div></div></div></div></div><div></div></div></div></div></div></div></div></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1581px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" data-new-api="ArrowLeftSmall24" data-old-api="ArrowLeft" fill="#d3d3d3" class="Zi Zi--ArrowLeft"><path d="M10.752 12l4.025-3.78a.684.684 0 000-1.01.796.796 0 00-1.075 0l-4.42 4.15a.866.866 0 000 1.28l4.42 4.15a.796.796 0 001.075 0 .684.684 0 000-1.01L10.752 12z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/553445980" class="PostItem"><div><h1 class="PostItem-Title">移动端TB(D)R架构基础</h1><p class="PostItem-Summary">当前移动端GPU概况 虽然移动GPU的型号很多，但是从上面的图片分析可以得出，市面上主要的厂家只有：Adreno，Mali和PowerVR。 移动端和PC端功耗对比 对于PC端来说，主流性能平台功耗一般在30…</p><div class="PostItem-Footer"><span>123</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/89831655" class="PostItem"><div><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-ff3cd2129900d45d54d3a25b89895015_250x0.jpg" srcset="https://pic1.zhimg.com/v2-ff3cd2129900d45d54d3a25b89895015_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="PCGPlanet5-移动端GPGPU"><h1 class="PostItem-Title">PCGPlanet5-移动端GPGPU</h1><div class="PostItem-Footer"><span>Frost...</span><span class="PostItem-FooterTitle">发表于移动端程序...</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/158616331" class="PostItem"><div><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-f870630853cb16c33b7458b72020b212_250x0.jpg" srcset="https://pic4.zhimg.com/v2-f870630853cb16c33b7458b72020b212_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="手机硬件的特点（TBDR）"><h1 class="PostItem-Title">手机硬件的特点（TBDR）</h1><div class="PostItem-Footer"><span>SONG</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/548238736" class="PostItem"><div><img src="./移动端游戏性能分析 - 内存相关 - 知乎_files/v2-4601e7bf4f0b069f21c909ed9161117a_250x0.jpg" srcset="https://pic1.zhimg.com/v2-4601e7bf4f0b069f21c909ed9161117a_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="从Imagination GPU聊起：当手机芯片，应用于超算"><h1 class="PostItem-Title">从Imagination GPU聊起：当手机芯片，应用于超算</h1><div class="PostItem-Footer"><span>欧阳洋葱</span><span class="PostItem-FooterTitle">发表于周三电子</span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" data-new-api="ArrowRightSmall24" data-old-api="ArrowRight" fill="#d3d3d3" class="Zi Zi--ArrowRight"><path d="M13.248 12l-4.025 3.78a.684.684 0 000 1.01.796.796 0 001.075 0l4.42-4.15a.867.867 0 000-1.28l-4.42-4.15a.796.796 0 00-1.075 0 .684.684 0 000 1.01L13.248 12z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain"><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="ArrowShapeUpwardFill24" data-old-api="BackToTop" aria-label="回到顶部" class="Zi Zi--BackToTop" fill="currentColor"><path d="M13.204 3.107a1.75 1.75 0 00-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0016.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","allowSignUp":true}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"club":{"tags":{},"admins":{"data":[]},"members":{"data":[]},"profile":{},"checkin":{},"comments":{"paging":{},"loading":{},"meta":{},"ids":{}},"postList":{"paging":{},"loading":{},"ids":{}},"recommend":{"data":[]},"silences":{"data":[]},"application":{"profile":null}},"entities":{"users":{"9b939bd116cd066ce372288d50538da8":{"uid":1437579071195046000,"userType":"people","id":"9b939bd116cd066ce372288d50538da8"},"josh-lee-12":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-70621b79f1611bdacea0282c1e445798.jpg?source=172ae18b","uid":"43692526141440","userType":"people","isFollowing":false,"urlToken":"josh-lee-12","id":"55ba791b69c0912aa32072089e35ad38","description":"","name":"Josh LEE","isAdvertiser":false,"headline":"Make a better world!","gender":1,"url":"\u002Fpeople\u002F55ba791b69c0912aa32072089e35ad38","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-70621b79f1611bdacea0282c1e445798_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-f64540a83905e891c2a0756a33fc9521_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-f64540a83905e891c2a0756a33fc9521_l.png?source=172ae18b","description":"被 50 个人关注","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"481796640":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGpRA2R6CFx1ClFNgfJERpdg&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"entityWords":[{"name":"renderpass","mention":"renderpass","matchorder":1,"begin":916,"end":926,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJXCgpyZW5kZXJwYXNzEglPdGhlclRlcm0YlAcgngcoATUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"framebuffer","mention":"framebuffer","matchorder":1,"begin":11592,"end":11603,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0,"attachedInfoBytes":"sgJTCgtmcmFtZWJ1ZmZlchIETWF0aBjIWiDTWigBNQAAAAA6B2FydGljbGVAAEgAUiQ3N2VkZTc2My04NDZjLTRkOGYtOWExMy1iNGJjNGY5YTQzMWY=","isOnAB":false,"isNatural":1},{"name":"registers","mention":"registers","matchorder":1,"begin":12414,"end":12423,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJUCglyZWdpc3RlcnMSB01lZGljYWwY\u002FmAgh2EoATUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"cycle","mention":"cycle","matchorder":22,"begin":2489,"end":2494,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Novel","score":0,"attachedInfoBytes":"sgJOCgVjeWNsZRIFTm92ZWwYuRMgvhMoFjUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"离线编译器","mention":"离线编译器","matchorder":1,"begin":11882,"end":11887,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0,"attachedInfoBytes":"sgJbCg\u002Fnprvnur\u002FnvJbor5HlmagSCENvbXB1dGVyGOpcIO9cKAE1AAAAADoHYXJ0aWNsZUAASABSJDc3ZWRlNzYzLTg0NmMtNGQ4Zi05YTEzLWI0YmM0ZjlhNDMxZg==","isOnAB":false,"isNatural":1},{"name":"external memory","mention":"external memory","matchorder":2,"begin":6044,"end":6059,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJaCg9leHRlcm5hbCBtZW1vcnkSB01lZGljYWwYnC8gqy8oAjUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"cycles","mention":"cycles","matchorder":7,"begin":5041,"end":5047,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJRCgZjeWNsZXMSB01lZGljYWwYsScgtycoBzUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"shared memory","mention":"shared memory","matchorder":2,"begin":1497,"end":1510,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJaCg1zaGFyZWQgbWVtb3J5EglPdGhlclRlcm0Y2Qsg5gsoAjUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"纹理采样","mention":"纹理采样","matchorder":1,"begin":12309,"end":12313,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJZCgznurnnkIbph4fmoLcSCU90aGVyVGVybRiVYCCZYCgBNQAAAAA6B2FydGljbGVAAEgAUiQ3N2VkZTc2My04NDZjLTRkOGYtOWExMy1iNGJjNGY5YTQzMWY=","isOnAB":false,"isNatural":1},{"name":"128-191cycles","mention":"128-191cycles","matchorder":1,"begin":5187,"end":5200,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJYCg0xMjgtMTkxY3ljbGVzEgdNZWRpY2FsGMMoINAoKAE1AAAAADoHYXJ0aWNsZUAASABSJDc3ZWRlNzYzLTg0NmMtNGQ4Zi05YTEzLWI0YmM0ZjlhNDMxZg==","isOnAB":false,"isNatural":1},{"name":"latency","mention":"latency","matchorder":2,"begin":3001,"end":3008,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJUCgdsYXRlbmN5EglPdGhlclRlcm0YuRcgwBcoAjUAAAAAOgdhcnRpY2xlQABIAFIkNzdlZGU3NjMtODQ2Yy00ZDhmLTlhMTMtYjRiYzRmOWE0MzFm","isOnAB":false,"isNatural":1},{"name":"atomic","mention":"atomic","matchorder":3,"begin":8518,"end":8524,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0,"attachedInfoBytes":"sgJTCgZhdG9taWMSCUNvbW1vZGl0eRjGQiDMQigDNQAAAAA6B2FydGljbGVAAEgAUiQ3N2VkZTc2My04NDZjLTRkOGYtOWExMy1iNGJjNGY5YTQzMWY=","isOnAB":false,"isNatural":1},{"name":"compute shader","mention":"compute shader","matchorder":1,"begin":9154,"end":9168,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0,"attachedInfoBytes":"sgJbCg5jb21wdXRlIHNoYWRlchIJQ29tbW9kaXR5GMJHINBHKAE1AAAAADoHYXJ0aWNsZUAASABSJDc3ZWRlNzYzLTg0NmMtNGQ4Zi05YTEzLWI0YmM0ZjlhNDMxZg==","isOnAB":false,"isNatural":1},{"name":"256-319cycles","mention":"256-319cycles","matchorder":1,"begin":5493,"end":5506,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJYCg0yNTYtMzE5Y3ljbGVzEgdNZWRpY2FsGPUqIIIrKAE1AAAAADoHYXJ0aWNsZUAASABSJDc3ZWRlNzYzLTg0NmMtNGQ4Zi05YTEzLWI0YmM0ZjlhNDMxZg==","isOnAB":false,"isNatural":1},{"name":"320-383cycles","mention":"320-383cycles","matchorder":1,"begin":5646,"end":5659,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJYCg0zMjAtMzgzY3ljbGVzEgdNZWRpY2FsGI4sIJssKAE1AAAAADoHYXJ0aWNsZUAASABSJDc3ZWRlNzYzLTg0NmMtNGQ4Zi05YTEzLWI0YmM0ZjlhNDMxZg==","isOnAB":false,"isNatural":1}],"id":481796640,"title":"移动端游戏性能分析 - 内存相关","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F481796640","imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9127f55344df6af258900557d2d2538b_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9127f55344df6af258900557d2d2538b_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e7681ce4704a0a9f7db400f76a66a6b3_200x112.jpg\" data-rawwidth=\"843\" data-rawheight=\"484\" data-size=\"normal\" data-caption=\"\" data-watermark=\"watermark\" data-original-src=\"v2-e7681ce4704a0a9f7db400f76a66a6b3\" data-watermark-src=\"v2-43e7df0b1358a2b495123248f96c7604\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e7681ce4704a0a9f7db400f76a66a6b3_r.jpg\"\u002F\u003E本文主要总结和介绍移动端游戏性能相关问题的分析，本篇为内存专题。 GPU is very IO limited! IO is very often the throughput bottleneck, so its important to be smart about IO. --- By someone 1 Introduction随着移动端游戏渲染画质提高，海量几何…","created":1647432501,"updated":1647562909,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-70621b79f1611bdacea0282c1e445798.jpg?source=172ae18b","uid":"43692526141440","userType":"people","isFollowing":false,"urlToken":"josh-lee-12","id":"55ba791b69c0912aa32072089e35ad38","description":"","name":"Josh LEE","isAdvertiser":false,"headline":"Make a better world!","gender":1,"url":"\u002Fpeople\u002F55ba791b69c0912aa32072089e35ad38","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-70621b79f1611bdacea0282c1e445798_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-f64540a83905e891c2a0756a33fc9521_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-f64540a83905e891c2a0756a33fc9521_l.png?source=172ae18b","description":"被 50 个人关注","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"","imageWidth":719,"imageHeight":755,"content":"\u003Cp data-pid=\"DhTployj\"\u003E本文主要总结和介绍移动端游戏性能相关问题的分析，本篇为内存专题。\u003C\u002Fp\u003E\u003Cp data-pid=\"tcJBuFj7\"\u003EGPU is very IO limited! IO is very often the throughput bottleneck, so its important to be smart about IO.    --- By  someone\u003C\u002Fp\u003E\u003Ch2\u003E1 Introduction\u003C\u002Fh2\u003E\u003Cp data-pid=\"pj1NVW8g\"\u003E随着移动端游戏渲染画质提高，海量几何顶点、纹理数据、超高分辨率等都挑战着移动端GPU内存带宽。在PC端，独立显卡都有一块GPU专属的DRAM(显存)，它具有非常高的带宽设计，但在移动端，受限于功耗，所以在移动端一般都与CPU共用SOC中互联的DRAM，但这也有问题，就是SOC总线访问DRAM的带宽往往也不能满足实际游戏应用的需要，因此为了解决这个问题，移动端一般采用Tile Based Rendering（TBR）:\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-43e7df0b1358a2b495123248f96c7604_b.jpg\" data-rawwidth=\"843\" data-rawheight=\"484\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"843\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-43e7df0b1358a2b495123248f96c7604_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;843&#39; height=&#39;484&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"843\" data-rawheight=\"484\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"843\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-43e7df0b1358a2b495123248f96c7604_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-43e7df0b1358a2b495123248f96c7604_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"QNCq5ZaN\"\u003ETBR架构下，GPU内部L1 level设计了一块Tile Memory，高带宽低延迟，Renderpass渲染时，将屏幕按tile划分为多个区域，逐tile渲染写入到tile memory上，并且整个renderpass最后只需要向外部DRAM写出一次，而IMR渲染在每个draw call的fragment都要写到DRAM中，相比于IMR，大量节省了Framebuffer读写的开销。当然，TBR架构只是移动端GPU设计的总体架构，关于内存的优化，还有非常多的微架构设计在里面，例如CRC、frame buffer compression、sparse texture、load tile(frame_buffer_fetch)、Transaction elimination等等移动端GPU特性。\u003C\u002Fp\u003E\u003Cp data-pid=\"MEzgHXAn\"\u003EGPU存储体系的设计哲学是更大的内存带宽，而不是更低的访问延迟。该设计原则不同于CPU依赖多级Cache来降低内存访问延迟的策略，GPU则是通过大量的并行线程来规避或者叫隐藏内存访问的延迟，具体来说就是GPU在等待某个内存数据到来的时候，会运行成百上千个其他与该数据无关的线程，来处理另外的数据请求，这就是GPU存储体系内存访问的特点：高带宽，高延迟。\u003C\u002Fp\u003E\u003Cp data-pid=\"NcLyi1TO\"\u003EGPU设计中，一般会采用多个EU（execute unit）组成一个cluster core，又由多个cluster core组成最终的GPU，每个Core部分会有Registers、L1 cache、shared memory等资源，多个Core之间会通过L2 cache连接和外面DRAM交互。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f38a7dc0e17d72543d35610435bedb1_b.jpg\" data-rawwidth=\"674\" data-rawheight=\"339\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"674\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f38a7dc0e17d72543d35610435bedb1_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;674&#39; height=&#39;339&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"674\" data-rawheight=\"339\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"674\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f38a7dc0e17d72543d35610435bedb1_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9f38a7dc0e17d72543d35610435bedb1_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cul\u003E\u003Cli data-pid=\"AvmniA-i\"\u003ERegister\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"a13bR1by\"\u003E- 由编译器管理，访问速度最快\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"RJfNY5fY\"\u003EShared memory\u002F L1 cache\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"HBn0Wo1J\"\u003E-低延迟，高带宽，如shared memory可由用户编程使用，例如compute中一般对于同一个workgroup可以共享使用\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"U3DGqb6G\"\u003ERead-only Cache\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"Cd_4mKv6\"\u003E-一般用于texture、uniform等的缓存，由硬件管理\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"P4ldmh88\"\u003EL2 cache\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"2Gt0zYSh\"\u003E-一般所以对Global memory的访问，都要经过L2 cache，较大，如mali G710，L2 cache大小是512~2048KB\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"Os-2UKQw\"\u003EGlobal Memory\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"ObkYoZgi\"\u003E-由SoC总线互联，总线上的IP都可以访问，目前移动端一般几GB到几十GB不等，但访问延迟较大，约几百cycle\u003C\u002Fp\u003E\u003Ch2\u003E2 内存相关Performance Counter分析\u003C\u002Fh2\u003E\u003Cp data-pid=\"q8bhff9_\"\u003E内存Performance Counter的分析，一般自上而下，比如先分析GPU与外部DRAM交互的带宽是否成为瓶颈，如果是，那么进一步解刨GPU内部进一步分析，如Shader Core、TU、EU等。\u003C\u002Fp\u003E\u003Ch3\u003EExternal memory bandwidth\u003C\u002Fh3\u003E\u003Cp data-pid=\"tLmbWdPF\"\u003E下面相关counter描述GPU与SOC DRAM交互的读写带宽，DRAM的读写对功耗指标来说非常敏感，一般来说，1GB\u002Fs的带宽会产生80mW到100mW的功耗，假设某游戏的功耗预算是650mW，并且以60FPS的帧率来运行，那么这个游戏每帧只能有100MB左右的DRAM读写，因此，某些游戏来说，GPU内存带宽的优化非常重要。\u003C\u002Fp\u003E\u003Cp data-pid=\"FBViYH9J\"\u003E主要有三类counter，一是反应读写数据吞吐量的read\u002Fwrite bytes counter，二是反应读写stall rate的counter，三是反应read\u002Fwrite latency的counter。 其中stall rate和latency能反应出memory读写是否是一个瓶颈。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1c5bf6f3d53cf6d9e3e197b89c887b78_b.jpg\" data-rawwidth=\"601\" data-rawheight=\"448\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"601\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1c5bf6f3d53cf6d9e3e197b89c887b78_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;601&#39; height=&#39;448&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"601\" data-rawheight=\"448\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"601\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1c5bf6f3d53cf6d9e3e197b89c887b78_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1c5bf6f3d53cf6d9e3e197b89c887b78_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cul\u003E\u003Cli data-pid=\"diZt0iHH\"\u003EExternal read\u002Fwrite bytes\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"w06h_mKX\"\u003E读写带宽的计算：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E$MaliExternalBusBeatsReadBeat * ($MaliConstantsBusWidthBits \u002F 8)\n$MaliExternalBusBeatsWriteBeat * ($MaliConstantsBusWidthBits \u002F 8)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"A9Z-QWT_\"\u003EExternal read\u002Fwrite stall\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"f25DrSSH\"\u003Estall counter表示GPU的读写请求已经ready，但Memroy system当前不能接受这个请求，如果stall率过高，就需要考虑是不读写请求已经超出了当前memory system的最大能力，此时需要考虑优化并减少带宽。\u003C\u002Fp\u003E\u003Cp data-pid=\"HxwP0Xie\"\u003E以read stall rate为例，通过下面公式计算：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"n\"\u003Emax\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emin\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusStallsReadStallCycles\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliConstantsL2SliceCount\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliGPUCyclesGPUActive\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E))\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E100\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E100\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E),\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"3VGZyObi\"\u003EExternal read\u002Fwrite latency\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"Rwnb6Fw3\"\u003Elatency counter表示一个读写请求发送完成后，经过多少个cycle后被gpu看到。过高的latency，也需要考虑是不是所请求的数据超出了当前memory system的最大能力，，此时需要考虑优化并减少带宽。Mali GPU根据laytency的范围，有多组相关的counter:\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusReadLatency0127Cycles\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F0-127cycles\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusReadLatency128191Cycles\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F128-191cycles\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusReadLatency192255Cycles\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F192-255cycles\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusReadLatency256319Cycles\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F256-319cycles\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusReadLatency320383Cycles\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F320-383cycles\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliExternalBusBeatsReadBeat\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESUM\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EAbove\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EAll\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002F384+cycles\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003EShader Core Memory Traffic\u003C\u002Fh3\u003E\u003Cp data-pid=\"UWSz54Jl\"\u003E前面讲到的external memory bandwidth可以总体算出Memory的吞吐及判断Memory是否是瓶颈，但不能判断memory bound在具体什么地方，因此需要从Shader Core相关Counter进一步分析，从这系列counter，可以区分出带宽的来源。\u003C\u002Fp\u003E\u003Cp data-pid=\"CxalsQ33\"\u003E对于读取来讲，源头主要有三个：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"7_EvUycD\"\u003EFragment Front-end（处理fragment shader执行前的一些事情，如polygon list reader、triangle setup、rast等）\u003C\u002Fli\u003E\u003Cli data-pid=\"01MKYonr\"\u003ELoad\u002FStore Unit（一般处理shader 执行时的一些读写请求，在mali valhall架构中，除texture和frame buffer write back外，读写都走Load\u002FStore Unit）\u003C\u002Fli\u003E\u003Cli data-pid=\"Jhy9PlsQ\"\u003ETexture Unit（纹理的采样）\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp data-pid=\"iRpP4SIz\"\u003E对于写出来讲，源头有两个：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"OmDNwCoP\"\u003ELoad\u002FStore Unit\u003C\u002Fli\u003E\u003Cli data-pid=\"7Y-ROvTB\"\u003ETile Buffer Write Back Unit（一个tile渲染结束后，需要 write back到外部DRAM上）\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp data-pid=\"DLfi1Ghf\"\u003E下面介绍具体counter:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"5LBNWtYb\"\u003ERead From L2 cache\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliCoreL2ReadsFragmentL2ReadBeats\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E16\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002Ffragment front-end从L2上共读取了多少Bytes\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliCoreL2ReadsLoadStoreL2ReadBeats\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E16\u003C\u002Fspan\u003E  \u003Cspan class=\"c1\"\u003E\u002F\u002FLoad\u002FStore unit从L2上共读取了多少Bytes\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"err\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMaliCoreL2ReadsTextureL2ReadBeats\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"mi\"\u003E16\u003C\u002Fspan\u003E\n  \u003Cspan class=\"c1\"\u003E\u002F\u002FTexture unit从L2上共读取了多少Bytes\n\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"wRY5Wqwn\"\u003ERead From external memory\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E$MaliCoreExternalReadsFragmentExternalReadBeats * 16\n$MaliCoreExternalReadsLoadStoreExternalReadBeats * 16\n$MaliCoreExternalReadsTextureExternalReadBeats * 16\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cul\u003E\u003Cli data-pid=\"3QGFBUkP\"\u003EWrite Access\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E($MaliCoreWritesLoadStoreWritebackWriteBeats +  $MaliCoreWritesLoadStoreOtherWriteBeats) * 16  \u002F\u002F从Load\u002FStore写出到L2的内存\n$MaliCoreWritesTileBufferWriteBeats * 16  \u002F\u002FTile buffer写出到L2的内存\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003EShader Core Load\u002FStore Unit\u003C\u002Fh3\u003E\u003Cp data-pid=\"E91jl88T\"\u003E更近一步，如果知道了Shader Core带宽具体来源后，可具体进一步根据Load\u002FStore Unit或Texture Unit的相关counter进一步分析。\u003C\u002Fp\u003E\u003Cp data-pid=\"iIQu_wGB\"\u003E在mali valhall架构中，除texture和frame buffer write back外，读写都走Load\u002FStore Unit。由于Load\u002FStore单元设计时，每次读写是按Load\u002FStore unit的接口宽度来进行读写的，因此更希望应用按接口宽度对数据读写，而不希望partial read\u002Fwrite，因此这里counter可区分有多少请求full read\u002Fwrite，又有多少是partial read\u002Fwrite，另外还能区别出atomic access 的cycles\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E$MaliCoreLoadStoreCyclesFullReadCycles   \u002F\u002Ffull read的cycles\n$MaliCoreLoadStoreCyclesPartialReadCycles  \u002F\u002Fpartial read的cycles\n$MaliCoreLoadStoreCyclesFullWriteCycles  \u002F\u002Ffull write的cycles\n$MaliCoreLoadStoreCyclesPartialWriteCycles   \u002F\u002Fpartial write的cycles\n\n$MaliCoreLoadStoreCyclesAtomicAccessCycles  \u002F\u002Fatomic cycles\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"kj7HIiJE\"\u003E对于partial read\u002Fwrite较高的情况下，Load\u002FStore单元处理效率较差，为了提升效率，可以做如下优化：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"Mgt3rDZ0\"\u003E尽量使用vector data loads\u003C\u002Fli\u003E\u003Cli data-pid=\"J7Ygmxg-\"\u003E避免 strided data访问的padding\u003C\u002Fli\u003E\u003Cli data-pid=\"WjXxp6yg\"\u003E对于compute shader，尽量让同一个warp内线程访问相临的内存地址\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-484775dd04abf4c0ecdce96a66fe0bdc_b.jpg\" data-rawwidth=\"1091\" data-rawheight=\"179\" data-size=\"normal\" class=\"origin_image zh-lightbox-thumb\" width=\"1091\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-484775dd04abf4c0ecdce96a66fe0bdc_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1091&#39; height=&#39;179&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"1091\" data-rawheight=\"179\" data-size=\"normal\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1091\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-484775dd04abf4c0ecdce96a66fe0bdc_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-484775dd04abf4c0ecdce96a66fe0bdc_b.jpg\"\u002F\u003E\u003Cfigcaption\u003E场景：Warp requests 32 aligned, consecutive 4-byte words   该场景下的Bus utilization: 100%\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"hHWpamZS\"\u003E对于atomic ，是一个多cycles的操作，也是比较昂贵的操作，在性能比较关键的shader，应该尽可能减少atomic的使用。\u003C\u002Fp\u003E\u003Cp data-pid=\"Vz8Vr91J\"\u003E另外，还有两个指标需要关注，那就是：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"YoFpXit2\"\u003ELoad\u002FStore bytes read\u002Fwrite from L2 per access cycle\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E($MaliCoreL2ReadsLoadStoreL2ReadBeats * 16) \u002F  ($MaliCoreLoadStoreCyclesFullReadCycles +  $MaliCoreLoadStoreCyclesPartialReadCycles) \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"UqcdJMiU\"\u003E表示每个cycle从L2 memory平均读取的bytes，这个指标反应L1 cache miss率，如果这个值较高，那相应的L1 miss率应该也较高，因考虑数据formats及访问的pattern是否合理\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"wCOgRk7C\"\u003ELoad\u002FStore bytes read from external memory per access cycle\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E($MaliCoreExternalReadsLoadStoreExternalReadBeats  * 16) \u002F ($MaliCoreLoadStoreCyclesFullReadCycles +  $MaliCoreLoadStoreCyclesPartialReadCycles) \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"FjhoSFpy\"\u003E表示每个cycle从external memory平均读取的bytes，这个指标反应L2 cache miss率，如果这个值较高，那相应的L2 miss率应该也较高，因考虑数据formats及访问的pattern是否合理\u003C\u002Fp\u003E\u003Ch3\u003EShader Core Texture Unit\u003C\u002Fh3\u003E\u003Cul\u003E\u003Cli data-pid=\"C9kJ90Ow\"\u003ETexture bytes read from L2 per texture cycle\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E($MaliCoreL2ReadsTextureL2ReadBeats * 16) \u002F $MaliCoreTextureCyclesTexturingActive\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"KMDjzMbs\"\u003E表示每个cycle从L2中平均读取的bytes，反应L1 miss率\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"czVtd9sr\"\u003ETexture bytes read from external memory per texture cycle\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E($MaliCoreExternalReadsTextureExternalReadBeats * 16) \u002F  $MaliCoreTextureCyclesTexturingActive\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"Q43DG4X2\"\u003E表示每个cycle从外部DRAM中平均读取的bytes，反应L2 miss率\u003C\u002Fp\u003E\u003Cp data-pid=\"Za3alRfT\"\u003E对texure的一些优化及推荐配置：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"lh7SwrHR\"\u003E对离线生成的texture尽可能使能mipmaps\u003C\u002Fli\u003E\u003Cli data-pid=\"xEJF995A\"\u003E对离线生成的texture尽可能使用ASTC或ETC进行压缩\u003C\u002Fli\u003E\u003Cli data-pid=\"0dQbXH7R\"\u003E对运行时渲染或生成的texture，尽量使narrower format（如32bit format）\u003C\u002Fli\u003E\u003Cli data-pid=\"t2UFdWg8\"\u003E尽可能避免使用imageLoad\u002FStore，因为可能会使framebuffer不能进行压缩\u003C\u002Fli\u003E\u003Cli data-pid=\"wO7ivwkI\"\u003E减少negative LOD bias\u003C\u002Fli\u003E\u003Cli data-pid=\"ILrYoc7y\"\u003E对于各向异性filtering，减少MAX_ANISOTROPY level的使用\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Ch2\u003E3 其它内存优化分析视角\u003C\u002Fh2\u003E\u003Cp data-pid=\"qikekHlq\"\u003E除了从GPU Performance Counter视角外，还有其它一些视角可以辅助分析内存相关问题\u003C\u002Fp\u003E\u003Ch3\u003Eshader分析\u003C\u002Fh3\u003E\u003Cp data-pid=\"-SDghZQ_\"\u003E通过Mali的离线编译器，可以对shader生成一个静态分析报告:\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-07b980600a1c22fce4b851b0225593b2_b.jpg\" data-rawwidth=\"737\" data-rawheight=\"205\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"737\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-07b980600a1c22fce4b851b0225593b2_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;737&#39; height=&#39;205&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"737\" data-rawheight=\"205\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"737\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-07b980600a1c22fce4b851b0225593b2_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-07b980600a1c22fce4b851b0225593b2_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"bPuQrXVM\"\u003E图中FMA代表算复杂运算，CVT代表简单操作，SFU表示特殊函数，LS代表Load\u002FStore指令，T表示纹理采样。后面的Bound也清晰的指出这段代码的瓶颈是LS，因此需要对shader中内存Load\u002FStore相关操作尽可能优化。\u003C\u002Fp\u003E\u003Cp data-pid=\"z4Bu1D7W\"\u003E另外，这里需要特别注意的是，registers在GPU内存体系中属于金字塔尖最金贵的内存资源，每个EU的resigsters file大小一般几KB到几十KB，如果shader中寄存器使用过多，那么单个EU可以并发的warp数将受到限制，从而影响性能，因此应该尽可能减少寄存器的使用（使用低精度变量、减小变量的生存的scope），也要避免写一些超大的inline shader（shader功能要单一，不要将多个不同功能的shader内联到一起通过uniform控制分析来使用）。\u003C\u002Fp\u003E\u003Ch3\u003E游戏行为分析\u003C\u002Fh3\u003E\u003Cp data-pid=\"x8LpBtg_\"\u003E可以通过RenderDoc抓关键帧分析游戏renderpass之间依赖关系，整理出Frame Graph关系图，如在Apple Xcode中，可以轻松抓取出Frame Graph:\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-996e9f9126ea312562ed7c85be4444fd_b.jpg\" data-rawwidth=\"1000\" data-rawheight=\"854\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb\" width=\"1000\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-996e9f9126ea312562ed7c85be4444fd_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1000&#39; height=&#39;854&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"1000\" data-rawheight=\"854\" data-size=\"normal\" data-caption=\"\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1000\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-996e9f9126ea312562ed7c85be4444fd_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-996e9f9126ea312562ed7c85be4444fd_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"6zZltgZN\"\u003EFrame Graph可以看到游戏renderpass 之间读写关系，这样可以提前分析识别出一些pass是否合理，是否可以优化掉一些pass的内存读取\u003C\u002Fp\u003E\u003Ch2\u003E4 游戏优化建议\u003C\u002Fh2\u003E\u003Cul\u003E\u003Cli data-pid=\"45TUQ942\"\u003EOpenGL ES : 在一个frame中，对于同一个FBO，尽可绑定一次后完成所有的渲染操作，因为重复绑定渲染的话，在TBR架构中会造成额外的ReadBack（将外面DRAM上的Frame buffer数据读回到Tile buffer上）和WriteBack，从而增加读带宽\u003C\u002Fli\u003E\u003Cli data-pid=\"nVVd1TOb\"\u003EOpenGL ES: 在FBO绑定后，在开始渲染操作之前调用glClear() ，可以节少一次ReadBack，如果没有Clear，那需要读回tile，从而能增量渲染\u003C\u002Fli\u003E\u003Cli data-pid=\"KqTdcY_A\"\u003EOpenGL ES: 如果有可能，在FBO的渲染结束后，调用glInvalidateFramebuffer() or glDiscardFramebufferExt() ，可节少tile buffer向external DRAM的WriteBack\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-71bc8cb4a6e90f7c985c9962a843a850_b.jpg\" data-rawwidth=\"820\" data-rawheight=\"471\" data-size=\"normal\" class=\"origin_image zh-lightbox-thumb\" width=\"820\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-71bc8cb4a6e90f7c985c9962a843a850_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;820&#39; height=&#39;471&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"820\" data-rawheight=\"471\" data-size=\"normal\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"820\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-71bc8cb4a6e90f7c985c9962a843a850_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-71bc8cb4a6e90f7c985c9962a843a850_b.jpg\"\u002F\u003E\u003Cfigcaption\u003E重复绑定FBO渲染，Tile Memory与DRAM之间增加一次读\u002F写\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cul\u003E\u003Cli data-pid=\"pKmUiUtj\"\u003EOpenGL ES: 对于延迟渲染管线，使用EXT_shader_pixel_local_storage，可节省Gbuffer的读写带宽\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003E参考文献\u003C\u002Fh2\u003E\u003Cp data-pid=\"60of7vOf\"\u003E【1】\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fdeveloper.arm.com\u002Fdocumentation\u002F102730\u002F0100\u002F%3Flang%3Den%23md456-mali-g77-performance-counter-reference__content-behavior\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EDocumentation - Arm Developer\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"ibikAMq4\"\u003E【2】\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FMali_%28GPU%29%23Mali-V77\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Een.wikipedia.org\u002Fwiki\u002FM\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Eali_(GPU)#Mali-V77\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"jWRvlm7p\"\u003E【3】\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fdeveloper.arm.com\u002Fsolutions\u002Fgraphics-and-gaming\u002Fdeveloper-guides\u002Flearn-the-basics\u002Ftile-based-rendering\u002Fsingle-page\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EGraphics and Gaming Development | Tile-Based Rendering – Arm Developer\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"C74tNBVs\"\u003E【4】\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fdeveloper.arm.com\u002Fdocumentation\u002F101863\u002F7-4\u002FUsing-Mali-Offline-Compiler\u002FPerformance-analysis\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EDocumentation - Arm Developer\u003C\u002Fa\u003E\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19570894","type":"topic","id":"19570894","name":"图形处理器（GPU）"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19613730","type":"topic","id":"19613730","name":"计算机图形学"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19568806","type":"topic","id":"19568806","name":"Unity（游戏引擎）"}],"voteupCount":28,"voting":0,"heavyUpStatus":"allow_heavy_up","commentCount":1,"contributions":[],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"favlistsCount":121,"isNormal":true,"status":0,"shareText":"移动端游戏性能分析 - 内存相关 - 来自知乎专栏，作者: Josh LEE https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F481796640 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":3,"hasColumn":false,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"cryFaceCount":0,"cryFaceHasSet":false,"hugCount":0,"hugHasSet":false,"likeCount":3,"likeHasSet":false,"onlookerCount":0,"onlookerHasSet":false},"abParam":{"shangyebiaoshi":"1"},"attachedInfo":"kgIkCgkxOTUxOTc0NDUSCTQ4MTc5NjY0MBgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":false}},"canReference":false,"reactionInstruction":{}}},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{},"zvideos":{},"zvideoContributions":{},"briefs":{},"eduCourses":{}},"currentUser":"9b939bd116cd066ce372288d50538da8","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{"params":[{"id":"vessay_v2_sdk","type":"Int","value":"1","layerId":"Qtkm"},{"id":"pc_ppt_publish","type":"Int","value":"1","layerId":"pc_ppt_publish"},{"id":"titlepagechoose","type":"Int","value":"0","layerId":"titlepagechoose"},{"id":"helpcenter_pc","type":"Int","value":"1","layerId":"helpcenter_pc"},{"id":"pc_comment","type":"Int","value":"1","layerId":"EsOR"},{"id":"pc_follow","type":"Int","value":"1","layerId":"pc_follow"},{"id":"draftsentrance","type":"Int","value":"1","layerId":"draftsentrance"},{"id":"se_clubtab","type":"Int","value":"0","layerId":"e8ys"}],"experiments":[{"expId":"pc_ppt_publish-2_v2","expPrefix":"pc_ppt_publish","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"helpcenter_pc-2_v11","expPrefix":"helpcenter_pc","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"pc_comment-2_v4","expPrefix":"pc_comment","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"pc_follow-3_v5","expPrefix":"pc_follow","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false}],"chains":[{"chainId":"_all_"}],"encodedParams":"CtwBGwA\u002FAEcAtABpAWoBdAE7AswC1wLYAk8DUAOgA6EDogO3A\u002FMD9AMzBIwEjQSmBNYEEQUpBTIFUQWLBYwFngUWBjAGMQZ+BusGJwdXB3cHeAebB9gH3AfdBycIZwh0CHYIeQjFCNoI5Qg\u002FCUIJVAlVCWAJjQmrCcMJxAnFCcYJxwnICckJygnLCcwJ0QnlCfEJ9AkECkkKZQprCpgKpQqpCr4KxArUCt0K7Qr9Cv4KKQs7CzwLQwtGC3ELdguFC4cLjQu5C8AL1wvgC+UL5gs4DHEMjwysDMMMyQy1CxJuAAAAAQABAAIDAAAAAAAAAAAAAAAEBAAEAAABAQAAAQAAAQAAAAEAAAAAAgIABAAABgAAAQABAAAAAAAAAAAAAAAAAAAAAAAHAwAAAAABAAAAAAEBAAcAAQEAAQAAAAAABQAAAgAAAAIAAAAAAAM="},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F104.0.5112.81 Safari\u002F537.36 Edg\u002F104.0.1293.54"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F481796640","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F481796640","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"https:\u002F\u002Fcn.bing.com\u002F","xUDId":"ADAds6PjzxOPTmBuqv67KXaBAfLOjNtmuyk=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"上海","countryName":"中国","regionName":"上海","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"newRights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{},"videoSupport":{},"textBenefit":{},"mcnManage":{},"tasks":{},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"scoreInfo":{},"recentlyCreated":[],"analysis":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"announcement":{},"bannerList":[],"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"creatorsRecommendInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"income":{"aggregation":{}}},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"concernedUpvoters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"room":{"meta":{},"isFetching":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false}},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"club":{},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]}},"fetchHost":"www.zhihu.com","subAppName":"column"}</script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/vendor.4bb309fcb0b4b803488b.js.download"></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_09e9ad9b.6faf2a4951b4ff734e07.js.download"></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_79b5cf47.1419adbd3890e66b0630.js.download"></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_29107295.92a39e4cefc23aa607d1.js.download"></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.lib_0ad37f8a.bafb36126cc61095ca41.js.download"></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/column.app.c315806dbb1eab8d6858.js.download"></script><script defer="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/aria.js.download"></script><script src="./移动端游戏性能分析 - 内存相关 - 知乎_files/hm.js.download" async=""></script><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/zap.js.download"></script><script src="./移动端游戏性能分析 - 内存相关 - 知乎_files/push.js.download"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./移动端游戏性能分析 - 内存相关 - 知乎_files/emoticon.js.download"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete12-0" id="Popover11-toggle" aria-haspopup="true" aria-owns="Popover11-content" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" data-new-api="ArrowUpDown24" data-old-api="Select" fill="#afbdcf" class="Zi Zi--Select"><path d="M12.53 3.47a.75.75 0 00-1.06 0l-5 5a.75.75 0 001.06 1.06L12 5.06l4.47 4.47a.75.75 0 101.06-1.06l-5-5zm-5 11a.75.75 0 00-1.06 1.06l5 5a.75.75 0 001.06 0l5-5a.75.75 0 10-1.06-1.06L12 18.94l-4.47-4.47z" fill-rule="evenodd" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>