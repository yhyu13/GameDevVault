<!DOCTYPE html>
<!-- saved from url=(0078)https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps -->
<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus js-focus-visible theme-dark" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none" data-js-focus-visible=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="Cascaded Shadow Maps - Win32 apps">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps">
			<meta property="og:description" content="Cascaded shadow maps (CSMs) are the best way to combat one of the most prevalent errors with shadowing perspective aliasing.">
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png">
		<meta property="og:image:alt" content="Microsoft Logo">

	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@docsmsft">


	<meta name="author" content="stevewhims">
<meta name="breadcrumb_path" content="/windows/desktop/breadcrumb/toc.json">
<meta name="depot_name" content="MSDN.win32">
<meta name="description" content="Cascaded shadow maps (CSMs) are the best way to combat one of the most prevalent errors with shadowing perspective aliasing.">
<meta name="document_id" content="53c0970d-f4ca-79a3-691a-8603b782c141">
<meta name="document_version_independent_id" content="70f05d59-4924-b802-46a0-e3cb46163b75">
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/win32-pr/blob/27a9dfa3ef68240fbf09f1c64dff7b2232874ef4/desktop-src/DxTechArts/cascaded-shadow-maps.md">
<meta name="locale" content="en-us">
<meta name="ms.assetid" content="d3570d0a-74e0-5b9c-6586-c933f630c4ee">
<meta name="ms.author" content="stwhi">
<meta name="ms.date" content="05/31/2018">
<meta name="ms.prod" content="desktop">
<meta name="ms.technology" content="graphics-gaming">
<meta name="ms.topic" content="article">
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/DxTechArts/cascaded-shadow-maps.md">
<meta name="search.ms_docsetname" content="win32">
<meta name="search.ms_product" content="MSDN">
<meta name="search.ms_sitename" content="Docs">
<meta name="site_name" content="Docs">
<meta name="uhfHeaderId" content="MSDocsHeader-WinDevCenter">
<meta name="updated_at" content="2019-08-23 08:04 PM">
<meta name="page_type" content="conceptual">
<meta name="toc_rel" content="toc.json">
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/MSDN.win32/{branchName}{pdfName}">
<meta name="word_count" content="4337">


	<meta name="scope" content="Windows, Desktop">
<link href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps" rel="canonical">
	<title>Cascaded Shadow Maps - Win32 apps | Microsoft Docs</title>

		<link rel="stylesheet" href="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/4b6bc452.site-ltr.css">

	<link rel="stylesheet" href="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/5a8a71c1.conceptual.css">


	<script async="" defer="" crossorigin="anonymous" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/lux.js.download"></script><script async="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/analytics.js.download"></script><script>
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/DxTechArts/cascaded-shadow-maps.md',
			extendBreadcrumb: false,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true
		},
		functions:{}
	};
	</script>
	<script nomodule="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/bluebird.min.js.download" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/fetch.umd.min.js.download" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/template.min.js.download" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/url.min.js.download" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script nomodule="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/7501e2bd.index-polyfills.js.download"></script>
		<script src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/4d2360b4.index-docs.js.download"></script><style></style><script src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/jsll-4.js.download" async="" defer=""></script>
<script async="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/t.js.download"></script><style type="text/css" media="print">.usabilla_live_button_container { display: none; }</style><script async="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/t.js(1).download"></script><script async="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/t.js(2).download"></script><script async="" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/t.js(3).download"></script></head>

<body lang="en-us" dir="ltr" class="nimbus-is-editor" data-gr-c-s-loaded="true"><div style="display: none;" id="lightningjs-usabilla_live"><div><iframe frameborder="0" id="lightningjs-frame-usabilla_live" src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/saved_resource.html"></iframe></div></div>
<div class="header-holder has-default-focus">
	<a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused is-fixed has-inner-focus focus-visible has-top-zero has-left-zero has-right-zero has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization"><!----><!----><div class="nav-bar"><!---->  <div class="nav-bar-brand">
		<a class="nav-bar-button" itemprop="url" href="https://www.microsoft.com/" aria-label="Microsoft">
			<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
		</a>
	</div> 
			
		<div class="nav-bar-item is-hidden-tablet">
			<button class="nav-bar-button nav-bar-menu" title="Global navigation" aria-expanded="false">
				<span class="nav-bar-menu-title"><!---->Documentation<!----></span>
				<div class="nav-bar-burger">
					<span></span>
					<span></span>
					<span></span>
					<span class="nav-bar-burger-label"><!---->Global navigation<!----></span>
				</div>
			</button>
		</div>
	
			
		<nav class="nav-bar-nav" role="navigation" aria-label="Global">
			<ul class="nav-bar-nav-list">
				
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="https://docs.microsoft.com/en-us/">
				<span><!---->Docs<!----></span>
			</a>
		</li>
	
				<!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline is-active" href="https://docs.microsoft.com/en-us/">
					<span><!---->Documentation<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/learn/">
					<span><!---->Learn<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/answers/products/">
					<span><!---->Q&amp;A<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/samples/browse/">
					<span><!---->Code Samples<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button has-hover-underline" aria-controls="ax-32">
			<span><!---->More<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-32" aria-label="More">
			<!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://docs.microsoft.com/en-us/"><!---->Documentation<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://docs.microsoft.com/en-us/learn/"><!---->Learn<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://docs.microsoft.com/en-us/answers/products/"><!---->Q&amp;A<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://docs.microsoft.com/en-us/samples/browse/"><!---->Code Samples<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
			<span class="nav-bar-spacer"></span>
			
		<div class="nav-bar-search " id="ax-33" hidden="">
			
		<form class="nav-bar-search-form" method="GET" name="searchForm" role="search" id="searchForm" aria-label="Search" aria-expanded="false" action="https://docs.microsoft.com/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input" class="autocomplete-input input   is-small" type="search" name="search" aria-expanded="false" aria-owns="ax-34-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search">

				<span aria-hidden="true" class="icon is-small is-left" hidden="">
					<span class="has-text-primary docon docon-undefined"></span>
				</span>

				<span class="autocomplete-loader loader has-text-primary" aria-hidden="true" hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-34-listbox" aria-label="site-search-input-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="All">
			<input name="scope" hidden="" value="Desktop">
			
			
		</form>
	
		</div>
		
					<div class="nav-bar-search">
						<!-- hidden when the width drops to tablet -->
						
		<form class="nav-bar-search-form" method="GET" name="searchForm" role="search" id="searchFormDesktop" aria-label="Search" aria-expanded="false" action="https://docs.microsoft.com/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-35" class="autocomplete-input input control has-icons-left  is-small" type="search" name="search" aria-expanded="false" aria-owns="ax-36-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-search"></span>
				</span>

				<span class="autocomplete-loader loader has-text-primary" aria-hidden="true" hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-36-listbox" aria-label="ax-35-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="All">
			<input name="scope" hidden="" value="Desktop">
			
			
		</form>
	
					</div>
			  
		<div class="nav-bar-search " hidden="">
			<div class="nav-bar-search-form-expander">
				<button id="form-expander" class="nav-bar-button has-hover-underline " title="Search" aria-expanded="false" aria-controls="ax-33">
					
		<span class="is-visually-hidden-mobile"><!---->Search<!----></span>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	
				</button>
			</div>
		</div>
	
			
		<div class="nav-bar-item is-size-7 is-hidden-mobile has-padding-left-extra-small">
			
		<a class="docs-sign-in auth-status-determined not-authenticated button is-text has-inner-focus has-text-primary is-small" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#">
			Sign in
		</a>
	 
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button class="dropdown-trigger button is-text has-padding-none has-background-transparent" aria-controls="user-menu" aria-expanded="false" aria-label="Your Account">
				<figure class="image is-36x36">
					<img class="has-body-background-medium is-rounded" alt="" data-profile-property="avatarUrl">
				</figure>
			</button>
			<div class="dropdown-menu box" id="user-menu" role="menu">
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img class="has-body-background-medium is-rounded" aria-labelledby="displayName" data-profile-property="avatarUrl">
						</figure>
					</div>
					<div class="media-content">
						<p class="title is-size-4">
							<span id="displayName" class="is-inline-truncated has-max-width-200" data-profile-property="displayName"></span>
						</p>
						<p class="subtitle is-size-7 has-margin-bottom-none">
							<span class="is-inline-truncated has-max-width-200" data-profile-property="upn"></span>
						</p>
					</div>
				</div>
				<ul>
					<li><a href="https://docs.microsoft.com/profile" data-profile-property="profileUrl"><!---->Profile<!----></a></li>
					<li><a href="https://docs.microsoft.com/profile" data-profile-property="bookmarksUrl"><!---->Bookmarks<!----></a></li>
					<li><a href="https://docs.microsoft.com/profile" data-profile-property="collectionsUrl"><!---->Collections<!----></a></li>
				</ul>
				<div class="has-border-top">
					<a class="docs-sign-out" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#"><!---->Sign out<!----></a>
				</div>
			</div>
		</div>
	
		</div>
	
		 <!----></div><div class="nav-bar is-content"><!----> 
		<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="https://developer.microsoft.com/windows">
			<span><!---->Windows Dev Center<!----></span>
		</a>
	 
		
		<nav class="nav-bar-nav" role="navigation" aria-label="Site">
			<ul class="nav-bar-nav-list">
				
				<!----> <li class="dropdown nav-bar-item">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button has-hover-underline" aria-controls="ax-38">
			<span><!---->Explore<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-38" aria-label="Explore">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/get-started-windows-10"><!---->Get started developing for Windows<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/windows-10-for-developers"><!---->What’s new for Windows 10<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/enterprise"><!---->Build for enterprise<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/accessible-apps"><!---->Develop for accessibility<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/ad-monetization-platform"><!---->Ad Monetization platform<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="dropdown nav-bar-item">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button has-hover-underline" aria-controls="ax-39">
			<span><!---->Platforms<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-39" aria-label="Platforms">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://docs.microsoft.com/windows/apps/desktop/"><!---->Windows PCs<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/iot"><!---->Windows IoT<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/mixed-reality"><!---->Mixed Reality<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/games"><!---->Games<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/web"><!---->Web<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://docs.microsoft.com/windows/uwp/"><!---->UWP<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/windows/apps">
					<span><!---->Docs<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/downloads">
					<span><!---->Downloads<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/samples">
					<span><!---->Samples<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/support">
					<span><!---->Support<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://partner.microsoft.com/dashboard">
					<span><!---->Dashboard<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button has-hover-underline" aria-controls="ax-40">
			<span><!---->More<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-40" aria-label="More">
			<!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button " aria-controls="ax-41">
			<span><!---->Explore<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-right-light "></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-41" aria-label="Explore">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/get-started-windows-10"><!---->Get started developing for Windows<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/windows-10-for-developers"><!---->What’s new for Windows 10<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/enterprise"><!---->Build for enterprise<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/accessible-apps"><!---->Develop for accessibility<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/ad-monetization-platform"><!---->Ad Monetization platform<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button " aria-controls="ax-42">
			<span><!---->Platforms<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-right-light "></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-42" aria-label="Platforms">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://docs.microsoft.com/windows/apps/desktop/"><!---->Windows PCs<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/iot"><!---->Windows IoT<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/mixed-reality"><!---->Mixed Reality<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/games"><!---->Games<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://developer.microsoft.com/web"><!---->Web<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button" href="https://docs.microsoft.com/windows/uwp/"><!---->UWP<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://docs.microsoft.com/windows/apps"><!---->Docs<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/downloads"><!---->Downloads<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/samples"><!---->Samples<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://developer.microsoft.com/windows/support"><!---->Support<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button" href="https://partner.microsoft.com/dashboard"><!---->Dashboard<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
		<span class="nav-bar-spacer"></span>
		
	 <!----></div></header>		</div>
		<div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none" data-bi-name="content-header">
			<nav class="has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow" data-bi-name="breadcrumb" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
				<ul id="page-breadcrumbs" class="breadcrumbs"><!---->
			<!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/">
								<span itemprop="name">
									Windows
								</span>
						  </a>
					<meta itemprop="position" content="1">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/apps/">
								<span itemprop="name">
									Apps
								</span>
						  </a>
					<meta itemprop="position" content="2">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/">
								<span itemprop="name">
									Win32
								</span>
						  </a>
					<meta itemprop="position" content="3">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/desktop-app-technologies">
								<span itemprop="name">
									Desktop Technologies
								</span>
						  </a>
					<meta itemprop="position" content="4">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/graphics-and-multimedia">
								<span itemprop="name">
									Graphics and Gaming
								</span>
						  </a>
					<meta itemprop="position" content="5">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/directx">
								<span itemprop="name">
									DirectX graphics and gaming
								</span>
						  </a>
					<meta itemprop="position" content="6">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/classic-directx-graphics">
								<span itemprop="name">
									Classic DirectX Graphics
								</span>
						  </a>
					<meta itemprop="position" content="7">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/dx9-technical-articles">
								<span itemprop="name">
									DirectX Technical Articles
								</span>
						  </a>
					<meta itemprop="position" content="8">
				</li><!---->
		<!----></ul>
			</nav>
		<div class="content-header-controls">
			<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
				<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
				<span class="contents-expand-title">Contents</span>
			</button>
		</div>
		<div class="content-header-controls exit-focus">
			<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
				<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
				<span>Exit focus mode</span>
			</button>
		</div>
		<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
			<ul class="is-hidden-mobile action-list has-flex-justify-content-start has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
				<li>
					<button type="button" class="bookmark button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="bookmarks" data-bi-name="bookmark" title="Add bookmark for Cascaded Shadow Maps - Win32 apps | Microsoft Docs" aria-pressed="false">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-single-bookmark"></span>
						</span>
						<span class="bookmark-status is-visually-hidden-touch is-hidden-portrait">Bookmark</span>
					</button>
				</li>
						<li id="contenteditbtn">
							<a href="https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/DxTechArts/cascaded-shadow-maps.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit" data-original_content_git_url="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/DxTechArts/cascaded-shadow-maps.md" data-original_content_git_url_template="{repo}/blob/{branch}/desktop-src/DxTechArts/cascaded-shadow-maps.md" data-pr_repo="" data-pr_branch="">
							<span class="icon">
								<span class="docon docon-edit-outline" aria-hidden="true"></span>
							</span>
							<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
						</a>
					</li>
				<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" data-bi-name="twitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwin32%2Fdxtecharts%2Fcascaded-shadow-maps%3FWT.mc_id%3Dtwitter&amp;text=Cascaded%20Shadow%20Maps%20-%20Win32%20apps%20%7C%20Microsoft%20Docs&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwin32%2Fdxtecharts%2Fcascaded-shadow-maps%3FWT.mc_id%3Dtwitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwin32%2Fdxtecharts%2Fcascaded-shadow-maps%3FWT.mc_id%3Dlinkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" data-bi-name="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwin32%2Fdxtecharts%2Fcascaded-shadow-maps%3FWT.mc_id%3Dfacebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" data-bi-name="email" href="mailto:?subject=%5BShared%20Article%5D%20Cascaded%20Shadow%20Maps%20-%20Win32%20apps%20%7C%20Microsoft%20Docs&amp;body=Cascaded%20Shadow%20Maps%20-%20Win32%20apps%20%7C%20Microsoft%20Docs%0A%0Ahttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwin32%2Fdxtecharts%2Fcascaded-shadow-maps%3FWT.mc_id%3Demail">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>				</li>
			</ul>
			<button type="button" class="has-border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
				<span class="icon">
					<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
				</span>
				<span class="contents-expand-title">Table of contents</span>
			</button>
			<div class="is-invisible"></div>
			<div class="is-hidden-tablet level-item is-flexible level-right">
				<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus has-border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
					<span class="icon">
						<span class="docon docon-more-vertical" aria-hidden="true"></span>
					</span>
				</button>
			</div>
		</div>
	</div>

	<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"></div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="is-fixed is-flex is-flex-column" role="navigation" aria-label="Primary" data-bi-name="left toc" style="width: 247.833px; top: 196px; bottom: 24px;"><form action="javascript:" role="search" aria-label="Search" class="has-margin-bottom-small"><label class="visually-hidden" for="ax-43">Search</label><div class="autocomplete is-block" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-43" class="autocomplete-input input control has-icons-left is-full-width is-small" type="text" aria-expanded="false" aria-owns="ax-44-listbox" aria-activedescendant="" placeholder="Filter by title">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-filter-settings"></span>
				</span>

				<span class="autocomplete-loader loader has-text-primary" aria-hidden="true" hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-44-listbox" aria-label="ax-43-suggestions" hidden="">
				
			</ul><!----></div></form><ul class="tree is-vertically-scrollable has-flex-grow has-flex-shrink" role="tree" aria-label="Table of contents" data-bi-name="tree"><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/dx9-technical-articles">Technical Articles</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/sixty-four-bit-programming-for-game-developers">64-bit programming for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="3" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/authenticode-signing-for-game-developers">Authenticode Signing for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="4" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/best-security-practices-in-game-development">Best Security Practices in Game Development</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="5" role="treeitem" tabindex="0" class="tree-item is-leaf is-selected" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps" aria-current="page">Cascaded Shadow Maps</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="6" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/coding-for-multiple-cores">Coding for multicore on Xbox 360 and Windows</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="7" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/common-techniques-to-improve-shadow-depth-maps">Common Techniques to Improve Shadow Depth Maps</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="8" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/crash-dump-analysis">Crash Dump Analysis</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="9" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/debugging-with-symbols">Debugging with Symbols</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="10" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/direct3d10-frequently-asked-questions">Direct3D 10 Frequently Asked Questions</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="11" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/directx-9-frequently-asked-questions">DirectX Frequently Asked Questions</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="12" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/directx-setup-for-game-developers">DirectX Installation for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="13" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/disabling-shortcut-keys-in-games">Disabling Shortcut Keys in Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="14" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/game-timing-and-multicore-processors">Game Timing and Multicore Processors</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="15" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/games-for-windows-technical-requirements-1-1-0006">Games for Windows Technical Requirements</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="16" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/games-for-windows-test-requirements-1-0-0006">Games for Windows Test Cases</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="17" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/gaming-with-least-privileged-user-accounts">Gaming with Least-Privileged User Accounts</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="18" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/install-on-demand-for-games">Install-on-Demand for Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="19" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/installation-and-maintenance-of-games">Installation and Maintenance of Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="20" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/lockless-programming">Lockless Programming Considerations for Xbox 360 and Microsoft Windows</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="21" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/mmo-installation-best-practices">Installation Best Practices for Massively Multiplayer Online Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="22" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/installing-and-using-input-method-editors">Installing and Using Input Method Editors</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="23" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/introduction-to-the-10-foot-experience-for-windows-game-developers">Introduction to the 10-Foot Experience for Windows Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="24" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/accessibility-best-practices">Making Video Games Accessible: Business Justifications and Design Considerations</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="25" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/optimizing-dvd-performance-for-windows-games">Optimizing DVD performance for Windows Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="26" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/patching-methods-in-windows-xp-and-vista">Patching Game Software in Windows XP, Windows Vista, and Windows 7</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="27" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/resource-management-best-practices">Resource Management Best Practices</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="28" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/simplifying-game-installation">Simplifying Game Installation</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="29" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/taking-advantage-of-high-dpi-mouse-movement">Taking Advantage of High-Definition Mouse Movement</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="30" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/the-direct3d-transformation-pipeline">The Direct3D Transformation Pipeline</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="31" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/top-issues-for-windows-titles">Top Issues for Windows Titles</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="32" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/top-tools-and-techniques-for-making-more-robust-windows-games">Top Tools and Techniques for Making More Robust Windows Games</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="33" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/user-account-control-for-game-developers">User Account Control for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="34" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/using-an-input-method-editor-in-a-game">Using an Input Method Editor in a Game</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="35" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/games-and-firewalls">Windows Firewall for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="36" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/windows-game-explorer-integration">Windows Games Explorer for Game Developers</a></li><li role="none"><a aria-setsize="37" aria-level="1" aria-posinset="37" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/windows-installer-for-game-developers">Windows Installer for Game Developers</a></li></ul><a class="button is-small is-text has-flex-justify-content-start has-inner-focus has-margin-top-small has-border-top has-border-bottom has-flex-shrink-none" href="https://docs.microsoft.com/en-us/windows/win32/opbuildpdf/dxtecharts/toc.pdf?branch=live" data-bi-name="downloadPdf" rel="nofollow"><!----> <span class="icon is-size-8 has-text-subtle">
				<span aria-hidden="true" class="docon docon-dictionary-download"></span>
			</span>
			<span><!---->Download PDF<!----></span><!----></a></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="cascaded-shadow-maps">Cascaded Shadow Maps</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time class="" data-article-date="" aria-label="Article review date" datetime="2018-05-31T00:00:00.000Z" data-article-date-source="ms.date">05/31/2018</time>
							</li>
								<li class="readingTime">21 minutes to read</li>
								<li class="contributors-holder">
									<a href="https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/DxTechArts/cascaded-shadow-maps.md" title="3 Contributors" aria-label="3 Contributors">
										<ul class="contributors" data-bi-name="contributors" aria-hidden="true">
													<li><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/stevewhims.png" data-src="https://github.com/stevewhims.png?size=32" role="presentation"></li>
													<li><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/mijacobs.png" data-src="https://github.com/mijacobs.png?size=32" role="presentation"></li>
													<li><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/msatranjr.png" data-src="https://github.com/msatranjr.png?size=32" role="presentation"></li>
										</ul>
									</a>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						<ol><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#cascaded-shadow-maps-and-perspective-aliasing">Cascaded Shadow Maps and Perspective Aliasing</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#partitioning-the-frustum">Partitioning the Frustum</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#calculating-a-view-frustum-bound">Calculating a View-Frustum Bound</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-shadow-map">Render the Shadow Map</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-scene">Render the Scene</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#blend-between-cascades">Blend between Cascades</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#filtering-shadow-maps">Filtering Shadow Maps</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#pcf-and-csms">PCF and CSMs</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#variance-shadow-maps">Variance Shadow Maps</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#light-bleeding">Light Bleeding</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-with-csms">VSMs with CSMs</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-compared-to-standard-shadows-with-pcf">VSMs Compared to Standard Shadows with PCF</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#summary">Summary</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#references">References</a></li></ol></nav>

						<!-- <content> -->
							<p>Cascaded shadow maps (CSMs) are the best way to combat one of the most prevalent errors with shadowing: perspective aliasing. This technical article, which assumes the reader is familiar with shadow mapping, tackles the topic of CSMs. Specifically, it:</p>
<ul>
<li>explains the complexity of CSMs;</li>
<li>gives details on the possible variations of the CSM algorithms;</li>
<li>describes the two most common filtering techniques—percentage closer filtering (PCF) and filtering with variance shadow maps (VSMs);</li>
<li>identifies and addresses some of the common pitfalls associated with adding filtering to CSMs; and</li>
<li>shows how to map CSMs to Direct3D 10 through Direct3D 11 hardware.</li>
</ul>
<p>The code used in this article can be found in the DirectX Software Development Kit (SDK) in the CascadedShadowMaps11 and VarianceShadows11 samples. This article will prove most useful after implementing the techniques covered in the technical article, <a href="https://docs.microsoft.com/en-us/windows/desktop/DxTechArts/common-techniques-to-improve-shadow-depth-maps" data-linktype="absolute-path">Common Techniques to Improve Shadow Depth Maps</a>, are implemented.</p>
<h2 id="cascaded-shadow-maps-and-perspective-aliasing" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#cascaded-shadow-maps-and-perspective-aliasing" aria-labelledby="cascaded-shadow-maps-and-perspective-aliasing"></a>Cascaded Shadow Maps and Perspective Aliasing</h2>
<p>Perspective aliasing in a shadow map is one of the most difficult problems to overcome. In the technical article, Common Techniques to Improve Shadow Depth Maps, perspective aliasing is described and some approaches to mitigate the problem are identified. In practice, CSMs tend to be the best solution, and are commonly employed in modern games.</p>
<p>The basic concept of CSMs is easy to understand. Different areas of the camera frustum require shadow maps with different resolutions. Objects nearest the eye require a higher resolution than do more distant objects. In fact, when the eye moves very close to the geometry, the pixels nearest the eye can require so much resolution that even a 4096 × 4096 shadow map is insufficient.</p>
<p>The basic idea of CSMs is to partition the frustum into multiple frusta. A shadow map is rendered for each subfrustum; the pixel shader then samples from the map that most closely matches the required resolution (Figure 2).</p>
<p><strong>Figure 1. Shadow map coverage</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/shadow-map-coverage.png" alt="shadow map coverage" data-linktype="relative-path"></p>
<p>In Figure 1, quality is shown (left to right) from highest to lowest. The series of grids representing shadow maps with a view frustum (inverted cone in red) shows how pixel coverage is affected with different resolution shadow maps. Shadows are of the highest quality (white pixels) when there is a 1:1 ratio mapping pixels in light space to texels in the shadow map. Perspective aliasing occurs in the form of large, blocky texture maps (left image) when too many pixels map to the same shadow texel. When the shadow map is too large, it is under sampled. In this case, texels are skipped, shimmering artifacts are introduced, and performance is affected.</p>
<p><strong>Figure 2. CSM shadow quality</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/csm-shadow-quality.png" alt="csm shadow quality" data-linktype="relative-path"></p>
<p>Figure 2 shows cutouts from the highest quality section in each shadow map in Figure 1. The shadow map with the most closely placed pixels (at the apex) is nearest the eye. Technically, these are maps of the same size, with white and grey used to exemplify the success of the cascaded shadow map. White is ideal because it shows good coverage—a 1:1 ratio for eye-space pixels and shadow-map texels.</p>
<p>CSMs require the following steps per frame.</p>
<ol>
<li><p>Partition the frustum into subfrusta.</p>
</li>
<li><p>Compute an orthographic projection for each subfrustum.</p>
</li>
<li><p>Render a shadow map for each subfrustum.</p>
</li>
<li><p>Render the scene.</p>
<ol>
<li><p>Bind the shadow maps and render.</p>
</li>
<li><p>The vertex shader does the following:</p>
<ul>
<li>Computes texture coordinates for each light subfrustum (unless the needed texture coordinate is calculated in the pixel shader).</li>
<li>Transforms and lights the vertex, and so on.</li>
</ul>
</li>
<li><p>The pixel shader does the following:</p>
<ul>
<li>Determines the proper shadow map.</li>
<li>Transforms the texture coordinates if necessary.</li>
<li>Samples the cascade.</li>
<li>Lights the pixel.</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="partitioning-the-frustum" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#partitioning-the-frustum" aria-labelledby="partitioning-the-frustum"></a>Partitioning the Frustum</h2>
<p>Partitioning the frustum is the act of creating subfrusta. One technique for splitting the frustum is to calculate intervals from zero percent to one hundred percent in the Z-direction. Each interval then represents a near plane and a far plane as a percentage of the Z-axis.</p>
<p><strong>Figure 3. View frustums partitioned arbitrarily</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/view-frustums-partitioned-arbitrarily.png" alt="view frustums partitioned arbitrarily" data-linktype="relative-path"></p>
<p>In practice, recalculating the frustum splits per frame causes shadow edges to shimmer. The generally accepted practice is to use a static set of cascade intervals per scenario. In this scenario, the interval along the Z-axis is used to describe a subfrustum that occurs when partitioning the frustum. Determining the correct size intervals for a given scene depends upon several factors.</p>
<h3 id="orientation-of-the-scene-geometry" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#orientation-of-the-scene-geometry" aria-labelledby="orientation-of-the-scene-geometry"></a>Orientation of the Scene Geometry</h3>
<p>With respect to scene geometry, camera orientation affects cascade interval selection. For example, a camera very near the ground, such as a ground camera in a football game, has a different static set of cascade intervals than a camera in the sky.</p>
<p>Figure 4 shows some different cameras and their respective partitions. When the scene's Z-range is very large, more split planes are required. For example, when the eye is very near the ground plane, but distant objects are still visible, multiple cascades can be necessary. Dividing the frustum so that more splits are near the eye (where perspective aliasing is changing the fastest) is also valuable. When most of the geometry is clumped into a small section (such as an overhead view or a flight simulator) of the view frustum, fewer cascades are necessary.</p>
<p><strong>Figure 4. Different configurations require different frustum splits</strong></p>
<p>![different configurations require different frustum splits](images/different-configurations-require different-frustum-splits.png)</p>
<p>(Left) When geometry has a high dynamic range in Z, lots of cascades are required. (Center) When the geometry has low dynamic range in Z, there is little benefit from multiple frustums. (Right) Only three partitions are needed when the dynamic range is medium.</p>
<h3 id="orientation-of-the-light-and-the-camera" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#orientation-of-the-light-and-the-camera" aria-labelledby="orientation-of-the-light-and-the-camera"></a>Orientation of the Light and the Camera</h3>
<p>Each cascade's projection matrix is fit tightly around its corresponding subfrustum. In configurations where the view camera and the light directions are orthogonal, the cascades can be fit tightly with little overlap. The overlap becomes larger as the light and the view camera move into parallel alignment (Figure 5). When the light and the view camera are nearly parallel, it is called a "dueling frusta," and is a very hard scenario for most shadowing algorithms. It is not uncommon to constrain the light and camera so that this scenario does not occur. CSMs, however, perform much better than many other algorithms in this scenario.</p>
<p><strong>Figure 5. Cascade overlap increases as light direction becomes parallel with camera direction</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/cascade-overlap-increases-as-light-direction-becomes.jpg" alt="cascade overlap increases as light direction becomes parallel with camera direction" data-linktype="relative-path"></p>
<p>Many CSM implementations use fixed-size frusta. The pixel shader can use the Z-depth to index into the array of cascades when the frustum is split in fixed-size intervals.</p>
<h2 id="calculating-a-view-frustum-bound" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#calculating-a-view-frustum-bound" aria-labelledby="calculating-a-view-frustum-bound"></a>Calculating a View-Frustum Bound</h2>
<p>Once the frustum intervals are selected, the subfrusta are created using one of two: fit to scene and fit to cascade.</p>
<h3 id="fit-to-scene" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#fit-to-scene" aria-labelledby="fit-to-scene"></a>Fit to Scene</h3>
<p>All of the frusta can be created with the same near plane. This forces the cascades to overlap. The CascadedShadowMaps11 sample calls this technique fit to scene.</p>
<h3 id="fit-to-cascade" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#fit-to-cascade" aria-labelledby="fit-to-cascade"></a>Fit to Cascade</h3>
<p>Alternatively, frusta can be created with the actual partition interval being used as near and far planes. This causes a tighter fit, but degenerates to fit to scene in the case of dueling frusta. The CascadedShadowMaps11 samples calls this technique fit to cascade.</p>
<p>These two methods are shown in Figure 6. Fit to cascade wastes less resolution. The problem with fit to cascade is that the orthographic projection grows and shrinks based on the orientation of the view frustum. The fit to scene technique pads the orthographic projection by the max size of the view frustum removing the artifacts that appear when the view-camera moves. <a href="https://docs.microsoft.com/en-us/windows/desktop/DxTechArts/common-techniques-to-improve-shadow-depth-maps" data-linktype="absolute-path">Common Techniques to Improve Shadow Depth Maps</a> addresses the artifacts that appear when the light moves in the section "Moving the light in texel sized increments."</p>
<p><strong>Figure 6. Fit to scene vs. fit to cascade</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/fit-to-scene-vs-fit-to-cascade.png" alt="fit to scene versus fit to cascade" data-linktype="relative-path"></p>
<h2 id="render-the-shadow-map" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-shadow-map" aria-labelledby="render-the-shadow-map"></a>Render the Shadow Map</h2>
<p>The CascadedShadowMaps11 sample renders the shadow maps into one large buffer. This is because PCF on texture arrays is a Direct3D 10.1 feature. For every cascade, a viewport is created that covers the section of the depth buffer corresponding to that cascade. A null pixel shader is bound because only the depth is needed. Finally, the correct viewport and shadow matrix are set for each cascade as the depth maps are rendered one at a time into the main shadow buffer.</p>
<h2 id="render-the-scene" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-scene" aria-labelledby="render-the-scene"></a>Render the Scene</h2>
<p>The buffer containing the shadows is now bound to the pixel shader. There are two methods for selecting the cascade implemented in the CascadedShadowMaps11 sample. These two methods are explained with shader code.</p>
<h3 id="interval-based-cascade-selection" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#interval-based-cascade-selection" aria-labelledby="interval-based-cascade-selection"></a>Interval-Based Cascade Selection</h3>
<p><strong>Figure 7. Interval-based cascade selection</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/interval-based-cascade-selection.jpg" alt="interval-based cascade selection" data-linktype="relative-path"></p>
<p>In interval-based selection (Figure 7), the vertex shader computes the position in world-space of the vertex.</p>
<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="Output.vDepth = mul( Input.vPosition, m_mWorldView ).z;
"><span>Output.vDepth = mul( Input.vPosition, m_mWorldView ).z;
</span></code></pre>
<p>The pixel shader receives the interpolated depth.</p>
<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="fCurrentPixelDepth = Input.vDepth;
"><span>fCurrentPixelDepth = Input.vDepth;
</span></code></pre>
<p>Interval-based cascade selection uses a vector comparison and a dot product to determine the correct cacade. The CASCADE_COUNT_FLAG specifies the number of cascades. The m_fCascadeFrustumsEyeSpaceDepths_data constrains the view frustum partitions. After the comparison, the fComparison contains a value of 1 where the current pixel is larger than the barrier, and a value of 0 when the current cascade is smaller. A dot product sums these values into an array index.</p>
<div class="codeHeader" id="code-try-2" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        float4 vCurrentPixelDepth = Input.vDepth;
        float4 fComparison = ( vCurrentPixelDepth &gt; m_fCascadeFrustumsEyeSpaceDepths_data[0]);
        float fIndex = dot(
        float4( CASCADE_COUNT_FLAG &gt; 0,
        CASCADE_COUNT_FLAG &gt; 1,
        CASCADE_COUNT_FLAG &gt; 2,
        CASCADE_COUNT_FLAG &gt; 3)
        , fComparison );

        fIndex = min( fIndex, CASCADE_COUNT_FLAG );
        iCurrentCascadeIndex = (int)fIndex;
"><span>        float4 vCurrentPixelDepth = Input.vDepth;
        float4 fComparison = ( vCurrentPixelDepth &gt; m_fCascadeFrustumsEyeSpaceDepths_data[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">float</span> fIndex = dot(
        float4( CASCADE_COUNT_FLAG &gt; <span class="hljs-number">0</span>,
        CASCADE_COUNT_FLAG &gt; <span class="hljs-number">1</span>,
        CASCADE_COUNT_FLAG &gt; <span class="hljs-number">2</span>,
        CASCADE_COUNT_FLAG &gt; <span class="hljs-number">3</span>)
        , fComparison );

        fIndex = min( fIndex, CASCADE_COUNT_FLAG );
        iCurrentCascadeIndex = (<span class="hljs-keyword">int</span>)fIndex;
</span></code></pre>
<p>Once the cascade is selected, the texture coordinate must be transformed to the correct cascade.</p>
<div class="codeHeader" id="code-try-3" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="vShadowTexCoord = mul( InterpolatedPosition, m_mShadow[iCascadeIndex] );
"><span>vShadowTexCoord = mul( InterpolatedPosition, m_mShadow[iCascadeIndex] );
</span></code></pre>
<p>This texture coordinate is then used to sample the texture with the X-coordinate and the Y-coordinate. The Z-coordinate is used to do the final depth comparison.</p>
<h3 id="map-based-cascade-selection" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#map-based-cascade-selection" aria-labelledby="map-based-cascade-selection"></a>Map-Based Cascade Selection</h3>
<p>Map-based selection (Figure 8) tests against the four sides of the cascades to find the tightest map that covers the specific pixel. Instead of calculating the position in world space, the vertex shader calculates the view-space position for every cascade. The pixel shader iterates over the cascades in order to scale and shift the texture coordinates so that they index the current cascade. The texture coordinate is then tested against the texture bounds. When the X and Y values of the texture coordinate fall inside a cascade, they are used to sample the texture. The Z-coordinate is used to do the final depth comparison.</p>
<p><strong>Figure 8. Map-based cascade selection</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/map-based-cascade-selection.jpg" alt="map-based cascade selection" data-linktype="relative-path"></p>
<h3 id="interval-based-selection-vs-map-based-selection" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#interval-based-selection-vs-map-based-selection" aria-labelledby="interval-based-selection-vs-map-based-selection"></a>Interval-Based Selection vs. Map-Based Selection</h3>
<p>Interval-based selection is slightly faster than map-based selection because the cascade selection can be done directly. Map-based selection must intersect the texture coordinate with the cascade bounds.</p>
<p>Map-based selection uses the cascade more efficiently when shadow maps do not align perfectly (see Figure 8).</p>
<h2 id="blend-between-cascades" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#blend-between-cascades" aria-labelledby="blend-between-cascades"></a>Blend between Cascades</h2>
<p>VSMs (discussed later in this article) and filtering techniques such as PCF can be used with low-resolution CSMs to produce soft shadows. Unfortunately, this results in a visible seam (Figure 9) between cascade layers because the resolution does not match. The solution is to create a band between shadow maps where the shadow test is performed for both cascades. The shader then linearly interpolates between the two values based on the pixel's location in the blend band. The samples CascadedShadowMaps11 and VarianceShadows11 provide a GUI slider that can be used to increase and decrease this blur band. The shader performs a dynamic branch so that the vast majority of pixels only read from the current cascade.</p>
<p><strong>Figure 9. Cascade seams</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/cascade-seams.jpg" alt="cascade seams" data-linktype="relative-path"></p>
<p>(Left) A visible seam can be seen where cascades overlap. (Right) When the cascades are blended between, no seam occurs.</p>
<h2 id="filtering-shadow-maps" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#filtering-shadow-maps" aria-labelledby="filtering-shadow-maps"></a>Filtering Shadow Maps</h2>
<h3 id="pcf" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#pcf" aria-labelledby="pcf"></a>PCF</h3>
<p>Filtering ordinary shadow maps does not produce soft, blurred shadows. The filtering hardware blurs the depth values, and then compares those blurred values to the light space texel. The hard edge resulting from the pass/fail test still exists. Blurring shadow maps only serves to erroneously move the hard edge. PCF enables filtering on shadow maps. The general idea of PCF is to calculate a percentage of the pixel in shadow based on the number of subsamples that pass the depth test over the total number of subsamples.</p>
<p>Direct3D 10 and Direct3D 11 hardware can perform PCF. The input to a PCF sampler consists of the texture-coordinate and a comparison depth value. For simplicity, PCF is explained with a four-tap filter. The texture sampler reads the texture four times, similar to a standard filter. However, the returned result is a percentage of the pixels that passed the depth test. Figure 10 shows how a pixel that passes one of the four depth tests is 25 percent in shadow. The actual value returned is a linear interpolation based on the subtexel coordinates of the texture reads to produce a smooth gradient. Without this linear interpolation, the four-tap PCF would only be able to return five values: { 0.0, 0.25, 0.5, 0.75, 1.0 }.</p>
<p><strong>Figure 10. PCF filtered image, with 25 percent of the selected pixel covered</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/pcf-filtered-image.png" alt="pcf filtered image, with 25 percent of the selected pixel covered" data-linktype="relative-path"></p>
<p>It is also possible to do PCF without hardware support or extend PCF to larger kernels. Some techniques even sample with a weighted kernel. To do this, create a kernel (such as a Gaussian) for an N × N grid. The weights must add up to 1. The texture is then sampled N2 times. Each sample is scaled by the corresponding weights in the kernel. The CascadedShadowMaps11 sample uses this approach.</p>
<h3 id="depth-bias" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#depth-bias" aria-labelledby="depth-bias"></a>Depth Bias</h3>
<p>Depth bias becomes even more important when large PCF kernels are used. It is only valid to compare a pixel's light-space depth against the pixel it maps to in the depth map. The depth map texel's neighbors refer to a different position. This depth is likely to be similar, but can be very different depending on the scene. Figure 11 highlights the artifacts that occur. A single depth is compared to three neighboring texels in the shadow map. One of the depth tests erroneously fails because its depth does not correlate to the computed light-space depth of the current geometry. The recommended solution to this problem is to use a larger offset. Too large of an offset, however, can result in Peter Panning. Calculating a tight near plane and far plane helps reduce the effects of using an offset.</p>
<p><strong>Figure 11. Erroneous self-shadowing</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/erroneous-self-shadowing.png" alt="erroneous self-shadowing" data-linktype="relative-path"></p>
<p>The erroneous self-shadowing results from comparing pixels in the light-space depth to the texels in the shadow map that do not correlate. The depth in light-space correlates to shadow texel 2 in the depth map. Texel 1 is greater than the light-space depth while 2 is equal and 3 is less. Texels 2 and 3 pass the depth test, while Texel 1 fails.</p>
<h3 id="calculating-a-per-texel-depth-bias-with-ddx-and-ddy-for-large-pcfs" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#calculating-a-per-texel-depth-bias-with-ddx-and-ddy-for-large-pcfs" aria-labelledby="calculating-a-per-texel-depth-bias-with-ddx-and-ddy-for-large-pcfs"></a>Calculating a Per-Texel Depth Bias with DDX and DDY for Large PCFs</h3>
<p>Calculating a per texel depth bias with <strong>ddx</strong> and <strong>ddy</strong> for large PCFs is a technique that calculates the correct depth bias—assuming the surface is planar—for the adjacent shadow map texel.</p>
<p>This technique fits the comparison depth to a plane using the derivative information. Because this technique is computationally complex, it should be used only when a GPU has compute cycles to spare. When very large kernels are used, this may be the only technique that works to remove self-shadowing artifacts without causing Peter Panning.</p>
<p>Figure 12 highlights the problem. The depth in light-space is known for the one texel that is being compared. The light-space depths that correspond to the neighboring texels in the depth map are unknown.</p>
<p><strong>Figure 12. Scene and depth map</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/scene-and-depth-map.png" alt="scene and depth map" data-linktype="relative-path"></p>
<p>The rendered scene is shown at left, and the depth map with a sample texel block is shown at right. The eye-space texel maps to the pixel labeled D in the center of the block. This comparison is accurate. The correct depth in eye space correlating to the pixels that neighbor D is unknown. Mapping the neighboring texels back to eye space is possible only if we assume the pixel pertains to the same triangle as D.</p>
<p>The depth is known for the texel that correlates with the light-space position. The depth is unknown for the neighboring texels in the depth map.</p>
<p>At a high level, this technique uses the <strong>ddx</strong> and <strong>ddy</strong> HLSL operations to find the derivative of the light-space position. This is nontrivial because the derivative operations return the gradient of the light-space depth with respect to screen space. To convert this to a gradient of the light-space depth with respect to light space, a conversion matrix must be calculated.</p>
<h3 id="explanation-with-shader-code" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#explanation-with-shader-code" aria-labelledby="explanation-with-shader-code"></a>Explanation with Shader Code</h3>
<p>The details of the rest of the algorithm are given as an explanation of the shader code that performs this operation. This code can be found in the CascadedShadowMaps11 sample. Figure 13 shows how the light-space texture coordinates map to the depth map and how the derivatives in X and Y can be used to create a transformation matrix.</p>
<p><strong>Figure 13. Screen-space to light-space matrix</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/screen-space-to-light-space-matrix.png" alt="screen-space to light-space matrix" data-linktype="relative-path"></p>
<p>The derivatives of the light-space position in X and Y are used to create this matrix.</p>
<p>The first step is to calculate the derivative of the light-view-space position.</p>
<div class="codeHeader" id="code-try-4" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="          float3 vShadowTexDDX = ddx (vShadowMapTextureCoordViewSpace);
          float3 vShadowTexDDY = ddy (vShadowMapTextureCoordViewSpace);
"><span>          float3 vShadowTexDDX = ddx (vShadowMapTextureCoordViewSpace);
          float3 vShadowTexDDY = ddy (vShadowMapTextureCoordViewSpace);
</span></code></pre>
<p>Direct3D 11 class GPUs calculate these derivatives by running 2 × 2 quad of pixels in parallel and subtracting the texture coordinates from the neighbor in X for <strong>ddx</strong> and from the neighbor in Y for <strong>ddy</strong>. These two derivatives make up the rows of a 2 × 2 matrix. In its current form, this matrix could be used to convert screen-space neighboring pixels to light-space slopes. However, the inverse of this matrix is needed. A matrix that transforms light-space neighboring pixels to screen-space slopes is needed.</p>
<div class="codeHeader" id="code-try-5" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="          float2x2 matScreentoShadow = float2x2( vShadowTexDDX.xy, vShadowTexDDY.xy );
          float fInvDeterminant = 1.0f / fDeterminant;

          float2x2 matShadowToScreen = float2x2 (
          matScreentoShadow._22 * fInvDeterminant,
          matScreentoShadow._12 * -fInvDeterminant,
          matScreentoShadow._21 * -fInvDeterminant,
          matScreentoShadow._11 * fInvDeterminant );
"><span>          float2x2 matScreentoShadow = float2x2( vShadowTexDDX.xy, vShadowTexDDY.xy );
          <span class="hljs-keyword">float</span> fInvDeterminant = <span class="hljs-number">1.0f</span> / fDeterminant;

          float2x2 matShadowToScreen = float2x2 (
          matScreentoShadow._22 * fInvDeterminant,
          matScreentoShadow._12 * -fInvDeterminant,
          matScreentoShadow._21 * -fInvDeterminant,
          matScreentoShadow._11 * fInvDeterminant );
</span></code></pre>
<p><strong>Figure 14. Light-space to screen-space</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/light-space-to-screen-space.png" alt="light-space to screen-space" data-linktype="relative-path"></p>
<p>This matrix is then used to transform the two texels above and to the right of the current texel. These neighbors are represented as an offset from the current texel.</p>
<div class="codeHeader" id="code-try-6" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="          float2 vRightShadowTexelLocation = float2( m_fTexelSize, 0.0f );
          float2 vUpShadowTexelLocation = float2( 0.0f, m_fTexelSize );
          float2 vRightTexelDepthRatio = mul( vRightShadowTexelLocation,
          matShadowToScreen );
          float2 vUpTexelDepthRatio = mul( vUpShadowTexelLocation,
          matShadowToScreen );
"><span>          float2 vRightShadowTexelLocation = float2( m_fTexelSize, <span class="hljs-number">0.0f</span> );
          float2 vUpShadowTexelLocation = float2( <span class="hljs-number">0.0f</span>, m_fTexelSize );
          float2 vRightTexelDepthRatio = mul( vRightShadowTexelLocation,
          matShadowToScreen );
          float2 vUpTexelDepthRatio = mul( vUpShadowTexelLocation,
          matShadowToScreen );
</span></code></pre>
<p>The ratio that the matrix creates is finally multiplied by the depth derivatives to calculate the depth offsets for the neighboring pixels.</p>
<div class="codeHeader" id="code-try-7" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="            float fUpTexelDepthDelta =
            vUpTexelDepthRatio.x * vShadowTexDDX.z
            + vUpTexelDepthRatio.y * vShadowTexDDY.z;
            float fRightTexelDepthDelta =
            vRightTexelDepthRatio.x * vShadowTexDDX.z
            + vRightTexelDepthRatio.y * vShadowTexDDY.z;
"><span>            <span class="hljs-keyword">float</span> fUpTexelDepthDelta =
            vUpTexelDepthRatio.x * vShadowTexDDX.z
            + vUpTexelDepthRatio.y * vShadowTexDDY.z;
            <span class="hljs-keyword">float</span> fRightTexelDepthDelta =
            vRightTexelDepthRatio.x * vShadowTexDDX.z
            + vRightTexelDepthRatio.y * vShadowTexDDY.z;
</span></code></pre>
<p>These weights can now be used in a PCF loop to add an offset to the position.</p>
<div class="codeHeader" id="code-try-8" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="    for( int x = m_iPCFBlurForLoopStart; x &lt; m_iPCFBlurForLoopEnd; ++x ) 
    {
        for( int y = m_iPCFBlurForLoopStart; y &lt; m_iPCFBlurForLoopEnd; ++y )
            {
            if ( USE_DERIVATIVES_FOR_DEPTH_OFFSET_FLAG )
            {
            depthcompare += fRightTexelDepthDelta * ( (float) x ) +
            fUpTexelDepthDelta * ( (float) y );
            }
            // Compare the transformed pixel depth to the depth read
            // from the map.
            fPercentLit += g_txShadow.SampleCmpLevelZero( g_samShadow,
            float2(
            vShadowTexCoord.x + ( ( (float) x ) * m_fNativeTexelSizeInX ) ,
            vShadowTexCoord.y + ( ( (float) y ) * m_fTexelSize )
            ),
            depthcompare
            );
            }
     }
"><span>    <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> x = m_iPCFBlurForLoopStart; x &lt; m_iPCFBlurForLoopEnd; ++x ) 
    {
        <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> y = m_iPCFBlurForLoopStart; y &lt; m_iPCFBlurForLoopEnd; ++y )
            {
            <span class="hljs-keyword">if</span> ( USE_DERIVATIVES_FOR_DEPTH_OFFSET_FLAG )
            {
            depthcompare += fRightTexelDepthDelta * ( (<span class="hljs-keyword">float</span>) x ) +
            fUpTexelDepthDelta * ( (<span class="hljs-keyword">float</span>) y );
            }
            <span class="hljs-comment">// Compare the transformed pixel depth to the depth read</span>
            <span class="hljs-comment">// from the map.</span>
            fPercentLit += g_txShadow.SampleCmpLevelZero( g_samShadow,
            float2(
            vShadowTexCoord.x + ( ( (<span class="hljs-keyword">float</span>) x ) * m_fNativeTexelSizeInX ) ,
            vShadowTexCoord.y + ( ( (<span class="hljs-keyword">float</span>) y ) * m_fTexelSize )
            ),
            depthcompare
            );
            }
     }
</span></code></pre>
<h2 id="pcf-and-csms" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#pcf-and-csms" aria-labelledby="pcf-and-csms"></a>PCF and CSMs</h2>
<p>PCF does not work on texture arrays in Direct3D 10. To use PCF, all of the cascades are stored in one large texture atlas.</p>
<h3 id="derivative-based-offset" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#derivative-based-offset" aria-labelledby="derivative-based-offset"></a>Derivative-Based Offset</h3>
<p>Adding the derivative based offsets for CSMs presents some challenges. This is due to a derivative calculation within divergent flow control. The problem occurs because of a fundamental way that GPUs operate. Direct3D11 GPUs operate on 2 × 2 quads of pixels. To perform a derivative, GPUs generally subtract the current pixel's copy of a variable from the neighboring pixel's copy of that same variable. How this happens varies from GPU to GPU. The texture coordinates are determined by map-based or interval-based cascade selection. Some pixels in a pixel quad choose a different cascade than the rest of the pixels. This results in visible seams between shadow maps because the derivative-based offsets are now completely wrong. The solution is to perform the derivative on light-view space texture coordinates. These coordinates are the same for every cascade.</p>
<h3 id="padding-for-pcf-kernels" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#padding-for-pcf-kernels" aria-labelledby="padding-for-pcf-kernels"></a>Padding for PCF Kernels</h3>
<p>PCF kernels index outside of a cascade partition if the shadow buffer is not padded. The solution is to pad the outer rim of the cascade by one-half the size of the PCF kernel. This must be implemented in the shader that selects the cascade and in the projection matrix that must render the cascade large enough that the border is preserved.</p>
<h2 id="variance-shadow-maps" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#variance-shadow-maps" aria-labelledby="variance-shadow-maps"></a>Variance Shadow Maps</h2>
<p>VSMs (see <a href="https://portal.acm.org/citation.cfm?doid=1111411.1111440" data-linktype="external">Variance shadow maps</a> by Donnelly and Lauritzen for more information) enable direct shadow map filtering. When using VSMs, all of the power of the texture-filtering hardware can be used. Trilinear and anisotropic (Figure 15) filtering can be used. Additionally, VSMs can be blurred directly through convolution. VSMs do have some drawbacks; two channels of depth data must be stored (depth and depth squared). When shadows overlap, light-bleeding is common. They work well, however, with lower resolutions and can be combined with CSMs.</p>
<p><strong>Figure 15. Anisotropic filtering</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/anisotropic-filtering.png" alt="anisotropic filtering" data-linktype="relative-path"></p>
<h3 id="algorithm-details" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#algorithm-details" aria-labelledby="algorithm-details"></a>Algorithm Details</h3>
<p>VSMs work by rendering the depth and the depth squared to a two-channel shadow map. This two-channel shadow map can then be blurred and filtered just like a normal texture. The algorithm then uses Chebychev's Inequality in the pixel shader to estimate the fraction of pixel area that would pass the depth test.</p>
<p>The pixel shader fetches the depth and depth-squared values.</p>
<div class="codeHeader" id="code-try-9" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        float  fAvgZ  = mapDepth.x; // Filtered z
        float  fAvgZ2 = mapDepth.y; // Filtered z-squared
"><span>        <span class="hljs-keyword">float</span>  fAvgZ  = mapDepth.x; <span class="hljs-comment">// Filtered z</span>
        <span class="hljs-keyword">float</span>  fAvgZ2 = mapDepth.y; <span class="hljs-comment">// Filtered z-squared</span>
</span></code></pre>
<p>The depth comparison is performed.</p>
<div class="codeHeader" id="code-try-10" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        if ( fDepth &lt;= fAvgZ )
        {
        fPercentLit = 1;
        }
"><span>        <span class="hljs-keyword">if</span> ( fDepth &lt;= fAvgZ )
        {
        fPercentLit = <span class="hljs-number">1</span>;
        }
</span></code></pre>
<p>If the depth comparison fails, the percentage of the pixel that is lit is estimated. Variance is calculated as average-of-squares minus square-of-average.</p>
<div class="codeHeader" id="code-try-11" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        float variance = ( fAvgZ2 ) − ( fAvgZ * fAvgZ );
        variance = min( 1.0f, max( 0.0f, variance + 0.00001f ) );
"><span>        <span class="hljs-keyword">float</span> variance = ( fAvgZ2 ) − ( fAvgZ * fAvgZ );
        variance = min( <span class="hljs-number">1.0f</span>, max( <span class="hljs-number">0.0f</span>, variance + <span class="hljs-number">0.00001f</span> ) );
</span></code></pre>
<p>The fPercentLit value is estimated with Chebychev's Inequality.</p>
<div class="codeHeader" id="code-try-12" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        float mean           = fAvgZ;
        float d              = fDepth - mean;
        float fPercentLit    = variance / ( variance + d*d );
"><span>        <span class="hljs-keyword">float</span> mean           = fAvgZ;
        <span class="hljs-keyword">float</span> d              = fDepth - mean;
        <span class="hljs-keyword">float</span> fPercentLit    = variance / ( variance + d*d );
</span></code></pre>
<h2 id="light-bleeding" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#light-bleeding" aria-labelledby="light-bleeding"></a>Light Bleeding</h2>
<p>The biggest drawback to VSMs is light bleeding (Figure 16). Light bleeding occurs when multiple shadow casters occlude each other along edges. VSMs shade the edges of shadows based on depth disparities. When shadows overlap each other, a depth disparity exists in the center of a region that should be shadowed. This is a problem with using the VSM algorithm.</p>
<p><strong>Figure 16. VSM light bleeding</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/vsm-light-bleeding.png" alt="vsm light bleeding" data-linktype="relative-path"></p>
<p>A partial solution to the problem is to raise the fPercentLit to a power. This has the effect of dampening the blur, which can cause artifacts where depth disparity is small. Sometimes there exists a magical value that alleviates the problem.</p>
<div class="codeHeader" id="code-try-13" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="fPercentLit = pow( p_max, MAGIC_NUMBER );
"><span>fPercentLit = <span class="hljs-built_in">pow</span>( p_max, MAGIC_NUMBER );
</span></code></pre>
<p>An alternative to raising the percent lit to a power is to avoid configurations where shadows overlap. Even highly tuned shadow configurations have several constraints on light, camera, and geometry. Light bleeding is also lessened by using higher resolution textures.</p>
<p>Layered variance shadow maps (LVSMs) solve the problem at the expense of breaking the frustum into layers that are perpendicular to the light. The number of maps required would be quite large when CSMs are also being used.</p>
<p>Additionally, Andrew Lauritzen, co-author of the paper on VSMs, and author of a paper on LVSMs, discussed combining exponential shadow maps (ESMs) with VSMs to counteract light blending in a <a href="https://forum.beyond3d.com/showthread.php?t=47427" data-linktype="external">Beyond3D Forum</a>.</p>
<h2 id="vsms-with-csms" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-with-csms" aria-labelledby="vsms-with-csms"></a>VSMs with CSMs</h2>
<p>The sample VarianceShadow11 combines VSMs and CSMs. The combination is fairly straightforward. The sample follows the same steps as the CascadedShadowMaps11 sample. Because PCF is not used, the shadows are blurred in a two-pass separable convolution. Not using PCF also enables the sample to use texture arrays instead of a texture atlas. PCF on texture arrays is a Direct3D 10.1 feature.</p>
<h3 id="gradients-with-csms" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#gradients-with-csms" aria-labelledby="gradients-with-csms"></a>Gradients with CSMs</h3>
<p>Using gradients with CSMs can produce a seam along the border between two cascades as seen in Figure 17. The sample instruction uses derivatives between pixels to calculate information, such as the mipmap level, needed by the filter. This causes a problem in particular for mipmap selection or anisotropic filtering. When pixels in a quad take different branches in the shader, the derivatives calculated by the GPU hardware are invalid. This results in a jagged seam along the shadow map.</p>
<p><strong>Figure 17. Seams on cascade borders due to anisotropic filtering with divergent flow control</strong></p>
<p><img src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/seams-on-cascade-borders-due-to-anisotropic.jpg" alt="seams on cascade borders due to anisotropic filtering with divergent flow control" data-linktype="relative-path"></p>
<p>This problem is solved by computing the derivatives on the position in light-view space; the light-view space coordinate is not specific to the selected cascade. The computed derivatives can be scaled by the scale portion of the projection-texture matrix to the correct mipmap level.</p>
<div class="codeHeader" id="code-try-14" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-4">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="        float3 vShadowTexCoordDDX = ddx( vShadowMapTextureCoordViewSpace );
        vShadowTexCoordDDX *= m_vCascadeScale[iCascade].xyz;
        float3 vShadowTexCoordDDY = ddy( vShadowMapTextureCoordViewSpace );
        vShadowTexCoordDDY *= m_vCascadeScale[iCascade].xyz;

        mapDepth += g_txShadow.SampleGrad( g_samShadow, vShadowTexCoord.xyz,
        vShadowTexCoordDDX, vShadowTexCoordDDY );
"><span>        float3 vShadowTexCoordDDX = ddx( vShadowMapTextureCoordViewSpace );
        vShadowTexCoordDDX *= m_vCascadeScale[iCascade].xyz;
        float3 vShadowTexCoordDDY = ddy( vShadowMapTextureCoordViewSpace );
        vShadowTexCoordDDY *= m_vCascadeScale[iCascade].xyz;

        mapDepth += g_txShadow.SampleGrad( g_samShadow, vShadowTexCoord.xyz,
        vShadowTexCoordDDX, vShadowTexCoordDDY );
</span></code></pre>
<h2 id="vsms-compared-to-standard-shadows-with-pcf" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-compared-to-standard-shadows-with-pcf" aria-labelledby="vsms-compared-to-standard-shadows-with-pcf"></a>VSMs Compared to Standard Shadows with PCF</h2>
<p>Both VSMs and PCF attempt to approximate the fraction of pixel area that would pass the depth test. VSMs work with filtering hardware and can be blurred with separable kernels. Separable convolution kernels are considerably cheaper to implement than a full kernel. Additionally, VSMs compare one light-space depth against one value in the light-space depth map. This means that VSMs do not have the same offset problems as PCF. Technically, VSMs are sampling depth over a greater area, as well as performing a statistical analysis. This is less precise than PCF. In practice, VSMs do a very good job of blending, which results in less offset being necessary. As described above, the number one drawback to VSMs is light bleeding.</p>
<p>VSMs and PCF represent a trade-off between GPU compute power and GPU texture bandwidth. VSMs require more math to be performed to calculate the variance. PCF requires more texture memory bandwidth. Large PCF kernels can quickly become bottlenecked by texture bandwidth. With GPU computation power growing more rapidly than GPU bandwidth, VSMs are becoming the more practical of the two algorithms. VSMs also look better with lower resolution shadow maps due to blending and filtering.</p>
<h2 id="summary" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#summary" aria-labelledby="summary"></a>Summary</h2>
<p>CSMs offer a solution to the perspective aliasing problem. There are several possible configurations to get the needed visual fidelity for a title. PCF and VSMs are widely used and should be combined with CSMs to reduce aliasing.</p>
<h2 id="references" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#references" aria-labelledby="references"></a>References</h2>
<p>Donnelly, W. and Lauritzen, A. <a href="https://portal.acm.org/citation.cfm?doid=1111411.1111440" data-linktype="external">Variance shadow maps</a>. In SI3D '06: Proceedings of the 2006 symposium on Interactive 3D graphics and games. 2006. pp. 161–165. New York, NY, USA: ACM Press.</p>
<p>Lauritzen, Andrew and McCool, Michael. <a href="https://portal.acm.org/citation.cfm?id=1375714.1375739&amp;coll=GUIDE&amp;dl=GUIDE&amp;CFID=45360327&amp;CFTOKEN=34578992" data-linktype="external">Layered variance shadow maps</a>. Proceedings of graphics interface 2008, May 28–30, 2008, Windsor, Ontario, Canada.</p>
<p>Engel, Woflgang F. Section 4. Cascaded Shadow Maps. ShaderX5 , Advanced Rendering Techniques, Wolfgang F. Engel, Ed. Charles River Media, Boston, Massachusetts. 2006. pp. 197–206.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

						<!-- </content> -->

						</main>

						<!-- recommended content page section -->

							<nav data-bi-name="recommendation-bottom" hidden="" id="recommended-content-center" class="is-hidden-desktop" aria-labelledby="recommended-content-center-title">
								<h3 id="recommended-content-center-title" class="is-size-2 has-margin-top-large has-margin-bottom-small">Related Articles</h3>
							</nav>

						<!-- end recommended content page section -->

						<!-- page rating section -->
								<div class="is-hidden-desktop has-border-top has-margin-top-large has-padding-top-small">
									
									
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-8">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-text is-link is-small" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->


						<!-- feedback section -->

						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="footerContainer is-visible-interactive has-default-focus ">
<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="https://docs.microsoft.com/en-us/locale?target=https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps" data-bi-name="select-locale"><span class="icon docon docon-world is-size-4 has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">English (United States)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>

    <ul class="links" data-bi-name="footerlinks">
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
		<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
						</div>
					</div>

					<div class="is-size-7 right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
						<div id="affixed-right-container" class="doc-outline is-fixed is-vertically-scrollable" style="width: 129.5px; top: 196px; bottom: 24px;">
								
								
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-8">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-text is-link is-small" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav data-bi-name="recommendation-sidebar" hidden="" id="recommended-content-nav" role="navigation" aria-labelledby="recommended-content-nav-title">
									<h3 id="recommended-content-nav-title">Related Articles</h3>
								</nav>
							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							<ol><li class="selected"><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#cascaded-shadow-maps-and-perspective-aliasing">Cascaded Shadow Maps and Perspective Aliasing</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#partitioning-the-frustum">Partitioning the Frustum</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#calculating-a-view-frustum-bound">Calculating a View-Frustum Bound</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-shadow-map">Render the Shadow Map</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#render-the-scene">Render the Scene</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#blend-between-cascades">Blend between Cascades</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#filtering-shadow-maps">Filtering Shadow Maps</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#pcf-and-csms">PCF and CSMs</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#variance-shadow-maps">Variance Shadow Maps</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#light-bleeding">Light Bleeding</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-with-csms">VSMs with CSMs</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#vsms-compared-to-standard-shadows-with-pcf">VSMs Compared to Standard Shadows with PCF</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#summary">Summary</a></li><li><a href="https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps#references">References</a></li></ol></nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<div id="openFeedbackContainer" class="openfeedback-container"></div>

	<div class="footerContainer has-default-focus is-hidden-interactive ">
<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="https://docs.microsoft.com/en-us/locale?target=https://docs.microsoft.com/en-us/windows/win32/dxtecharts/cascaded-shadow-maps" data-bi-name="select-locale"><span class="icon docon docon-world is-size-4 has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">English (United States)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
    <ul class="links" data-bi-name="footerlinks">
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
		<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
	</div>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
	<span id="adobe-target-experiment-container" hidden=""></span>


<div class="nsc-panel nsc-panel-compact nsc-hide">
    <div class="nsc-panel-move"></div>
    <div class="nsc-panel-tooltip">
        <div class="nsc-panel-tooltip-layout" layout="row" layout-align="start center">CTRL+V to toggle the panel</div>
    </div>

    <div class="nsc-panel-layout" flex="" layout="row" layout-align="start center">
        <div class="nsc-panel-groups" flex="" layout="row" layout-align="start start">

            <!-- group -->
            <div class="nsc-panel-group" flex="none" layout="row" layout-align="start start">
                <div class="nsc-panel-button separated active">
                    <div class="nsc-panel-select" flex="" layout="row">
                        <div class="nsc-panel-text nsc-noselect" flex="" layout="row" layout-align="center center">
                            <span class="nsc-icon nsc-icon-cursor-normal" data-i18n="videoPanelSimpleCursor" data-event="nimbus-editor-active-tools" data-event-param="cursorRing">&nbsp;</span>
                        </div>
                        <div class="nsc-panel-trigger">
                            <span class="nsc-icon nsc-icon-arrow">&nbsp;</span>
                        </div>
                    </div>
                    <div class="nsc-panel-dropdown to-top">
                        <ul flex="" layout="row" layout-align="start center">
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-cursor-shade" data-i18n="videoPanelFocusMouse" data-event="nimbus-editor-active-tools" data-event-param="cursorShadow">&nbsp;</span>
                            </li>
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-cursor-circle" data-i18n="videoPanelAnimatedCursor" data-event="nimbus-editor-active-tools" data-event-param="cursorRing">&nbsp;</span>
                            </li>
                            <!--<li class="nsc-panel-dropdown-icon " flex layout="row" layout-align="start center">-->
                            <!--<span class="nsc-icon nsc-icon-cursor-tail"></span>-->
                            <!--</li>-->
                            <!--<li class="nsc-panel-dropdown-icon " flex layout="row" layout-align="start center">-->
                            <!--<span class="nsc-icon nsc-icon-cursor-long"></span>-->
                            <!--</li>-->
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-cursor-normal" data-i18n="videoPanelSimpleCursor" data-event="nimbus-editor-active-tools" data-event-param="cursorDefault">&nbsp;</span>
                            </li>
                            <!--<li class="nsc-panel-dropdown-icon" flex layout="row" layout-align="start center">-->
                            <!--<span class="nsc-icon nsc-icon-cursor-none" data-event="nimbus-editor-active-tools" data-event-param="cursorNone"></span>-->
                            <!--</li>-->
                        </ul>
                    </div>
                </div>
            </div>
            <!-- /group -->

            <!-- group -->
            <div class="nsc-panel-group" flex="none" layout="row" layout-align="start start">
                <button class="nsc-panel-button" type="button">
                    <span class="nsc-icon nsc-icon-pen" data-i18n="videoPanelPen" data-event="nimbus-editor-active-tools" data-event-param="pen">&nbsp;</span>
                </button>
                <button class="nsc-panel-button" type="button">
                    <span class="nsc-icon nsc-icon-arrow-line" data-i18n="videoPanelArrow" data-event="nimbus-editor-active-tools" data-event-param="arrow">&nbsp;</span>
                </button>
                <button class="nsc-panel-button" type="button">
                    <span class="nsc-icon nsc-icon-square" data-i18n="videoPanelSquare" data-event="nimbus-editor-active-tools" data-event-param="square">&nbsp;</span>
                </button>
                <div class="nsc-panel-button separated">
                    <div class="nsc-panel-select" flex="" layout="row">
                        <div class="nsc-panel-text nsc-noselect" flex="" layout="row" layout-align="center center">
                            <span class="nsc-icon nsc-icon-attention" data-i18n="videoPanelMark" data-event="nimbus-editor-active-tools" data-event-param="notifRed">&nbsp;</span>
                        </div>
                        <div class="nsc-panel-trigger">
                            <span class="nsc-icon nsc-icon-arrow">&nbsp;</span>
                        </div>
                    </div>
                    <div class="nsc-panel-dropdown to-top">
                        <ul flex="" layout="row" layout-align="start center">
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-attention" data-i18n="videoPanelMark" data-event="nimbus-editor-active-tools" data-event-param="notifRed">&nbsp;</span>
                            </li>
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-question" data-i18n="videoPanelQuestion" data-event="nimbus-editor-active-tools" data-event-param="notifBlue">&nbsp;</span>
                            </li>
                            <li class="nsc-panel-dropdown-icon" flex="" layout="row" layout-align="start center">
                                <span class="nsc-icon nsc-icon-done" data-i18n="videoPanelCheckmark" data-event="nimbus-editor-active-tools" data-event-param="notifGreen">&nbsp;</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="nsc-panel-button assembled">
                    <div class="nsc-panel-select" flex="" layout="row">
                        <div class="nsc-panel-text nsc-noselect" flex="" layout="row" layout-align="center center">
							<span class="nsc-icon nsc-icon-fill-none nsc-panel-icon-fill">
								<span class="nsc-panel-icon-fill-inner" id="nsc_panel_button_colors" style="background:#00FF00;" data-event="nimbus-editor-active-color" data-event-param="#00FF00">&nbsp;</span>
							</span>
                        </div>
                        <div class="nsc-panel-trigger">
                            <span class="nsc-icon nsc-icon-arrow">&nbsp;</span>
                        </div>
                    </div>
                    <div class="nsc-panel-dropdown">
                        <div class="nsc-panel-drop-area">
                            <div class="nsc-panel-colors">

                                <!-- picked -->
                                <div class="nsc-colors-picked">
                                    <div class="nsc-colors-picked-layout" flex="" layout="row" layout-align="start start" layout-wrap="">
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#000000">
                                                <span class="nsc-colors-picked-button-inner" style="background: #000000;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#0000FF">
                                                <span class="nsc-colors-picked-button-inner" style="background: #0000FF;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#FF00FF">
                                                <span class="nsc-colors-picked-button-inner" style="background: #FF00FF;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#00FFFF">
                                                <span class="nsc-colors-picked-button-inner" style="background: #00FFFF;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#00FF00">
                                                <span class="nsc-colors-picked-button-inner" style="background: #00FF00;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#FFFF00">
                                                <span class="nsc-colors-picked-button-inner" style="background: #FFFF00;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#FF0000">
                                                <span class="nsc-colors-picked-button-inner" style="background: #FF0000;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <div class="nsc-colors-picked-item">
                                            <button class="nsc-colors-picked-button" type="button" data-event="nimbus-editor-active-color" data-event-param="#FFFFFF">
                                                <span class="nsc-colors-picked-button-inner" style="background: #FFFFFF;">&nbsp;</span>
                                            </button>
                                        </div>
                                        <!--<div class="nsc-colors-picked-item">-->
                                        <!--<button class="nsc-colors-picked-button custom" type="button"> -->
                                        <!--<i class="nsc-icon ic-color-custom"></i> -->
                                        <!--</button>-->
                                        <!--</div>-->
                                    </div>
                                </div>
                                <!-- /picked -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /group -->

            <!-- group -->
            <div class="nsc-panel-group" flex="none" layout="row" layout-align="start start">
                <button class="nsc-panel-button nsc-hide" type="button">
                    <span class="nsc-icon nsc-icon-eraser" data-i18n="videoPanelClear" data-event="nimbus-editor-active-tools" data-event-param="clear">&nbsp;</span>
                </button>
                <button class="nsc-panel-button" type="button">
                    <span class="nsc-icon nsc-icon-eraser-all" data-i18n="videoPanelClearAll" data-event="nimbus-editor-active-tools" data-event-param="clearAll">&nbsp;</span>
                </button>
                <button class="nsc-panel-button" type="button">
                    <span class="nsc-icon nsc-icon-webcam" data-i18n="videoPanelCamera" id="nimbus_web_camera_toggle">&nbsp;</span>
                </button>
            </div>
            <!-- /group -->
        </div>

        <div class="nsc-panel-actions" flex="none" layout="row" layout-align="start center">
            <button class="nsc-panel-button big" type="button" id="nsc_panel_button_play" style="display: none;">
                <span class="nsc-icon nsc-icon-play">&nbsp;</span>
            </button>
            <button class="nsc-panel-button big" type="button" id="nsc_panel_button_pause">
                <span class="nsc-icon nsc-icon-pause">&nbsp;</span>
            </button>
            <button class="nsc-panel-button big" type="button" id="nsc_panel_button_stop">
                <span class="nsc-icon nsc-icon-stop">&nbsp;</span>
            </button>
        </div>

        <!-- panel togglers -->
        <div class="nsc-panel-togglers" layout="row" layout-align="start center" flex="none">
            <button class="nsc-panel-toggle-button" type="button">
                <span class="nsc-icon nsc-icon-panel-close" data-i18n="videoPanelHideShowPanel">&nbsp;</span>
            </button>
        </div>
        <!-- /panel togglers -->

    </div>
</div>
<div class="nsc-video-editor nsc-hide events" style="width: 1263px; height: 16893px;"><canvas width="1263" height="16893" style="width: 1263px; height: 16893px; position: absolute; top: 0px; left: 0px; z-index: 0;"></canvas><canvas width="1263" height="16893" style="width: 1263px; height: 16893px; position: absolute; top: 0px; left: 0px; z-index: 1;"></canvas><canvas width="1263" height="16893" style="width: 1263px; height: 16893px; position: absolute; top: 0px; left: 0px; z-index: 2;"></canvas></div><div class="nsc-content-camera nsc-hide" style="top: 0px; left: 0px;">
    <div class="nsc-content-camera-buttons" flex="none" layout="row" layout-align="start start">
        <button class="nsc-content-camera-button" type="button" id="nsc_video_camera_collapse" style="display: none">
            <span class="nsc-icon nsc-icon-panel-collapse"></span>
        </button>
        <button class="nsc-content-camera-button" type="button" id="nsc_video_camera_expand">
            <span class="nsc-icon nsc-icon-panel-expand"></span>
        </button>
        <button class="nsc-content-camera-button" type="button" id="nsc_video_camera_close">
            <span class="nsc-icon nsc-icon-panel-close"></span>
        </button>
    </div>
    <div class="nsc-content-camera-container">
        <div class="nsc-content-camera-shadow"></div>
    </div>
</div>
<div class="usabilla_live_button_container" role="button" tabindex="0" style="top: 50%; margin-top: 0px; position: fixed; width: 0px; height: 0px; z-index: 99999990; right: 0px; display: none;" aria-label="Usabilla Feedback Button"><iframe src="./Cascaded Shadow Maps - Win32 apps _ Microsoft Docs_files/saved_resource(1).html" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" data-tags="right" title="Usabilla Feedback Button" style="width: 0px; height: 0px; margin: 0px; padding: 0px; border: 0px; overflow: hidden; z-index: 9998; position: absolute; left: 0px; top: 0px; box-shadow: 0px 0px 0px; background-color: transparent;"></iframe></div></body></html>